<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>External Backup using RBME - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "External Backup using RBME";
        var mkdocs_page_input_path = "scenarios/rbme.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">External Backup using RBME</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#install_rbme_package">Install RBME package</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#configuring_rbme">Configuring RBME</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#configuring_rear_for_using_rbme">Configuring ReaR for using RBME</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#running_rearrbme">Running ReaR/RBME</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#recover_the_system_with_rbme">Recover the system with RBME</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#references">References</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="restic.html">External Backup using restic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../issues/index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">SCENARIOS</li>
      <li class="breadcrumb-item active">External Backup using RBME</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="rsync_backup_made_easy_rbme">Rsync Backup Made Easy (RBME)<a class="headerlink" href="#rsync_backup_made_easy_rbme" title="Permanent link">&para;</a></h1>
<p>RBME was created by <a href="https://schlomo.schapiro.org/">Schlomo Schapiro</a> in 2006 to have a simple backup using rsync per host and per day classified on the backup server.</p>
<p>ReaR 2.6 until 2.9 can only perform a recovery using RBME! Therefore, making backup with RBME needs to be done outside of ReaR.</p>
<p>However, we made a quick update to ReaR (v3.0 which is not released yet) to make a RBME backup via a <code>rear -v mkbackup</code> run.</p>
<h2 id="install_rbme_package">Install RBME package<a class="headerlink" href="#install_rbme_package" title="Permanent link">&para;</a></h2>
<p>The rbme package is not available anywhere, therefore, you have to generate it yourself by cloning <a href="https://github.com/gdha/rbme">Gratien's rbme clone from Schlomo</a> if you want to create a RMP package.</p>
<p>The installation of the rpm or deb package has to be done as root via the usual commands. As reminder, <code>rbme</code> relies on <code>procmail</code>, so have this installed if not present.</p>
<h2 id="configuring_rbme">Configuring RBME<a class="headerlink" href="#configuring_rbme" title="Permanent link">&para;</a></h2>
<p>RBME comes with a <code>/etc/rbme.conf</code> configuration file. All details are nicely explained in this configuration file.</p>
<p>However, it is important to set the <code>BACKUP_PATH</code> variable correct!</p>
<pre><code># Where to create the backups in.
# Strongly recommended to be a separate filesystem !
BACKUP_PATH=/backup
</code></pre>
<p>Be aware, that RBME backup workflow will generate another configuration file which will overrule the main setting of <code>BACKUP_PATH</code>:</p>
<pre><code>/etc/rbme.local.conf - path will be changed each time you run `rear mkbackup`
BACKUP_PATH=/var/tmp/rear.GfkC5WobMbH7DcV/outputfs
</code></pre>
<p>If you want to receive a mail report make sure that <code>postfix</code> is installed and configure also in <code>/etc/rbme.conf</code>:</p>
<pre><code># send result per email, separate multiple addresses by spaces
MAILTO=root
</code></pre>
<p>Before making the first backup with RBME we could create an exclude list to avoid backing up some file systems, e.g.:</p>
<pre><code># cat /etc/backup-excludes.lst 
/apps
/VMs
</code></pre>
<p>It is not required to add system in-memory file systems like <code>/proc</code>, <code>/sys</code>, <code>/tmp</code>, <code>/var/tmp</code> or <code>/run</code></p>
<h2 id="configuring_rear_for_using_rbme">Configuring ReaR for using RBME<a class="headerlink" href="#configuring_rear_for_using_rbme" title="Permanent link">&para;</a></h2>
<p>The following <code>/etc/rear/local.conf</code> file was used to make a backup with RBME via ReaR:</p>
<pre><code># cat /etc/rear/local.conf 
# This file etc/rear/local.conf is intended for the user's
# manual configuration of Relax-and-Recover (ReaR).
#
#### Rsync Backup Made Easy ####
################################
# RBME backup: Finished in 8131 seconds (135 min) -for 2.9 Gb data
BACKUP=RBME
BACKUP_URL=nfs://192.168.122.1/apps/export/RBME

# Use the same IP address(es) of the this system to be activated in the rescue OS
USE_STATIC_NETWORKING="y"

# To be able to login via ssh
SSH_ROOT_PASSWORD="relax"

# To save space limit what we need within rescue image (no firmware and only the loaded kernel modules)
# The difference in size of the iso image is 800Mb with and 80Mb without.
FIRMWARE_FILES=( 'no' )
MODULES=( 'loaded_modules' )

PROGRESS_MODE="plain"
PROGRESS_WAIT_SECONDS="10"
</code></pre>
<h2 id="running_rearrbme">Running ReaR/RBME<a class="headerlink" href="#running_rearrbme" title="Permanent link">&para;</a></h2>
<p>Now to make a ReaR image and a full backup of your system with RBME just run:</p>
<pre><code># rear -v mkbackup
....
Make a backup via RBME
</code></pre>
<p>Be aware, this may take a very long time to finish the first time you run RBME (more than 1 hour).</p>
<p>You could also run during the day <code>rear mkbackuponly</code> to just execute <code>rbme</code> without creating an iso image. This will take only a few seconds now.</p>
<p>For example, on our backup server we see the following inside the archive directory:</p>
<pre><code>dr-xr-xr-x. 18 root root      4096 Nov  6 10:35 2025-11-07
dr-xr-xr-x. 18 root root      4096 Nov  6 10:35 2025-11-13
dr-xr-xr-x. 16 root root      4096 Nov  6 10:35 2025-11-17
dr-xr-xr-x. 14 root root       190 Nov  6 10:35 2025-11-18
-rw-------.  1 root root       202 Nov 18 15:58 README
-rw-r--r--.  1 qemu qemu  69658624 Nov 18 15:58 rear-alma.iso
-rw-------.  1 root root    127954 Nov 18 15:58 rear-alma.log
-rw-r--r--.  1 root root 866234368 Nov 13 15:35 rear-alma-rbme.iso
-rw-------.  1 root root       267 Nov 18 15:58 VERSION
</code></pre>
<h2 id="recover_the_system_with_rbme">Recover the system with RBME<a class="headerlink" href="#recover_the_system_with_rbme" title="Permanent link">&para;</a></h2>
<p>Boot the iso image and once you have a prompt run the command: <code>rear -v recover</code></p>
<pre><code>RESCUE alma:~ # rear -v recover
Relax-and-Recover 2.6 / 2020-06-17
Running rear recover (PID 575)
Using log file: /var/log/rear/rear-alma.log
Running workflow recover within the ReaR rescue/recovery system
Starting required daemons for NFS: RPC portmapper (portmap or rpcbind) and rpc.statd if available.
Started RPC portmapper 'rpcbind'.
RPC portmapper 'rpcbind' available.
Starting rpc.statd failed.
RPC status rpc.statd unavailable (you may have to mount NFS without locking 'nolock').
Select a backup to restore.
1) 2025-11-19
2) 2025-11-20
3) Abort
#? 2
Backup 2025-11-20 chosen.
Comparing disks
Device vda has expected (same) size 8589934592 bytes (will be used for 'recover')
Disk configuration looks identical
Proceed with 'recover' (yes) otherwise manual disk layout configuration is enforced
(default 'yes' timeout 30 seconds)
yes
User confirmed to proceed with 'recover'
Start system layout restoration.
Disk '/dev/vda': creating 'msdos' partition table
Disk '/dev/vda': creating partition number 1 with name 'primary'
Disk '/dev/vda': creating partition number 2 with name 'primary'
Creating LVM PV /dev/vda2
Restoring LVM VG 'almalinux'
Sleeping 3 seconds to let udev or systemd-udevd create their devices...
Creating filesystem of type xfs with mount point / on /dev/mapper/almalinux-root.
Mounting filesystem /
Creating filesystem of type xfs with mount point /boot on /dev/vda1.
Mounting filesystem /boot
Creating swap on /dev/mapper/almalinux-swap
Disk layout created.
Restoring from backup 2025-11-20.
Preparing restore operation
Restored 461 MiB [avg 42917 KiB/sec]
Restored 991 MiB [avg 48329 KiB/sec]
Restored 1440 MiB [avg 47580 KiB/sec]
Restored 1598 MiB [avg 39912 KiB/sec]
Restored 1976 MiB [avg 39682 KiB/sec]
OK
Restored 1976 MiB in 61 seconds [avg 33176 KiB/sec]
Created SELinux /mnt/local/.autorelabel file : after reboot SELinux will relabel all files
Recreating directories (with permissions) from /var/lib/rear/recovery/directories_permissions_owner_group
Renamed LVM devices file /mnt/local//etc/lvm/devices/system.devices to /mnt/local//etc/lvm/devices/system.devices.rearbak
to prevent LVM problems in the recovered system, verify that the file
is correct after booting the recovered system and move it back, or
regenerate it using vgimportdevices.
Migrating disk-by-id mappings in certain restored files in /mnt/local to current disk-by-id mappings ...
Running dracut...
Updated initrd with new drivers for kernel 5.14.0-503.11.1.el9_5.x86_64.
Running dracut...
Updated initrd with new drivers for kernel 5.14.0-570.58.1.el9_6.x86_64.
Installing GRUB2 boot loader...
Determining where to install GRUB2 (no GRUB2_INSTALL_DEVICES specified)
Found possible boot disk /dev/vda - installing GRUB2 there
Finished 'recover'. The target system is mounted at '/mnt/local'.
Exiting rear recover (PID 575) and its descendant processes ...
Running exit tasks
</code></pre>
<p>Rebooted the recovered system, and it came up fine. No issues encountered on the system.</p>
<h3 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://github.com/schlomo/rbme">GitHub rbme project</a></li>
</ul>
              
            </div>
          </div>

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="restic.html" class="btn btn-neutral float-right" title="External Backup using restic">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="netfs_rsync.html" class="btn btn-neutral" title="Internal Backup with rsync to NFS server"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=scenarios/rbme.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
      <span><a href="netfs_rsync.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="restic.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
