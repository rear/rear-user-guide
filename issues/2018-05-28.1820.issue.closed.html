<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1820 Issue closed: Rear recover overwrites Mountpint ownership xxx to root - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1820 Issue closed: Rear recover overwrites Mountpint ownership xxx to root";
        var mkdocs_page_input_path = "issues/2018-05-28.1820.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1820 Issue closed: Rear recover overwrites Mountpint ownership xxx to root</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1820_issue_closed_rear_recover_overwrites_mountpint_ownership_xxx_to_root"><a href="https://github.com/rear/rear/issues/1820">#1820 Issue</a> <code>closed</code>: Rear recover overwrites Mountpint ownership xxx to root<a class="headerlink" href="#1820_issue_closed_rear_recover_overwrites_mountpint_ownership_xxx_to_root" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="nirmal21s_opened_issue_at_2018-05-28_1624"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> opened issue at <a href="https://github.com/rear/rear/issues/1820">2018-05-28 16:24</a>:<a class="headerlink" href="#nirmal21s_opened_issue_at_2018-05-28_1624" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>ReaR version ("/usr/sbin/rear -V"):2.3</li>
<li>OS version ("cat /etc/rear/os.conf" or "lsb_release -a" or "cat
    /etc/os-release"):RHEL 7.5</li>
<li>ReaR configuration files ("cat /etc/rear/site.conf" or "cat
    /etc/rear/local.conf"):</li>
</ul>
<!-- -->

<pre><code>SERVER=
NSR_CLIENT_MODE=yes
OUTPUT=ISO
ISO_PREFIX="rear-nsr-$HOSTNAME"
BACKUP=NSR
OUTPUT_URL=file:///isorear/rear
export TMPDIR=/isorear/temprear
MODULES_LOAD=( tg3 igb )
#
# Static IP (no DHCP!)
USE_DHCLIENT=
USE_STATIC_NETWORKING="y"
# NTP
TIMESYNC=NTP
</code></pre>
<ul>
<li>System architecture (x86 compatible or POWER and/or what kind of
    virtual machine):x86_64</li>
<li>Are you using BIOS or UEFI or another way to boot? BIOS</li>
<li>Brief description of the issue: After rear recovery from ISO , one
    mount point has root ownershop. looks like it has overwritten .<br />
    The below FS ownership should be like below. But after restore it
    was changed to root.</li>
</ul>
<p><code>/opt/xxxxx 1775 gemapp gtousers</code><br />
But on checking "directories_permissions_owner_group" the permission
was "/opt/xxxxx 1775 gemapp gtousers"..</p>
<ul>
<li>Work-around, if any:</li>
</ul>
<h4 id="nirmal21s_commented_at_2018-05-29_0222"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1820#issuecomment-392634721">2018-05-29 02:22</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-05-29_0222" title="Permanent link">&para;</a></h4>
<p>@gdha @hpannenb<br />
For this issue , i hope this entry will solve this issue
"DIRECTORY_ENTRIES_TO_RECOVER="<br />
But i am confused with the syntax , kindly correct me if i am wrong .<br />
DIRECTORY_ENTRIES_TO_RECOVER=( '/opt/xxxxx 1775 gemapp gtousers' )<br />
But this mount points has no links</p>
<h4 id="nirmal21s_commented_at_2018-05-29_0231"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1820#issuecomment-392635980">2018-05-29 02:31</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-05-29_0231" title="Permanent link">&para;</a></h4>
<p>Attaching the $VAR_DIR/recovery/directories_permissions_owner_group
, In which the permission and ownership is saved correct. But during the
recovery its saving as "root"<br />
<a href="https://github.com/rear/rear/files/2046575/directories_permissions_owner_group.txt">directories_permissions_owner_group.txt</a></p>
<h4 id="gdha_commented_at_2018-05-29_0739"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1820#issuecomment-392682024">2018-05-29 07:39</a>:<a class="headerlink" href="#gdha_commented_at_2018-05-29_0739" title="Permanent link">&para;</a></h4>
<p>@nirmal21s Try to add <code>CLONE_ALL_USERS_GROUPS=yes</code> to your local.conf
file as I think your users and groups were not known within the rescue
environment.</p>
<h4 id="nirmal21s_commented_at_2018-05-29_0803"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1820#issuecomment-392688374">2018-05-29 08:03</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-05-29_0803" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
Thanks</p>
<h4 id="jsmeix_commented_at_2018-06-04_1235"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1820#issuecomment-394339087">2018-06-04 12:35</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-06-04_1235" title="Permanent link">&para;</a></h4>
<p>@nirmal21s<br />
you changed your
<a href="https://github.com/rear/rear/issues/1820#issuecomment-392688374">https://github.com/rear/rear/issues/1820#issuecomment-392688374</a><br />
from <code>Thanks . it worked</code> to plain <code>Thanks</code>.<br />
Does it mean it did not work?</p>
<h4 id="nirmal21s_commented_at_2018-06-04_1753"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1820#issuecomment-394442500">2018-06-04 17:53</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-06-04_1753" title="Permanent link">&para;</a></h4>
<p>Now only we are doing the testing with now with
CLONE_ALL_USERS_GROUPS=yes.<br />
Soon i will update.</p>
<h4 id="nirmal21s_commented_at_2018-06-05_0418"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1820#issuecomment-394576425">2018-06-05 04:18</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-06-05_0418" title="Permanent link">&para;</a></h4>
<p>@jsmeix<br />
This option also not worked. But the files under that directory has been
restored with correct permission and ownership.<br />
Still the directory recreated as root only .<br />
thinking to try DIRECTORY_ENTRIES_TO_RECOVER =( '/opt/xxx 1775
myowner mygroup' )<br />
kindly provide your feedback.</p>
<h4 id="jsmeix_commented_at_2018-06-11_1329"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1820#issuecomment-396243355">2018-06-11 13:29</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-06-11_1329" title="Permanent link">&para;</a></h4>
<p>@nirmal21s<br />
to be able to find out when exactly permissions and ownership changes<br />
you would need to use our current ReaR upstream GitHub master code<br />
because after the ReaR 2.3 release I added a migration mode
confirmation<br />
directly after restore of the backup (i.e. at beginning of finalize
stage), cf.<br />
<a href="https://github.com/rear/rear/pull/1758">https://github.com/rear/rear/pull/1758</a></p>
<p>In general I recommend to use our current ReaR upstream GitHub master
code<br />
because that is the only place where we fix bugs - i.e. bugs in
released<br />
ReaR versions are not fixed by us (i.e. by ReaR upstream).<br />
Bugs in released ReaR versions that got fixed in current ReaR upstream<br />
GitHub master code might be fixed (if the fix can be backported with
reasonable effort)<br />
by the Linux distributor wherefrom you got your ReaR version.</p>
<p>To use our current ReaR upstream GitHub master code<br />
do the following:</p>
<pre>
Basically "git clone" it into a separated directory and then
configure and run ReaR from within that directory like:

# git clone https://github.com/rear/rear.git

# mv rear rear.github.master

# cd rear.github.master

# vi etc/rear/local.conf

# usr/sbin/rear -D mkbackup
</pre>

<p>Note the relative paths "etc/rear/" and "usr/sbin/".</p>
<p>To enforce migration mode during <code>rear recover</code><br />
call in the running ReaR recovery system</p>
<pre>
# export MIGRATION_MODE='true'
</pre>

<p>directly before you call "rear recover".</p>
<p>In MIGRATION_MODE manual disk layout configuration happens<br />
via several user dialogs.</p>
<p>In this case in particular the user confirmation dialog after backup
restore<br />
is of interest that shows up as follows:</p>
<pre>
Confirm restored config files or edit them
1) Confirm it is OK to recreate initrd and reinstall bootloader and continue 'rear recover'
2) Edit restored etc/fstab (/mnt/local/etc/fstab)
3) View restored etc/fstab (/mnt/local/etc/fstab)
4) Use Relax-and-Recover shell and return back to here
5) Abort 'rear recover'
</pre>

<p>There select <code>Use Relax-and-Recover shell and return back to here</code><br />
which gets you into a (sub)-shell where you can inspect the up to that
point<br />
recreated system below /mnt/local/ and check what permissions and
ownerships<br />
there are directly after the backup was restored.</p>
<p>FYI<br />
for another example how to use that you may have a look at<br />
<a href="http://lists.relax-and-recover.org/pipermail/rear-users/2018-April/003547.html">http://lists.relax-and-recover.org/pipermail/rear-users/2018-April/003547.html</a><br />
cf.
<a href="https://github.com/rear/rear/pull/1758#issuecomment-386311817">https://github.com/rear/rear/pull/1758#issuecomment-386311817</a></p>
<h4 id="jsmeix_commented_at_2018-06-11_1340"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1820#issuecomment-396246620">2018-06-11 13:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-06-11_1340" title="Permanent link">&para;</a></h4>
<p>@nirmal21s<br />
I forgot that in MIGRATION_MODE there is another user confirmation
dialog<br />
that should help to find out when exactly those unexpected permissions
and<br />
ownerships are set.</p>
<p>That other user confirmation dialog happens directly after the disk
layout<br />
was recreated (i.e. it happens directly before the backup gets
restored).<br />
That other user confirmation dialog shows up as</p>
<pre>
Confirm the recreated disk layout or go back one step
1) Confirm recreated disk layout and continue 'rear recover'
2) Go back one step to redo disk layout recreation
3) Use Relax-and-Recover shell and return back to here
4) Abort 'rear recover'
</pre>

<p>where you also should select
<code>Use Relax-and-Recover shell and return back to here</code><br />
and inspect the up to that point recreated system.</p>
<h4 id="jsmeix_commented_at_2018-06-11_1414"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1820#issuecomment-396258426">2018-06-11 14:14</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-06-11_1414" title="Permanent link">&para;</a></h4>
<p>@nirmal21s<br />
things in DIRECTORY_ENTRIES_TO_RECOVER<br />
are not created if they already exist, see the<br />
usr/share/rear/restore/default/900_create_missing_directories.sh<br />
script (cf. the DIRECTORY_ENTRIES_TO_RECOVER description in
<code>default.conf</code>)<br />
that is run at the end of the backup restore (i.e. intentionally after
the backup restore)<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/restore/default/900_create_missing_directories.sh">https://github.com/rear/rear/blob/master/usr/share/rear/restore/default/900_create_missing_directories.sh</a><br />
that reads (excerpts):</p>
<pre>
  # Create only symlinks if the symbolic link name does not yet exist (regardless in what form)
  # so that things that have been already restored from the backup do not get changed here:
...
  # Create only directories if nothing with that name already exists (regardless in what form)
  # so that things that have been already restored from the backup do not get changed here:
</pre>

<p>I.e. DIRECTORY_ENTRIES_TO_RECOVER is only intended to create missing
stuff<br />
that was not already restored from the backup - it is intentionally not
intended to<br />
overwrite anything that was restored from the backup.</p>
<h4 id="nirmal21s_commented_at_2018-06-12_1401"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1820#issuecomment-396600033">2018-06-12 14:01</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-06-12_1401" title="Permanent link">&para;</a></h4>
<p>@jsmeix Thanks a lot .. it worked out..<br />
Issue has been issue</p>
<h4 id="jsmeix_commented_at_2018-06-12_1418"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1820#issuecomment-396606126">2018-06-12 14:18</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-06-12_1418" title="Permanent link">&para;</a></h4>
<p>@nirmal21s<br />
thanks for your feedback!</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2018-05-28.1820.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
