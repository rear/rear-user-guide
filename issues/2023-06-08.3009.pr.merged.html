<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#3009 PR merged: More general RPM build - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#3009 PR merged: More general RPM build";
        var mkdocs_page_input_path = "issues/2023-06-08.3009.pr.merged.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#3009 PR merged: More general RPM build</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="3009_pr_merged_more_general_rpm_build"><a href="https://github.com/rear/rear/pull/3009">#3009 PR</a> <code>merged</code>: More general RPM build<a class="headerlink" href="#3009_pr_merged_more_general_rpm_build" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>fixed / solved / done</code></p>
<h4 id="pcahyna_opened_issue_at_2023-06-08_1256"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> opened issue at <a href="https://github.com/rear/rear/pull/3009">2023-06-08 12:56</a>:<a class="headerlink" href="#pcahyna_opened_issue_at_2023-06-08_1256" title="Permanent link">&para;</a></h4>
<h5 id="pull_request_details">Pull Request Details:<a class="headerlink" href="#pull_request_details" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p>Type: <strong>Enhancement</strong></p>
</li>
<li>
<p>Impact: <strong>Low</strong></p>
</li>
<li>
<p>Reference to related issue (URL):</p>
</li>
<li>
<p>How was this pull request tested?<br />
    'make srpm and 'make rpm' with the in-tree spec file and spec file
    from RHEL 7, RHEL 8 and RHEL 9 (after some adjustements: adding the
    rpmrelease definition and removing patches).</p>
</li>
<li>
<p>Brief description of the changes in this pull request:<br />
    Make the RPM targets in Makefile work with a wider range of custom
    specs, the current RPM build works well with the spec in tree, but
    can fail if one uses a customized spec.</p>
</li>
</ul>
<p>Changes:</p>
<ul>
<li>Support additional sources in RPM spec (the additional sources will
    need to be placed in the same directory as the spec file -
    packaging/rpm).</li>
<li>Support %autosetup in rpm spec - some RPM specs use the new
    %autosetup macro instead of %setup. Support this when building the
    SRPM and RPM (in case we switch to %autosetup or one wants to use
    another spec file, e.g. from Fedora).</li>
<li>Respect the value of 'rpmrelease' whehn building the RPM manually
    from the generated SRPM. Not having the value in the spec file
    causes it to be lost when one builds the resulting SRPM manually,
    because rpmbuild is not invoked with the correct command line
    (unless one takes care to pass the same parameters to rpmbuild that
    "make rpm" would use). Having "make rpm" produce different RPMs
    (different NVR) than manually building the SRPM generated by "make
    srpm" is confusing, so restore the former behavior. This reverts
    commit f8c77f6831de09802038f60acd2ba2a0ba6fb864.</li>
<li>Allow <code>Source0</code> instead of <code>Source</code> in spec</li>
</ul>
<h4 id="pcahyna_commented_at_2023-06-09_0829"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/3009#issuecomment-1584180760">2023-06-09 08:29</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-06-09_0829" title="Permanent link">&para;</a></h4>
<p>CentOS 6 Docker build now fails with</p>
<pre><code>RPM build errors:
error: Bad owner/group: /var/tmp/build-rear-2.7/rear.spec
    Bad owner/group: /var/tmp/build-rear-2.7/rear.spec
make: *** [srpm] Error 1
</code></pre>
<h4 id="pcahyna_commented_at_2023-06-09_1214"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/3009#issuecomment-1584480362">2023-06-09 12:14</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-06-09_1214" title="Permanent link">&para;</a></h4>
<p>tar preserves ownership even without -p and rpmbuild in CentOS 6 does
not like it. It will be necessary to copy the files around to reset
ownership. I will finish it shortly.</p>
<h4 id="pcahyna_commented_at_2023-06-09_1338"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/3009#issuecomment-1584592442">2023-06-09 13:38</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-06-09_1338" title="Permanent link">&para;</a></h4>
<p>should be fixed now.</p>
<h4 id="pcahyna_commented_at_2023-06-12_1409"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/3009#issuecomment-1587421321">2023-06-12 14:09</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-06-12_1409" title="Permanent link">&para;</a></h4>
<p>@schlomo can you please check if this does not break your use cases? I
looked at the GH action results, the build seems OK.</p>
<p>The opensuse-leap-15.3 build failure is unrelated and a result of
upgrade of COPR builders to Fedora 38 (
<a href="https://github.com/rpm-software-management/mock/issues/1062">https://github.com/rpm-software-management/mock/issues/1062</a>
)</p>
<h4 id="pcahyna_commented_at_2023-06-13_0942"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/3009#issuecomment-1588936582">2023-06-13 09:42</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-06-13_0942" title="Permanent link">&para;</a></h4>
<blockquote>
<p>The opensuse-leap-15.3 build failure is unrelated and a result of
upgrade of COPR builders to Fedora 38 (
<a href="https://github.com/rpm-software-management/mock/issues/1062">rpm-software-management/mock#1062</a>
)</p>
</blockquote>
<p>A workaround is now in place, see the linked issue, so the
opensuse-leap-15.3 Packit build is succeeding again.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2023 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2023-06-08.3009.pr.merged.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
