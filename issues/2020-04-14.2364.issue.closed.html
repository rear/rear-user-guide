<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2364 Issue closed: Use simpler, more fail-safe, and much faster syntax ARRAY+=( additional elements ) everywhere - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2364 Issue closed: Use simpler, more fail-safe, and much faster syntax ARRAY+=( additional elements ) everywhere";
        var mkdocs_page_input_path = "issues/2020-04-14.2364.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rsync.html">Internal Backup using BACKUP=RSYNC method</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2364 Issue closed: Use simpler, more fail-safe, and much faster syntax ARRAY+=( additional elements ) everywhere</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2364_issue_closed_use_simpler_more_fail-safe_and_much_faster_syntax_array_additional_elements_everywhere"><a href="https://github.com/rear/rear/issues/2364">#2364 Issue</a> <code>closed</code>: Use simpler, more fail-safe, and much faster syntax ARRAY+=( additional elements ) everywhere<a class="headerlink" href="#2364_issue_closed_use_simpler_more_fail-safe_and_much_faster_syntax_array_additional_elements_everywhere" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>cleanup</code>, <code>fixed / solved / done</code>,
<code>minor bug</code></p>
<h4 id="jsmeix_opened_issue_at_2020-04-14_1435"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> opened issue at <a href="https://github.com/rear/rear/issues/2364">2020-04-14 14:35</a>:<a class="headerlink" href="#jsmeix_opened_issue_at_2020-04-14_1435" title="Permanent link">&para;</a></h4>
<p>This is a follow up of<br />
<a href="https://github.com/rear/rear/issues/2220">https://github.com/rear/rear/issues/2220</a><br />
therein in particular in its initial comment (excerpt)</p>
<pre><code>replace the appending to the array
  CLONE_USERS=( "${CLONE_USERS[@]:-}" daemon rpc ... dbus )
by += i.e.
  CLONE_USERS+=( daemon rpc ... dbus )
I've verified that += works properly
even in bash 3 and set -ue.
</code></pre>
<p>and<br />
<a href="https://github.com/rear/rear/issues/2220#issuecomment-529933383">https://github.com/rear/rear/issues/2220#issuecomment-529933383</a></p>
<p>I used the following commands to get where we use<br />
the form <code>ARRAY=( "${ARRAY[@]}" additional elements )</code></p>
<pre><code>for f in $( find usr/sbin/rear usr/share/rear/ -type f ) ; \
do grep -q '[[:alpha:]_][[:alpha:]_]*=( "${[[:alpha:]_][[:alpha:]_]*\[@\]' $f || continue ; \
echo $f \
grep '[[:alpha:]_][[:alpha:]_]*=( "${[[:alpha:]_][[:alpha:]_]*\[@\]' $f ; \
done
</code></pre>
<p>that results 270 cases in 119 files<br />
and for the form <code>ARRAY=("${ARRAY[@]}" additional elements)</code><br />
the command</p>
<pre><code>for f in $( find usr/sbin/rear usr/share/rear/ -type f ) ; \
do grep -q '[[:alpha:]_][[:alpha:]_]*=("${[[:alpha:]_][[:alpha:]_]*\[@\]' $f || continue ; \
echo $f ; \
grep '[[:alpha:]_][[:alpha:]_]*=("${[[:alpha:]_][[:alpha:]_]*\[@\]' $f ; \
done
</code></pre>
<p>that results 2 cases in 2 files.</p>
<p>So it seems the job is doable - not nice to do - but doable ;-)</p>
<h4 id="olivero2_commented_at_2020-04-16_1040"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-614568710">2020-04-16 10:40</a>:<a class="headerlink" href="#olivero2_commented_at_2020-04-16_1040" title="Permanent link">&para;</a></h4>
<p>@jsmeix<br />
Regarding the regexp: I'm using IntelliJ IDEA, which features <a href="https://www.jetbrains.com/help/idea/2019.3/regular-expression-syntax-reference.html?utm_campaign=IU&amp;utm_content=2019.3&amp;utm_medium=link&amp;utm_source=product">Java
regexps</a>.</p>
<p>The regexp <code>\(\s*\S+\[@\]</code> found 334 occurrences and seems to work quite
well for one-line and multiline assignments (we'd have to subtract 2
occurrences for your latest commit).</p>
<h4 id="olivero2_commented_at_2020-04-17_1526"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-615308771">2020-04-17 15:26</a>:<a class="headerlink" href="#olivero2_commented_at_2020-04-17_1526" title="Permanent link">&para;</a></h4>
<p>Based on master bec26773 (Update restoreonly-workflow.sh) here are my
search results from within IntelliJ IDEA. Unfortunately, the only thing
I was able to export in a readable way is a flat list of files. :-/</p>
<pre><code>Targets
Occurrences of '\(\s*\S+\[@\]' in project
Found Occurrences
001_configure_workflow.sh
04-scenarios.adoc
06-layout-configuration.adoc
12-BLOCKCLONE.adoc
15-EFISTUB.adoc
200_check_rsync_relative_option.sh
200_check_rsync_relative_option.sh
200_prep_borg.sh
200_prepare_backup_installation.sh
205_inspect_tar_capabilities.sh
240_kernel_modules.sh
280_include_virtualbox.sh
300_map_disks.sh
300_map_disks.sh
340_add_isofs_module.sh
390_copy_binaries_libraries.sh
400_check_backup_special_files.sh
400_check_tape_drive.sh
400_check_tape_drive.sh
400_prep_ava.sh
400_prep_bacula.sh
400_prep_bareos.sh
400_prep_cdm.sh
400_prep_dp.sh
400_prep_fdrupstream.sh
400_prep_galaxy.sh
400_prep_galaxy.sh
400_prep_galaxy.sh
400_prep_nbkdc.sh
400_prep_nbu.sh
400_prep_nsr.sh
400_prep_sesam.sh
400_prep_tsm.sh
400_prep_yum.sh
400_prep_zypper.sh
400_restore_backup.sh
400_verify_tsm.sh
430_autoresize_all_partitions.sh
500_make_backup.sh
500_ssh.sh
540_choose_backup.sh
540_generate_device_code.sh
540_generate_device_code.sh
55-migrate-network-devices.sh
550_rebuild_initramfs.sh
550_rebuild_initramfs.sh
550_rebuild_initramfs.sh
600_check_rsync_xattr.sh
680_install_PPC_bootlist.sh
680_install_PPC_bootlist.sh
830_copy_kernel_initrd.sh
950_dsmc_save_result_files.sh
950_nsr_save_result_files.sh
checklayout-workflow.sh
dhcp-setup-functions.sh
dump-workflow.sh
finalizeonly-workflow.sh
layout-functions.sh
layoutonly-workflow.sh
linux-functions.sh
mkbackup-workflow.sh
mkrescue-workflow.sh
opaladmin-workflow.sh
rd.sh
rear-release-notes.txt
savelayout-workflow.sh
udev-workflow.sh
uefi-functions.sh
validate-workflow.sh
</code></pre>
<h4 id="jsmeix_commented_at_2020-04-17_1543"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-615317773">2020-04-17 15:43</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-17_1543" title="Permanent link">&para;</a></h4>
<p>I really would need the matching lines.<br />
Searching in each file is not what I could do with reasonable effort.</p>
<p>What my regexps found was those patterns if they appear on one line:</p>
<pre><code>LettersAndUnderscores=( "${LettersAndUnderscores[@]
LettersAndUnderscores=("${LettersAndUnderscores[@]
LettersAndUnderscores=( ${LettersAndUnderscores[@]
LettersAndUnderscores=(${LettersAndUnderscores[@]
</code></pre>
<p>There was nothing found for
<code>LettersAndUnderscores=("${LettersAndUnderscores[@]</code></p>
<p>For <code>LettersAndUnderscores=(${LettersAndUnderscores[*]</code><br />
only one match was found:</p>
<pre><code>usr/share/rear/build/OPALPBA/Linux-i386/095_exclude_non_essential_files.sh

Log "Before exclusion: PROGS=(${PROGS[*]})"
Log "After exclusion: PROGS=(${PROGS[*]})"
Log "Before exclusion: REQUIRED_PROGS=(${REQUIRED_PROGS[*]})"
Log "After exclusion: REQUIRED_PROGS=(${REQUIRED_PROGS[*]})"
</code></pre>
<p>which looks OK as is.</p>
<p>For <code>LettersAndUnderscores=( ${LettersAndUnderscores[*]</code><br />
only one match was found:</p>
<pre><code>usr/share/rear/build/default/501_check_ssh_keys.sh

    key_files=( ${SSH_UNPROTECTED_PRIVATE_KEYS[*]} )
</code></pre>
<p>which is intentionally as is because a comment explains it<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/build/default/501_check_ssh_keys.sh#L41">https://github.com/rear/rear/blob/master/usr/share/rear/build/default/501_check_ssh_keys.sh#L41</a></p>
<p>Nothing is found (on one line) for</p>
<pre><code>LettersAndUnderscores=( "${LettersAndUnderscores[*]
LettersAndUnderscores=("${LettersAndUnderscores[*]
</code></pre>
<h4 id="jsmeix_commented_at_2020-04-17_1545"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-615319253">2020-04-17 15:45</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-17_1545" title="Permanent link">&para;</a></h4>
<p>Next week I will think about a test that finds false</p>
<pre><code>ARRAY=( additional elements )
</code></pre>
<p>assignments that actually should have been</p>
<pre><code>ARRAY+=( additional elements )
</code></pre>
<p>in particular to detect possible errors I have made here.</p>
<h4 id="olivero2_commented_at_2020-04-17_1546"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-615319888">2020-04-17 15:46</a>:<a class="headerlink" href="#olivero2_commented_at_2020-04-17_1546" title="Permanent link">&para;</a></h4>
<p>Another export based on c5f61051 with matching lines:</p>
<pre><code>Targets
Occurrences of '\(\s*\S+\[@\]' in project
Found Occurrences
001_configure_workflow.sh
if (( ${#OPAL_PBA_PROGS[@]} == 0 &amp;&amp; ${#OPAL_PBA_COPY_AS_IS[@]} == 0)) &amp;&amp; has_binary plymouth; then
PROGS+=( "${OPAL_PBA_PROGS[@]}" clear )
COPY_AS_IS+=( "${OPAL_PBA_COPY_AS_IS[@]}" )
LIBS+=( "${OPAL_PBA_LIBS[@]}" )
04-scenarios.adoc
COPY_AS_IS_EXCLUDE=( "${COPY_AS_IS_EXCLUDE[@]}" )
06-layout-configuration.adoc
EXCLUDE_RECREATE=( "${EXCLUDE_RECREATE[@]}" "fs:/media/backup" )
EXCLUDE_RECREATE=( "${EXCLUDE_RECREATE[@]}" "/dev/backup" )
12-BLOCKCLONE.adoc
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone )
BACKUP_PROG_EXCLUDE=( ${BACKUP_PROG_EXCLUDE[@]} '/media/*' )
 `REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone mount.ntfs-3g )`
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone )
BACKUP_PROG_EXCLUDE=( ${BACKUP_PROG_EXCLUDE[@]} '/media/*' )
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone )
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone )
BACKUP_PROG_EXCLUDE=( "${BACKUP_PROG_EXCLUDE[@]}" '/products/*' )
15-EFISTUB.adoc
BACKUP_PROG_EXCLUDE=( ${BACKUP_PROG_EXCLUDE[@]} /mnt )
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" snapper chattr lsattr xfs_repair )
COPY_AS_IS=( "${COPY_AS_IS[@]}" /usr/lib/snapper/installation-helper /etc/snapper/config-templates/default )
200_prep_borg.sh
COPY_AS_IS+=( "${COPY_AS_IS_BORG[@]}" )
PROGS+=( "${PROGS_BORG[@]}" borg locale )
205_inspect_tar_capabilities.sh
echo "BACKUP_PROG_OPTIONS=( ${BACKUP_PROG_OPTIONS[@]} )" &gt;&gt; $ROOTFS_DIR/etc/rear/rescue.conf
210_include_dhclient.sh
        dhclients=(${dhclients[@]} "$x")
COPY_AS_IS=( "${COPY_AS_IS[@]}" "/etc/localtime" "/usr/lib/dhcpcd/*" )
PROGS=( "${PROGS[@]}" arping ipcalc usleep "${dhclients[@]}" )
240_kernel_modules.sh
MODULES=(
COPY_AS_IS=(
280_include_virtualbox.sh
    MODULES+=( ${VBOX_MODULES[@]} )
    COPY_AS_IS+=( ${VBOX_COPY_AS_IS[@]} )
300_map_disks.sh
    regular_choices=( "${possible_targets[@]}" "$skip_choice" )
300_map_disks.sh
    regular_choices=( "${possible_targets[@]}" "$skip_choice" )
390_copy_binaries_libraries.sh
local all_libs=( "${LIBS[@]}" $( RequiredSharedObjects "${all_binaries[@]}" "${LIBS[@]}" ) )
400_check_backup_special_files.sh
    FDRUPSTREAM ) CHECK_CONFIG_FILES+=( "${CHECK_CONFIG_FILES_FDRUPSTREAM[@]}" ) ;;
400_check_tape_drive.sh
    PROGS+=( "${PROGS_OBDR[@]}" )
    REQUIRED_PROGS+=( "${REQUIRED_PROGS_OBDR[@]}" )
400_check_tape_drive.sh
    PROGS+=( "${PROGS_OBDR[@]}" )
    REQUIRED_PROGS+=( "${REQUIRED_PROGS_OBDR[@]}" )
400_prep_ava.sh
COPY_AS_IS+=( "${COPY_AS_IS_AVA[@]}" )
COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_AVA[@]}" )
PROGS+=( "${PROGS_AVA[@]}" )
400_prep_bacula.sh
COPY_AS_IS+=( "${COPY_AS_IS_BACULA[@]}" )
COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_BACULA[@]}" )
PROGS+=( "${PROGS_BACULA[@]}" )
400_prep_bareos.sh
COPY_AS_IS+=( "${COPY_AS_IS_BAREOS[@]}" )
COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_BAREOS[@]}" )
PROGS+=( "${PROGS_BAREOS[@]}" )
400_prep_cdm.sh
COPY_AS_IS+=( "${COPY_AS_IS_CDM[@]}" )
COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_CDM[@]}" )
PROGS+=( "${PROGS_CDM[@]}" fmt )
400_prep_dp.sh
COPY_AS_IS+=( "${COPY_AS_IS_DP[@]}" )
COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_DP[@]}" )
400_prep_fdrupstream.sh
COPY_AS_IS+=( "${COPY_AS_IS_FDRUPSTREAM[@]}" "${FDRUPSTREAM_INSTALL_PATH}" )
COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_FDRUPSTREAM[@]}" )
PROGS+=( "${PROGS_FDRUPSTREAM[@]}" )
REQUIRED_PROGS+=( "${REQUIRED_PROGS_FDRUPSTREAM[@]}" col )
400_prep_galaxy.sh
COPY_AS_IS+=( "${COPY_AS_IS_GALAXY[@]}" )
COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_GALAXY[@]}" )
400_prep_galaxy.sh
COPY_AS_IS+=( "${COPY_AS_IS_GALAXY10[@]}" )
COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_GALAXY10[@]}" )
400_prep_galaxy.sh
COPY_AS_IS+=( "${COPY_AS_IS_GALAXY7[@]}" )
COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_GALAXY7[@]}" )
400_prep_nbkdc.sh
COPY_AS_IS=( 
COPY_AS_IS_EXCLUDE=( 
400_prep_nbu.sh
COPY_AS_IS+=( "${COPY_AS_IS_NBU[@]}" )
COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_NBU[@]}" )
PROGS+=( "${PROGS_NBU[@]}" col )
400_prep_nsr.sh
COPY_AS_IS+=( "${COPY_AS_IS_NSR[@]}" )
COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_NSR[@]}" )
PROGS+=( "${PROGS_NSR[@]}" fmt )
400_prep_sesam.sh
        COPY_AS_IS=( 
        COPY_AS_IS_EXCLUDE=( 
        LIBS=( 
400_prep_tsm.sh
COPY_AS_IS+=( "${COPY_AS_IS_TSM[@]}"
COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_TSM[@]}" )
PROGS+=( "${PROGS_TSM[@]}" )
400_prep_yum.sh
test "${COPY_AS_IS_YUM[*]:-}" &amp;&amp; COPY_AS_IS+=( "${COPY_AS_IS_YUM[@]}" )
test "${COPY_AS_IS_EXCLUDE_YUM[*]:-}" &amp;&amp; COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_YUM[@]}" )
test "${REQUIRED_PROGS_YUM[*]:-}" &amp;&amp; REQUIRED_PROGS+=( "${REQUIRED_PROGS_YUM[@]}" )
test "${PROGS_YUM[*]:-}" &amp;&amp; PROGS+=( "${PROGS_YUM[@]}" )
400_prep_zypper.sh
test "${COPY_AS_IS_ZYPPER[*]:-}" &amp;&amp; COPY_AS_IS+=( "${COPY_AS_IS_ZYPPER[@]}" )
test "${COPY_AS_IS_EXCLUDE_ZYPPER[*]:-}" &amp;&amp; COPY_AS_IS_EXCLUDE+=( "${COPY_AS_IS_EXCLUDE_ZYPPER[@]}" )
test "${REQUIRED_PROGS_ZYPPER[*]:-}" &amp;&amp; REQUIRED_PROGS+=( "${REQUIRED_PROGS_ZYPPER[@]}" )
test "${PROGS_ZYPPER[*]:-}" &amp;&amp; PROGS+=( "${PROGS_ZYPPER[@]}" )
400_verify_tsm.sh
DIRECTORY_ENTRIES_TO_RECOVER+=( "${excluded_mountpoints[@]}" )
430_autoresize_all_partitions.sh
        if (( ${#partitions[@]} == 0 )) ; then
500_make_backup.sh
            pipes_rc=( ${PIPESTATUS[@]} )
            pipes_rc=( ${PIPESTATUS[@]} )
500_ssh.sh
        copy_as_is_ssh_files=( "${SSH_FILES[@]}" )
contains_visible_char "${copy_as_is_ssh_files[*]}" &amp;&amp; COPY_AS_IS+=( "${copy_as_is_ssh_files[@]}" )
540_choose_backup.sh
(( ${#backups[@]} &gt; 0 ))
540_generate_device_code.sh
        Debug "deps (${#deps[@]}): ${deps[*]}"
540_generate_device_code.sh
        Debug "deps (${#deps[@]}): ${deps[*]}"
55-migrate-network-devices.sh
            NEW_DEVICES=( "${NEW_DEVICES[@]/$choice/}" )
550_rebuild_initramfs.sh
NEW_INITRD_MODULES=( ${OLD_INITRD_MODULES[@]} ${OLD_INITRD_MODULES[@]} $( cat $TMP_DIR/storage_drivers ) )
550_rebuild_initramfs.sh
NEW_INITRD_MODULES=( ${OLD_INITRD_MODULES[@]} ${OLD_INITRD_MODULES[@]} $( cat $TMP_DIR/storage_drivers ) )
550_rebuild_initramfs.sh
NEW_INITRD_MODULES=( ${OLD_INITRD_MODULES[@]} ${OLD_INITRD_MODULES[@]} $( cat $TMP_DIR/storage_drivers ) )
600_check_rsync_xattr.sh
        RSYNC_OPTIONS=( "${BACKUP_RSYNC_OPTIONS[@]}" --xattrs )
680_install_PPC_bootlist.sh
    boot_list=( ${boot_list[@]:0:5} )
680_install_PPC_bootlist.sh
    boot_list=( ${boot_list[@]:0:5} )
830_copy_kernel_initrd.sh
#RESULT_FILES=( "${USB_FILES[@]}" "$USB_DIR/kernel" "$USB_DIR/$REAR_INITRD_FILENAME" )
950_dsmc_save_result_files.sh
    TSM_RESULT_FILES=( "${RESULT_FILES[@]}" )
950_nsr_save_result_files.sh
    NSR_RESULT_FILES=( "${RESULT_FILES[@]}" )
dhcp-setup-functions.sh
                        ((pads=4-${#target_arr[@]}))
layout-functions.sh
    while (( ${#devlist[@]} )) ; do
        devlist=( "${devlist[@]}" )
    while (( ${#devlist[@]} )) ; do
        devlist=( "${devlist[@]}" )
linux-functions.sh
    if (( ${#STORAGE_DRIVERS[@]} == 0 )) ; then
opaladmin-workflow.sh
    (( ${#OPALADMIN_DEVICES[@]} == 0 )) &amp;&amp; Error "Could not detect TCG Opal 2-compliant disks."
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
rd.sh
        dhclients=(${dhclients[@]} "$x")
rear-release-notes.txt
    in etc/rear/local.conf MODULES=( "${MODULES[@]}" 'moduleX' 'moduleY' ) to
    now MODULES=( "${MODULES[@]}" 'moduleX' 'moduleY' ) includes all kernel
uefi-functions.sh
    local modules=( ${GRUB2_MODULES_LOAD:+"${GRUB2_MODULES_LOAD[@]}"} )
    if (( ${#dirs[@]} )) &amp;&amp; ! (( ${#modules[@]} )) ; then
    if (( ${#dirs[@]} )) &amp;&amp; ! (( ${#modules[@]} )) ; then
    (( ${#GRUB2_MODULES[@]} )) &amp;&amp; LogPrint "Installing only ${GRUB2_MODULES[*]} modules into $outfile memdisk"
    (( ${#modules[@]} )) &amp;&amp; LogPrint "GRUB2 modules to load: ${modules[*]}"
</code></pre>
<h4 id="jsmeix_commented_at_2020-04-17_1548"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-615320911">2020-04-17 15:48</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-17_1548" title="Permanent link">&para;</a></h4>
<p>I did not check documentation files.<br />
I only checked <code>find usr/sbin/rear usr/share/rear/ -type f</code></p>
<h4 id="olivero2_commented_at_2020-04-17_1550"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-615322176">2020-04-17 15:50</a>:<a class="headerlink" href="#olivero2_commented_at_2020-04-17_1550" title="Permanent link">&para;</a></h4>
<p>Obviously, the above list contains false positives (e.g.
<code>Identifier1=("Identifier2[@]" ...)</code>). And others.</p>
<p>This one seems more specific:</p>
<pre><code>Targets
Occurrences of '\w\s*=\s*\(\s*\S+\[@\]' in project
Found Occurrences

04-scenarios.adoc
COPY_AS_IS_EXCLUDE=( "${COPY_AS_IS_EXCLUDE[@]}" )

06-layout-configuration.adoc
EXCLUDE_RECREATE=( "${EXCLUDE_RECREATE[@]}" "fs:/media/backup" )
EXCLUDE_RECREATE=( "${EXCLUDE_RECREATE[@]}" "/dev/backup" )

12-BLOCKCLONE.adoc
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone )
BACKUP_PROG_EXCLUDE=( ${BACKUP_PROG_EXCLUDE[@]} '/media/*' )
 `REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone mount.ntfs-3g )`
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone )
BACKUP_PROG_EXCLUDE=( ${BACKUP_PROG_EXCLUDE[@]} '/media/*' )
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone )
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone )
BACKUP_PROG_EXCLUDE=( "${BACKUP_PROG_EXCLUDE[@]}" '/products/*' )

15-EFISTUB.adoc
BACKUP_PROG_EXCLUDE=( ${BACKUP_PROG_EXCLUDE[@]} /mnt )
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" snapper chattr lsattr xfs_repair )
COPY_AS_IS=( "${COPY_AS_IS[@]}" /usr/lib/snapper/installation-helper /etc/snapper/config-templates/default )

205_inspect_tar_capabilities.sh
echo "BACKUP_PROG_OPTIONS=( ${BACKUP_PROG_OPTIONS[@]} )" &gt;&gt; $ROOTFS_DIR/etc/rear/rescue.conf

210_include_dhclient.sh
        dhclients=(${dhclients[@]} "$x")
COPY_AS_IS=( "${COPY_AS_IS[@]}" "/etc/localtime" "/usr/lib/dhcpcd/*" )
PROGS=( "${PROGS[@]}" arping ipcalc usleep "${dhclients[@]}" )

240_kernel_modules.sh
MODULES=(
COPY_AS_IS=(

300_map_disks.sh
    regular_choices=( "${possible_targets[@]}" "$skip_choice" )

300_map_disks.sh
    regular_choices=( "${possible_targets[@]}" "$skip_choice" )

390_copy_binaries_libraries.sh
local all_libs=( "${LIBS[@]}" $( RequiredSharedObjects "${all_binaries[@]}" "${LIBS[@]}" ) )

400_prep_nbkdc.sh
COPY_AS_IS=( 
COPY_AS_IS_EXCLUDE=(

400_prep_sesam.sh
        COPY_AS_IS=( 
        COPY_AS_IS_EXCLUDE=( 
        LIBS=(

500_make_backup.sh
            pipes_rc=( ${PIPESTATUS[@]} )
            pipes_rc=( ${PIPESTATUS[@]} )

500_ssh.sh
        copy_as_is_ssh_files=( "${SSH_FILES[@]}" )

55-migrate-network-devices.sh
            NEW_DEVICES=( "${NEW_DEVICES[@]/$choice/}" )

550_rebuild_initramfs.sh
NEW_INITRD_MODULES=( ${OLD_INITRD_MODULES[@]} ${OLD_INITRD_MODULES[@]} $( cat $TMP_DIR/storage_drivers ) )

550_rebuild_initramfs.sh
NEW_INITRD_MODULES=( ${OLD_INITRD_MODULES[@]} ${OLD_INITRD_MODULES[@]} $( cat $TMP_DIR/storage_drivers ) )

550_rebuild_initramfs.sh
NEW_INITRD_MODULES=( ${OLD_INITRD_MODULES[@]} ${OLD_INITRD_MODULES[@]} $( cat $TMP_DIR/storage_drivers ) )

600_check_rsync_xattr.sh
        RSYNC_OPTIONS=( "${BACKUP_RSYNC_OPTIONS[@]}" --xattrs )

680_install_PPC_bootlist.sh
    boot_list=( ${boot_list[@]:0:5} )

680_install_PPC_bootlist.sh
    boot_list=( ${boot_list[@]:0:5} )

830_copy_kernel_initrd.sh
#RESULT_FILES=( "${USB_FILES[@]}" "$USB_DIR/kernel" "$USB_DIR/$REAR_INITRD_FILENAME" )

950_dsmc_save_result_files.sh
    TSM_RESULT_FILES=( "${RESULT_FILES[@]}" )

950_nsr_save_result_files.sh
    NSR_RESULT_FILES=( "${RESULT_FILES[@]}" )

layout-functions.sh
        devlist=( "${devlist[@]}" )
        devlist=( "${devlist[@]}" )

opaladmin-workflow.sh
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )
    local devices=( "${@:-${OPALADMIN_DEVICES[@]}}" )

rd.sh
        dhclients=(${dhclients[@]} "$x")

rear-release-notes.txt
    in etc/rear/local.conf MODULES=( "${MODULES[@]}" 'moduleX' 'moduleY' ) to
    now MODULES=( "${MODULES[@]}" 'moduleX' 'moduleY' ) includes all kernel

uefi-functions.sh
    local modules=( ${GRUB2_MODULES_LOAD:+"${GRUB2_MODULES_LOAD[@]}"} )
</code></pre>
<h4 id="jsmeix_commented_at_2020-04-17_1553"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-615323359">2020-04-17 15:53</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-17_1553" title="Permanent link">&para;</a></h4>
<p>Your results found things as in<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/prep/SESAM/default/400_prep_sesam.sh">https://github.com/rear/rear/blob/master/usr/share/rear/prep/SESAM/default/400_prep_sesam.sh</a></p>
<p>Ahh - with inserted empty lines that separate the files<br />
I can read it so much easier!</p>
<p>Next week I will have a look at those remaining issues.</p>
<p>@OliverO2<br />
have a nice and relaxed weekend<br />
and many thanks for all your help here!</p>
<h4 id="olivero2_commented_at_2020-04-17_1554"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-615324096">2020-04-17 15:54</a>:<a class="headerlink" href="#olivero2_commented_at_2020-04-17_1554" title="Permanent link">&para;</a></h4>
<p>Thanks, have an excellent weekend, too. Be safe, stay healthy!</p>
<h4 id="olivero2_commented_at_2020-04-17_2149"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-615479355">2020-04-17 21:49</a>:<a class="headerlink" href="#olivero2_commented_at_2020-04-17_2149" title="Permanent link">&para;</a></h4>
<p>Ending the day on a high note:</p>
<ol>
<li>There is an export option for IntelliJ IDEA search results in a
    readable form (context menu rules)!</li>
<li>I have found an even more specific regexp.</li>
<li>I have hand-edited out false positives.</li>
</ol>
<p>So I guess this is all that's left (documentation included, would seem
nicer if that would be fixed, too, for consistency):</p>
<pre><code>Targets
    Occurrences of '(\w+)\s*=\s*\(\s*\S+[{$]\1\[@\]' in project

Found Occurrences
    06-layout-configuration.adoc  (2 usages found)
        152 EXCLUDE_RECREATE=( "${EXCLUDE_RECREATE[@]}" "fs:/media/backup" )
        193 EXCLUDE_RECREATE=( "${EXCLUDE_RECREATE[@]}" "/dev/backup" )
    12-BLOCKCLONE.adoc  (8 usages found)
        149 REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone )
        159 BACKUP_PROG_EXCLUDE=( ${BACKUP_PROG_EXCLUDE[@]} '/media/*' )
        276 `REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone mount.ntfs-3g )`
        295 REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone )
        315 BACKUP_PROG_EXCLUDE=( ${BACKUP_PROG_EXCLUDE[@]} '/media/*' )
        403 REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone )
        424 REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone )
        677 BACKUP_PROG_EXCLUDE=( "${BACKUP_PROG_EXCLUDE[@]}" '/products/*' )
    15-EFISTUB.adoc  (3 usages found)
        138 BACKUP_PROG_EXCLUDE=( ${BACKUP_PROG_EXCLUDE[@]} /mnt )
        141 REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" snapper chattr lsattr xfs_repair )
        142 COPY_AS_IS=( "${COPY_AS_IS[@]}" /usr/lib/snapper/installation-helper /etc/snapper/config-templates/default )
    240_kernel_modules.sh  (2 usages found)
        20 MODULES=(
        30 COPY_AS_IS=(
    400_prep_nbkdc.sh  (2 usages found)
        63 COPY_AS_IS=(
        75 COPY_AS_IS_EXCLUDE=(
    400_prep_sesam.sh  (3 usages found)
        14 COPY_AS_IS=(
        27 COPY_AS_IS_EXCLUDE=(
        39 LIBS=(
</code></pre>
<h4 id="jsmeix_commented_at_2020-04-20_0747"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-616372774">2020-04-20 07:47</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-20_0747" title="Permanent link">&para;</a></h4>
<p>@OliverO2<br />
thank you for your precise and well readable list in your<br />
<a href="https://github.com/rear/rear/issues/2364#issuecomment-615479355">https://github.com/rear/rear/issues/2364#issuecomment-615479355</a></p>
<p>I have now fixed those items too.</p>
<h4 id="jsmeix_commented_at_2020-04-20_1322"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-616549422">2020-04-20 13:22</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-20_1322" title="Permanent link">&para;</a></h4>
<p>Regarding<br />
<a href="https://github.com/rear/rear/issues/2364#issuecomment-615319253">https://github.com/rear/rear/issues/2364#issuecomment-615319253</a><br />
a test that finds false <code>ARRAY=( additional elements )</code> assignments<br />
I checked for all array variables that are set in default.conf<br />
if they are also set elsewhere which could be false because<br />
usually array variables that are set in default.conf should be<br />
only extended by additional elements:</p>
<pre><code># arrvars="$( grep '^[[:alpha:]_][[:alpha:]_]*=(' usr/share/rear/conf/default.conf | cut -d '=' -f 1 | sort -u )" ; \
 for f in $( find usr/share/rear -type f | egrep -v 'usr/share/rear/conf/default.conf|usr/share/rear/prep/GNU/Linux/210_include_dhclient.sh' ) ; \
 do found="" ; \
  for arrvar in $arrvars ; \
   do if grep -q "[^_]*$arrvar=" $f ; \
    then found=yes ; break ; fi ; \
   done ; \
  test $found || continue ; \
  echo $f ; \
  for arrvar in $arrvars ; \
   do grep "[^_]*$arrvar=" $f ; \
   done ; \
  echo ; \
 done

usr/share/rear/output/OBDR/default/810_write_image.sh
BACKUP_PROG_COMPRESS_OPTIONS=

usr/share/rear/output/USB/Linux-i386/830_copy_kernel_initrd.sh
#RESULT_FILES=( "${USB_FILES[@]}" "$USB_DIR/kernel" "$USB_DIR/$REAR_INITRD_FILENAME" )

usr/share/rear/output/TSM/default/950_dsmc_save_result_files.sh
TSM_RESULT_FILES=()
    TSM_RESULT_FILES=(
    TSM_RESULT_FILES=( "${RESULT_FILES[@]}" )

usr/share/rear/output/DP/default/950_dp_save_result_files.sh
#DP_RESULT_FILES=()

usr/share/rear/output/NSR/default/950_nsr_save_result_files.sh
NSR_RESULT_FILES=()
        NSR_RESULT_FILES=( 
        NSR_RESULT_FILES=( "${RESULT_FILES[@]}" )

usr/share/rear/build/GNU/Linux/420_copy_firmware_files.sh
# The special value FIRMWARE_FILES=( 'no' ) or any value that
    LogPrint "Omit copying files in /lib*/firmware/ (FIRMWARE_FILES='$FIRMWARE_FILES')"
test "${FIRMWARE_FILES[*]}" || FIRMWARE_FILES=( 'yes' )
# The special value FIRMWARE_FILES=( 'yes' ) or any value that

usr/share/rear/build/GNU/Linux/400_copy_modules.sh
# The special user setting MODULES=( 'no_modules' ) enforces that
    # Since ReaR version 2.5 we have MODULES=( 'all_modules' ) in default.conf
    # MODULES array contents like MODULES=( 'moduleX' 'all_modules' 'moduleY' ):
    # The setting MODULES=( 'loaded_modules' ) results that only those kernel modules
    # MODULES array contents like MODULES=( 'moduleX' 'loaded_modules' 'moduleY' ):
    # MODULES=() which means the currently loaded kernel modules get included in the recovery system
    # MODULES=( 'moduleX' 'moduleY' ) where additional kernel modules can be specified
    # to be included in the recovery system in addition to the ones via an empty MODULES=() setting:
    # to not lose the below added modules but with MODULES=( 'all_modules' ) in default.conf
    # MODULES=( 'moduleX' 'moduleY' ) in etc/rear/local.conf to get additional kernel modules
    # included in the recovery system in addition to the ones via an empty MODULES=() setting:
            # Fallback is the plain module file without other needed modules (cf. the MODULES=( 'loaded_modules' ) case

usr/share/rear/build/OPALPBA/Linux-i386/095_exclude_non_essential_files.sh
Log "Before exclusion: PROGS=(${PROGS[*]})"
PROGS=( $(printf '%s\n' "${PROGS[@]}" | sed -r '/^('"$(printf '%s|' "${progs_to_exclude[@]}")"')$/d') )
Log "After exclusion: PROGS=(${PROGS[*]})"
Log "Before exclusion: REQUIRED_PROGS=(${REQUIRED_PROGS[*]})"
REQUIRED_PROGS=( $(printf '%s\n' "${REQUIRED_PROGS[@]}" | sed -r '/^('"$(printf '%s|' "${progs_to_exclude[@]}")"')$/d') 
Log "After exclusion: REQUIRED_PROGS=(${REQUIRED_PROGS[*]})"
Log "Before exclusion: REQUIRED_PROGS=(${REQUIRED_PROGS[*]})"
REQUIRED_PROGS=( $(printf '%s\n' "${REQUIRED_PROGS[@]}" | sed -r '/^('"$(printf '%s|' "${progs_to_exclude[@]}")"')$/d') 
Log "After exclusion: REQUIRED_PROGS=(${REQUIRED_PROGS[*]})"

usr/share/rear/conf/Linux-ppc64.conf
test "${FIRMWARE_FILES[*]}" || FIRMWARE_FILES=( 'no' )

usr/share/rear/conf/Linux-ppc64le.conf
    test "${FIRMWARE_FILES[*]}" || FIRMWARE_FILES=( 'no' )

usr/share/rear/conf/examples/borg-example.conf
COPY_AS_IS_BORG=( $BORG_KEYS_DIR )
ONLY_INCLUDE_VG=( "vg00" )

usr/share/rear/conf/examples/SLE12-SP1-btrfs-example.conf
BACKUP_PROG_INCLUDE=( /var/tmp /srv /var/lib/pgsql /var/spool /var/lib/libvirt/images /var/opt/ /tmp /var/lib/named /var
#MODULES_LOAD=( )

usr/share/rear/conf/examples/RHEL7-ISO-Oracle-example.conf
#ONLY_INCLUDE_VG=( "vg00" )

usr/share/rear/conf/examples/SLE12-SP2-btrfs-example.conf
BACKUP_PROG_INCLUDE=( /var/cache /var/lib/mailman /var/tmp /var/lib/pgsql /usr/local /opt /var/lib/libvirt/images /boot/
#MODULES_LOAD=( )

usr/share/rear/conf/examples/SLE12-btrfs-example.conf
BACKUP_PROG_INCLUDE=( /home /var/tmp /var/spool /var/opt /var/log /var/lib/pgsql /var/lib/mailman /var/lib/named /usr/lo

usr/share/rear/conf/examples/SLE11-SLE12-SAP-HANA-UEFI-example.conf
EXCLUDE_VG=( vgHANA-data-HC2 vgHANA-data-HC3 vgHANA-log-HC2 vgHANA-log-HC3 vgHANA-shared-HC2 vgHANA-shared-HC3 )

usr/share/rear/layout/prepare/default/420_autoresize_last_partitions.sh
# AUTORESIZE_EXCLUDE_PARTITIONS=( boot swap efi /dev/sdb3 /dev/sdc4 )
test "$AUTORESIZE_EXCLUDE_PARTITIONS" || AUTORESIZE_EXCLUDE_PARTITIONS=( boot swap efi )

usr/share/rear/rescue/NETFS/default/610_save_capabilities.sh
is_true "$NETFS_RESTORE_CAPABILITIES" &amp;&amp; NETFS_RESTORE_CAPABILITIES=( '/' )

usr/share/rear/rescue/GNU/Linux/240_kernel_modules.sh
# The special user setting MODULES=( 'no_modules' ) enforces that

usr/share/rear/rescue/GNU/Linux/220_load_modules_from_initrd.sh
        INITRD_MODULES=

usr/share/rear/restore/RSYNC/default/200_remove_relative_rsync_option.sh
    BACKUP_RSYNC_OPTIONS=( $( RmInArray "--relative" "${BACKUP_RSYNC_OPTIONS[@]}" ) )
    BACKUP_RSYNC_OPTIONS=( $( RmInArray "-R" "${BACKUP_RSYNC_OPTIONS[@]}" ) )

usr/share/rear/verify/OBDR/NETFS/default/540_set_backup_compression.sh
BACKUP_PROG_COMPRESS_OPTIONS=

usr/share/rear/lib/array-functions.sh
    # usage: BACKUP_RSYNC_OPTIONS=( $( RmInArray "--relative" "${BACKUP_RSYNC_OPTIONS[@]}" ) )

usr/share/rear/lib/bootloader-functions.sh
    FEATURE_SYSLINUX_MODULES=
        FEATURE_SYSLINUX_MODULES="y"

usr/share/rear/lib/linux-functions.sh
    # The special user setting MODULES=( 'no_modules' ) enforces that

usr/share/rear/finalize/Fedora/i386/550_rebuild_initramfs.sh
    OLD_INITRD_MODULES=( $(cat $VAR_DIR/recovery/initrd_modules) )
    OLD_INITRD_MODULES=()
Log "Original OLD_INITRD_MODULES='${OLD_INITRD_MODULES[@]}'"
NEW_INITRD_MODULES=( ${OLD_INITRD_MODULES[@]} ${OLD_INITRD_MODULES[@]} $( cat $TMP_DIR/storage_drivers ) )
NEW_INITRD_MODULES=( $(tr " " "\n" &lt;&lt;&lt; "${NEW_INITRD_MODULES[*]}" | sort | uniq -u) )
Log "New INITRD_MODULES='${OLD_INITRD_MODULES[@]} ${NEW_INITRD_MODULES[@]}'"
INITRD_MODULES="${OLD_INITRD_MODULES[@]} ${NEW_INITRD_MODULES[@]}"
WITH_INITRD_MODULES=$( printf '%s\n' ${INITRD_MODULES[@]} | awk '{printf "--with=%s ", $1}' )

usr/share/rear/finalize/SUSE_LINUX/i386/550_rebuild_initramfs.sh
    #   INITRD_MODULES=""
    #   # This replaces old INITRD_MODULES= variable from /etc/sysconfig/kernel
    Log "Original INITRD_MODULES='$INITRD_MODULES'"
    OLD_INITRD_MODULES=( $INITRD_MODULES )
    NEW_INITRD_MODULES=( $INITRD_MODULES $INITRD_MODULES $( cat $TMP_DIR/storage_drivers ) )
    NEW_INITRD_MODULES=( $( tr " " "\n" &lt;&lt;&lt; "${NEW_INITRD_MODULES[*]}" | sort | uniq -u ) )
    Log "New INITRD_MODULES='${OLD_INITRD_MODULES[@]} ${NEW_INITRD_MODULES[@]}'"
    sed -i -e '/^INITRD_MODULES/s/^.*$/#&amp;\nINITRD_MODULES="'"${OLD_INITRD_MODULES[*]} ${NEW_INITRD_MODULES[*]}"'"/' $TAR

usr/share/rear/finalize/Debian/i386/550_rebuild_initramfs.sh
INITRD_MODULES="$( sort -t " " -k 1 -u $TMP_DIR/storage_drivers $TARGET_FS_ROOT/etc/initramfs-tools/module[s] )"

usr/share/rear/prep/NETFS/default/040_inspect_configuration_files.sh
# If the user defines in local.conf for example: BACKUP_PROG_OPTIONS="--option1 --option2" then you will see

usr/share/rear/prep/NETFS/GNU/Linux/205_inspect_tar_capabilities.sh
echo "BACKUP_PROG_OPTIONS=( ${BACKUP_PROG_OPTIONS[@]} )" &gt;&gt; $ROOTFS_DIR/etc/rear/rescue.conf
    # prep/GNU/Linux/310_include_cap_utils.sh uses NETFS_RESTORE_CAPABILITIES=( 'Yes' ) to kick in next line, and is

usr/share/rear/prep/DUPLICITY/default/250_find_all_libs.sh
    sorted_unique_COPY_AS_IS=$(echo "${COPY_AS_IS[@]}" | tr ' ' '\n' | sort -u | tr '\n' ' ')
    eval COPY_AS_IS=${sorted_unique_COPY_AS_IS}
    sorted_unique_LIBS=$(echo "${LIBS[@]}" | tr ' ' '\n' | sort -u | tr '\n' ' ')
    eval LIBS=${sorted_unique_LIBS[@]}

usr/share/rear/prep/GNU/Linux/310_include_cap_utils.sh
    # that would store a false NETFS_RESTORE_CAPABILITIES='()' into /etc/rear/rescue.conf
    # when NETFS_RESTORE_CAPABILITIES=() but '()' is not an empty array but the string "()"
    NETFS_RESTORE_CAPABILITIES=( 'No' )

usr/share/rear/prep/GNU/Linux/280_include_virtualbox.sh
    #VBOX_COPY_AS_IS=( /etc/init.d/vboxadd* /opt/VBoxGuestAdditions-* /usr/sbin/VBoxService )
    VBOX_COPY_AS_IS=( /etc/init.d/vboxadd*  /usr/sbin/VBoxService )
    VBOX_MODULES=( vboxsf vboxvideo vboxguest )

usr/share/rear/prep/OPALPBA/Linux-i386/001_configure_workflow.sh
FIRMWARE_FILES=( 'no' )
MODULES=( 'loaded_modules' )
USE_RESOLV_CONF='no'
</code></pre>
<p>I will check those cases one by one...</p>
<h4 id="jsmeix_commented_at_2020-04-20_1350"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-616567193">2020-04-20 13:50</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-20_1350" title="Permanent link">&para;</a></h4>
<p>For the (actually not so much) fun of it:</p>
<p><code>ARRAY+=( additional elements )</code> is very much faster<br />
than <code>ARRAY=( "${ARRAY[@]}" additional elements )</code><br />
in particular for bigger arrays:</p>
<pre><code># unset arr ; time for i in $( seq 10 99 ) ; do arr+=( element$i ) ; done
real    0m0.004s
user    0m0.001s
sys     0m0.001s

# unset arr ; time for i in $( seq 100 999 ) ; do arr+=( element$i ) ; done
real    0m0.008s
user    0m0.008s
sys     0m0.000s

# unset arr ; time for i in $( seq 1000 9999 ) ; do arr+=( element$i ) ; done
real    0m0.046s
user    0m0.041s
sys     0m0.005s
</code></pre>
<p>versus lame old code</p>
<pre><code># unset arr ; time for i in $( seq 10 99 ) ; do arr=( "${arr[@]}" element$i ) ; done
real    0m0.016s
user    0m0.013s
sys     0m0.003s

# unset arr ; time for i in $( seq 100 999 ) ; do arr=( "${arr[@]}" element$i ) ; done
real    0m1.160s
user    0m1.157s
sys     0m0.003s

# unset arr ; time for i in $( seq 1000 9999 ) ; do arr=( "${arr[@]}" element$i ) ; done
real    2m24.567s
user    2m23.277s
sys     0m0.847s
</code></pre>
<p>I used a not so fast Intel Core i3-4000M CPU @ 2.40GHz for that tests.</p>
<p>Adding a single element to large arrays in both ways:</p>
<pre><code># unset arr ; for i in $( seq 100 999 ) ; do arr+=( element$i ) ; done ; \
 time arr+=( final_element1 ) ; \
 time arr=( "${arr[@]}" final_element2 )

real    0m0.000s
user    0m0.000s
sys     0m0.000s

real    0m0.003s
user    0m0.003s
sys     0m0.000s

# unset arr ; for i in $( seq 1000 9999 ) ; do arr+=( element$i ) ; done ; \
 time arr+=( final_element1 ) ; \
 time arr=( "${arr[@]}" final_element2 )

real    0m0.000s
user    0m0.000s
sys     0m0.000s

real    0m0.026s
user    0m0.026s
sys     0m0.000s

# unset arr ; for i in $( seq 10000 99999 ) ; do arr+=( element$i ) ; done ; \
 time arr+=( final_element1 ) ; \
 time arr=( "${arr[@]}" final_element2 )

real    0m0.000s
user    0m0.000s
sys     0m0.000s

real    0m0.284s
user    0m0.280s
sys     0m0.004s
</code></pre>
<h4 id="jsmeix_commented_at_2020-04-20_1358"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-616572074">2020-04-20 13:58</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-20_1358" title="Permanent link">&para;</a></h4>
<p>Same for strings but less serious in practice:<br />
Better code <code>string+=" additional words"</code></p>
<pre><code># unset string ; time for i in $( seq 10 99 ) ; do string+=" word$i" ; done
real    0m0.003s
user    0m0.002s
sys     0m0.001s

# unset string ; time for i in $( seq 100 999 ) ; do string+=" word$i" ; done
real    0m0.009s
user    0m0.009s
sys     0m0.000s

# unset string ; time for i in $( seq 1000 9999 ) ; do string+=" word$i" ; done
real    0m0.361s
user    0m0.358s
sys     0m0.003s
</code></pre>
<p>versus lame old code <code>string="$string additional words"</code></p>
<pre><code># unset string ; time for i in $( seq 10 99 ) ; do string="$string word$i" ; done
real    0m0.004s
user    0m0.004s
sys     0m0.000s

# unset string ; time for i in $( seq 100 999 ) ; do string="$string word$i" ; done
real    0m0.054s
user    0m0.051s
sys     0m0.002s

# unset string ; time for i in $( seq 1000 9999 ) ; do string="$string word$i" ; done
real    0m5.438s
user    0m5.431s
sys     0m0.007s
</code></pre>
<p>FYI<br />
how long empty <code>for</code> loops and plain <code>seq</code> take:</p>
<pre><code># time for i in $( seq 10 99 ) ; do : ; done
real    0m0.004s
user    0m0.001s
sys     0m0.003s

# time for i in $( seq 100 999 ) ; do : ; done
real    0m0.005s
user    0m0.003s
sys     0m0.002s

# time for i in $( seq 1000 9999 ) ; do : ; done
real    0m0.020s
user    0m0.016s
sys     0m0.004s

# time seq 10 99 &gt;/dev/null
real    0m0.004s
user    0m0.003s
sys     0m0.000s

# time seq 100 999 &gt;/dev/null
real    0m0.004s
user    0m0.003s
sys     0m0.001s

# time seq 1000 9999 &gt;/dev/null
real    0m0.004s
user    0m0.004s
sys     0m0.000s
</code></pre>
<h4 id="jsmeix_commented_at_2020-04-20_1455"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-616606990">2020-04-20 14:55</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-20_1455" title="Permanent link">&para;</a></h4>
<p>Regarding<br />
<a href="https://github.com/rear/rear/issues/2364#issuecomment-616549422">https://github.com/rear/rear/issues/2364#issuecomment-616549422</a></p>
<pre><code>usr/share/rear/output/OBDR/default/810_write_image.sh
BACKUP_PROG_COMPRESS_OPTIONS=
</code></pre>
<p>is OK because there is a comment that explains it:</p>
<pre><code># Disable compression (as tape drive does compression already)
Log "Disable compression for backup (BACKUP_PROG_COMPRESS_*)"
BACKUP_PROG_COMPRESS_OPTIONS=
BACKUP_PROG_COMPRESS_SUFFIX=

usr/share/rear/output/USB/Linux-i386/830_copy_kernel_initrd.sh
#RESULT_FILES=( "${USB_FILES[@]}" "$USB_DIR/kernel" "$USB_DIR/$REAR_INITRD_FILENAME" )
</code></pre>
<p>is only a comment so it is ok</p>
<pre><code>usr/share/rear/output/TSM/default/950_dsmc_save_result_files.sh
TSM_RESULT_FILES=()
    TSM_RESULT_FILES=(
    TSM_RESULT_FILES=( "${RESULT_FILES[@]}" )
</code></pre>
<p>is a false positive: there is no TSM_RESULT_FILES in default.conf</p>
<pre><code>usr/share/rear/output/DP/default/950_dp_save_result_files.sh
#DP_RESULT_FILES=()
</code></pre>
<p>is only a comment so it is ok</p>
<pre><code>usr/share/rear/output/NSR/default/950_nsr_save_result_files.sh
NSR_RESULT_FILES=()
        NSR_RESULT_FILES=( 
        NSR_RESULT_FILES=( "${RESULT_FILES[@]}" )
</code></pre>
<p>is a false positive: there is no NSR_RESULT_FILES in default.conf</p>
<pre><code>usr/share/rear/build/GNU/Linux/420_copy_firmware_files.sh
# The special value FIRMWARE_FILES=( 'no' ) or any value that
    LogPrint "Omit copying files in /lib*/firmware/ (FIRMWARE_FILES='$FIRMWARE_FILES')"
test "${FIRMWARE_FILES[*]}" || FIRMWARE_FILES=( 'yes' )
# The special value FIRMWARE_FILES=( 'yes' ) or any value that
</code></pre>
<p>is only a comment so it is ok</p>
<pre><code>usr/share/rear/build/GNU/Linux/400_copy_modules.sh
# The special user setting MODULES=( 'no_modules' ) enforces that
    # Since ReaR version 2.5 we have MODULES=( 'all_modules' ) in default.conf
    # MODULES array contents like MODULES=( 'moduleX' 'all_modules' 'moduleY' ):
    # The setting MODULES=( 'loaded_modules' ) results that only those kernel modules
    # MODULES array contents like MODULES=( 'moduleX' 'loaded_modules' 'moduleY' ):
    # MODULES=() which means the currently loaded kernel modules get included in the recovery system
    # MODULES=( 'moduleX' 'moduleY' ) where additional kernel modules can be specified
    # to be included in the recovery system in addition to the ones via an empty MODULES=() setting:
    # to not lose the below added modules but with MODULES=( 'all_modules' ) in default.conf
    # MODULES=( 'moduleX' 'moduleY' ) in etc/rear/local.conf to get additional kernel modules
    # included in the recovery system in addition to the ones via an empty MODULES=() setting:
            # Fallback is the plain module file without other needed modules (cf. the MODULES=( 'loaded_modules' ) case
</code></pre>
<p>is only a comment so it is ok</p>
<pre><code>usr/share/rear/build/OPALPBA/Linux-i386/095_exclude_non_essential_files.sh
Log "Before exclusion: PROGS=(${PROGS[*]})"
PROGS=( $(printf '%s\n' "${PROGS[@]}" | sed -r '/^('"$(printf '%s|' "${progs_to_exclude[@]}")"')$/d') )
Log "After exclusion: PROGS=(${PROGS[*]})"
Log "Before exclusion: REQUIRED_PROGS=(${REQUIRED_PROGS[*]})"
REQUIRED_PROGS=( $(printf '%s\n' "${REQUIRED_PROGS[@]}" | sed -r '/^('"$(printf '%s|' "${progs_to_exclude[@]}")"')$/d') 
Log "After exclusion: REQUIRED_PROGS=(${REQUIRED_PROGS[*]})"
Log "Before exclusion: REQUIRED_PROGS=(${REQUIRED_PROGS[*]})"
REQUIRED_PROGS=( $(printf '%s\n' "${REQUIRED_PROGS[@]}" | sed -r '/^('"$(printf '%s|' "${progs_to_exclude[@]}")"')$/d') 
Log "After exclusion: REQUIRED_PROGS=(${REQUIRED_PROGS[*]})"
</code></pre>
<p>looks ok</p>
<pre><code>usr/share/rear/conf/Linux-ppc64.conf
test "${FIRMWARE_FILES[*]}" || FIRMWARE_FILES=( 'no' )
</code></pre>
<p>is ok because it sets FIRMWARE_FILES only if empty</p>
<pre><code>usr/share/rear/conf/Linux-ppc64le.conf
    test "${FIRMWARE_FILES[*]}" || FIRMWARE_FILES=( 'no' )
</code></pre>
<p>is ok because it sets FIRMWARE_FILES only if empty</p>
<pre><code>usr/share/rear/conf/examples/borg-example.conf
COPY_AS_IS_BORG=( $BORG_KEYS_DIR )
ONLY_INCLUDE_VG=( "vg00" )
</code></pre>
<p>is ok because both COPY_AS_IS_BORG and ONLY_INCLUDE_VG<br />
are set empty in default.conf</p>
<pre><code>usr/share/rear/conf/examples/SLE12-SP1-btrfs-example.conf
BACKUP_PROG_INCLUDE=( /var/tmp /srv /var/lib/pgsql /var/spool /var/lib/libvirt/images /var/opt/ /tmp /var/lib/named /var
#MODULES_LOAD=( )
</code></pre>
<p>is ok because BACKUP_PROG_INCLUDE is set empty in default.conf<br />
and MODULES_LOAD is only a comment</p>
<pre><code>usr/share/rear/conf/examples/RHEL7-ISO-Oracle-example.conf
#ONLY_INCLUDE_VG=( "vg00" )
</code></pre>
<p>is only a comment so it is ok</p>
<pre><code>usr/share/rear/conf/examples/SLE12-SP2-btrfs-example.conf
BACKUP_PROG_INCLUDE=( /var/cache /var/lib/mailman /var/tmp /var/lib/pgsql /usr/local /opt /var/lib/libvirt/images /boot/
#MODULES_LOAD=( )
</code></pre>
<p>is ok because BACKUP_PROG_INCLUDE is set empty in default.conf<br />
and MODULES_LOAD is only a comment</p>
<pre><code>usr/share/rear/conf/examples/SLE12-btrfs-example.conf
BACKUP_PROG_INCLUDE=( /home /var/tmp /var/spool /var/opt /var/log /var/lib/pgsql /var/lib/mailman /var/lib/named /usr/lo
</code></pre>
<p>is ok because BACKUP_PROG_INCLUDE is set empty in default.conf</p>
<pre><code>usr/share/rear/conf/examples/SLE11-SLE12-SAP-HANA-UEFI-example.conf
EXCLUDE_VG=( vgHANA-data-HC2 vgHANA-data-HC3 vgHANA-log-HC2 vgHANA-log-HC3 vgHANA-shared-HC2 vgHANA-shared-HC3 )
</code></pre>
<p>is ok because EXCLUDE_VG is set empty in default.conf</p>
<pre><code>usr/share/rear/layout/prepare/default/420_autoresize_last_partitions.sh
# AUTORESIZE_EXCLUDE_PARTITIONS=( boot swap efi /dev/sdb3 /dev/sdc4 )
test "$AUTORESIZE_EXCLUDE_PARTITIONS" || AUTORESIZE_EXCLUDE_PARTITIONS=( boot swap efi )
</code></pre>
<p>is ok because it sets AUTORESIZE_EXCLUDE_PARTITIONS only if empty</p>
<pre><code>usr/share/rear/rescue/NETFS/default/610_save_capabilities.sh
is_true "$NETFS_RESTORE_CAPABILITIES" &amp;&amp; NETFS_RESTORE_CAPABILITIES=( '/' )
</code></pre>
<p>is ok because that behaviour is explained in default.conf:</p>
<pre><code># The special value NETFS_RESTORE_CAPABILITIES=( 'Yes' ) results that 'getcap -r /'
# is used as fallback which could become unusable slow on systems with zillions of files
# in particular when tons of stuff is mounted cf. https://github.com/rear/rear/issues/1283
# In this case one must explicitly specify on what directories 'getcap -r' should be run.

usr/share/rear/rescue/GNU/Linux/240_kernel_modules.sh
# The special user setting MODULES=( 'no_modules' ) enforces that
</code></pre>
<p>is only a comment so it is ok</p>
<p>I will contiune that tomorrow...</p>
<h4 id="jsmeix_commented_at_2020-04-21_1519"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-617246885">2020-04-21 15:19</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-21_1519" title="Permanent link">&para;</a></h4>
<p>...continuing:</p>
<pre><code>usr/share/rear/rescue/GNU/Linux/220_load_modules_from_initrd.sh
        INITRD_MODULES=
</code></pre>
<p>is ok because the code is</p>
<pre><code>    MODULES_LOAD+=(
      $(
        INITRD_MODULES=
        source /etc/sysconfig/kernel
        echo $INITRD_MODULES
      )
    )

usr/share/rear/restore/RSYNC/default/200_remove_relative_rsync_option.sh
    BACKUP_RSYNC_OPTIONS=( $( RmInArray "--relative" "${BACKUP_RSYNC_OPTIONS[@]}" ) )
    BACKUP_RSYNC_OPTIONS=( $( RmInArray "-R" "${BACKUP_RSYNC_OPTIONS[@]}" ) )
</code></pre>
<p>is ok and the reason is described in a commet in the code</p>
<pre><code>usr/share/rear/verify/OBDR/NETFS/default/540_set_backup_compression.sh
BACKUP_PROG_COMPRESS_OPTIONS=
</code></pre>
<p>is ok because the reason is described in a commet in the code</p>
<pre><code>usr/share/rear/lib/array-functions.sh
    # usage: BACKUP_RSYNC_OPTIONS=( $( RmInArray "--relative" "${BACKUP_RSYNC_OPTIONS[@]}" ) )
</code></pre>
<p>is only a comment so it is ok</p>
<pre><code>usr/share/rear/lib/bootloader-functions.sh
    FEATURE_SYSLINUX_MODULES=
        FEATURE_SYSLINUX_MODULES="y"
</code></pre>
<p>is a false positive: there is no FEATURE_SYSLINUX_MODULES in
default.conf</p>
<pre><code>usr/share/rear/lib/linux-functions.sh
    # The special user setting MODULES=( 'no_modules' ) enforces that
</code></pre>
<p>is only a comment so it is ok</p>
<pre><code>usr/share/rear/finalize/Fedora/i386/550_rebuild_initramfs.sh
    OLD_INITRD_MODULES=( $(cat $VAR_DIR/recovery/initrd_modules) )
    OLD_INITRD_MODULES=()
Log "Original OLD_INITRD_MODULES='${OLD_INITRD_MODULES[@]}'"
NEW_INITRD_MODULES=( ${OLD_INITRD_MODULES[@]} ${OLD_INITRD_MODULES[@]} $( cat $TMP_DIR/storage_drivers ) )
NEW_INITRD_MODULES=( $(tr " " "\n" &lt;&lt;&lt; "${NEW_INITRD_MODULES[*]}" | sort | uniq -u) )
Log "New INITRD_MODULES='${OLD_INITRD_MODULES[@]} ${NEW_INITRD_MODULES[@]}'"
INITRD_MODULES="${OLD_INITRD_MODULES[@]} ${NEW_INITRD_MODULES[@]}"
WITH_INITRD_MODULES=$( printf '%s\n' ${INITRD_MODULES[@]} | awk '{printf "--with=%s ", $1}' )

usr/share/rear/finalize/SUSE_LINUX/i386/550_rebuild_initramfs.sh
    #   INITRD_MODULES=""
    #   # This replaces old INITRD_MODULES= variable from /etc/sysconfig/kernel
    Log "Original INITRD_MODULES='$INITRD_MODULES'"
    OLD_INITRD_MODULES=( $INITRD_MODULES )
    NEW_INITRD_MODULES=( $INITRD_MODULES $INITRD_MODULES $( cat $TMP_DIR/storage_drivers ) )
    NEW_INITRD_MODULES=( $( tr " " "\n" &lt;&lt;&lt; "${NEW_INITRD_MODULES[*]}" | sort | uniq -u ) )
    Log "New INITRD_MODULES='${OLD_INITRD_MODULES[@]} ${NEW_INITRD_MODULES[@]}'"
    sed -i -e '/^INITRD_MODULES/s/^.*$/#&amp;\nINITRD_MODULES="'"${OLD_INITRD_MODULES[*]} ${NEW_INITRD_MODULES[*]}"'"/' $TAR

usr/share/rear/finalize/Debian/i386/550_rebuild_initramfs.sh
INITRD_MODULES="$( sort -t " " -k 1 -u $TMP_DIR/storage_drivers $TARGET_FS_ROOT/etc/initramfs-tools/module[s] )"
</code></pre>
<p>are false positives: there is neither OLD_INITRD_MODULES<br />
nor OLD_INITRD_MODULES nor INITRD_MODULES in default.conf</p>
<pre><code>usr/share/rear/prep/NETFS/default/040_inspect_configuration_files.sh
# If the user defines in local.conf for example: BACKUP_PROG_OPTIONS="--option1 --option2" then you will see
</code></pre>
<p>is only a comment so it is ok</p>
<pre><code>usr/share/rear/prep/NETFS/GNU/Linux/205_inspect_tar_capabilities.sh
echo "BACKUP_PROG_OPTIONS=( ${BACKUP_PROG_OPTIONS[@]} )" &gt;&gt; $ROOTFS_DIR/etc/rear/rescue.conf
    # prep/GNU/Linux/310_include_cap_utils.sh uses NETFS_RESTORE_CAPABILITIES=( 'Yes' ) to kick in next line, and is
</code></pre>
<p>is ok</p>
<pre><code>usr/share/rear/prep/DUPLICITY/default/250_find_all_libs.sh
    sorted_unique_COPY_AS_IS=$(echo "${COPY_AS_IS[@]}" | tr ' ' '\n' | sort -u | tr '\n' ' ')
    eval COPY_AS_IS=${sorted_unique_COPY_AS_IS}
    sorted_unique_LIBS=$(echo "${LIBS[@]}" | tr ' ' '\n' | sort -u | tr '\n' ' ')
    eval LIBS=${sorted_unique_LIBS[@]}
</code></pre>
<p>looks ok<br />
but that also shows an interesting question whether or not<br />
we make the COPY_AS_IS PROGS REQUIRED_PROGS<br />
and LIBS arrays list each element only once<br />
(i.e. convert those arrays to sets) before we process them<br />
to avoid duplicate work.</p>
<pre><code>usr/share/rear/prep/GNU/Linux/310_include_cap_utils.sh
    # that would store a false NETFS_RESTORE_CAPABILITIES='()' into /etc/rear/rescue.conf
    # when NETFS_RESTORE_CAPABILITIES=() but '()' is not an empty array but the string "()"
    NETFS_RESTORE_CAPABILITIES=( 'No' )
</code></pre>
<p>is ok because the reason is described in a commet in the code</p>
<pre><code>usr/share/rear/prep/GNU/Linux/280_include_virtualbox.sh
    #VBOX_COPY_AS_IS=( /etc/init.d/vboxadd* /opt/VBoxGuestAdditions-* /usr/sbin/VBoxService )
    VBOX_COPY_AS_IS=( /etc/init.d/vboxadd*  /usr/sbin/VBoxService )
    VBOX_MODULES=( vboxsf vboxvideo vboxguest )
</code></pre>
<p>is a false positive: there is neither VBOX_COPY_AS_IS<br />
nor VBOX_MODULES in default.conf</p>
<pre><code>usr/share/rear/prep/OPALPBA/Linux-i386/001_configure_workflow.sh
FIRMWARE_FILES=( 'no' )
MODULES=( 'loaded_modules' )
USE_RESOLV_CONF='no'
</code></pre>
<p>seems to be ok - those settings seem to be needed to<br />
"Configure the workflow for TCG Opal pre-boot authentication (PBA) image
creation"</p>
<h4 id="jsmeix_commented_at_2020-04-21_1521"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-617248190">2020-04-21 15:21</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-21_1521" title="Permanent link">&para;</a></h4>
<p>I found no false <code>ARRAY=( additional elements )</code> assignments<br />
so from my current point of view this issue seems to be done.</p>
<h4 id="jsmeix_commented_at_2020-04-22_1337"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2364#issuecomment-617784505">2020-04-22 13:37</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-22_1337" title="Permanent link">&para;</a></h4>
<p>In contrast to what I wrote above in<br />
<a href="https://github.com/rear/rear/issues/2364#issuecomment-617246885">https://github.com/rear/rear/issues/2364#issuecomment-617246885</a><br />
the item</p>
<pre><code>usr/share/rear/prep/DUPLICITY/default/250_find_all_libs.sh
    sorted_unique_COPY_AS_IS=$(echo "${COPY_AS_IS[@]}" | tr ' ' '\n' | sort -u | tr '\n' ' ')
    eval COPY_AS_IS=${sorted_unique_COPY_AS_IS}
    sorted_unique_LIBS=$(echo "${LIBS[@]}" | tr ' ' '\n' | sort -u | tr '\n' ' ')
    eval LIBS=${sorted_unique_LIBS[@]}
</code></pre>
<p>is not ok because is needlessly messes around<br />
with the LIBS and COPY_AS_IS arrays.<br />
I tried to fix that a bit via<br />
<a href="https://github.com/rear/rear/commit/6d25fd17b7ed2a6409362fcc33252eff4d9ce1d5">https://github.com/rear/rear/commit/6d25fd17b7ed2a6409362fcc33252eff4d9ce1d5</a><br />
but in general the prep/DUPLICITY/default/250_find_all_libs.sh<br />
looks as if it should be completely overhauled.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2020-04-14.2364.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
