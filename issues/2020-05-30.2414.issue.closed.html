<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2414 Issue closed: fedora 32 mkbackup fails due to missing module file - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2414 Issue closed: fedora 32 mkbackup fails due to missing module file";
        var mkdocs_page_input_path = "issues/2020-05-30.2414.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li class="breadcrumb-item active">#2414 Issue closed: fedora 32 mkbackup fails due to missing module file</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2414_issue_closed_fedora_32_mkbackup_fails_due_to_missing_module_file"><a href="https://github.com/rear/rear/issues/2414">#2414 Issue</a> <code>closed</code>: fedora 32 mkbackup fails due to missing module file<a class="headerlink" href="#2414_issue_closed_fedora_32_mkbackup_fails_due_to_missing_module_file" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="jholland-vin-dit_opened_issue_at_2020-05-30_1648"><img src="https://avatars.githubusercontent.com/u/3165127?v=4" width="50"><a href="https://github.com/jholland-vin-dit">jholland-vin-dit</a> opened issue at <a href="https://github.com/rear/rear/issues/2414">2020-05-30 16:48</a>:<a class="headerlink" href="#jholland-vin-dit_opened_issue_at_2020-05-30_1648" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"):Relax-and-Recover 2.4 /
    2018-06-21</p>
</li>
<li>
<p>OS version ("cat /etc/os-release" or "lsb_release -a" or "cat
    /etc/rear/os.conf"):ID=fedora<br />
    VERSION_ID=32</p>
</li>
<li>
<p>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):</p>
</li>
</ul>
<!-- -->

<pre><code>KEEP_BUILD_DIR="yes"
OUTPUT=ISO
OUTPUT_URL=file:///home/rear
BACKUP=NETFS
BACKUP_URL="cifs://192.168.61.122/FED5"
#BACKUP_URL="file:///mnt/backup"
BACKUP_OPTIONS="cred=/etc/rear/cifs"
BACKUP_PROG_EXCLUDE=( "${BACKUP_PROG_EXCLUDE[@]}" '/home/jholland/rhel8.0'  )
</code></pre>
<ul>
<li>
<p>Hardware (PC or PowerNV BareMetal or ARM) or virtual machine (KVM
    guest or PoverVM LPAR):<br />
    PC</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device):<br />
    x86_64</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot):<br />
    UEFI</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe):<br />
    SSD</p>
</li>
<li>
<p>Storage layout ("lsblk -ipo
    NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT" or "lsblk" as
    makeshift):</p>
</li>
</ul>
<!-- -->

<pre><code>NAME                          KNAME PKNAME TRAN   TYPE  FSTYPE   SIZE MOUNTPOINT
/dev/sda                      /dev/sda
|                                          sata   disk         465.8G 
|-/dev/sda1                   /dev/sda1
|                                   /dev/sda
|                                                 part  vfat     600M /boot/efi
|-/dev/sda2                   /dev/sda2
|                                   /dev/sda
|                                                 part  ext4       1G /boot
`-/dev/sda3                   /dev/sda3
                                    /dev/sda
                                                  part  crypto 464.2G 
  `-/dev/mapper/luks-4d4441c7-3072-4ce7-9d44-4fe0c5891200
                              /dev/dm-0
                                    /dev/sda3
                                                  crypt LVM2_m 464.2G 
    |-/dev/mapper/fedora_localhost--live-root
    |                         /dev/dm-1
    |                               /dev/dm-0
    |                                             lvm   ext4      70G /
    |-/dev/mapper/fedora_localhost--live-swap
    |                         /dev/dm-2
    |                               /dev/dm-0
    |                                             lvm   swap    23.8G [SWAP]
    `-/dev/mapper/fedora_localhost--live-home
                              /dev/dm-3
                                    /dev/dm-0
                                                  lvm   ext4   370.4G /home
/dev/sr0                      /dev/sr0
                                           sata   rom           1024M
</code></pre>
<ul>
<li>Description of the issue (ideally so that others can reproduce it):</li>
</ul>
<!-- -->

<pre><code>Copying kernel modules
ERROR: nls_cp437 exists but no module file?
</code></pre>
<ul>
<li>
<p>Workaround, if any:</p>
</li>
<li>
<p>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files):</p>
</li>
</ul>
<p>To paste verbatim text like command output or file content,<br />
include it between a leading and a closing line of three backticks like</p>
<pre><code>```
verbatim content
```
</code></pre>
<h4 id="jsmeix_commented_at_2020-06-02_0723"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-637344902">2020-06-02 07:23</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-06-02_0723" title="Permanent link">&para;</a></h4>
<p>@jholland-vin-dit<br />
the error exit happens in<br />
usr/share/rear/build/GNU/Linux/400_copy_modules.sh<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/build/GNU/Linux/400_copy_modules.sh#L156">https://github.com/rear/rear/blob/master/usr/share/rear/build/GNU/Linux/400_copy_modules.sh#L156</a></p>
<p>I am not a Fedora user so I cannot reproduce what goes wrong<br />
on Fedora 32 that a kernel module <code>nls_cp437</code> seems to exist<br />
but without a file that contains the module.</p>
<p>E.g. on my openSUSE Leap 15.1 system things look normal:</p>
<pre><code># modinfo -F filename nls_cp437
/lib/modules/4.12.14-lp151.28.48-default/kernel/fs/nls/nls_cp437.ko

# KERNEL_VERSION="$( uname -r )"
# modinfo -k $KERNEL_VERSION -F filename nls_cp437
/lib/modules/4.12.14-lp151.28.48-default/kernel/fs/nls/nls_cp437.ko
</code></pre>
<p>You could inspect the ReaR log file<br />
when you run it in debug mode like "rear -D mkrescue/mkbackup"<br />
what happend during build/GNU/Linux/400_copy_modules.sh<br />
regarding the <code>nls_cp437</code> module, cf.<br />
"Debugging issues with Relax-and-Recover" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>As a workaround try in etc/rear/local.conf</p>
<pre><code>MODULES=( 'all_modules' )
</code></pre>
<p>which runs simpler code in build/GNU/Linux/400_copy_modules.sh<br />
that should not fail because of whatever inconsistencies of kernel<br />
module names versus kernel module files.</p>
<p>Read the <code>MODULES</code> description in your<br />
usr/share/rear/conf/default.conf file.</p>
<h4 id="jholland-vin-dit_commented_at_2020-06-02_1029"><img src="https://avatars.githubusercontent.com/u/3165127?v=4" width="50"><a href="https://github.com/jholland-vin-dit">jholland-vin-dit</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-637447274">2020-06-02 10:29</a>:<a class="headerlink" href="#jholland-vin-dit_commented_at_2020-06-02_1029" title="Permanent link">&para;</a></h4>
<p>Thanks, that got me past that hurdle!</p>
<h4 id="jholland-vin-dit_commented_at_2020-06-02_1114"><img src="https://avatars.githubusercontent.com/u/3165127?v=4" width="50"><a href="https://github.com/jholland-vin-dit">jholland-vin-dit</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-637468903">2020-06-02 11:14</a>:<a class="headerlink" href="#jholland-vin-dit_commented_at_2020-06-02_1114" title="Permanent link">&para;</a></h4>
<p>Thanks, that got me past that hurdle!</p>
<blockquote>
<p>On Jun 2, 2020, at 3:23 AM, Johannes Meixner
<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a> wrote:</p>
<p>@jholland-vin-dit
<a href="https://github.com/jholland-vin-dit">https://github.com/jholland-vin-dit</a><br />
the error exit happens in<br />
usr/share/rear/build/GNU/Linux/400_copy_modules.sh<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/build/GNU/Linux/400_copy_modules.sh#L156">https://github.com/rear/rear/blob/master/usr/share/rear/build/GNU/Linux/400_copy_modules.sh#L156</a>
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/build/GNU/Linux/400_copy_modules.sh#L156">https://github.com/rear/rear/blob/master/usr/share/rear/build/GNU/Linux/400_copy_modules.sh#L156</a><br />
I am not a Fedora user so I cannot reproduce what goes wrong<br />
on Fedora 32 that a kernel module nls_cp437 seems to exist<br />
but without a file that contains the module<br />
like on my openSUSE Leap 15.1 system:</p>
<h1 id="modinfo_-f_filename_nls_cp437">modinfo -F filename nls_cp437<a class="headerlink" href="#modinfo_-f_filename_nls_cp437" title="Permanent link">&para;</a></h1>
<p>/lib/modules/4.12.14-lp151.28.48-default/kernel/fs/nls/nls_cp437.ko</p>
<h1 id="kernel_version_uname_-r">KERNEL_VERSION="$( uname -r )"<a class="headerlink" href="#kernel_version_uname_-r" title="Permanent link">&para;</a></h1>
<h1 id="modinfo_-k_kernel_version_-f_filename_nls_cp437">modinfo -k $KERNEL_VERSION -F filename nls_cp437<a class="headerlink" href="#modinfo_-k_kernel_version_-f_filename_nls_cp437" title="Permanent link">&para;</a></h1>
<p>/lib/modules/4.12.14-lp151.28.48-default/kernel/fs/nls/nls_cp437.ko<br />
You could inspect the ReaR log file<br />
when you run it in debug mode like "rear -D mkrescue/mkbackup"<br />
what happend during build/GNU/Linux/400_copy_modules.sh<br />
regarding the nls_cp437 module, cf.<br />
"Debugging issues with Relax-and-Recover" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a>
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a><br />
As a workaround try in etc/rear/local.conf</p>
<p>MODULES=( 'all_modules' )<br />
which runs simpler code in build/GNU/Linux/400_copy_modules.sh<br />
that should not fail because of whatever inconsistencies of kernel<br />
module names versuse kernel module files.</p>
<p>Read the <code>MODULES</code> description in your<br />
usr/share/rear/conf/default.conf file.<br />
—<br />
You are receiving this because you were mentioned.<br />
Reply to this email directly, view it on GitHub
<a href="https://github.com/rear/rear/issues/2414#issuecomment-637344902">https://github.com/rear/rear/issues/2414#issuecomment-637344902</a>,
or unsubscribe
<a href="https://github.com/notifications/unsubscribe-auth/AAYEXR6PJ2KR6AFMAFH5S6LRUSSIVANCNFSM4NOYO2TQ">https://github.com/notifications/unsubscribe-auth/AAYEXR6PJ2KR6AFMAFH5S6LRUSSIVANCNFSM4NOYO2TQ</a>.</p>
</blockquote>
<h4 id="jsmeix_commented_at_2020-06-02_1121"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-637473314">2020-06-02 11:21</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-06-02_1121" title="Permanent link">&para;</a></h4>
<p>@jholland-vin-dit<br />
thanks for your feedback that things work now for you.<br />
It is important for us at ReaR upstream to get such explicit feedback<br />
so we know whether or not there could be a hidden issue inside ReaR.<br />
FYI:<br />
Since ReaR 2.5 <code>MODULES=( 'all_modules' )</code> is the default, cf.<br />
<a href="https://github.com/rear/rear/blob/master/doc/rear-release-notes.txt#L211">https://github.com/rear/rear/blob/master/doc/rear-release-notes.txt#L211</a><br />
so this issue should no longer happen with ReaR 2.5 default behaviour.</p>
<h4 id="jholland-vin-dit_commented_at_2020-06-02_1130"><img src="https://avatars.githubusercontent.com/u/3165127?v=4" width="50"><a href="https://github.com/jholland-vin-dit">jholland-vin-dit</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-637478076">2020-06-02 11:30</a>:<a class="headerlink" href="#jholland-vin-dit_commented_at_2020-06-02_1130" title="Permanent link">&para;</a></h4>
<h1 id="well_that_got_me_past_that_hurdle_then_i_ran_into_another_one_with_httpsgithubcomrearrearissues1996_i_followed_the_advice_near_the_bottom_of_that_issue_page_to">Well, that got me past <em>that</em> hurdle. Then I ran into another one with <a href="https://github.com/rear/rear/issues/1996">https://github.com/rear/rear/issues/1996  </a> I followed the advice near the bottom of that issue page to<a class="headerlink" href="#well_that_got_me_past_that_hurdle_then_i_ran_into_another_one_with_httpsgithubcomrearrearissues1996_i_followed_the_advice_near_the_bottom_of_that_issue_page_to" title="Permanent link">&para;</a></h1>
<p>remove the linuxefi module which seems to not exist anymore,<br />
ending up with having same line as for slackware.</p>
<h1 id="i_have_followed_your_sugestion_and_also_removed_multiboot_it_was_causing_the_same_problems_as_linuxefi">I have followed your sugestion and also removed multiboot (it was causing the same problems as linuxefi)<a class="headerlink" href="#i_have_followed_your_sugestion_and_also_removed_multiboot_it_was_causing_the_same_problems_as_linuxefi" title="Permanent link">&para;</a></h1>
<p>Now my backup has completed and created the big tarball and iso.<br />
I am going to try a restore when I get a spare HD to restore onto.</p>
<p>It's great to get the help, thank you!</p>
<h4 id="jsmeix_commented_at_2020-06-02_1140"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-637483457">2020-06-02 11:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-06-02_1140" title="Permanent link">&para;</a></h4>
<p>@jholland-vin-dit<br />
in our current ReaR upstream master code we have substantial changes<br />
how UEFI booting of the ReaR recovery system ISO is implemented,<br />
in particular see
<a href="https://github.com/rear/rear/pull/2293">https://github.com/rear/rear/pull/2293</a></p>
<p>So you may like to try out our current ReaR upstream GitHub master
code<br />
from within a separated directory as a test to find out if things work
better<br />
with current ReaR upstream master code compared to your installed<br />
ReaR version, see the section<br />
"Testing current ReaR upstream GitHub master code" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>Of course I am totally selfish when I suggest you should test<br />
our current ReaR upstream GitHub master code because<br />
we at ReaR upstream need tests with recent Fedora versions ;-)</p>
<h4 id="jholland-vin-dit_commented_at_2020-06-02_1146"><img src="https://avatars.githubusercontent.com/u/3165127?v=4" width="50"><a href="https://github.com/jholland-vin-dit">jholland-vin-dit</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-637486543">2020-06-02 11:46</a>:<a class="headerlink" href="#jholland-vin-dit_commented_at_2020-06-02_1146" title="Permanent link">&para;</a></h4>
<p>Sorry, but I probably won’t do that very soon. Maybe sometime in the
future.</p>
<blockquote>
<p>On Jun 2, 2020, at 7:40 AM, Johannes Meixner
<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a> wrote:</p>
<p>@jholland-vin-dit
<a href="https://github.com/jholland-vin-dit">https://github.com/jholland-vin-dit</a><br />
in our current ReaR upstream master code we have substantial changes<br />
how UEFI booting of the ReaR recovery system is implemented, in<br />
particular see #2293
<a href="https://github.com/rear/rear/pull/2293">https://github.com/rear/rear/pull/2293</a><br />
So you may like to try out our current ReaR upstream GitHub master
code<br />
from within a separated directory as a test to find out if things work
better<br />
with current ReaR upstream master code compared to your installed<br />
ReaR version, see the section<br />
"Testing current ReaR upstream GitHub master code" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a>
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a><br />
Of course I am totally selfish when I suggest you should test<br />
our current ReaR upstream GitHub master code because<br />
we at ReaR upstream need tests with recent Fedora versions ;-)</p>
<p>—<br />
You are receiving this because you were mentioned.<br />
Reply to this email directly, view it on GitHub
<a href="https://github.com/rear/rear/issues/2414#issuecomment-637483457">https://github.com/rear/rear/issues/2414#issuecomment-637483457</a>,
or unsubscribe
<a href="https://github.com/notifications/unsubscribe-auth/AAYEXRZ3KBCQKC76JNPRC73RUTQLBANCNFSM4NOYO2TQ">https://github.com/notifications/unsubscribe-auth/AAYEXRZ3KBCQKC76JNPRC73RUTQLBANCNFSM4NOYO2TQ</a>.</p>
</blockquote>
<h4 id="jholland-vin-dit_commented_at_2020-06-03_2223"><img src="https://avatars.githubusercontent.com/u/3165127?v=4" width="50"><a href="https://github.com/jholland-vin-dit">jholland-vin-dit</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-638492289">2020-06-03 22:23</a>:<a class="headerlink" href="#jholland-vin-dit_commented_at_2020-06-03_2223" title="Permanent link">&para;</a></h4>
<p>So I got a spare hard drive and tried to restore my fedora 32 backup. It
seemed to be having problems with the source disk being encrypted? It
looked like it was trying to prompt for a password but it wasn’t letting
me enter it. I tried going in the rear shell but didn’t see anything
that looked helpful.</p>
<blockquote>
<p>On Jun 2, 2020, at 7:46 AM, John Holland <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#106;&#111;&#104;&#110;&#98;&#104;&#111;&#108;&#108;&#97;&#110;&#100;&#64;&#105;&#99;&#108;&#111;&#117;&#100;&#46;&#99;&#111;&#109;">&#106;&#111;&#104;&#110;&#98;&#104;&#111;&#108;&#108;&#97;&#110;&#100;&#64;&#105;&#99;&#108;&#111;&#117;&#100;&#46;&#99;&#111;&#109;</a>
wrote:</p>
<p>﻿Sorry, but I probably won’t do that very soon. Maybe sometime in the
future.</p>
<blockquote>
<p>On Jun 2, 2020, at 7:40 AM, Johannes Meixner
<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a> wrote:</p>
<p>@jholland-vin-dit<br />
in our current ReaR upstream master code we have substantial
changes<br />
how UEFI booting of the ReaR recovery system is implemented, in<br />
particular see #2293</p>
<p>So you may like to try out our current ReaR upstream GitHub master
code<br />
from within a separated directory as a test to find out if things
work better<br />
with current ReaR upstream master code compared to your installed<br />
ReaR version, see the section<br />
"Testing current ReaR upstream GitHub master code" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>Of course I am totally selfish when I suggest you should test<br />
our current ReaR upstream GitHub master code because<br />
we at ReaR upstream need tests with recent Fedora versions ;-)</p>
<p>—<br />
You are receiving this because you were mentioned.<br />
Reply to this email directly, view it on GitHub, or unsubscribe.</p>
</blockquote>
</blockquote>
<h4 id="jsmeix_commented_at_2020-06-04_0728"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-638659801">2020-06-04 07:28</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-06-04_0728" title="Permanent link">&para;</a></h4>
<p>@jholland-vin-dit<br />
I am not a CIFS user so I won't reproduce CIFS issues<br />
or could even fix possible bugs with CIFS in ReaR.</p>
<p>From plain looking at the ReaR documentation that<br />
mentiones cifs I see in "man rear"</p>
<pre><code>BACKUP_URL=cifs://
To backup to a Samba share (CIFS), use
BACKUP_URL=cifs://cifs-server-name/share/path.
To provide credentials for CIFS mounting use a
/etc/rear/cifs credentials file and define
BACKUP_OPTIONS="cred=/etc/rear/cifs"
and pass along:

username=_username_
password=_secret password_
domain=_domain_
</code></pre>
<p>and in usr/share/rear/conf/examples/USB-and-Samba-example.conf</p>
<pre><code># Backup to a network share:
BACKUP=NETFS
# When using CIFS as backup/output destination make sure that cifs-utils package is installed
# Path to the cifs share:
BACKUP_URL=cifs://server/share
# Username and password of a valid Samba/Active Directory user:
BACKUP_OPTIONS="username=sambauser,pass=password"
</code></pre>
<p>so in both cases username and the secret password<br />
must be provided either in a /etc/rear/cifs file<br />
or directly in the BACKUP_OPTIONS config variable<br />
which means the ReaR recovery system contains<br />
the secret password.</p>
<p>From plain looking at the ReaR code that is related to <code>cifs</code> I see<br />
in usr/share/rear/backup/NETFS/default/100_mount_NETFS_path.sh</p>
<pre><code>mount_url $BACKUP_URL $BUILD_DIR/outputfs $BACKUP_OPTIONS
</code></pre>
<p>that leads to usr/share/rear/lib/global-functions.sh</p>
<pre><code>### Mount URL $1 at mountpoint $2[, with options $3]
mount_url() {
...
    case $(url_scheme $url) in
    ....
        (cifs)
            if [ x"$options" = x"$defaultoptions" ];then
                # defaultoptions contains noatime which is not valid for cifs (issue #752)
                mount_cmd="mount $v -o rw,guest //$(url_host $url)$(url_path $url) $mountpoint"
            else
                mount_cmd="mount $v -o $options //$(url_host $url)$(url_path $url) $mountpoint"
            fi
            ;;
</code></pre>
<p>so your <code>BACKUP_OPTIONS="cred=/etc/rear/cifs"</code><br />
should result a mount command of the form</p>
<pre><code>mount -v -o cred=/etc/rear/cifs ...
</code></pre>
<p>to mount the CIFS share at a local mointpoint.</p>
<p>As far as I see there is currently no way in ReaR how to provide<br />
CIFS username and the secret password in an interactive way<br />
via some kind of user dialog in ReaR.</p>
<p>In "man mount.cifs" I see</p>
<pre><code>OPTIONS
...
password=arg|pass=arg
specifies the CIFS password. If this option is not given
then the environment variable PASSWD is used.
If the password is not specified directly or indirectly
via an argument to mount,
mount.cifs will prompt for a password,
unless the guest option is specified.
Note that a password which contains the delimiter
character (i.e. a comma ',') will fail to be parsed correctly
on the command line. However, the same password defined
in the PASSWD environment variable or via a credentials
file (see below) or entered at the password prompt
will be read correctly.

credentials=filename|cred=filename
specifies a file that contains a username and/or password
and optionally the name of the workgroup.
The format of the file is:
    username=value
    password=value
    domain=value
This is preferred over having passwords in plaintext
in a shared file, such as /etc/fstab .
Be sure to protect any credentials file properly.
</code></pre>
<p>Accordingly it seems in your case it is mount.cifs that<br />
prompts for a password because you did not provide<br />
it via ReaR options or via the environment variable PASSWD<br />
before you launched "rear recover".</p>
<p>But you won't see when mount.cifs prompts for a password<br />
because while usr/sbin/rear is running both stdout and stderr<br />
are redirected into ReaR's log file, cf.<br />
"What to do with stdin, stdout, and stderr" in<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a></p>
<h4 id="jsmeix_commented_at_2020-06-04_0742"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-638668166">2020-06-04 07:42</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-06-04_0742" title="Permanent link">&para;</a></h4>
<p>@jholland-vin-dit<br />
according to your <code>lsblk</code> output you use<br />
LVM on LUKS encrypted volume.</p>
<p>So when you made the CIFS access working for you<br />
the next possible issue could be already waiting for you:<br />
<a href="https://github.com/rear/rear/issues/2389">https://github.com/rear/rear/issues/2389</a></p>
<h4 id="jholland-vin-dit_commented_at_2020-06-04_1245"><img src="https://avatars.githubusercontent.com/u/3165127?v=4" width="50"><a href="https://github.com/jholland-vin-dit">jholland-vin-dit</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-638824664">2020-06-04 12:45</a>:<a class="headerlink" href="#jholland-vin-dit_commented_at_2020-06-04_1245" title="Permanent link">&para;</a></h4>
<p>Thanks for looking into it,<br />
I think I will wait a bit before trying REAR on Fedora 32 again. I like
REAR when it works as it did on RHEL 8 for me. It’s too disruptive for
me to test/troubleshoot it on Fedora though.</p>
<blockquote>
<p>On Jun 4, 2020, at 3:42 AM, Johannes Meixner
<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a> wrote:</p>
<p>﻿<br />
@jholland-vin-dit<br />
according to your lsblk output you use<br />
LVM on LUKS encrypted volume.</p>
<p>So when you made the CIFS access working for you<br />
the next possible issue could be already waiting for you:<br />
#2389</p>
<p>—<br />
You are receiving this because you were mentioned.<br />
Reply to this email directly, view it on GitHub, or unsubscribe.</p>
</blockquote>
<h4 id="z1atk0_commented_at_2020-08-04_1433"><img src="https://avatars.githubusercontent.com/u/12568948?u=b5ffadfef1826bccac03b8a8d20a1caf61158a59&v=4" width="50"><a href="https://github.com/z1atk0">z1atk0</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-668632798">2020-08-04 14:33</a>:<a class="headerlink" href="#z1atk0_commented_at_2020-08-04_1433" title="Permanent link">&para;</a></h4>
<p>Just for kicks (I only upgraded to FC32 yesterday and got bitten by this
problem today), adding the following line to
<code>usr/share/rear/build/GNU/Linux/400_copy_modules.sh</code> at line 108 right
after the line containing</p>
<pre><code>modinfo $module 1&gt;/dev/null || continue
</code></pre>
<p>fixes the problem for me:</p>
<pre><code>grep -q $(echo $module | tr '_-' '..') /lib/modules/$KERNEL_VERSION/modules.builtin &amp;&amp; continue
</code></pre>
<p>Feel free to use this workaround if you want. :slightly_smiling_face:</p>
<p>Bye,<br />
Thomas</p>
<h4 id="jholland-vin-dit_commented_at_2020-08-04_2017"><img src="https://avatars.githubusercontent.com/u/3165127?v=4" width="50"><a href="https://github.com/jholland-vin-dit">jholland-vin-dit</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-668804032">2020-08-04 20:17</a>:<a class="headerlink" href="#jholland-vin-dit_commented_at_2020-08-04_2017" title="Permanent link">&para;</a></h4>
<p>This is interesting. I don’t think I’m going to continue trying REAR for
Fedora as doing full backups of Fedora seems silly since it is such a
moving target. Congratulations on solving it though!</p>
<blockquote>
<p>On Aug 4, 2020, at 10:33 AM, Thomas Zajic <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a>
wrote:</p>
<p>Just for kicks (I only upgraded to FC32 yesterday and got bitten by
this problem today), adding the following line to
usr/share/rear/build/GNU/Linux/400_copy_modules.sh at line 108
(right after the line containing modinfo $module 1&gt;/dev/null ||
continue) fixes the problem for me:<br />
grep -q $(echo $module | tr '_-' '..')
/lib/modules/$KERNEL_VERSION/modules.builtin &amp;&amp; continue<br />
Feel free to use this workaround if you want. 🙂</p>
<p>Bye,<br />
Thomas</p>
<p>—<br />
You are receiving this because you were mentioned.<br />
Reply to this email directly, view it on GitHub
<a href="https://github.com/rear/rear/issues/2414#issuecomment-668632798">https://github.com/rear/rear/issues/2414#issuecomment-668632798</a>,
or unsubscribe
<a href="https://github.com/notifications/unsubscribe-auth/AAYEXR6IOWOCCSCZJP67FLDR7AL4NANCNFSM4NOYO2TQ">https://github.com/notifications/unsubscribe-auth/AAYEXR6IOWOCCSCZJP67FLDR7AL4NANCNFSM4NOYO2TQ</a>.</p>
</blockquote>
<h4 id="jsmeix_commented_at_2020-08-05_1029"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-669115481">2020-08-05 10:29</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-08-05_1029" title="Permanent link">&para;</a></h4>
<p>@z1atk0<br />
thank you for your<br />
<a href="https://github.com/rear/rear/issues/2414#issuecomment-668632798">https://github.com/rear/rear/issues/2414#issuecomment-668632798</a></p>
<p>I implemented it for current GitHub master code via<br />
<a href="https://github.com/rear/rear/pull/2469">https://github.com/rear/rear/pull/2469</a></p>
<p>FYI:<br />
I am not a Fedora user so I cannot reproduce Fedora specific issues<br />
but on my openSUSE Leap 15.1 system I noticed that there are modules<br />
that are listed in /lib/modules/*/modules.builtin and also exist as a
file:</p>
<pre><code># uname -a
Linux linux-h9wr 4.12.14-lp151.28.52-default ...

# for builtin_module in $( cat /lib/modules/4.12.14-lp151.28.52-default/modules.builtin ) ; do \
 module_name=$( basename $builtin_module | cut -d '.' -f1 ) ; \
 modinfo $module_name &amp;&gt;/dev/null &amp;&amp; echo builtin module $builtin_module found by modinfo ; done
builtin module kernel/lib/crc32.ko found by modinfo

# grep crc32 /lib/modules/4.12.14-lp151.28.52-default/modules.builtin
kernel/crypto/crc32c_generic.ko
kernel/lib/crc32.ko

# modinfo crc32 -F filename
/lib/modules/4.12.14-lp151.28.52-default/kernel/arch/x86/crypto/crc32-pclmul.ko
/lib/modules/4.12.14-lp151.28.52-default/kernel/crypto/crc32_generic.ko
</code></pre>
<p>With
<a href="https://github.com/rear/rear/pull/2469">https://github.com/rear/rear/pull/2469</a><br />
the new behaviour is that when modules are listed in modules.builtin<br />
and are shown by modinfo then those modules are skipped.<br />
Before
<a href="https://github.com/rear/rear/pull/2469">https://github.com/rear/rear/pull/2469</a>
for such modules<br />
the modules file(s) would have been included in the recovery system.<br />
This would be a backward incompatible change if we had not already<br />
<code>MODULES=( 'all_modules' )</code> by default so the different behaviour<br />
with
<a href="https://github.com/rear/rear/pull/2469">https://github.com/rear/rear/pull/2469</a>
should affect only exceptional cases.</p>
<h4 id="jsmeix_commented_at_2020-08-10_1424"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2414#issuecomment-671386938">2020-08-10 14:24</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-08-10_1424" title="Permanent link">&para;</a></h4>
<p>With
<a href="https://github.com/rear/rear/pull/2469">https://github.com/rear/rear/pull/2469</a>
merged<br />
the initially described issue "... fails due to missing module file"<br />
should be avoided.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2023 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2020-05-30.2414.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
