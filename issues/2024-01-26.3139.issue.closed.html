<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#3139 Issue closed: Syslog and journald in rescue system not showing service logs - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#3139 Issue closed: Syslog and journald in rescue system not showing service logs";
        var mkdocs_page_input_path = "issues/2024-01-26.3139.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#3139 Issue closed: Syslog and journald in rescue system not showing service logs</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="3139_issue_closed_syslog_and_journald_in_rescue_system_not_showing_service_logs"><a href="https://github.com/rear/rear/issues/3139">#3139 Issue</a> <code>closed</code>: Syslog and journald in rescue system not showing service logs<a class="headerlink" href="#3139_issue_closed_syslog_and_journald_in_rescue_system_not_showing_service_logs" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>bug</code>, <code>critical / security / legal</code>, <code>blocker</code></p>
<h4 id="schlomo_opened_issue_at_2024-01-26_1352"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> opened issue at <a href="https://github.com/rear/rear/issues/3139">2024-01-26 13:52</a>:<a class="headerlink" href="#schlomo_opened_issue_at_2024-01-26_1352" title="Permanent link">&para;</a></h4>
<p>Current ReaR from master shows a strange problem with regard to logging
in the rescue system, for example:</p>
<pre><code>RESCUE rear-u2204:~ # journalctl -u ssh --no-pager --boot
-- No entries --
</code></pre>
<p>(I'm connected via SSH)</p>
<p>whereas the original system shows me the log:</p>
<pre><code>root@rear-u2204:/src/rear# journalctl -u ssh --no-pager --boot
Jan 26 13:04:26 rear-u2204 systemd[1]: Starting OpenBSD Secure Shell server...
Jan 26 13:04:26 rear-u2204 sshd[634]: Server listening on 0.0.0.0 port 22.
Jan 26 13:04:26 rear-u2204 sshd[634]: Server listening on :: port 22.
Jan 26 13:04:26 rear-u2204 systemd[1]: Started OpenBSD Secure Shell server.
Jan 26 13:04:34 rear-u2204 sshd[873]: Accepted publickey for root from 192.168.11.6 port 44082 ssh2: RSA SHA256:seEU/B1WR98Ck/27Mh9MARstsMqMyMnv63t30+0w1K8
Jan 26 13:04:34 rear-u2204 sshd[873]: pam_unix(sshd:session): session opened for user root(uid=0) by (uid=0)
Jan 26 13:07:38 rear-u2204 sshd[2141]: Accepted publickey for root from 192.168.11.6 port 45826 ssh2: RSA SHA256:seEU/B1WR98Ck/27Mh9MARstsMqMyMnv63t30+0w1K8
Jan 26 13:07:38 rear-u2204 sshd[2141]: pam_unix(sshd:session): session opened for user root(uid=0) by (uid=0)
</code></pre>
<p>Also syslog doesn't work as expected, again on the rescue system:</p>
<pre><code>RESCUE rear-u2204:~ # logger reartest
RESCUE rear-u2204:~ # journalctl --boot -g reartest
-- No entries --
</code></pre>
<p>and on the source system it works as expected:</p>
<pre><code>root@rear-u2204:/src/rear# logger reartest
root@rear-u2204:/src/rear# journalctl --boot -g reartest
Jan 26 13:40:34 rear-u2204 root[53389]: reartest
</code></pre>
<p>I actually observed this while working on #3138 but didn't want to add
this problem into that PR. The problem was <strong>identical in appearance</strong>
on all systems (RHEL 7,8,9 and SLES 12,15 and Ubuntu 20,22).</p>
<p>Especially the syslog problem is very strange as it seems that
<code>/dev/log</code> is configured correctly:</p>
<pre><code>RESCUE rear-u2204:~ # systemctl list-sockets
LISTEN                      UNIT                         ACTIVATES               
/dev/log                    systemd-journald.socket      systemd-journald.service
/run/systemd/journal/socket systemd-journald.socket      systemd-journald.service
/run/systemd/journal/stdout systemd-journald.socket      systemd-journald.service
/run/udev/control           systemd-udevd-control.socket systemd-udevd.service
kobject-uevent 1            systemd-udevd-kernel.socket  systemd-udevd.service

5 sockets listed.
Pass --all to see loaded but inactive sockets, too.
RESCUE rear-u2204:~ # systemctl status systemd-journald
‚óè systemd-journald.service - Journal Service
     Loaded: loaded (/usr/lib/systemd/system/systemd-journald.service; static)
     Active: active (running) since Fri 2024-01-26 13:31:15 UTC; 12min ago
TriggeredBy: ‚óè systemd-journald.socket
       Docs: man:systemd-journald.service(8)
             man:systemd-journald.conf(5)
   Main PID: 75 (systemd-journal)
     Status: "Processing requests..."
      Tasks: 1 (limit: 4563)
     Memory: 9.1M
        CPU: 35ms
     CGroup: /system.slice/systemd-journald.service
             ‚îî‚îÄ75 /usr/lib/systemd/systemd-journald

Jan 26 13:31:15 rear-u2204 systemd-journald[75]: Journal started
Jan 26 13:31:15 rear-u2204 systemd-journald[75]: Runtime Journal (/run/log/journal/3a64d7109b544834b661896de0e54ded) is 8.0M, max 77.8M, 69.8M free.
Notice: journal has been rotated since unit was started, output may be incomplete.
</code></pre>
<p>Starting Rsyslog also doesn't work because some rsyslog modules are
missing:</p>
<pre><code>RESCUE rear-u2204:~ # /etc/scripts/run-syslog
rsyslog internal message (3,-2066): could not load module 'lmnet', errors: trying to load module /usr/lib/x86_64-linux-gnu/rsyslog/lmnet.so: /usr/lib/x86_64-linux-gnu/rsyslog/lmnet.so: cannot open shared object file: No such file or directory [v8.2112.0 try https://www.rsyslog.com/e/2066 ]
Error during class init for object 'conf' - failing...
rsyslogd initializiation failed - global classes could not be initialized.
Did you do a "make install"?
Suggested action: run rsyslogd with -d -n options to see what exactly fails.
rsyslogd: run failed with error -2066 (see rsyslog.h or try https://www.rsyslog.com/e/2066 to learn what that number means)
</code></pre>
<p>In general the JournalD log looks very different from the one on the
source machine, for example it reports all lines as if they belong to
systemd, for example</p>
<pre><code>RESCUE rear-u2204:~ # journalctl -ef --no-pager -n 20
Jan 26 13:45:33 rear-u2204 systemd[1]: Registering bus object implementation for path=/org/freedesktop/systemd1/unit iface=org.freedesktop.systemd1.Service
Jan 26 13:45:33 rear-u2204 systemd[1]: Registering bus object implementation for path=/org/freedesktop/systemd1/unit iface=org.freedesktop.systemd1.Slice
Jan 26 13:45:33 rear-u2204 systemd[1]: Registering bus object implementation for path=/org/freedesktop/systemd1/unit iface=org.freedesktop.systemd1.Socket
Jan 26 13:45:33 rear-u2204 systemd[1]: Registering bus object implementation for path=/org/freedesktop/systemd1/unit iface=org.freedesktop.systemd1.Swap
Jan 26 13:45:33 rear-u2204 systemd[1]: Registering bus object implementation for path=/org/freedesktop/systemd1/unit iface=org.freedesktop.systemd1.Target
Jan 26 13:45:33 rear-u2204 systemd[1]: Registering bus object implementation for path=/org/freedesktop/systemd1/unit iface=org.freedesktop.systemd1.Timer
Jan 26 13:45:33 rear-u2204 systemd[1]: Registering bus object implementation for path=/org/freedesktop/LogControl1 iface=org.freedesktop.LogControl1
Jan 26 13:45:33 rear-u2204 systemd[1]: Accepted new private connection.
Jan 26 13:45:33 rear-u2204 systemd[1]: Bus private-bus-connection: changing state AUTHENTICATING ‚Üí RUNNING
Jan 26 13:45:33 rear-u2204 systemd[1]: Got message type=method_call sender=n/a destination=org.freedesktop.systemd1 path=/org/freedesktop/systemd1/unit/rsyslog_2eservice interface=org.freedesktop.DBus.Properties member=GetAll cookie=1 reply_cookie=0 signature=s error-name=n/a error-message=n/a
Jan 26 13:45:33 rear-u2204 systemd[1]: Failed to read pids.max attribute of cgroup root, ignoring: No data available
Jan 26 13:45:33 rear-u2204 systemd[1]: Sent message type=method_return sender=org.freedesktop.systemd1 destination=n/a path=n/a interface=n/a member=n/a cookie=1 reply_cookie=1 signature=a{sv} error-name=n/a error-message=n/a
Jan 26 13:45:33 rear-u2204 systemd[1]: Got message type=method_call sender=n/a destination=org.freedesktop.systemd1 path=/org/freedesktop/systemd1/unit/syslog_2esocket interface=org.freedesktop.DBus.Properties member=Get cookie=2 reply_cookie=0 signature=ss error-name=n/a error-message=n/a
Jan 26 13:45:33 rear-u2204 systemd[1]: Sent message type=method_return sender=org.freedesktop.systemd1 destination=n/a path=n/a interface=n/a member=n/a cookie=2 reply_cookie=2 signature=v error-name=n/a error-message=n/a
Jan 26 13:45:33 rear-u2204 systemd[1]: Bus private-bus-connection: changing state RUNNING ‚Üí CLOSING
Jan 26 13:45:33 rear-u2204 systemd[1]: Bus private-bus-connection: changing state CLOSING ‚Üí CLOSED
Jan 26 13:45:33 rear-u2204 systemd[1]: Got disconnect on private connection.
Jan 26 13:47:17 rear-u2204 systemd[1]: Received SIGCHLD from PID 632 (less).
Jan 26 13:47:17 rear-u2204 systemd[1]: Child 632 (less) died (code=exited, status=0/SUCCESS)
Jan 26 13:47:17 rear-u2204 systemd[1]: sshd.service: Child 632 belongs to sshd.service.
</code></pre>
<p>(while running this I connected via SSH to this box and no new log lines
appeared)</p>
<p>This problem makes debugging stuff in the rescue system very difficult
and I'd consider it a critical bug.</p>
<p>@rear/contributors do you experience the same? Any ideas what could be
the problem here?</p>
<h4 id="schlomo_commented_at_2024-01-26_1355"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/3139#issuecomment-1912107171">2024-01-26 13:55</a>:<a class="headerlink" href="#schlomo_commented_at_2024-01-26_1355" title="Permanent link">&para;</a></h4>
<p>A quick test with ReaR version <code>2.6</code> shows unfortunately exactly the
same behaviour üò¢</p>
<h4 id="pcahyna_commented_at_2024-01-27_1333"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/3139#issuecomment-1913157701">2024-01-27 13:33</a>:<a class="headerlink" href="#pcahyna_commented_at_2024-01-27_1333" title="Permanent link">&para;</a></h4>
<blockquote>
<p>The problem was identical in appearance on all systems (RHEL 7,8,9 and
SLES 12,15 and Ubuntu 20,22).</p>
</blockquote>
<p>strange, I saw the problem on RHEL 9 (this was the motivation for fixing
the rsyslog startup in PR #3041 , which is clearly not a working
solution on Ubuntu) but not RHEL 8. syslog messages went to journal
there.</p>
<h4 id="schlomo_commented_at_2024-01-27_1706"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/3139#issuecomment-1913261630">2024-01-27 17:06</a>:<a class="headerlink" href="#schlomo_commented_at_2024-01-27_1706" title="Permanent link">&para;</a></h4>
<p>@pcahyna TBH, I didn't do the <code>logger</code> test on all systems - so that it
indeed might have not been a problem on all of them. But I did check for
service logs and that was as described above (service logs missing from
journal) on all systems. The reason for checking was that the PPDM
service fails to start on boot, so I had to check for that.</p>
<h4 id="github-actions_commented_at_2024-03-28_0204"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/3139#issuecomment-2024269568">2024-03-28 02:04</a>:<a class="headerlink" href="#github-actions_commented_at_2024-03-28_0204" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2024-01-26.3139.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
