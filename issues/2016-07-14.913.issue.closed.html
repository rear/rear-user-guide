<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#913 Issue closed: If /boot partition is too small it should exit immediately or give me bigger warning - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#913 Issue closed: If /boot partition is too small it should exit immediately or give me bigger warning";
        var mkdocs_page_input_path = "issues/2016-07-14.913.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#913 Issue closed: If /boot partition is too small it should exit immediately or give me bigger warning</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="913_issue_closed_if_boot_partition_is_too_small_it_should_exit_immediately_or_give_me_bigger_warning"><a href="https://github.com/rear/rear/issues/913">#913 Issue</a> <code>closed</code>: If /boot partition is too small it should exit immediately or give me bigger warning<a class="headerlink" href="#913_issue_closed_if_boot_partition_is_too_small_it_should_exit_immediately_or_give_me_bigger_warning" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>bug</code>, <code>cleanup</code>, <code>fixed / solved / done</code></p>
<h4 id="blaskovic_opened_issue_at_2016-07-14_1024"><img src="https://avatars.githubusercontent.com/u/1025719?v=4" width="50"><a href="https://github.com/blaskovic">blaskovic</a> opened issue at <a href="https://github.com/rear/rear/issues/913">2016-07-14 10:24</a>:<a class="headerlink" href="#blaskovic_opened_issue_at_2016-07-14_1024" title="Permanent link">&para;</a></h4>
<ul>
<li>rear version (/usr/sbin/rear -V):<ul>
<li>Relax-and-Recover 1.17.2 / Git</li>
</ul>
</li>
<li>OS version (cat /etc/rear/os.conf or lsb_release -a):</li>
</ul>
<!-- -->

<pre><code># cat /etc/rear/os.conf
OS_VENDOR=RedHatEnterpriseServer
OS_VERSION=7
</code></pre>
<ul>
<li>rear configuration files (cat /etc/rear/site.conf or cat
    /etc/rear/local.conf):</li>
</ul>
<!-- -->

<pre><code>OUTPUT=ISO
BACKUP=NETFS
BACKUP_URL=file:///mnt/external-drive
GRUB_RESCUE=1
</code></pre>
<ul>
<li>Brief description of the issue<ul>
<li>In case my /boot partition is too small to write iso file here,
    it just put a small warning, that it is not big enough. So if I
    run this in cron, I don't know if something went wrong and there
    is no ISO image in /boot.</li>
<li>Then if I want to recover totally broken system, I can't because
    it does not contain recovery image</li>
</ul>
</li>
<li>Work-around, if any<ul>
<li>I don't know it it exists - maybe I can resize /boot before</li>
</ul>
</li>
</ul>
<!-- -->

<pre><code># rear -v mkbackup
Relax-and-Recover 1.17.2 / Git
Using log file: /var/log/rear/rear-qeos-149.log
mkdir: created directory '/var/lib/rear/output'
Creating disk layout
Excluding component fs:/mnt/rear-trash
Creating root filesystem layout
Copying files and directories
Copying binaries and libraries
Copying kernel modules
Creating initramfs
Making ISO image
Wrote ISO image: /var/lib/rear/output/rear-qeos-149.iso (121M)
WARNING: Not enough disk space available in /boot for GRUB2 rescue image
           Required: 118 MiB / Available: 52 MiB
Copying resulting files to file location
Encrypting disabled
Creating tar archive '/mnt/rear-trash/heyhere/qeos-149/backup.tar.gz'
Archived 814 MiB [avg 3863 KiB/sec]OK
Archived 814 MiB in 217 seconds [avg 3845 KiB/sec]
</code></pre>
<h4 id="jsmeix_commented_at_2016-07-14_1220"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/913#issuecomment-232649885">2016-07-14 12:20</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-14_1220" title="Permanent link">&para;</a></h4>
<p>@schlomo<br />
this "WARNING:" is probably something for you to comment<br />
( because I know what you think about warning messages ;-)</p>
<p>I am not al all an expert in this area but from my point of view<br />
it seems having "enough disk space available" is a mandatory<br />
condition to proceed.</p>
<p>In general I think rear should error out if mandatory<br />
conditions to propceed are not fulfilled cf.<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a></p>
<p>I will do a pull request...</p>
<h4 id="schlomo_commented_at_2016-07-14_1242"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/913#issuecomment-232654462">2016-07-14 12:42</a>:<a class="headerlink" href="#schlomo_commented_at_2016-07-14_1242" title="Permanent link">&para;</a></h4>
<p>I would like to clarify what is happening here:</p>
<ul>
<li>You are talking about adding the kernel and initrd to the GRUB(2)
    boot menu, not the ISO image.</li>
<li>This is an add-on feature which is enabled by <code>GRUB_RESCUE=y</code>. You
    should never rely on this feature for disaster recovery purposes.
    The main reason for this is to be quickly able to recover a server
    from soft errors like deleting all of <code>/lib</code> without digging out the
    rescue boot media.</li>
<li>ATM the code checks for sufficient free disk space before copying
    files.</li>
<li>If there is not enough space then we print this WARNING and
    continue. The reason is that the actual rescue media can still be
    successfully written later on. This means that the main objective of
    ReaR (create bootable rescue media off-server) was not compromised.
    This main objective was not compromised by the failure to add ReaR
    to the local boot configuration. Therefore this should be a WARNING
    and not an ERROR, IMHO</li>
</ul>
<p>That said, if you want please submit a pull request that adds a new
boolean variable <code>GRUB_RESCUE_REQUIRED</code> which will, when enabled, change
the WARNING into an ERROR. For example, you could replace the <code>return</code>
statement after the WARNING with a check for this variable and have it
die there with a message like "GRUB_RESCUE is required but could not
add ReaR". It would be also nice to have the same WARNING/ERROR behavior
for other failure cases in this code path.</p>
<p>And please provide code for both GRUB and GRUB2 which are ATM handled in
different files.</p>
<h4 id="jsmeix_commented_at_2016-07-14_1312"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/913#issuecomment-232661112">2016-07-14 13:12</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-14_1312" title="Permanent link">&para;</a></h4>
<p>I disagree.</p>
<p>I think when the user has specified in local.conf</p>
<pre>
GRUB_RESCUE=1
</pre>

<p>then it should mean that rear must do that<br />
without the need for an additional</p>
<pre>
GRUB_RESCUE_REQUIRED
</pre>

<p>confirmation.</p>
<p>I.e. I think that an explicit setting in local.conf<br />
is a mandatory request that rear must do that.</p>
<p>In contrast if the default would be "GRUB_RESCUE=1"<br />
then one could consider that as "do it as far as possible"<br />
depending on how that functionality is described<br />
in usr/share/rear/conf/default.conf</p>
<p>@gdha</p>
<p>What do you think how settings in local.conf<br />
should be meant in general?</p>
<h4 id="jsmeix_commented_at_2016-07-14_1319"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/913#issuecomment-232662751">2016-07-14 13:19</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-14_1319" title="Permanent link">&para;</a></h4>
<p>Perhaps the different points of view are because<br />
in older rear versions the default was</p>
<pre>
GRUB_RESCUE=y
</pre>

<p>but nowadays it is changed to</p>
<pre>
GRUB_RESCUE=n
</pre>

<p>by git commit 7e098795<br />
but git log only tells about that commit:</p>
<pre>
    * default.conf: GRUB_RESCUE=n instead of y before (to save space under /boot)
</pre>

<p>but no GitHub issue number.</p>
<h4 id="jsmeix_commented_at_2016-07-14_1329"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/913#issuecomment-232665274">2016-07-14 13:29</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-14_1329" title="Permanent link">&para;</a></h4>
<p>The initial commit where GRUB_RESCUE was added<br />
was 5b02e4ff5d49aab9d2af8417fc1a6559b9d23dd7<br />
but again no GitHub issue or other further information...</p>
<h4 id="jsmeix_commented_at_2016-08-17_1018"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/913#issuecomment-240371854">2016-08-17 10:18</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-17_1018" title="Permanent link">&para;</a></h4>
<p>The whole GRUB_RESCUE functionality is meanwhile<br />
overhauled and documented in default.conf<br />
via several pull requests (see above).<br />
In particular the initial issue here was fixed<br />
via
<a href="https://github.com/rear/rear/pull/917">https://github.com/rear/rear/pull/917</a></p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2023 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-07-14.913.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
