<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1724 Issue closed: On PPC64 manual IP config fails with "SIOCSIFFLAGS: Invalid argument" - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1724 Issue closed: On PPC64 manual IP config fails with \"SIOCSIFFLAGS: Invalid argument\"";
        var mkdocs_page_input_path = "issues/2018-02-06.1724.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1724 Issue closed: On PPC64 manual IP config fails with "SIOCSIFFLAGS: Invalid argument"</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1724_issue_closed_on_ppc64_manual_ip_config_fails_with_siocsifflags_invalid_argument"><a href="https://github.com/rear/rear/issues/1724">#1724 Issue</a> <code>closed</code>: On PPC64 manual IP config fails with "SIOCSIFFLAGS: Invalid argument"<a class="headerlink" href="#1724_issue_closed_on_ppc64_manual_ip_config_fails_with_siocsifflags_invalid_argument" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code>,
<code>special hardware or VM</code></p>
<h4 id="schubiduuu_opened_issue_at_2018-02-06_0904"><img src="https://avatars.githubusercontent.com/u/26376668?v=4" width="50"><a href="https://github.com/schubiduuu">schubiduuu</a> opened issue at <a href="https://github.com/rear/rear/issues/1724">2018-02-06 09:04</a>:<a class="headerlink" href="#schubiduuu_opened_issue_at_2018-02-06_0904" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>rear version (/usr/sbin/rear -V):
    rear-2.3-49.git.0.4e40a7b.unknown.changed</li>
<li>OS version (cat /etc/rear/os.conf or lsb_release -a):</li>
</ul>
<pre>
SB Version:    core-2.0-noarch:core-3.2-noarch:core-4.0-noarch:core-2.0-ppc64:core-3.2-ppc64:core-4.0-ppc64:desktop-4.0-noarch:desktop-4.0-ppc32:desktop-4.0-ppc64:graphics-2.0-noarch:graphics-2.0-ppc32:graphics-2.0-ppc64:graphics-3.2-noarch:graphics-3.2-ppc32:graphics-3.2-ppc64:graphics-4.0-noarch:graphics-4.0-ppc32:graphics-4.0-ppc64
Distributor ID: SUSE LINUX
Description:    SUSE Linux Enterprise Server 11 (ppc64)
Release:        11
Codename:       n/a
</pre>

<ul>
<li>rear configuration files (cat /etc/rear/site.conf or cat
    /etc/rear/local.conf):</li>
</ul>
<pre>
AUTOEXCLUDE_MULTIPATH=n
BOOT_OVER_SAN=y

REAR_INITRD_COMPRESSION="lzma"
OUTPUT=ISO
BACKUP=TSM
OUTPUT_URL=file:///iso/

COPY_AS_IS=( "${COPY_AS_IS[@]}" /etc/sysconfig/network/config /etc/sysconfig/network/scripts/functions )
MODULES=( 'all_modules' )
FIRMWARE_FILES=( 'yes' )
MODULES_LOAD=( scsi_mod scsi_tgt scsi_transport_srp ibmvscsic dm_mod dm_snapshot scsi_dh scsi_dh_alua scsi_dh_emc scsi_dh_rdac scsi_dh_hp_sw dm_multipath dm_round_robin dm_queue_length dm_least_pending dm_service_time crc_t10dif sd_mod linear dm_log dm_region_hash dm_mirror mbcache jbd ext3 ibmveth nx_crypto sg ipv6_lib ipv6 loop xfs fuse sunrpc nfs_acl auth_rpcgss lockd fscache nfs joydev cdrom ide_cd_mod sr_mod st )

EXCLUDE_VG=( vgHANA-data-HC2 vgHANA-data-HC3 vgHANA-log-HC2 vgHANA-log-HC3 vgHANA-shared-HC2 vgHANA-hared-HC3 )
BACKUP_PROG_EXCLUDE=( "${BACKUP_PROG_EXCLUDE[@]}" '/hana/*' )
COPY_AS_IS_TSM=( /etc/adsm/TSM.PWD /opt/tivoli/tsm/client/ba/bin/dsmc /opt/tivoli/tsm/client/ba/bin/inclexcl /opt/tivoli/tsm/client/ba/bin/dsm.sys /opt/tivoli/tsm/client/ba/bin/dsm.opt /opt/tivoli/tsm/client/api/bin64/libgpfs.so /opt/tivoli/tsm/client/api/bin64/libdmapi.so /opt/tivoli/tsm/client/ba/bin/EN_US/dsmclientV3.cat /usr/local/ibm/gsk8* )

</pre>

<ul>
<li>Are you using legacy BIOS or UEFI boot? BIOS</li>
<li>Brief description of the issue:</li>
</ul>
<p>After boot into recovery environment I tried to change the IP address or
change the operational state of eth0 it keeps telling me: SIOCSIFFLAGS:
Invalid argument.</p>
<p>Commands that I used were ifconfig and ip.</p>
<ul>
<li>Work-around, if any: no</li>
</ul>
<h4 id="jsmeix_commented_at_2018-02-06_1257"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-363413974">2018-02-06 12:57</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-02-06_1257" title="Permanent link">&para;</a></h4>
<p>This is a follow-up of another issue starting at<br />
<a href="https://github.com/rear/rear/issues/1701#issuecomment-361954934">https://github.com/rear/rear/issues/1701#issuecomment-361954934</a></p>
<p>I guess (but I am not at all a sufficient networking expert<br />
to make an authoritative decision here) that this issue<br />
depends on "special hardware" - probably not on the ppc64<br />
architecture because @schabrolles tested ReaR a lot<br />
on POWER architecture - but perhaps more likely on special<br />
networking hardware (e.g. special network interface card).</p>
<p>@schabrolles<br />
if time permits, could you have a look here?</p>
<h4 id="jsmeix_commented_at_2018-02-06_1306"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-363416571">2018-02-06 13:06</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-02-06_1306" title="Permanent link">&para;</a></h4>
<p>@schubiduuu<br />
according to your<br />
<a href="https://github.com/rear/rear/issues/1701#issuecomment-363384811">https://github.com/rear/rear/issues/1701#issuecomment-363384811</a><br />
you already use in your etc/rear/local.conf</p>
<pre>
MODULES=( 'all_modules' )
FIRMWARE_FILES=( 'yes' )
REAR_INITRD_COMPRESSION="lzma"
</pre>

<p>but that alone would not make all those kernel modules loaded<br />
in the recovery system that were loaded on your original system, cf.<br />
<a href="https://github.com/rear/rear/issues/1701#issuecomment-362537902">https://github.com/rear/rear/issues/1701#issuecomment-362537902</a></p>
<p>If the issue depends on the kernel driver for your network interface
card<br />
and/or on other kernel modules related to networking, you may also try<br />
if it helps to get all modules that were loaded on your original
system<br />
also loaded in the recovery system via</p>
<pre>
MODULES_LOAD=( first_module second_module ... )
</pre>

<p>where you could generate the list of needed modules in the right
ordering<br />
on the original system e.g. by a command like</p>
<pre>
cat /proc/modules | cut -d ' ' -f 1 | tac
</pre>

<p>under the assumption that /proc/modules lists last loaded modules
topmost.</p>
<h4 id="schubiduuu_commented_at_2018-02-06_1348"><img src="https://avatars.githubusercontent.com/u/26376668?v=4" width="50"><a href="https://github.com/schubiduuu">schubiduuu</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-363427024">2018-02-06 13:48</a>:<a class="headerlink" href="#schubiduuu_commented_at_2018-02-06_1348" title="Permanent link">&para;</a></h4>
<p>I included every module listed in the output of "cat /proc/modules | cut
-d ' ' -f 1 | tac".</p>
<p>The issue still persists. The strange thing about this issue is that we
were able to use REAR with SLES11 and the same HW in the past. We didn't
change anything regarding devices, drivers, OS etc.</p>
<p>Local.conf of the initial post is updated to the current one.</p>
<h4 id="jsmeix_commented_at_2018-02-06_1453"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-363446158">2018-02-06 14:53</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-02-06_1453" title="Permanent link">&para;</a></h4>
<p>@schubiduuu<br />
if you were able to use an older version of ReaR<br />
with SLES11 and the same HW in the past<br />
it would be of interest which older version had worked for you<br />
(ideally up to which ReaR version it had worked for you).</p>
<p>The major rewite of 310_network_devices.sh<br />
is only available in the current ReaR GitHub master code since<br />
<a href="https://github.com/rear/rear/commit/02937854b6ea2060a978d69355581ba93adb9e7e">https://github.com/rear/rear/commit/02937854b6ea2060a978d69355581ba93adb9e7e</a></p>
<p>The last released ReaR version 2.3 still has the<br />
"traditional" 310_network_devices.sh (plus separated 360_teaming.sh).</p>
<p>@schubiduuu<br />
could you verify if it works again when you downgrade your<br />
current ReaR GitHub master code to the released ReaR version 2.3.</p>
<p>To download RPM packages of ReaR version 2.3 see<br />
<a href="http://relax-and-recover.org/download/">http://relax-and-recover.org/download/</a></p>
<p>Hmmm...<br />
by the way I noticed that for SLE11 it is not built for POWER
architecture<br />
only for openSUSE_Factory_PowerPC it gets built for ppc64 and
ppc64le<br />
so that RPM packages of ReaR version 2.3 for POWER architecture<br />
are currently only available at<br />
<a href="http://download.opensuse.org/repositories/Archiving:/Backup:/Rear/openSUSE_Factory_PowerPC/">http://download.opensuse.org/repositories/Archiving:/Backup:/Rear/openSUSE_Factory_PowerPC/</a><br />
but it should not matter for which SUSE product you use ReaR<br />
because ReaR is always the same bash scripts.</p>
<p>To downgrade a "git clone" of a ReaR GitHub master code<br />
to a particular git commit, for example to the git commit<br />
that matches theReaR version 2.3 release you can do the following:</p>
<p>Basically "git clone" it into a separated directory and then<br />
find and checkout the desired git commit and finally<br />
configure and run ReaR from within that directory like:</p>
<pre>
# git clone https://github.com/rear/rear.git

# mv rear rear.github.master

# cd rear.github.master

# git log | grep -B5 'ReaR 2.3 release'

commit 37bfa9c8591a69c83ea48bae73b6b0286ac36e8c
Author: Gratien D'haese <gratien.dhaese@gmail.com>
Date:   Wed Dec 20 16:22:57 2017 +0100

    ReaR 2.3 release

# git reset --hard 37bfa9c8591a69c83ea48bae73b6b0286ac36e8c
HEAD is now at 37bfa9c8 ReaR 2.3 release

# vi etc/rear/local.conf

# usr/sbin/rear -D mkbackup
</pre>

<p>Note the relative paths "etc/rear/" and "usr/sbin/".</p>
<p>To run <code>git</code> on SLE11 you need the RPM package "git-core" for ppc64 on
SLE11.<br />
Currently I don't know wherefrom you could download it if you do not yet
have it.</p>
<h4 id="schubiduuu_commented_at_2018-02-06_1521"><img src="https://avatars.githubusercontent.com/u/26376668?v=4" width="50"><a href="https://github.com/schubiduuu">schubiduuu</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-363455045">2018-02-06 15:21</a>:<a class="headerlink" href="#schubiduuu_commented_at_2018-02-06_1521" title="Permanent link">&para;</a></h4>
<p>The file "310_network_devices.sh" was modified to incoporate the
latest changes #1701 .<br />
The version which worked for a while is:
rear-2.2-106.git.0.39e3103.unknown.changed.<br />
We had to test newer REAR version due to some issues we encountered
during some tests in the past.</p>
<p>I don't use the version for SLES11 on x86 but the
openSUSE_Factory_PowerPC version.</p>
<h4 id="jsmeix_commented_at_2018-02-07_1309"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-363763896">2018-02-07 13:09</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-02-07_1309" title="Permanent link">&para;</a></h4>
<p>@schubiduuu<br />
I have no good news because I cannot reproduce<br />
any such issue on my SLES11 SP4 x86_64 system<br />
with current ReaR GitHub master code.</p>
<p>On my SLES11 SP4 x86_64 system everything "just works" for me<br />
for DHCP and<br />
for static IP address setup (same as the one of the original system)
and<br />
for manual network interface setup via</p>
<pre>
NETWORKING_PREPARATION_COMMANDS=( 'ip link set dev eth0 up' 'ip addr add 10.160.4.255/16 dev eth0' 'return' )
</pre>

<p>and for manual network interface setup via recovery system kernel
command line parameters</p>
<pre>
ip=10.160.4.255 nm=255.255.0.0 gw=10.160.255.245 netdev=eth0
</pre>

<p>I found some minor issues related to manual network interface setup<br />
so that I did
<a href="https://github.com/rear/rear/pull/1725">https://github.com/rear/rear/pull/1725</a><br />
but nothing really serious - even without that changes I always got a<br />
usable network interface eth0 so that both remote access via SSH<br />
and "rear recover" worked well for me.</p>
<p>I use this local.conf:</p>
<pre>
OUTPUT=ISO
BACKUP=NETFS
BACKUP_OPTIONS="nfsvers=3,nolock"
BACKUP_URL=nfs://10.160.4.244/nfs
SSH_ROOT_PASSWORD="rear"
USE_STATIC_NETWORKING="yes"
NETWORKING_PREPARATION_COMMANDS=( 'ip link set dev eth0 up' 'ip addr add 10.160.4.255/16 dev eth0' 'return' )
FIRMWARE_FILES=( 'no' )
MODULES=( 'loaded_modules' )
</pre>

<h4 id="jsmeix_commented_at_2018-02-07_1314"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-363765057">2018-02-07 13:14</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-02-07_1314" title="Permanent link">&para;</a></h4>
<p>@schubiduuu<br />
does this issue and
<a href="https://github.com/rear/rear/issues/1701">https://github.com/rear/rear/issues/1701</a><br />
appear only on one single system or do they appear on several systems?</p>
<p>In case of the latter do they appear only on same kind of hardware<br />
(e.g. only with one particular kind of network interface card)<br />
or do the issues appear on various different ppc64 systems?</p>
<h4 id="schubiduuu_commented_at_2018-02-07_1332"><img src="https://avatars.githubusercontent.com/u/26376668?v=4" width="50"><a href="https://github.com/schubiduuu">schubiduuu</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-363769484">2018-02-07 13:32</a>:<a class="headerlink" href="#schubiduuu_commented_at_2018-02-07_1332" title="Permanent link">&para;</a></h4>
<p>This issue appears on every SLES11 system (ppc) we have.</p>
<h4 id="jsmeix_commented_at_2018-02-07_1341"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-363771976">2018-02-07 13:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-02-07_1341" title="Permanent link">&para;</a></h4>
<p>Is "every SLES11 system (ppc)" same kind of hardware<br />
(in particular do all have same networking hardware)<br />
or do you have various different ppc64 systems?</p>
<p>I assume it only happens for SLES11 ppc64 systems<br />
but with SLES12 ppc64 systems it works<br />
or do you not have SLES12 ppc64 systems?</p>
<h4 id="schubiduuu_commented_at_2018-02-07_1348"><img src="https://avatars.githubusercontent.com/u/26376668?v=4" width="50"><a href="https://github.com/schubiduuu">schubiduuu</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-363773954">2018-02-07 13:48</a>:<a class="headerlink" href="#schubiduuu_commented_at_2018-02-07_1348" title="Permanent link">&para;</a></h4>
<p>Yes we are speaking about the same hardware as each system is virtual
running on the same host.<br />
We have issues for SLES11 ppc64 but not for SLES12.</p>
<h4 id="jsmeix_commented_at_2018-02-07_1356"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-363776045">2018-02-07 13:56</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-02-07_1356" title="Permanent link">&para;</a></h4>
<p>@schabrolles<br />
I dare to assign this issue to you - even if you may not have time right
now.</p>
<p>I will still have a look but as non-POWER user I can neither really
help<br />
with POWER architecture (PPC64) specific issues nor can I do<br />
a meaningful analysis what the root cause could be.</p>
<h4 id="schabrolles_commented_at_2018-02-08_0826"><img src="https://avatars.githubusercontent.com/u/19491077?u=0021b16ab426902cbe676f6831f41607bbe4d441&v=4" width="50"><a href="https://github.com/schabrolles">schabrolles</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-364037166">2018-02-08 08:26</a>:<a class="headerlink" href="#schabrolles_commented_at_2018-02-08_0826" title="Permanent link">&para;</a></h4>
<p>@schubiduuu I'm gonna try to replicate it on my power in my lab .... I
did not remember having already face this issue.</p>
<h4 id="schabrolles_commented_at_2018-02-08_0837"><img src="https://avatars.githubusercontent.com/u/19491077?u=0021b16ab426902cbe676f6831f41607bbe4d441&v=4" width="50"><a href="https://github.com/schabrolles">schabrolles</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-364039667">2018-02-08 08:37</a>:<a class="headerlink" href="#schabrolles_commented_at_2018-02-08_0837" title="Permanent link">&para;</a></h4>
<p>@schubiduuu, I got one idea,</p>
<p>I think your issue could be related to a TOO BIG initrd<br />
This is mostly due to the size of TSM client included into the rescue
image.</p>
<p>Try the following to reduce the amount of data to copy into the rescue
image:</p>
<pre><code>COPY_AS_IS_TSM=( /etc/adsm/TSM.PWD /opt/tivoli/tsm/client/ba/bin/dsmc /opt/tivoli/tsm/client/ba/bin/tsmbench_inclexcl /opt/tivoli/tsm/client/ba/bin/dsm.sys /opt/tivoli/tsm/client/ba/bin/dsm.opt /opt/tivoli/tsm/client/api/bin64/libgpfs.so /opt/tivoli/tsm/client/api/bin64/libdmapi.so /opt/tivoli/tsm/client/ba/bin/EN_US/dsmclientV3.cat /usr/local/ibm/gsk8* )
</code></pre>
<p>replace <code>/opt/tivoli/tsm/client/ba/bin/tsmbench_inclexcl</code> with your TSM
include/exclude file if you have one.</p>
<ul>
<li>You normally don't need to copy the firmware files or all modules
    (try by removing those lines in your local.conf)</li>
</ul>
<h4 id="jsmeix_commented_at_2018-02-08_0955"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-364060003">2018-02-08 09:55</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-02-08_0955" title="Permanent link">&para;</a></h4>
<p>@schabrolles<br />
many thanks for having a look!</p>
<p>FYI<br />
why @schubiduuu has currently all kernel modules<br />
and firmware in his recovery system, see<br />
<a href="https://github.com/rear/rear/issues/1701">https://github.com/rear/rear/issues/1701</a><br />
in particular starting at<br />
<a href="https://github.com/rear/rear/issues/1701#issuecomment-361954934">https://github.com/rear/rear/issues/1701#issuecomment-361954934</a><br />
and the subsequent comments, in particular<br />
<a href="https://github.com/rear/rear/issues/1701#issuecomment-363364586">https://github.com/rear/rear/issues/1701#issuecomment-363364586</a></p>
<p>I did some googling for "SIOCSIFFLAGS: Invalid argument"<br />
and got the impression that this error message is usually related<br />
to low-level issues like unsupported networking hardware,<br />
misbehaving networking hardware kernel driver,<br />
no MAC address (or a MAC address 00:00:00:00:00:00),<br />
and things like that.</p>
<p>From that I assumed that needed kernel modules or even firmware<br />
might be missing in the recovery system.<br />
Therefore I suggested to try things like MODULES=( 'all_modules' )<br />
FIRMWARE_FILES=( 'yes' ) and MODULES_LOAD=( ...), cf.<br />
<a href="https://github.com/rear/rear/issues/1724#issuecomment-363416571">https://github.com/rear/rear/issues/1724#issuecomment-363416571</a></p>
<h4 id="schabrolles_commented_at_2018-02-08_1033"><img src="https://avatars.githubusercontent.com/u/19491077?u=0021b16ab426902cbe676f6831f41607bbe4d441&v=4" width="50"><a href="https://github.com/schabrolles">schabrolles</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-364070280">2018-02-08 10:33</a>:<a class="headerlink" href="#schabrolles_commented_at_2018-02-08_1033" title="Permanent link">&para;</a></h4>
<p>@jsmeix,</p>
<p>I remember I had an issue with SLES11 and too BIG initrd (with TSM).<br />
The symptoms were: rescue image can boot (even with too BIG initrd) but
I got network ERRORS and FiberChannel failures.</p>
<p>I got a Power LPAR with SLES11 and just tested it with current master
branch. it always boot without having to specify :<br />
MODULES=( 'all_modules' )<br />
FIRMWARE_FILES=( 'yes' )<br />
=&gt; I recommend to not use them, because I want to have the smallest
initrd as possible.</p>
<p>A good think would be to have the latest kernel updated for SLES11 SP4.
(<a href="https://www.suse.com/support/update/announcement/2017/suse-su-20173265-1/">https://www.suse.com/support/update/announcement/2017/suse-su-20173265-1/</a>)</p>
<pre><code> powerpc/prom: Increase minimum RMA size to 512MB (bsc#984530,
bsc#1052370).
</code></pre>
<h4 id="jsmeix_commented_at_2018-02-08_1057"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-364076807">2018-02-08 10:57</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-02-08_1057" title="Permanent link">&para;</a></h4>
<p>@schabrolles<br />
in general it would be good when during "rear mkrescue" it could
autodetect<br />
as many issues as possible that would later lead to failures during
"rear recover"<br />
cf.
<a href="https://github.com/rear/rear/issues/1718#issuecomment-361871332">https://github.com/rear/rear/issues/1718#issuecomment-361871332</a></p>
<p>Do you think it is possible to autodetect during "rear mkrescue"<br />
that the ReaR initrd is too big and error out in this case?</p>
<h4 id="schubiduuu_commented_at_2018-02-08_1313"><img src="https://avatars.githubusercontent.com/u/26376668?v=4" width="50"><a href="https://github.com/schubiduuu">schubiduuu</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-364107520">2018-02-08 13:13</a>:<a class="headerlink" href="#schubiduuu_commented_at_2018-02-08_1313" title="Permanent link">&para;</a></h4>
<p>@schabrolles We followed you advice to include less files to reduce the
size of the recovery boot media and voilà we are able to use the network
interfaces and we are currently running a restore. Thanks so far for
this incredible helpful advice. 👍</p>
<h4 id="jsmeix_commented_at_2018-02-08_1328"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-364111006">2018-02-08 13:28</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-02-08_1328" title="Permanent link">&para;</a></h4>
<p>@schabrolles<br />
many thanks for your help here!<br />
Without you as POWER magician we (i.e. the other ReaR guys)<br />
would probably never had been able to see the root cause.</p>
<h4 id="jsmeix_commented_at_2018-02-08_1335"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-364112781">2018-02-08 13:35</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-02-08_1335" title="Permanent link">&para;</a></h4>
<p>@schubiduuu<br />
also many thanks to you because we (i.e. the ReaR developers)<br />
need venturous users like you who try out our "latest greatest"<br />
ReaR GitHub master code, report issues, and even stay patient<br />
when things do no longer "just work".</p>
<h4 id="jsmeix_commented_at_2018-02-08_1338"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-364113716">2018-02-08 13:38</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-02-08_1338" title="Permanent link">&para;</a></h4>
<p>@schabrolles<br />
I set this "support question" issue to "fixed/solved/done"<br />
but I think it revealed a needed enhancement in ReaR<br />
to avoid a too big initrd in certain POWER environments, cf.<br />
<a href="https://github.com/rear/rear/issues/1724#issuecomment-364076807">https://github.com/rear/rear/issues/1724#issuecomment-364076807</a></p>
<h4 id="jsmeix_commented_at_2018-07-12_1426"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-404531012">2018-07-12 14:26</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-07-12_1426" title="Permanent link">&para;</a></h4>
<p>@schabrolles<br />
regarding my above<br />
<a href="https://github.com/rear/rear/issues/1724#issuecomment-364113716">https://github.com/rear/rear/issues/1724#issuecomment-364113716</a><br />
see my
<a href="https://github.com/rear/rear/issues/1859">https://github.com/rear/rear/issues/1859</a><br />
which intends to make such issues more obvious to the user<br />
provided corrupted or missing files in the recovery system<br />
are the root cause of this issue here.</p>
<h4 id="schabrolles_commented_at_2018-07-16_0722"><img src="https://avatars.githubusercontent.com/u/19491077?u=0021b16ab426902cbe676f6831f41607bbe4d441&v=4" width="50"><a href="https://github.com/schabrolles">schabrolles</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-405166295">2018-07-16 07:22</a>:<a class="headerlink" href="#schabrolles_commented_at_2018-07-16_0722" title="Permanent link">&para;</a></h4>
<p>@jsmeix, You're right, I think #1859 could really help here. If initrd
cannot be uncompressed totally due to lack of space, we should detect it
with md5sums (file missing or with different size).</p>
<h4 id="jsmeix_commented_at_2018-07-16_0929"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-405192925">2018-07-16 09:29</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-07-16_0929" title="Permanent link">&para;</a></h4>
<p>@schabrolles<br />
could you explain the reason behind why in particular on POWER
architecture<br />
it might happen that the "initrd cannot be uncompressed totally due to
lack of space"<br />
because I would think in particular on POWER systems there is plenty of
"space"<br />
(I assume that "space" is main memory).</p>
<h4 id="schabrolles_commented_at_2018-07-16_1003"><img src="https://avatars.githubusercontent.com/u/19491077?u=0021b16ab426902cbe676f6831f41607bbe4d441&v=4" width="50"><a href="https://github.com/schabrolles">schabrolles</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-405200794">2018-07-16 10:03</a>:<a class="headerlink" href="#schabrolles_commented_at_2018-07-16_1003" title="Permanent link">&para;</a></h4>
<p>@jsmeix, It is specific to the PowerVM (Firmware based
virtualization).<br />
During LPAR (aka Logical Partition which could be seen as a VM) boot,
the Power Hardware hypervisor allocates private space for the bootstrap
(256MB). I don't have all the detail (and knowledge) about this very
specific phase (virtual firmware of the LPAR before LPAR kernel
bootstrap), but this 256MB should store some Firmware information,
kernel and initrd (compressed). It seems that the 256MB is hardcoded in
Linux kernel for Power ( variable ppc64_rma_size ). Recent Redhat
(since rhel7.4) and Suse (since sles12sp2) should have 512MB RMA size.</p>
<p>Finding a rule to know what is the maximum size allowed is a bit
difficult as it depends on:</p>
<ul>
<li>Power FW version</li>
<li>Kernel version (256MB or 512MB)</li>
<li>number of real and virtual adapters (will increase space needed by
    the FW part)</li>
</ul>
<p>So, having something that tell us that something is wrong about initrd
data in the recovery system is a good start even if it would be better
to have it during backup or rear-initrd creation (rear mkrescue).</p>
<h4 id="jsmeix_commented_at_2018-07-16_1053"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-405211231">2018-07-16 10:53</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-07-16_1053" title="Permanent link">&para;</a></h4>
<p>@schabrolles<br />
many thanks for your explanation.<br />
Now I understand the reason behind.</p>
<h4 id="jsmeix_commented_at_2018-07-17_1157"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-405556504">2018-07-17 11:57</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-07-17_1157" title="Permanent link">&para;</a></h4>
<p>With
<a href="https://github.com/rear/rear/pull/1864">https://github.com/rear/rear/pull/1864</a>
merged<br />
corrupt files in the recovery system should be detected<br />
and reported in an obvious way.</p>
<h4 id="jsmeix_commented_at_2018-07-18_1011"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1724#issuecomment-405881690">2018-07-18 10:11</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-07-18_1011" title="Permanent link">&para;</a></h4>
<p>I assume this isssue is meanwhile sufficiently answered<br />
and handled so that I can close it hereby.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2018-02-06.1724.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
