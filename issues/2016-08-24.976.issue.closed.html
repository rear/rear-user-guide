<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#976 Issue closed: Recover not working when rpm2cpio was used to unpack - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#976 Issue closed: Recover not working when rpm2cpio was used to unpack";
        var mkdocs_page_input_path = "issues/2016-08-24.976.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#976 Issue closed: Recover not working when rpm2cpio was used to unpack</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="976_issue_closed_recover_not_working_when_rpm2cpio_was_used_to_unpack"><a href="https://github.com/rear/rear/issues/976">#976 Issue</a> <code>closed</code>: Recover not working when rpm2cpio was used to unpack<a class="headerlink" href="#976_issue_closed_recover_not_working_when_rpm2cpio_was_used_to_unpack" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>not ReaR / invalid</code></p>
<h4 id="ziazis_opened_issue_at_2016-08-24_0930"><img src="https://avatars.githubusercontent.com/u/21216756?v=4" width="50"><a href="https://github.com/Ziazis">Ziazis</a> opened issue at <a href="https://github.com/rear/rear/issues/976">2016-08-24 09:30</a>:<a class="headerlink" href="#ziazis_opened_issue_at_2016-08-24_0930" title="Permanent link">&para;</a></h4>
<h1 id="cant_recover_when_using_rpm2cpio_to_extract_files_to_the_right_position">Can't recover when using rpm2cpio to extract files to the right position<a class="headerlink" href="#cant_recover_when_using_rpm2cpio_to_extract_files_to_the_right_position" title="Permanent link">&para;</a></h1>
<p>Please fill in the following items before submitting a new issue:</p>
<ul>
<li>
<p>rear version (/usr/sbin/rear -V): 1.18 / Git</p>
</li>
<li>
<p>OS version (cat /etc/rear/os.conf or lsb_release -a): SUSE_LINUX
    13.2</p>
</li>
<li>
<p>rear configuration files (cat /etc/rear/site.conf or cat
    /etc/rear/local.conf):<br />
    OUTPUT=PXE<br />
    OUTPUT_URL=nfs://server/path/BACKUP<br />
    BACKUP=NETFS<br />
    BACKUP_URL=nfs://server/path/BACKUP</p>
<h1 id="findmnt_-l_-t_btrfs_cut_-d_-f_1_egrep_-v_snapshotscrashsrv_sed_-e_s_-e_s_tr_n">findmnt -l -t btrfs | cut -d ' ' -f 1 | egrep -v 'snapshots|crash|srv' | sed -e "s/$//*'/" -e "s/^/'/" | tr '\n' ' '<a class="headerlink" href="#findmnt_-l_-t_btrfs_cut_-d_-f_1_egrep_-v_snapshotscrashsrv_sed_-e_s_-e_s_tr_n" title="Permanent link">&para;</a></h1>
<p>BACKUP_PROG_INCLUDE=( '/boot/grub2/x86_64-efi/<em>' '/var/tmp/</em>'
'/var/log/<em>' '/var/spool/</em>' '/var/lib/pgsql/<em>' '/var/opt/</em>'
'/var/lib/named/<em>' '/usr/local/</em>' '/var/lib/mailman/<em>' '/tmp/</em>'
'/opt/<em>' '/home/</em>' '/boot/grub2/i386-pc/*' )<br />
OUTPUT_PREFIX_PXE="BACKUP/$HOSTNAME"<br />
AUTOEXCLUDE_PATH=( /media /srv )<br />
AUTOEXCLUDE_MULTIPATH=n</p>
</li>
<li>
<p>Brief description of the issue<br />
    While using rear, when installed via rpm everything works fine.
    mkbackup, recover everything is fine.<br />
    But while trying to just unpack the files to be able to distribute
    them to other machines I kinda stumbled across the issue that my
    rear recover of those machines is not working. Unfortunatly the only
    issue I found is that I get the same error message as #870 with the
    rpc.statd can't start.</p>
</li>
</ul>
<p>I just can't find the reason why it happens though. Is there something
rpm is doing differently then just unpacking the script/config files to
the right positions?</p>
<p>I have used ' rpm2cpio rear-1.18-3.x86_64.rpm | cpio -idmv' to unpack
the files and then sync them to the other machines. Backuping works fine
without issues, so does the PXEboot but when starting the recover I get
the rpc.statd error. Seems to me that something is not being copied into
the live image, but what could be the reason to it?</p>
<p>Well my work around would be that I install the rpm on every machine and
copy the configurations after that - but I would still like to know how
rpm2cpio differs in that small regard to rpm -i</p>
<h4 id="jsmeix_commented_at_2016-08-24_0954"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/976#issuecomment-242013070">2016-08-24 09:54</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-24_0954" title="Permanent link">&para;</a></h4>
<p>This is no issue in rear.</p>
<p>I cannot really help here but I guess that the rpc.statd issue<br />
is not caused by how you put all the rear files on the<br />
other machine - you did put all the rear files on the other<br />
machine not only the *.sh scripts didn't you?</p>
<p>I guess the rpc.statd issue on the other machine is caused<br />
by whatever reason that is specific for the other machine<br />
or its networking environment.</p>
<h4 id="ziazis_commented_at_2016-08-24_1006"><img src="https://avatars.githubusercontent.com/u/21216756?v=4" width="50"><a href="https://github.com/Ziazis">Ziazis</a> commented at <a href="https://github.com/rear/rear/issues/976#issuecomment-242015661">2016-08-24 10:06</a>:<a class="headerlink" href="#ziazis_commented_at_2016-08-24_1006" title="Permanent link">&para;</a></h4>
<p>Yes, I did unpack all files that you get from rpm2cpio - even the empty
directory paths into the other machines - just hoped maybe you guys know
some more since you build the rpms. Guess I would need to look into rpm
itself and what exactly it is doing differently.</p>
<p>Like I said - it's partly even working. I can use manuels for rear, can
use mkbackup. The only issue occurs when booting up the PXE rescue image
and trying to recover from there.</p>
<p>Funny enough - when the rpm was not installed via the rpm command but
only copied, you can still install it and call 'rear mkrescue' and the
backup will work. It's probably some internal rpm2cpio difference to rpm
-i. Well I'll see if I can find some more information on that regard.</p>
<p>Thank you for your reply.</p>
<h4 id="jsmeix_commented_at_2016-08-24_1041"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/976#issuecomment-242023217">2016-08-24 10:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-24_1041" title="Permanent link">&para;</a></h4>
<p>You mean when you installed the plain files via cpio<br />
there is the rpc.statd issue but when you then install<br />
the rear RPM package with 'rpm' on the same machine,<br />
then there is no longer the rpc.statd issue?</p>
<p>First idea what is different are the RPM scriptlets<br />
but in my rear RPM package I don't see a scriptlet<br />
that could make a real difference</p>
<pre>
# rpm -q --scripts rear       
preinstall scriptlet (using /bin/sh):
if [ $1 -gt 1 ] ; then
# during upgrade remove obsolete directories
/usr/bin/rm -rf /usr/share/rear/output/NETFS
fi
</pre>

<p>because when you do not yet have rear files on a machine<br />
theer would be no obsolete /usr/share/rear/output/NETFS<br />
directory so that the preinstall scriptlet does nothing.</p>
<h4 id="ziazis_commented_at_2016-08-24_1100"><img src="https://avatars.githubusercontent.com/u/21216756?v=4" width="50"><a href="https://github.com/Ziazis">Ziazis</a> commented at <a href="https://github.com/rear/rear/issues/976#issuecomment-242026873">2016-08-24 11:00</a>:<a class="headerlink" href="#ziazis_commented_at_2016-08-24_1100" title="Permanent link">&para;</a></h4>
<p>Yes exactly this! That's why I'm so confused myself. I've looked at the
preinstall scriplets already and that's why I was asking here since I
couldn't find anything that was being done pre or past installation that
would make a difference in plain files over installing the rpm
package.<br />
But it obviously does something different since with the installed rpm
it's working and the plain files the recover failes with the rpc.statd
error.</p>
<p>Like I said it's the same issue #870 had. The sm-notify is not in the
liveimage. I tried specifying all progs required, but I probably miss
some since when I specify them in the local.conf it ONLY installs those
specified and not those specified + the defaults needed.</p>
<p>Edit: Maybe there are some variables that get set when you install it
via rpm? I don't know how the package itself is configured so that makes
it hard to reconstruct what is actually going wrong with the plain files
vs 'rpm -i' method.</p>
<p>Logfile extract of cpio:<br />
<a href="http://pastebin.com/UyrzBAFE">http://pastebin.com/UyrzBAFE</a></p>
<p>Logfile for rpm install:<br />
<a href="http://pastebin.com/c4MzDTVi">http://pastebin.com/c4MzDTVi</a></p>
<p>1135 rows of unpacking folders/files on both. So I should have
everything needed on cpio aswell.<br />
Can't see any specific difference besides the indexing?</p>
<h4 id="jsmeix_commented_at_2016-08-24_1342"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/976#issuecomment-242068002">2016-08-24 13:42</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-24_1342" title="Permanent link">&para;</a></h4>
<p>I have neither an idea what caused a difference<br />
nor do I have an idea what the difference is<br />
but I am curious to learn what it is in the end.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-08-24.976.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
