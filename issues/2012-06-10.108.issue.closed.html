<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#108 Issue closed: Relax-and-Recover asks password when using cifs to a public share - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#108 Issue closed: Relax-and-Recover asks password when using cifs to a public share";
        var mkdocs_page_input_path = "issues/2012-06-10.108.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#108 Issue closed: Relax-and-Recover asks password when using cifs to a public share</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="108_issue_closed_relax-and-recover_asks_password_when_using_cifs_to_a_public_share"><a href="https://github.com/rear/rear/issues/108">#108 Issue</a> <code>closed</code>: Relax-and-Recover asks password when using cifs to a public share<a class="headerlink" href="#108_issue_closed_relax-and-recover_asks_password_when_using_cifs_to_a_public_share" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>bug</code></p>
<h4 id="dagwieers_opened_issue_at_2012-06-10_2134"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> opened issue at <a href="https://github.com/rear/rear/issues/108">2012-06-10 21:34</a>:<a class="headerlink" href="#dagwieers_opened_issue_at_2012-06-10_2134" title="Permanent link">&para;</a></h4>
<p>When using the following configuration:</p>
<pre><code>OUTPUT=ISO
OUTPUT_URL=cifs://nas02/rear/
</code></pre>
<p>Rear asks for a password, while it should not ask for one (or at least
it should try first without).</p>
<h4 id="schlomo_commented_at_2012-06-10_2142"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6232299">2012-06-10 21:42</a>:<a class="headerlink" href="#schlomo_commented_at_2012-06-10_2142" title="Permanent link">&para;</a></h4>
<p>For NETFS_URL we supported additional options and had an example that
would<br />
use credentials=<file> for this purpose... Maybe we should clone this
for<br />
OUTPUT_URL as well?</p>
<h4 id="dagwieers_commented_at_2012-06-10_2146"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6232328">2012-06-10 21:46</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-06-10_2146" title="Permanent link">&para;</a></h4>
<p>Ok, I am confused. I would like to put the ISO image onto a CIFS share.
I assumed the above configuration would in fact do that. However when
looking in <em>output/ISO/Linux-i386/90_transfer_image.sh</em> the statement
<strong># The ISO has already been transferred by NETFS.</strong> assumes that I am
using NETFS (?).</p>
<p>So I wondered, should I have used <strong>OUTPUT=NETFS</strong> instead ? But that
leads to:</p>
<pre><code>[root@moria rear]# rear -v -D mkrescue
Relax and Recover 1.13.0 / $Date$
Using log file: /var/log/rear/rear-moria.log
ERROR: You must specify either BACKUP_URL or BACKUP_MOUNTCMD and BACKUP_UMOUNTCMD !
Aborting due to an error, check /var/log/rear/rear-moria.log for details
Finished in 1 seconds
</code></pre>
<p>Which in itself is very strange too, since I ran <strong>rear mkrescue</strong> so it
shouldn't bother me about any BACKUP configuration. (BACKUP= is in fact
empty)</p>
<p>If I then change it to add <em>unwanted</em> BACKUP variables:</p>
<pre><code>OUTPUT=NETFS
OUTPUT_URL=cifs://nas02/rear/
BACKUP=NETFS
BACKUP_URL=cifs://nas02/rear/
</code></pre>
<p>This happens:</p>
<pre><code>[root@moria rear]# rear -v -D mkrescue
Relax and Recover 1.13.0 / $Date$
Using log file: /var/log/rear/rear-moria.log
Creating disk layout
Creating root FS layout
Copy files and directories
Copy binaries and libraries
Copying kernel modules
Checking udev
Create initramfs
Password: 
Copying resulting files to cifs location
ERROR: Could not copy usage file to cifs location
Aborting due to an error, check /var/log/rear/rear-moria.log for details
Finished in 50 seconds
Terminated
</code></pre>
<p>So it doesn't work as expected, and I don't even know whether I am doing
it correctly either...</p>
<h4 id="schlomo_commented_at_2012-06-10_2151"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6232357">2012-06-10 21:51</a>:<a class="headerlink" href="#schlomo_commented_at_2012-06-10_2151" title="Permanent link">&para;</a></h4>
<p>I think the OUTPUT_URL stuff is not complete and that we need to enable
it<br />
to use more code from NETFS_URL e.g. to support mount options.</p>
<h4 id="dagwieers_commented_at_2012-06-10_2156"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6232394">2012-06-10 21:56</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-06-10_2156" title="Permanent link">&para;</a></h4>
<p>So the following configuration did what I wanted:</p>
<pre><code>OUTPUT=ISO
OUTPUT_URL=cifs://nas02/rear/
BACKUP=NETFS
BACKUP_URL=cifs://nas02/rear/
</code></pre>
<p>Although I was only interested in having the rescue environment on the
CIFS share using <em>rear mkrscue</em>. What is weird is that the BACKUP=NETFS
part seems to have taken care of copying my OUTPUT file to the
OUTPUT_URL ?</p>
<p>So conclusion:</p>
<ul>
<li>Using cifs:// makes Rear ask for a password (even on public shares)</li>
<li>Using cifs:// in OUTPUT_URL requires a BACKUP=NETFS to work !?!</li>
<li>Command <em>rear mkrescue</em> requires a BACKUP_URL (anything really)
    even if an OUTPUT_URL is defined</li>
</ul>
<p>I am convinced now that we need to reassess how this is supposed to
work.</p>
<h4 id="dagwieers_commented_at_2012-06-10_2206"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6232483">2012-06-10 22:06</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-06-10_2206" title="Permanent link">&para;</a></h4>
<p>Another weirdness is that if I do not specify an OUTPUT_URL in the
above example, my rear output on screen says:</p>
<pre><code>Excluding component fs:/var
</code></pre>
<p>I don't seen a connection there...</p>
<h4 id="dagwieers_commented_at_2012-06-10_2234"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6232661">2012-06-10 22:34</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-06-10_2234" title="Permanent link">&para;</a></h4>
<p>@schlomo You are right, the documentation does not mention CIFS or NFS
support for OUTPUT_URL. Although it happens to work if you push the
right knobs...</p>
<h4 id="kpieth_commented_at_2012-06-11_0922"><img src="https://avatars.githubusercontent.com/u/1444692?v=4" width="50"><a href="https://github.com/kpieth">kpieth</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6240185">2012-06-11 09:22</a>:<a class="headerlink" href="#kpieth_commented_at_2012-06-11_0922" title="Permanent link">&para;</a></h4>
<p>What do you think of:<br />
If OUTPUT_URL is set, then
"./output/ISO/Linux-i386/90_transfer_image.sh" should do the work. If
not, then the chosen BACKUP workflow cares about transferring the image.</p>
<h4 id="dagwieers_commented_at_2012-06-11_1528"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6247413">2012-06-11 15:28</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-06-11_1528" title="Permanent link">&para;</a></h4>
<p>I moved the discussion wrt. the current OUTPUT_URL and BACKUP_URL mess
to issue #37. So that this issue only relates to the CIFS password
issue.</p>
<h4 id="gdha_commented_at_2012-06-15_1431"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6357951">2012-06-15 14:31</a>:<a class="headerlink" href="#gdha_commented_at_2012-06-15_1431" title="Permanent link">&para;</a></h4>
<p>When we have defined a <code>BACKUP=NETFS</code> method and we also defined a
<code>BACKUP_URL=cifs://cifs-server-name/share/path</code> then a setting like
<code>BACKUP_OPTIONS="cred=/etc/rear/.cifs"</code> will make sure that no
credential will be asked.</p>
<p>I guess we only need to check the BACKUP_URL and BACKUP_OPTIONS and
making it not dependent of a BACKUP method. This way we can easily use
the same code for the OUTPUT_URL.</p>
<p>The bottom line is I'm in favor of using a credential definition (file).</p>
<h4 id="dagwieers_commented_at_2012-06-15_1842"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6363641">2012-06-15 18:42</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-06-15_1842" title="Permanent link">&para;</a></h4>
<p>I guess the expectation for a <strong>public</strong> share is that you don't need
credentials, and thus not need a credential definition file.</p>
<h4 id="schlomo_commented_at_2012-06-16_2113"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6376501">2012-06-16 21:13</a>:<a class="headerlink" href="#schlomo_commented_at_2012-06-16_2113" title="Permanent link">&para;</a></h4>
<p>Isn't putting your backups on a <em>public</em> share setup for failure? I
actually don't understand what is bad about the credentials file...</p>
<h4 id="dagwieers_commented_at_2012-06-16_2316"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6377329">2012-06-16 23:16</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-06-16_2316" title="Permanent link">&para;</a></h4>
<p>@schlomo That is not the point, this obviously was part of me testing
the CIFS code internally (triggering more than one issue). But it does
make sense to put the recovery images on a "public" share. (Or at least
a share that has certain ACLs set to not require a password)</p>
<p>BTW There is nothing bad about a credentials file per se, except maybe
if you have no need for credentials ? What do you put in the credentials
file for a public share ? Do we leave it empty ? Do we add empty values
? Do we add something that's not used ? It does not seem very obvious
and need to be fixed or documented...</p>
<p>Also, it's not because I open a ticket that it should get the highest
priority or that it requires someone to fix it in their own time. Issues
are listed so someone who does think it is valuable to fix, can look
into it. Or as a reference to others with a similar problem to chime in.
Or so we do not forget about it.</p>
<h4 id="gdha_commented_at_2012-06-25_0929"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6543062">2012-06-25 09:29</a>:<a class="headerlink" href="#gdha_commented_at_2012-06-25_0929" title="Permanent link">&para;</a></h4>
<p>With the default <code>,guest</code> option my <code>cred=</code> option is broken:</p>
<pre><code>2012-06-25 12:17:21 ERROR: Mount command 'mount -v -o cred=/home/gdha/projects/rear/rear-1.13.0/etc/rear/.cifs.phist,guest //hpx189.ncsbe.eu.jnj.com/phist /tmp/rear.d5jqHyre7SMb0CL/outputfs' failed.
</code></pre>
<p>To be honest for security reason I would not add <code>guest</code> option to cifs.
Is it possible to revert this change?</p>
<h4 id="dagwieers_commented_at_2012-06-25_1000"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6543598">2012-06-25 10:00</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-06-25_1000" title="Permanent link">&para;</a></h4>
<p>Sure, please revert.</p>
<h4 id="gdha_commented_at_2012-06-25_1047"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-6544375">2012-06-25 10:47</a>:<a class="headerlink" href="#gdha_commented_at_2012-06-25_1047" title="Permanent link">&para;</a></h4>
<p>it works with guest also. I leave it this way...</p>
<h4 id="pasarn_commented_at_2012-09-07_1005"><img src="https://avatars.githubusercontent.com/u/2298311?v=4" width="50"><a href="https://github.com/pasarn">pasarn</a> commented at <a href="https://github.com/rear/rear/issues/108#issuecomment-8361234">2012-09-07 10:05</a>:<a class="headerlink" href="#pasarn_commented_at_2012-09-07_1005" title="Permanent link">&para;</a></h4>
<p>Hello,</p>
<p>I can not mount the cifs target. The command from gdha:</p>
<blockquote>
<p>With the default ,guest option my cred= option is broken:</p>
<p>2012-06-25 12:17:21 ERROR: Mount command 'mount -v -o
cred=/home/gdha/projects/rear/rear-1.13.0/etc/rear/.cifs.phist,guest
//hpx189.ncsbe.eu.jnj.com/phist /tmp/rear.d5jqHyre7SMb0CL/outputfs'
failed.<br />
To be honest for security reason I would not add guest option to cifs.
Is it possible to revert this change?</p>
</blockquote>
<p>When i remove the guest parameter from global_functions.sh it works.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2023 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2012-06-10.108.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
