<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#3212 PR merged: default.conf example for COPY_AS_IS_EXCLUDE_TSM - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#3212 PR merged: default.conf example for COPY_AS_IS_EXCLUDE_TSM";
        var mkdocs_page_input_path = "issues/2024-04-30.3212.pr.merged.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#3212 PR merged: default.conf example for COPY_AS_IS_EXCLUDE_TSM</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="3212_pr_merged_defaultconf_example_for_copy_as_is_exclude_tsm"><a href="https://github.com/rear/rear/pull/3212">#3212 PR</a> <code>merged</code>: default.conf example for COPY_AS_IS_EXCLUDE_TSM<a class="headerlink" href="#3212_pr_merged_defaultconf_example_for_copy_as_is_exclude_tsm" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>documentation</code>, <code>fixed / solved / done</code></p>
<h4 id="jsmeix_opened_issue_at_2024-04-30_1402"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> opened issue at <a href="https://github.com/rear/rear/pull/3212">2024-04-30 14:02</a>:<a class="headerlink" href="#jsmeix_opened_issue_at_2024-04-30_1402" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>Type: <strong>Documentation</strong></p>
</li>
<li>
<p>Impact: <strong>High</strong><br />
    High impact when needed, cf.<br />
<a href="https://github.com/rear/rear/issues/3189">https://github.com/rear/rear/issues/3189</a><br />
    how long it could take until one finds out<br />
    that booting fails because the initrd is too big.</p>
</li>
<li>
<p>Reference to related issue (URL):<br />
<a href="https://github.com/rear/rear/issues/3189">https://github.com/rear/rear/issues/3189</a><br />
<a href="https://github.com/rear/rear/pull/1566">https://github.com/rear/rear/pull/1566</a></p>
</li>
<li>
<p>How was this pull request tested?<br />
    Only descriptions.<br />
    See also<br />
<a href="https://github.com/rear/rear/issues/3189#issuecomment-2079794186">https://github.com/rear/rear/issues/3189#issuecomment-2079794186</a></p>
</li>
<li>
<p>Description of the changes in this pull request:</p>
</li>
</ul>
<p>In default.conf explain how one could reduce<br />
the size of the ReaR recovery system initrd<br />
in particular on POWER architecture<br />
via COPY_AS_IS_TSM and alternatively<br />
via COPY_AS_IS_EXCLUDE_TSM and additionally<br />
via MODULES=( 'loaded_modules' ),<br />
see
<a href="https://github.com/rear/rear/issues/3189">https://github.com/rear/rear/issues/3189</a></p>
<h4 id="schlomo_commented_at_2024-05-02_1206"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/pull/3212#issuecomment-2090335577">2024-05-02 12:06</a>:<a class="headerlink" href="#schlomo_commented_at_2024-05-02_1206" title="Permanent link">&para;</a></h4>
<p>Thanks for the info about IBM Spectrum Protect, I didn't know that.</p>
<p>If there is a general size limit for the initrd on POWER systems then I
would expect a check for that, aborting if the initrd is too large
(since we know that it won't boot).</p>
<p>We might also add code to automatically enable some space reducing
features, like loading less modules and no extra firmware files.</p>
<p>Finally, if we could update the TSM configuration in ReaR to reflect
modern TSM agents, that would be of course really great. Maybe
@schabrolles can add some knowledge to this?</p>
<p>Otherwise of course the change in comments is fine, although personally
I find it a little bit misplaced under the TSM section. Maybe better add
a file to the <code>docs</code> directory explaining about ReaR on POWER?</p>
<h4 id="jsmeix_commented_at_2024-05-03_0745"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/3212#issuecomment-2092481874">2024-05-03 07:45</a>:<a class="headerlink" href="#jsmeix_commented_at_2024-05-03_0745" title="Permanent link">&para;</a></h4>
<p>I cannot properly implement a check that errors out<br />
because I am not at all a sufficient POWER expert.</p>
<p>There are several different kind of POWER systems<br />
and several different ways how to boot them.<br />
I assume that vague 128 - 4 = 124 MiB limit<br />
does not apply to all POWER boot methods<br />
so we cannot eror out in any case on POWER<br />
when ReaR's initrd is e.g. bigger than 123 MiB.</p>
<p>Regarding why the initrd size limit is vague:<br />
A colleague told me:</p>
<pre><code>The absolute limit you can push (in our case)
is 128 MB = 131072 KB (in binary).
But in fact IBM always adds some prep boot
(service data, their own "magic") data to that block.
And we were able to fill only 123 MB = 125952 KB.
And that is bad from IBM side as they are one
of the developers of the IEC standard
(because of the punch cards), but you will
never find it black on white on their site.
</code></pre>
<p>I.e. it is unknown how big that additional data is<br />
so it is unknown how much less than 128 MiB is left<br />
for the initrd.<br />
Therein note the "in our case":<br />
This means the case where things were tested at SUSE.<br />
By trial and error (via artificially increasing the<br />
initrd) colleagues as SUSE found that 123 MiB limit<br />
on the POWER system where they tested things.<br />
That POWER system reported errors during boot<br />
when the initrd was too big in contrast to<br />
<a href="https://github.com/rear/rear/issues/3189">https://github.com/rear/rear/issues/3189</a><br />
where<br />
<a href="https://github.com/rear/rear/files/14837101/boot.log">https://github.com/rear/rear/files/14837101/boot.log</a><br />
shows nothing - just a kernel panic at the end that<br />
tells noting about its root cause.</p>
<p>What I may implement is a LogPrint() or LogPrintError()<br />
user information when the inird is bigger than 120 MiB<br />
that tells about the vague 128 - 4 = 124 MiB limit<br />
so the user is at least informed that booting may fail<br />
(depending on his specific case).</p>
<p>Same basic reasoning (i.e. "it depends")<br />
for including a reduced/minimal TSM client:<br />
When the initrd size does not matter in some cases<br />
then the full TSM client should normally be included<br />
to have all TSM client functionality available<br />
during ReaR recovery system runtime.</p>
<p>On POWER by default no firmware files are included, cf.<br />
<a href="https://github.com/rear/rear/issues/3189#issuecomment-2076960341">https://github.com/rear/rear/issues/3189#issuecomment-2076960341</a><br />
which I now also mention here via my recent<br />
<a href="https://github.com/rear/rear/pull/3212/commits/10436d8f0102709291c2c94b1f73bd90d9b6b2cc">https://github.com/rear/rear/pull/3212/commits/10436d8f0102709291c2c94b1f73bd90d9b6b2cc</a></p>
<p>Whether or not MODULES=( 'loaded_modules' ) works<br />
depends on whether or not the replacement hardware or VM<br />
is fully compatible with the original system.<br />
I don't know if on POWER the replacement VM<br />
is always fully compatible with the original VM?<br />
As far as I know on POWER there is always a VM<br />
but there are different kind of VMs on POWER.</p>
<p>I also find it somewhat misplaced under the TSM section<br />
but that is all what I can do for now with my rather limited<br />
available time - in particular I will first and foremost<br />
continue with
<a href="https://github.com/rear/rear/issues/3189">https://github.com/rear/rear/issues/3189</a><br />
to help our customer - "customers first" ;-)<br />
Now there are multipath issues - again an area where<br />
I have zero personal experience with - so I need to<br />
somehow find my way through that stuff - hopefully as in<br />
<a href="https://github.com/rear/rear/issues/3189#issuecomment-2051683257">https://github.com/rear/rear/issues/3189#issuecomment-2051683257</a><br />
where my vague intuitiveness revealed the root cause...</p>
<h4 id="jsmeix_commented_at_2024-05-03_1149"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/3212#issuecomment-2092844731">2024-05-03 11:49</a>:<a class="headerlink" href="#jsmeix_commented_at_2024-05-03_1149" title="Permanent link">&para;</a></h4>
<p>I will merge it now.<br />
I ignore the two current CI errors</p>
<pre><code>testing-farm:fedora-40-x86_64 — Error
testing-farm:fedora-rawhide-x86_64 — Error
</code></pre>
<p>that both show at<br />
<a href="https://artifacts.dev.testing-farm.io/59b815ee-d4a4-46b4-a0db-fe3070972188/">https://artifacts.dev.testing-farm.io/59b815ee-d4a4-46b4-a0db-fe3070972188/</a><br />
and<br />
<a href="https://artifacts.dev.testing-farm.io/1c4a3dd1-8744-4ffb-b8f4-3ee0db996581/">https://artifacts.dev.testing-farm.io/1c4a3dd1-8744-4ffb-b8f4-3ee0db996581/</a><br />
(excerpts)</p>
<pre><code>fail: Failed to pull workdir from the guest.
 This usually means that login as 'root' to the guest does not work.
fail: Command 'yum install -y rsync' returned 255.
...
ssh: connect to host [IP address] port 22: Connection timed out
</code></pre>
<p>because the changes here are only comments in default.conf<br />
so the changes here cannot be a cause of those CI failures.</p>
<h4 id="jsmeix_commented_at_2024-05-03_1200"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/3212#issuecomment-2092866056">2024-05-03 12:00</a>:<a class="headerlink" href="#jsmeix_commented_at_2024-05-03_1200" title="Permanent link">&para;</a></h4>
<p>@gdha @schlomo<br />
thank you for review and comments!</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2024-04-30.3212.pr.merged.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
