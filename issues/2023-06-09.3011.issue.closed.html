<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#3011 Issue closed: Suggested tweaks to the initial rear recover menu - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#3011 Issue closed: Suggested tweaks to the initial rear recover menu";
        var mkdocs_page_input_path = "issues/2023-06-09.3011.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#3011 Issue closed: Suggested tweaks to the initial rear recover menu</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="3011_issue_closed_suggested_tweaks_to_the_initial_rear_recover_menu"><a href="https://github.com/rear/rear/issues/3011">#3011 Issue</a> <code>closed</code>: Suggested tweaks to the initial <code>rear recover</code> menu<a class="headerlink" href="#3011_issue_closed_suggested_tweaks_to_the_initial_rear_recover_menu" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>discuss / RFC</code>, <code>no-issue-activity</code></p>
<h4 id="danboid_opened_issue_at_2023-06-09_0954"><img src="https://avatars.githubusercontent.com/u/1429783?u=a0df565fd8514694c44d920a0e7bd5d81a16ccbc&v=4" width="50"><a href="https://github.com/danboid">danboid</a> opened issue at <a href="https://github.com/rear/rear/issues/3011">2023-06-09 09:54</a>:<a class="headerlink" href="#danboid_opened_issue_at_2023-06-09_0954" title="Permanent link">&para;</a></h4>
<p>I'm pretty confident in saying that the philosophy of the rear devs is
that rear should be as easy to use as possible and operate in the most
obvious and straightforward way, which is why I decided to file this
rather nitpicky suggestion regarding the first menu the user is
presented with when they run <code>rear recover</code>.</p>
<p>I would expect that the most common use case for rear is when a user is
restoring a backup onto the same machine with the same (disk) config
versus restoring the backup onto the same machine with a slightly
different disk config or another machine entirely. I would imagine this
is how it gets used the majority of the time and so in that case, when
the user is restoring a rear backup onto the same machine with the same
disk config, the option they most likely want to pick from the first
<code>rear recover</code> menu is awkwardly option #2, "Confirm identical disk
mapping and proceed without manual configuration" so my first suggestion
is that this should be moved to option #1 because its the most likely
option the user wants and so should logically be the first suggestion
and menu item, ie the "default" option.</p>
<p>Another reason I'm suggesting this tweak is that I presumed option 1 was
what I should be using on my first few goes with rear and not only does
option 1 make <code>rear recover</code> more complicated than it needs to be in
most cases, it doesn't currently doesn't work for me and so I'll be
opening a separate ticket for that.</p>
<p>My other suggested tweak for this menu is changing the wording of what
is currently the first option (which I think should be the second
option)- "Confirm disk mapping and continue <code>rear recover</code>". What does
"continue rear recover" mean to the new user? Not very much. How does
this option differ from ""Confirm identical disk mapping and proceed
without manual configuration" - it is not made clear from the options
current label. I think this option should be called something more like
"Confirm disk mapping and configure recovery options."</p>
<h4 id="jsmeix_commented_at_2023-06-13_1051"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/3011#issuecomment-1589059042">2023-06-13 10:51</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-06-13_1051" title="Permanent link">&para;</a></h4>
<p>I think you are talking about the user dialog<br />
which looks like</p>
<pre><code>Confirm disk mapping and continue 'rear recover'
n/a
Edit disk mapping (/var/lib/rear/layout/disk_mappings)
Use Relax-and-Recover shell and return back to here
Abort 'rear recover'
</code></pre>
<p>or</p>
<pre><code>Confirm disk mapping and continue 'rear recover'
Confirm identical disk mapping and proceed without manual configuration
Edit disk mapping (/var/lib/rear/layout/disk_mappings)
Use Relax-and-Recover shell and return back to here
Abort 'rear recover'
</code></pre>
<p>This dialog is implemented in<br />
layout/prepare/default/300_map_disks.sh<br />
which is in our current GitHub master code<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/layout/prepare/default/300_map_disks.sh">https://github.com/rear/rear/blob/master/usr/share/rear/layout/prepare/default/300_map_disks.sh</a></p>
<p>This dialog only appears in so called "migration mode"<br />
because the whole layout/prepare/default/300_map_disks.sh<br />
script is skipped if not in migration mode</p>
<pre><code># Skip if not in migration mode:
is_true "$MIGRATION_MODE" || return 0
</code></pre>
<p>The second choice of this dialog</p>
<pre><code>Confirm identical disk mapping and proceed without manual configuration
</code></pre>
<p>only appears when in migration mode ReaR autodetects<br />
that the proposed disk mapping is an identical mapping<br />
for example like</p>
<pre><code>Current disk mapping table (source =&gt; target):
  /dev/sda =&gt; /dev/sda
  /dev/sdb =&gt; /dev/sdb
  /dev/sdc =&gt; /dev/sdc
</code></pre>
<p>in layout/prepare/default/300_map_disks.sh via</p>
<pre><code>    is_completely_identical_layout_mapping &amp;&amp; choices[1]="Confirm identical disk mapping and proceed without manual configuration" || choices[1]="n/a"
</code></pre>
<p>where the is_completely_identical_layout_mapping function<br />
in lib/layout-functions.sh only checks that<br />
in /var/lib/rear/layout/disk_mappings<br />
all syntactically valid lines have<br />
same "source" and "target" disks.</p>
<p>This means the is_completely_identical_layout_mapping function<br />
returns 'true' when no disks get interchanged by the mapping.<br />
For example in</p>
<pre><code>Current disk mapping table (source =&gt; target):
  /dev/sda =&gt; /dev/sda
  /dev/sdb =&gt; /dev/sdc
  /dev/sdc =&gt; /dev/sdb
</code></pre>
<p>/dev/sdb and /dev/sdc get interchanged by the mapping.</p>
<p>BUT:</p>
<p>When no disks get interchanged by the mapping<br />
it does not mean that<br />
all target disks on the replacement hardware<br />
(i.e. on the hardware where "rear recover" is running)<br />
are identical compared to each source disk<br />
on the original system (where "rear mkbackup" was run).</p>
<p>In other words:<br />
When no disks get interchanged by the mapping<br />
it does not mean that nothing is migrated<br />
(i.e. it does not mean "all is the same")<br />
which matches that this dialog only appears<br />
in "migration mode" (i.e. the mode when<br />
something has changed regarding the disks).</p>
<p>The usual cases when in "migration mode"<br />
no disks get interchanged by the mapping<br />
is that some disk size(s) changed like</p>
<pre><code>  /dev/sda 110 GiB =&gt; /dev/sda 110 GiB
  /dev/sdb 120 GiB =&gt; /dev/sdb 120 GiB
  /dev/sdc 130 GiB =&gt; /dev/sdc 131 GiB
</code></pre>
<p>or when there are several target disks with same size like</p>
<pre><code>  /dev/sda 110 GiB =&gt; /dev/sda 110 GiB
  /dev/sdb 120 GiB =&gt; /dev/sdb 120 GiB
  /dev/sdc 120 GiB =&gt; /dev/sdc 120 GiB
</code></pre>
<p>The difference between</p>
<pre><code>Confirm disk mapping and continue 'rear recover'
</code></pre>
<p>and</p>
<pre><code>Confirm identical disk mapping and proceed without manual configuration
</code></pre>
<p>is that after</p>
<pre><code>Confirm disk mapping and continue 'rear recover'
</code></pre>
<p>several subsequent "migration mode" user dialogs appear<br />
while after</p>
<pre><code>Confirm identical disk mapping and proceed without manual configuration
</code></pre>
<p>those subsequent "migration mode" user dialogs do not appear<br />
in layout/prepare/default/300_map_disks.sh via</p>
<pre><code>    case "$choice" in
...
        (${choices[1]})
            if is_completely_identical_layout_mapping ; then
                # Confirm identical disk mapping and proceed without manual configuration:
                MIGRATION_MODE='false'
</code></pre>
<p>i.e.<br />
after</p>
<pre><code>Confirm identical disk mapping and proceed without manual configuration
</code></pre>
<p>the "migration mode" is switched off.</p>
<h4 id="jsmeix_commented_at_2023-06-13_1149"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/3011#issuecomment-1589146129">2023-06-13 11:49</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-06-13_1149" title="Permanent link">&para;</a></h4>
<p>@danboid<br />
personally (I cannot speak for other ReaR developers)<br />
I would like to ask you to avoid "well intentioned advice" like</p>
<pre><code>rear should be as easy to use as possible and
operate in the most obvious and straightforward way
</code></pre>
<p>My personal reasoning:</p>
<p>Personally I feel a bit treated as if I was an idiot<br />
when someone tells me such things because of course<br />
I do not intend to make ReaR so that it is hard to use or<br />
that it operates in obscure ways in a roundabout fashion.</p>
<p>BUT:</p>
<p>Often (basically always from my personal experience)<br />
what is the obvious and straightforward way<br />
from an end-user point of view<br />
becomes a maze of traps and snakepits<br />
when one implements it because at code level<br />
"obvious intents" are no longer obvious to implement.</p>
<p>From my personal experience the general root cause is<br />
that there are too many cases "out there in the wild"<br />
so there is no such thing as "the use case" and<br />
accordingly there is no such thing as "the implementation".</p>
<h4 id="danboid_commented_at_2023-06-13_1235"><img src="https://avatars.githubusercontent.com/u/1429783?u=a0df565fd8514694c44d920a0e7bd5d81a16ccbc&v=4" width="50"><a href="https://github.com/danboid">danboid</a> commented at <a href="https://github.com/rear/rear/issues/3011#issuecomment-1589220347">2023-06-13 12:35</a>:<a class="headerlink" href="#danboid_commented_at_2023-06-13_1235" title="Permanent link">&para;</a></h4>
<p>Surely the use case / purpose for rear is backing up and restoring Linux
based systems? That's what it is supposed to do right? If I'm mistaken
then please correct me.</p>
<h4 id="pcahyna_commented_at_2023-06-19_1435"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/3011#issuecomment-1597302429">2023-06-19 14:35</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-06-19_1435" title="Permanent link">&para;</a></h4>
<p>Given that migration mode is often a source of problems, to me it also
seems preferable to offer the option that leads to switching it off,
i.e.
<code>Confirm identical disk mapping and proceed without manual configuration</code>,
as the default. The question is, when this is not present (because the
disk mapping is not identical), the default must be something else - is
that ok?</p>
<h4 id="danboid_commented_at_2023-06-19_1556"><img src="https://avatars.githubusercontent.com/u/1429783?u=a0df565fd8514694c44d920a0e7bd5d81a16ccbc&v=4" width="50"><a href="https://github.com/danboid">danboid</a> commented at <a href="https://github.com/rear/rear/issues/3011#issuecomment-1597423044">2023-06-19 15:56</a>:<a class="headerlink" href="#danboid_commented_at_2023-06-19_1556" title="Permanent link">&para;</a></h4>
<p>Yes, that makes perfect sense to me.</p>
<h4 id="jsmeix_commented_at_2023-06-20_1030"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/3011#issuecomment-1598520513">2023-06-20 10:30</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-06-20_1030" title="Permanent link">&para;</a></h4>
<p>@pcahyna<br />
I disagree with your reasoning.<br />
Perhaps I misunderstand what you meant?</p>
<p>My arguments:</p>
<p>(1)<br />
Regarding "migration mode is often a source of problems":</p>
<p>As far as I implemented it (or at least I tried to implement it)<br />
migration mode is never the actual source of a problem.<br />
Actually it is the opposite:<br />
Because of a "source of a problem" ReaR enters migration mode<br />
and ReaR enters migration mode to give the user the chance<br />
to avoid bad consequences because of the actual problem.</p>
<p>(2)<br />
Switching migration mode off by some automatism would be<br />
a contradiction in itself because when ReaR enters migration mode<br />
there is a "source of a problem" so switching migration mode off<br />
means to ignore that "source of a problem" by some automatism.</p>
<p>(3)<br />
Switching migration mode off by some automatism would be<br />
in itself a source of possibly severe and fatal problems.</p>
<p>Did you understand that an identical disk mapping<br />
does not mean "all disks are same as on the original system"?</p>
<p>The standard example where<br />
"Confirm identical disk mapping and 'just proceed'"<br />
leads to a final disaster is:</p>
<ul>
<li>
<p>Original virtual machine with 20GiB virtual disk /dev/sda<br />
    for the system plus additionally attached 20GiB<br />
    virtual disk /dev/sdb for ReaR with OUTPUT=USB.</p>
</li>
<li>
<p>Replacement virtual machine with 20GiB virtual disk<br />
    for the system plus the above 20GiB ReaR disk.</p>
</li>
</ul>
<p>When on the replacement virtual machine<br />
the virtual disk for the system is /dev/sda<br />
and the ReaR disk is /dev/sdb<br />
all is well.</p>
<p>BUT:</p>
<p>When on the replacement virtual machine<br />
the virtual disk for the system is /dev/sdb<br />
and the ReaR disk is /dev/sda<br />
then<br />
"Confirm identical disk mapping and 'just proceed'"<br />
will recreate (the storage layout) on the ReaR disk<br />
which leads to a final disaster<br />
by destroying the backup on the ReaR disk<br />
unless WRITE_PROTECTED_IDS (fortunately) avoids it.</p>
<p>In migration mode I would prefer to not rely blindly<br />
on even more automatisms like WRITE_PROTECTED_IDS.</p>
<p>Instead in migration mode I prefer explicit user confirmation<br />
on which disk "rear recover" will recreate, in particular<br />
for cases like</p>
<pre><code>Ambiguous disk layout needs manual configuration
(more than one disk with same size used in '.../disklayout.conf')

Ambiguous possible target disks need manual configuration
(more than one with same size found)
</code></pre>
<p>cf. layout/prepare/default/250_compare_disks.sh</p>
<p>(4)<br />
A generic note:</p>
<p>Recently I see more often that the wish appears here<br />
to make ReaR again "bindly proceed automatically"<br />
which was how ReaR had behaved about 10 years ago<br />
when I became acquainted with ReaR.<br />
At that time my personal user experience was horrible.</p>
<p>Since that time I worked primarily to make ReaR behave better<br />
(primarily more fail-safe) for SUSE's ReaR users who are<br />
experienced system admins at SUSE customers<br />
who in the end pay my salary.</p>
<p>I assume also Red Hat customers prefer when ReaR<br />
behaves by default fail-safe (as far as possible<br />
with reasonable effort).</p>
<h4 id="jsmeix_commented_at_2023-06-23_1151"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/3011#issuecomment-1604172719">2023-06-23 11:51</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-06-23_1151" title="Permanent link">&para;</a></h4>
<p>As far as I see things work OK for me<br />
with automated user input via</p>
<pre><code>USER_INPUT_LAYOUT_MIGRATION_CONFIRM_MAPPINGS="2"
</code></pre>
<p>I had a 20 GiB sda system disk<br />
and an empty (unused) 1GiB sdb disk on the original machine.</p>
<p>The original machine and the replacement machine are VMs.</p>
<p>I did one test with a 20 GiB sda and 1 GiB sdb<br />
plus an additional 20 GiB sdc on a replacement machine<br />
so there is an identical disk mapping<br />
/dev/sda 20 GiB =&gt; /dev/sda 20 GiB</p>
<pre><code>RESCUE localhost:~ # export USER_INPUT_LAYOUT_MIGRATION_CONFIRM_MAPPINGS="2"

RESCUE localhost:~ # rear -D recover
Relax-and-Recover 2.7 / Git
...
Comparing disks
Cannot check write protection by ID for /dev/sdb (no ID found)
Cannot check write protection by ID for /dev/sdc (no ID found)
Ambiguous possible target disks need manual configuration (more than one with same size found)
Switching to manual disk layout configuration (GiB sizes rounded down to integer)
/dev/sda has same size 21474836480 (20 GiB)
/dev/sdb has same size 1073741824 (1 GiB)
/dev/sdc was not used on the original system and has now 21474836480 (20 GiB)
Using /dev/sda (same name and same size 21474836480) for recreating /dev/sda
Current disk mapping table (source =&gt; target):
  /dev/sda =&gt; /dev/sda

UserInput -I LAYOUT_MIGRATION_CONFIRM_MAPPINGS needed in /usr/share/rear/layout/prepare/default/300_map_disks.sh line 334
Confirm or edit the disk mapping
1) Confirm disk mapping and continue 'rear recover'
2) Confirm identical disk mapping and proceed without manual configuration
3) Edit disk mapping (/var/lib/rear/layout/disk_mappings)
4) Use Relax-and-Recover shell and return back to here
5) Abort 'rear recover'
(default '1' timeout 300 seconds)
UserInput: Will use predefined input in USER_INPUT_LAYOUT_MIGRATION_CONFIRM_MAPPINGS='2'
Hit any key to interrupt the automated input (timeout 10 seconds)
UserInput: Valid choice number result 'Confirm identical disk mapping and proceed without manual configuration'
User confirmed identical disk mapping and proceeding without manual configuration
...
</code></pre>
<p>I did another test with a 21 GiB sda and 1 GiB sdb<br />
plus an additional 20 GiB sdc on a replacement machine<br />
so there is not an identical disk mapping<br />
/dev/sda 20 GiB =&gt; /dev/sdc 20 GiB</p>
<pre><code>RESCUE localhost:~ # export USER_INPUT_LAYOUT_MIGRATION_CONFIRM_MAPPINGS="2"

RESCUE localhost:~ # rear -D recover
Relax-and-Recover 2.7 / Git
...
Comparing disks
Cannot check write protection by ID for /dev/sda (no ID found)
Cannot check write protection by ID for /dev/sdb (no ID found)
Cannot check write protection by ID for /dev/sdc (no ID found)
Device sda has size 22548578304 bytes but 21474836480 bytes is expected (needs manual configuration)
Switching to manual disk layout configuration (GiB sizes rounded down to integer)
/dev/sda had size 21474836480 (20 GiB) but is now 22548578304 (21 GiB)
/dev/sdb has same size 1073741824 (1 GiB)
/dev/sdc was not used on the original system and has now 21474836480 (20 GiB)
Cannot check write protection by ID for /dev/sdc (no ID found)
Using /dev/sdc (same size 21474836480) for recreating /dev/sda
Current disk mapping table (source =&gt; target):
  /dev/sda =&gt; /dev/sdc

UserInput -I LAYOUT_MIGRATION_CONFIRM_MAPPINGS needed in /usr/share/rear/layout/prepare/default/300_map_disks.sh line 334
Confirm or edit the disk mapping
1) Confirm disk mapping and continue 'rear recover'
2) n/a
3) Edit disk mapping (/var/lib/rear/layout/disk_mappings)
4) Use Relax-and-Recover shell and return back to here
5) Abort 'rear recover'
(default '1' timeout 300 seconds)
UserInput: Will use predefined input in USER_INPUT_LAYOUT_MIGRATION_CONFIRM_MAPPINGS='2'
Hit any key to interrupt the automated input (timeout 10 seconds)
UserInput: Valid choice number result 'n/a'
Not applicable (no identical disk mapping)
Current disk mapping table (source =&gt; target):
  /dev/sda =&gt; /dev/sdc

UserInput -I LAYOUT_MIGRATION_CONFIRM_MAPPINGS needed in /usr/share/rear/layout/prepare/default/300_map_disks.sh line 334
Confirm or edit the disk mapping
1) Confirm disk mapping and continue 'rear recover'
2) n/a
3) Edit disk mapping (/var/lib/rear/layout/disk_mappings)
4) Use Relax-and-Recover shell and return back to here
5) Abort 'rear recover'
(default '1' timeout 300 seconds)
UserInput: Will use predefined input in USER_INPUT_LAYOUT_MIGRATION_CONFIRM_MAPPINGS='2'
Hit any key to interrupt the automated input (timeout 10 seconds)
Confirm or edit the disk mapping
(default '1' timeout 300 seconds)

UserInput: No real user input (empty or only spaces) - using default input
UserInput: Valid choice number result 'Confirm disk mapping and continue 'rear recover''
User confirmed disk mapping
...
</code></pre>
<h4 id="github-actions_commented_at_2023-08-23_0159"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/3011#issuecomment-1689148871">2023-08-23 01:59</a>:<a class="headerlink" href="#github-actions_commented_at_2023-08-23_0159" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2023-06-09.3011.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
