<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2772 Issue closed: User guide: Missing info from layout configuration page - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2772 Issue closed: User guide: Missing info from layout configuration page";
        var mkdocs_page_input_path = "issues/2022-03-11.2772.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2772 Issue closed: User guide: Missing info from layout configuration page</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2772_issue_closed_user_guide_missing_info_from_layout_configuration_page"><a href="https://github.com/rear/rear/issues/2772">#2772 Issue</a> <code>closed</code>: User guide: Missing info from layout configuration page<a class="headerlink" href="#2772_issue_closed_user_guide_missing_info_from_layout_configuration_page" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>no-issue-activity</code></p>
<h4 id="danboid_opened_issue_at_2022-03-11_1416"><img src="https://avatars.githubusercontent.com/u/1429783?u=a0df565fd8514694c44d920a0e7bd5d81a16ccbc&v=4" width="50"><a href="https://github.com/danboid">danboid</a> opened issue at <a href="https://github.com/rear/rear/issues/2772">2022-03-11 14:16</a>:<a class="headerlink" href="#danboid_opened_issue_at_2022-03-11_1416" title="Permanent link">&para;</a></h4>
<p>I've yet to actually use rear but after looking at the docs I'm unclear
about a few things that I would like to see made more clear in the docs,
specifically the <a href="https://github.com/rear/rear/blob/master/doc/user-guide/06-layout-configuration.adoc">layout configuration
page</a>.</p>
<p>I want to use rear to backup a Ubuntu 20.04 server which uses md raid
for the system disks (MDRAID 10) and ZFS for /home. /home is going to be
backed up to another server using syncoid to preserve the snapshots so I
want to exclude /home and also stop it backing up the systemrescuecd USB
drive I've got plugged into it.</p>
<p>It looks like I'll need to use EXCLUDE_BACKUP=() for this but that
presents a few questions not covered in the current docs:</p>
<ul>
<li>What is the correct format for an exclude value?</li>
</ul>
<p>EXCLUDE_BACKUP=( "fs:/home" )</p>
<p>or</p>
<p>EXCLUDE_BACKUP=( "/home" )</p>
<p>I have seen both formats used in the current docs.</p>
<ul>
<li>
<p>How do I define multiple exclude paths or devices? Do I use multiple
    EXCLUDE_BACKUP statements, one with comma separated values or one
    with space separated values or...</p>
</li>
<li>
<p>Can I add devices to EXCLUDE_BACKUP or is it only for local fs
    paths / mounted disks?</p>
</li>
<li>
<p>I see there is also EXCLUDE_RECREATE but I don't understand what
    this is for? The comments / current docs say</p>
</li>
</ul>
<!-- -->

<pre><code># Exclude components during component recreation
</code></pre>
<p>What is 'component recreation'? It would seem this isn't just another
name for restore because there is also EXCLUDE_RESTORE=() so I'm unsure
if I should also use EXCLUDE_RECREATE?</p>
<h4 id="danboid_commented_at_2022-03-12_1759"><img src="https://avatars.githubusercontent.com/u/1429783?u=a0df565fd8514694c44d920a0e7bd5d81a16ccbc&v=4" width="50"><a href="https://github.com/danboid">danboid</a> commented at <a href="https://github.com/rear/rear/issues/2772#issuecomment-1065931437">2022-03-12 17:59</a>:<a class="headerlink" href="#danboid_commented_at_2022-03-12_1759" title="Permanent link">&para;</a></h4>
<p>It seems like <code>default.conf</code> is a more comprehensive source of
documentation for rear than the user guide. After having a quick skim
through that, I think I should actually be using:</p>
<pre><code>EXCLUDE_MOUNTPOINTS=(/home)
</code></pre>
<p>To stop rear backing up <code>/home</code> rather than <code>EXCLUDE_BACKUP=()</code> and it
seems multiple values are separated by spaces so am I right in thinking
that to stop rear backing up <code>/home</code> and my USB disk it would be a
statement like:</p>
<pre><code>EXCLUDE_MOUNTPOINTS=(/home /media/user/disk)
</code></pre>
<p>So, what is <code>EXCLUDE_BACKUP=()</code> used for and what are the 'components'
it manages?</p>
<p>We should probably update the layout config page of the rear user guide
to include EXCLUDE_MOUNTPOINTS as one of the highlighted functions as
this must be a commonly used option if its what's used to prevent always
connected USB drives, backup dirs etc from being backed up accidentally.</p>
<h4 id="danboid_commented_at_2022-03-13_1044"><img src="https://avatars.githubusercontent.com/u/1429783?u=a0df565fd8514694c44d920a0e7bd5d81a16ccbc&v=4" width="50"><a href="https://github.com/danboid">danboid</a> commented at <a href="https://github.com/rear/rear/issues/2772#issuecomment-1066073975">2022-03-13 10:44</a>:<a class="headerlink" href="#danboid_commented_at_2022-03-13_1044" title="Permanent link">&para;</a></h4>
<p>Its OT for this issue but does rear support restoring Ubuntu or proxmox
with ZFS root partitions?</p>
<pre><code>~/src/rear$ grep -r zpool *
~/src/rear$
</code></pre>
<p>I strongly suspect that means there is currently no ZFS support in rear
right?</p>
<p>Do I need to pass any special options to backup a md RAID10 array or
will rear handle all the RAID stuff automatically when using Linux's
software RAID?</p>
<h4 id="jsmeix_commented_at_2022-03-14_1200"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2772#issuecomment-1066701659">2022-03-14 12:00</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-03-14_1200" title="Permanent link">&para;</a></h4>
<p>ReaR currently does not support ZFS,<br />
see
<a href="https://github.com/rear/rear/issues/1932">https://github.com/rear/rear/issues/1932</a><br />
and
<a href="https://github.com/rear/rear/issues/2563">https://github.com/rear/rear/issues/2563</a></p>
<h4 id="jsmeix_commented_at_2022-03-14_1258"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2772#issuecomment-1066754013">2022-03-14 12:58</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-03-14_1258" title="Permanent link">&para;</a></h4>
<p>In general what is called "components" in ReaR is separated<br />
from what is called "backup" in ReaR.</p>
<p>"Components" are basically what is stored during "rear mkrescue" in<br />
var/lib/rear/layout/disklayout.conf<br />
i.e. the disk layout components like disks, partitions, and filesystems.</p>
<p>"Backup" are the files (and directories) that are saved<br />
via a backup method that is specified by <code>BACKUP= ...</code><br />
during "rear mkbackuponly".</p>
<p>"rear mkbackup" results the same as<br />
first "rear mkrescue" and then "rear mkbackuponly"<br />
(you may inspect what "rear -s mkrescue" shows compared<br />
to "rear -s mkbackup" and/or "rear -s mkbackuponly").</p>
<p>Currently there are various <code>EXCLUDE</code> user config variables<br />
in usr/share/rear/conf/default.conf for example things like</p>
<pre><code>BACKUP_PROG_EXCLUDE
BACKUP_ONLY_EXCLUDE
EXCLUDE_MOUNTPOINTS
EXCLUDE_MD
EXCLUDE_VG
EXCLUDE_COMPONENTS
AUTOEXCLUDE_DISKS
AUTOEXCLUDE_MULTIPATH
AUTOEXCLUDE_AUTOFS
AUTOEXCLUDE_PATH
EXCLUDE_BACKUP
EXCLUDE_RECREATE
EXCLUDE_RESTORE
</code></pre>
<p>Those config variables are used by ReaR in various specific ways<br />
and they may interact with each other in certain automated ways.</p>
<p>For some basic information what each one should do<br />
see the descriptions in usr/share/rear/conf/default.conf</p>
<p>For exact information what each one actually does and<br />
how each one may interact with other config variables<br />
you would have to inspect the scripts where each one is used.<br />
For example to find out in which scripts BACKUP_PROG_EXCLUDE<br />
is used you may use a command like</p>
<pre><code># find usr/share/rear/ -type f -name '*.sh' | xargs grep -l 'BACKUP_PROG_EXCLUDE'
</code></pre>
<p>and then inspect the actual bash code in those scripts.</p>
<p>But in particular BACKUP_PROG_EXCLUDE is only supported<br />
for ReaR's "internal" backup methods like "BACKUP=NETFS"<br />
in particular with "BACKUP_PROG=tar".</p>
<p>For ReaR's "external" backup methods see the section<br />
"BACKUP SOFTWARE INTEGRATION" in "man rear"<br />
e.g. online at<br />
<a href="https://github.com/rear/rear/blob/master/doc/rear.8.adoc">https://github.com/rear/rear/blob/master/doc/rear.8.adoc</a></p>
<p>See also the section "Relax-and-Recover versus backup and restore" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<h4 id="jsmeix_commented_at_2022-03-14_1304"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2772#issuecomment-1066760180">2022-03-14 13:04</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-03-14_1304" title="Permanent link">&para;</a></h4>
<p>Regarding the syntax of disk layout components:</p>
<p>To see the exact syntax of components in your particular case<br />
it should help to inspect after "rear mkrescue" was run<br />
the var/lib/rear/layout/diskdeps.conf file that lists the<br />
components for example something like</p>
<pre><code>/dev/sda1 /dev/sda
/dev/sda2 /dev/sda
/dev/sda3 /dev/sda
/dev/sda5 /dev/sda
fs:/ /dev/sda5
swap:/dev/sda1 /dev/sda1
</code></pre>
<p>Also var/lib/rear/layout/disktodo.conf lists the components, cf.<br />
<a href="https://github.com/rear/rear/issues/2229#issuecomment-529953810">https://github.com/rear/rear/issues/2229#issuecomment-529953810</a></p>
<p>For an example how EXCLUDE_COMPONENTS had worked for me<br />
to exclude a particular filesystem, see<br />
<a href="https://github.com/rear/rear/issues/1767#issuecomment-378925290">https://github.com/rear/rear/issues/1767#issuecomment-378925290</a></p>
<p>That issue
<a href="https://github.com/rear/rear/issues/1767">https://github.com/rear/rear/issues/1767</a><br />
also describes that it is currently not possible<br />
to exclude a partition between other partitions, see<br />
<a href="https://github.com/rear/rear/issues/1767#issuecomment-379758551">https://github.com/rear/rear/issues/1767#issuecomment-379758551</a><br />
and<br />
<a href="https://github.com/rear/rear/issues/1771">https://github.com/rear/rear/issues/1771</a></p>
<h4 id="danboid_commented_at_2022-03-14_1752"><img src="https://avatars.githubusercontent.com/u/1429783?u=a0df565fd8514694c44d920a0e7bd5d81a16ccbc&v=4" width="50"><a href="https://github.com/danboid">danboid</a> commented at <a href="https://github.com/rear/rear/issues/2772#issuecomment-1067117365">2022-03-14 17:52</a>:<a class="headerlink" href="#danboid_commented_at_2022-03-14_1752" title="Permanent link">&para;</a></h4>
<p>Thanks for your comprehensive replies @jsmeix ! I've not tested a rear
restore yet but I believe I've created a successful rear backup now by
using <code>EXCLUDE_COMPONENTS()</code> to exclude my ZFS pool members and external
disks.</p>
<p>So why does rear have both <code>EXCLUDE_COMPONENTS()</code> and
<code>EXCLUDE_MOUNTPOINTS()</code>? Do these not serve the same purpose?</p>
<h4 id="jsmeix_commented_at_2022-03-16_1318"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2772#issuecomment-1069119836">2022-03-16 13:18</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-03-16_1318" title="Permanent link">&para;</a></h4>
<p>EXCLUDE_COMPONENTS and EXCLUDE_MOUNTPOINTS behave differently:</p>
<p>See usr/share/rear/conf/default.conf</p>
<pre><code># Exclude filesystems by specifying their mountpoints. Will be automatically added to the
# $BACKUP_PROG_EXCLUDE array during backup to prevent the excluded filesystems' data to
# be backed up
# examples: /tmp
#           /media/bigdisk
EXCLUDE_MOUNTPOINTS=()
...
# Exclude any component from the recovery image.
# Some component types need a prefix:
# - filesystems: "fs:/var/cache"
# - physical volumes: "pv:/dev/sda2"
# - swap: "swap:/dev/mapper/system-swap"
# Volume groups look like: "/dev/system".
# If in doubt about the correct syntax, consult /var/lib/rear/layout/disktodo.conf
EXCLUDE_COMPONENTS=()
</code></pre>
<p>so the difference is that elements in the EXCLUDE_MOUNTPOINTS array<br />
get automatically added to the $BACKUP_PROG_EXCLUDE array<br />
while EXCLUDE_COMPONENTS excludes only those<br />
disk layout components (like disks, partitions, and filesystems)<br />
to be recreated during "rear recover".</p>
<p>For the actual differences inspect their actual code places:</p>
<pre><code># find usr/sbin/rear usr/share/rear/ -type f | xargs grep 'EXCLUDE_COMPONENTS'

usr/share/rear/conf/default.conf:EXCLUDE_COMPONENTS=()
usr/share/rear/layout/save/default/310_include_exclude.sh:for component in "${EXCLUDE_COMPONENTS[@]}" ; do
usr/share/rear/layout/save/default/310_include_exclude.sh:    LogPrint "Excluding component $component in EXCLUDE_COMPONENTS"

# find usr/sbin/rear usr/share/rear/ -type f | xargs grep 'EXCLUDE_MOUNTPOINTS'

usr/share/rear/conf/default.conf:# but not implicitly also all excluded mountpoints in EXCLUDE_MOUNTPOINTS:
usr/share/rear/conf/default.conf:EXCLUDE_MOUNTPOINTS=()
usr/share/rear/conf/default.conf:# You must also exclude the corresponding mountpoints in EXCLUDE_MOUNTPOINTS (see above)
usr/share/rear/conf/default.conf:# EXCLUDE_VG and EXCLUDE_MOUNTPOINTS will get populated automatically, if needed
usr/share/rear/conf/default.conf:# This is different from EXCLUDE_MOUNTPOINTS, which accepts only mountpoints.
usr/share/rear/layout/save/default/310_include_exclude.sh:# EXCLUDE_MOUNTPOINTS
usr/share/rear/layout/save/default/310_include_exclude.sh:#for mountpoint in "${EXCLUDE_MOUNTPOINTS[@]}" ; do
usr/share/rear/layout/save/default/310_include_exclude.sh:#    LogPrint "Excluding mountpoint $mountpoint in EXCLUDE_MOUNTPOINTS"
usr/share/rear/layout/save/default/320_autoexclude.sh:        if IsInArray "$mountpoint" "${EXCLUDE_MOUNTPOINTS[@]}" ; then
usr/share/rear/restore/NBU/default/300_create_nbu_restore_fs_list.sh:if [ ${#EXCLUDE_MOUNTPOINTS[@]} -gt 0 ]
usr/share/rear/restore/NBU/default/300_create_nbu_restore_fs_list.sh:    for FS in ${EXCLUDE_MOUNTPOINTS[@]}
usr/share/rear/backup/NETFS/default/400_create_include_exclude_files.sh:            if ! IsInArray "$mountpoint" "${EXCLUDE_MOUNTPOINTS[@]}" ; then
usr/share/rear/backup/NETFS/default/400_create_include_exclude_files.sh:    for excluded_mountpoint in "${EXCLUDE_MOUNTPOINTS[@]}" ; do
</code></pre>
<p>In particular<br />
usr/share/rear/layout/save/default/310_include_exclude.sh<br />
and<br />
usr/share/rear/layout/save/default/320_autoexclude.sh<br />
look interesting regarding EXCLUDE_MOUNTPOINTS<br />
where the former (310_include_exclude.sh) shows that<br />
a filesystem in EXCLUDE_MOUNTPOINTS still gets recreated because</p>
<pre><code># If a filesystem is excluded (for backup) we still may need to perform an
# mkfs on the filesystem as it may be referenced in fstab and mounted
# automatically, or is needed for a separate restore.
</code></pre>
<p>except its whole disk gets automatically excluded via<br />
usr/share/rear/layout/save/default/320_autoexclude.sh</p>
<p>And there is also EXCLUDE_RECREATE with similar<br />
but again somewhat different behaviour.</p>
<p>Personally I find the whole exclude functionality "hairy", cf.<br />
<a href="https://github.com/rear/rear/issues/2229#issuecomment-531474858">https://github.com/rear/rear/issues/2229#issuecomment-531474858</a></p>
<p>The current state is the grown result of many contributions<br />
by various different (mostly voluntary) contributors over a long time<br />
which is much appreciated because without all those continuous<br />
contributions there would be basically no ReaR at all.</p>
<p>We cannot "just clean it up" because each specific functionality<br />
is used by particular users and we want to<br />
"Maintain backward compatibility", cf.<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style#maintain-backward-compatibility">https://github.com/rear/rear/wiki/Coding-Style#maintain-backward-compatibility</a><br />
and we neither have the time nor the manpower<br />
to clean it up in a proper backward compatible way.</p>
<h4 id="danboid_commented_at_2022-04-26_1638"><img src="https://avatars.githubusercontent.com/u/1429783?u=a0df565fd8514694c44d920a0e7bd5d81a16ccbc&v=4" width="50"><a href="https://github.com/danboid">danboid</a> commented at <a href="https://github.com/rear/rear/issues/2772#issuecomment-1110013227">2022-04-26 16:38</a>:<a class="headerlink" href="#danboid_commented_at_2022-04-26_1638" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<p>Rear has the function <code>ONLY_INCLUDE_VG=( "vg0" )</code> which I can use to
backup the root partition / LVM VG on my server that uses LVM but rear
doesn't seem to have a matching <code>ONLY_INCLUDE_MD()</code> to only backup
specific soft RAID arrays to do a similar thing on my server that does
not use LVM but does use mdadm. Is there a reason for this other than
its not been implemented yet?</p>
<p>I want to use rear to backup <code>/dev/md0</code> on a server thats not using LVM
but I don't want to backup its external disks or ZFS pool. Here is the
relevant bit of its <code>/var/lib/rear/layout/disklayout.conf</code> :</p>
<pre><code>raid /dev/md0 metadata=1.2 level=raid10 raid-devices=4 uuid=a6bd74fc:af330bdc:c585f8e7:9a338b9f layout=n2 chunk=512 devices=/dev/nvme2n1p2,/dev/nvme1n1p2,/dev/nvme0n1p2,/dev/nvme3n1p2
part /dev/md0 3839413452800 1048576 rear-noname none /dev/md0p1
# Filesystems (only ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs are supported).
# Format: fs &lt;device&gt; &lt;mountpoint&gt; &lt;fstype&gt; [uuid=&lt;uuid&gt;] [label=&lt;label&gt;] [&lt;attributes&gt;]
fs /dev/md0p1 / xfs uuid=be0e9e5b-d449-4f4b-969f-248b81d13222 label=  options=rw,relatime,attr2,inode64,logbufs=8,logbsize=32k,sunit=1024,swidth=2048,noquota
</code></pre>
<p>Can I tell rear to only backup this md raid partition or must I instead
do it by excluding all the components I don't want?</p>
<h4 id="jsmeix_commented_at_2022-04-28_1214"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2772#issuecomment-1112130792">2022-04-28 12:14</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-04-28_1214" title="Permanent link">&para;</a></h4>
<p>I don't know if someone may have tried to implement ONLY_INCLUDE_MD<br />
some longer time ago but failed because it was impossible for some
reason<br />
but I guess there no reason other than it is not yet implemented and<br />
I know that noone asked for such functionality since some time<br />
so likely you are the first who asks for such functionality.</p>
<p>So when you need ONLY_INCLUDE_MD see the sections<br />
"How to adapt and enhance Relax-and-Recover" and<br />
"How to contribute to Relax-and-Recover" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>Perhaps it is easier to explicitly exclude all unwanted components?</p>
<p>Because ReaR config files (in particular etc/rear/local.conf)<br />
are executed via the bash builtin <code>source</code> you can run commands<br />
within your configuration files, in particular commands to<br />
automatically set configuration values as you need, see<br />
<a href="https://github.com/rear/rear/blob/master/etc/rear/local.conf">https://github.com/rear/rear/blob/master/etc/rear/local.conf</a><br />
So you could automatically exclude all unwanted components.</p>
<p>Have in mind that etc/rear/local.conf is executed<br />
for "rear mkrescue" which runs on the original system<br />
and also for "rear recover" which runs inside the ReaR recovery system.</p>
<p>So expected storage devices may not exist on new replacement hardware<br />
or unexpected storage devices may exist on used replacement hardware<br />
when etc/rear/local.conf is executed during "rear recover", cf. the
section<br />
"Prepare replacement hardware for disaster recovery" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>Simply put:<br />
Commands in ReaR config files must also work<br />
within the recovery system on replacement hardware.</p>
<h4 id="github-actions_commented_at_2022-06-28_0326"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2772#issuecomment-1168174953">2022-06-28 03:26</a>:<a class="headerlink" href="#github-actions_commented_at_2022-06-28_0326" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2022-03-11.2772.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
