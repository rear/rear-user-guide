<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1253 Issue closed: FATAL: Module fuse not found -- in RESCUE shell - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1253 Issue closed: FATAL: Module fuse not found -- in RESCUE shell";
        var mkdocs_page_input_path = "issues/2017-03-18.1253.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1253 Issue closed: FATAL: Module fuse not found -- in RESCUE shell</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1253_issue_closed_fatal_module_fuse_not_found_--_in_rescue_shell"><a href="https://github.com/rear/rear/issues/1253">#1253 Issue</a> <code>closed</code>: FATAL: Module fuse not found -- in RESCUE shell<a class="headerlink" href="#1253_issue_closed_fatal_module_fuse_not_found_--_in_rescue_shell" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="john-leone_opened_issue_at_2017-03-18_2004"><img src="https://avatars.githubusercontent.com/u/18706709?v=4" width="50"><a href="https://github.com/John-Leone">John-Leone</a> opened issue at <a href="https://github.com/rear/rear/issues/1253">2017-03-18 20:04</a>:<a class="headerlink" href="#john-leone_opened_issue_at_2017-03-18_2004" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (rear) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<pre>
RESCUE xrearm1d:~ # rear -V
Relax-and-Recover 2.00 / Git
</pre>

<pre>
RESCUE xrearm1d:~ # cat /etc/rear/os.conf
OS_VENDOR=RedHatEnterpriseServer
OS_VERSION=6
#
# WARNING ! This information was added automatically by the mkbackup workflow !!!
ARCH='Linux-i386'
OS='GNU/Linux'
OS_VERSION='6'
OS_VENDOR='RedHatEnterpriseServer'
OS_VENDOR_VERSION='RedHatEnterpriseServer/6'
OS_VENDOR_ARCH='RedHatEnterpriseServer/i386'
</pre>

<pre>
RESCUE xrearm1d:~ # cat /etc/rear/local.conf
# John L. added the lines below.
OUTPUT=ISO
BACKUP=NETFS
OUTPUT_URL=file:///midrange/backups
BACKUP_URL=sshfs://root@xxx.xxx.xxx.xxx/dbar/
BACKUP_PROG_EXCLUDE=("${BACKUP_PROG_EXCLUDE[@]}" '/u01' '/u02' '/u03')
</pre>

<ul>
<li>Are you using legacy BIOS or UEFI boot? BIOS</li>
<li>Brief description of the issue:<br />
    We use sshfs for backups and recovery on internal networks.. For
    servers behind firewalls we use BACKUP_URL=file:/// option, then we
    copy the files to a DBAR server for save keeping.<br />
    To recover DMZ servers we edit the BACKUP_URL= to include the
    correct IP for recovery.</li>
</ul>
<p>In the past "modprobe fuse" would load the kernel module but now it
fails.</p>
<pre>
RESCUE xrearm1d:~ # modprobe fuse
**FATAL: Module fuse not found.**
</pre>

<ul>
<li>Work-around, if any: None.</li>
</ul>
<p>Is there anything I can do to get fuse to load in the rescue shell?</p>
<p>Thanks for your help.<br />
John L.</p>
<p><a href="https://github.com/rear/rear/files/852708/rear-xrearm1d-log.txt">rear-xrearm1d-log.txt</a></p>
<h4 id="gdha_commented_at_2017-03-19_0914"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-287603826">2017-03-19 09:14</a>:<a class="headerlink" href="#gdha_commented_at_2017-03-19_0914" title="Permanent link">&para;</a></h4>
<p>@John-Leone Have a look at
<a href="https://github.com/rear/rear/commit/f6e54dd02899b0ea4c111ea42f653cc7bd8db121">https://github.com/rear/rear/commit/f6e54dd02899b0ea4c111ea42f653cc7bd8db121</a>
- it should have been working. After running the <strong>mkbackup</strong> flow did
you check the log file on <em>fuse</em> module being not found?<br />
Perhaps, it has another name? Check with <code>lsmod | grep fuse</code></p>
<h4 id="john-leone_commented_at_2017-03-19_2319"><img src="https://avatars.githubusercontent.com/u/18706709?v=4" width="50"><a href="https://github.com/John-Leone">John-Leone</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-287656562">2017-03-19 23:19</a>:<a class="headerlink" href="#john-leone_commented_at_2017-03-19_2319" title="Permanent link">&para;</a></h4>
<p>@gdha When BACKUP_URL=file:///midrange/backups this is all that's found
in the mkbackup flow log.</p>
<p>[root@xrearm1d xrearm1d]# grep fuse rear-xrearm1d.log<br />
2017-03-18 13:31:52 Cloning groups: group disk cdrom floppy tape audio
video lp tty dialout kmem uucp ssh_keys plugdev tty usbmuxd usbmux fuse
kvm oinstall 74 2 32 69 99 29</p>
<p>When BACKUP_URL=sshfs://root@xxx.xxx.xxx.xxx/dbar/ there is much more
found in the mkbackup flow log. See attached file.<br />
<a href="https://github.com/rear/rear/files/853655/rear-xrearm1d-log.txt">rear-xrearm1d-log.txt</a></p>
<h4 id="gdha_commented_at_2017-03-20_0658"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-287688539">2017-03-20 06:58</a>:<a class="headerlink" href="#gdha_commented_at_2017-03-20_0658" title="Permanent link">&para;</a></h4>
<p>@John-Leone the kernel module will only be loaded and copied to initrd
of ReaR when you specify <code>BACKUP_URL=sshfs://root@xxx.xxx.xxx.xxx/dbar/</code>
and that also happened I saw in the latter logfile. Are you sure the
module was not found nor loaded in the recover then?</p>
<h4 id="john-leone_commented_at_2017-03-20_1139"><img src="https://avatars.githubusercontent.com/u/18706709?v=4" width="50"><a href="https://github.com/John-Leone">John-Leone</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-287736224">2017-03-20 11:39</a>:<a class="headerlink" href="#john-leone_commented_at_2017-03-20_1139" title="Permanent link">&para;</a></h4>
<p>@gdha when BACKUP_URL=sshfs://root@xxx.xxx.xxx.xxx/dbar/ backup &amp;
recovery works fine. But, in the DMZ network we code
BACKUP_URL=file:///midrange/backups for mkbackup, then for recovery we
cd to /etc/rear in the ReaR rescue shell and update local.conf to
BACKUP_URL=sshfs://root@xxx.xxx.xxx.xxx/dbar/ so we can recover the
server. This is when we encounter this error:<br />
RESCUE xrearm1d:~ # modprobe fuse<br />
FATAL: Module fuse not found.<br />
It looks like when mkbackup with BACKUP_URL=file:/// we can't change
and use BACKUP_URL=sshfs://root@xxx.xxx.xxx.xxx/dbar/ for recovery.<br />
I'm not sure if this is by design or if there is a problem?<br />
Let me know if I can provide more information.</p>
<h4 id="gdha_commented_at_2017-03-20_1212"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-287742277">2017-03-20 12:12</a>:<a class="headerlink" href="#gdha_commented_at_2017-03-20_1212" title="Permanent link">&para;</a></h4>
<p>@John-Leone OK I understand your problem now - be sure you add
<code>MODULES_LOAD=${MODULES_LOAD[@] fuse }</code> in the <code>/etc/rear/local.conf</code>
file when you run <code>rear mkbackup</code> when the <code>BACKUP_URL</code> variable starts
with <code>file://</code> as kernel module <code>fuse</code> will only be copied when the
<code>BACKUP_URL</code> variable starts with <code>sshfs://</code></p>
<h4 id="john-leone_commented_at_2017-03-21_0139"><img src="https://avatars.githubusercontent.com/u/18706709?v=4" width="50"><a href="https://github.com/John-Leone">John-Leone</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-287950868">2017-03-21 01:39</a>:<a class="headerlink" href="#john-leone_commented_at_2017-03-21_0139" title="Permanent link">&para;</a></h4>
<p>@gdha I tried MODULES_LOAD=${MODULES_LOAD[@] fuse } but got the
following error: "/usr/share/rear/lib/global-functions.sh: line 285:
sshfs: command not found "<br />
Then I updated local.conf to include:
REQUIRED_PROGS=("${REQUIRED_PROGS[@]}" 'sshfs') and I got this
error: "ERROR: Cannot run 'sshfs' because 'fuse' kernel module is not
loadable"<br />
Do you have anything else I can try?</p>
<h4 id="gdha_commented_at_2017-03-21_0739"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-287999142">2017-03-21 07:39</a>:<a class="headerlink" href="#gdha_commented_at_2017-03-21_0739" title="Permanent link">&para;</a></h4>
<p>@John-Leone check the rear log to see whether <code>sshfs</code> executable and
<code>fuse</code> modules were copied to the initrd image. Did you try
<code>modprobe fuse</code>?</p>
<h4 id="john-leone_commented_at_2017-03-21_0957"><img src="https://avatars.githubusercontent.com/u/18706709?v=4" width="50"><a href="https://github.com/John-Leone">John-Leone</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288029158">2017-03-21 09:57</a>:<a class="headerlink" href="#john-leone_commented_at_2017-03-21_0957" title="Permanent link">&para;</a></h4>
<p>@gdha modprobe fuse worked when just MODULES_LOAD=${MODULES_LOAD[@]
fuse } was in local.conf.<br />
Where do I check the initrd image?</p>
<h4 id="gdha_commented_at_2017-03-21_1015"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288033465">2017-03-21 10:15</a>:<a class="headerlink" href="#gdha_commented_at_2017-03-21_1015" title="Permanent link">&para;</a></h4>
<p>@John-Leone Sorry I meant check the rear logging if it was copied, but
you already answered it yourself - yes it was. Does a recover work now?</p>
<h4 id="jsmeix_commented_at_2017-03-21_1039"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288038966">2017-03-21 10:39</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-03-21_1039" title="Permanent link">&para;</a></h4>
<p>Only side notes FYI (I did not yet read all the detail above):</p>
<p>@gdha<br />
only FYI there was a similar issue<br />
<a href="https://github.com/rear/rear/issues/1181">https://github.com/rear/rear/issues/1181</a></p>
<p>@John-Leone<br />
in general regarding possibly missing modules<br />
in the recovery system see the related issue<br />
<a href="https://github.com/rear/rear/issues/1202">https://github.com/rear/rear/issues/1202</a></p>
<p>Whenever a kernel module is missing in the recovery system<br />
the "big hammer" to get them all included is</p>
<pre>
COPY_AS_IS=( "${COPY_AS_IS[@]:-}" /lib/modules )
</pre>

<p>or wherever all the kernel modules are located<br />
for your particular Linux distribution.</p>
<h4 id="john-leone_commented_at_2017-03-21_1204"><img src="https://avatars.githubusercontent.com/u/18706709?v=4" width="50"><a href="https://github.com/John-Leone">John-Leone</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288058236">2017-03-21 12:04</a>:<a class="headerlink" href="#john-leone_commented_at_2017-03-21_1204" title="Permanent link">&para;</a></h4>
<p>@gdha @jsmeix I tried the big hammer, "COPY_AS_IS=(
"${COPY_AS_IS[@]:-}" /lib/modules )" in the local.conf file and got
this error:</p>
<p>From /var/log/rear/rear-xrearm1d.log:</p>
<pre>
cp: `/lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic/cnic.ko' and `/tmp/rear.qgoq0Blk6OqdKfi/rootfs//lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic/cnic.ko' are the same file
2017-03-21 07:47:15 ERROR: [ModulesCopyTo] Could not copy '/lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic/cnic.ko' to '/tmp/rear.qgoq0Blk6OqdKfi/rootfs'
==== Stack trace ====
Trace 0: /usr/sbin/rear:504 main
Trace 1: /usr/share/rear/lib/mkbackup-workflow.sh:15 WORKFLOW_mkbackup
Trace 2: /usr/share/rear/lib/framework-functions.sh:85 SourceStage
Trace 3: /usr/share/rear/lib/framework-functions.sh:45 Source
Trace 4: /usr/share/rear/build/GNU/Linux/400_copy_modules.sh:16 source
Trace 5: /usr/share/rear/lib/linux-functions.sh:131 ModulesCopyTo
Trace 6: /usr/share/rear/lib/_input-output-functions.sh:132 StopIfError
Message: [ModulesCopyTo] Could not copy '/lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic/cnic.ko' to '/tmp/rear.qgoq0Blk6OqdKfi/rootfs'
== End stack trace ==
2017-03-21 07:47:15 Running exit tasks.
2017-03-21 07:47:15 Finished in 243 seconds
2017-03-21 07:47:15 Removing build area /tmp/rear.qgoq0Blk6OqdKfi
removed directory: `/tmp/rear.qgoq0Blk6OqdKfi'
2017-03-21 07:47:15 End of program reached
</pre>

<h4 id="jsmeix_commented_at_2017-03-21_1516"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288111565">2017-03-21 15:16</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-03-21_1516" title="Permanent link">&para;</a></h4>
<p>Too bad!<br />
Seems a rare case where ReaR errors out too picky.<br />
I will have a look tomorrorw (if time permits).<br />
In the future this should behave (hopefully) better,<br />
i.e. when I have implemented<br />
<a href="https://github.com/rear/rear/issues/1202#issuecomment-284377443">https://github.com/rear/rear/issues/1202#issuecomment-284377443</a></p>
<h4 id="gozora_commented_at_2017-03-21_1554"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288124265">2017-03-21 15:54</a>:<a class="headerlink" href="#gozora_commented_at_2017-03-21_1554" title="Permanent link">&para;</a></h4>
<p>@John-Leone</p>
<p>I don't like this:</p>
<pre><code>cp: `/lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic/cnic.ko' and `/tmp/rear.qgoq0Blk6OqdKfi/rootfs//lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic/cnic.ko' are the same file
</code></pre>
<p>Maybe some broken/relative symlinks?</p>
<p>how does
<code>ls -al /lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic/cnic.ko</code>
output looks like on your system?</p>
<p>V.</p>
<h4 id="john-leone_commented_at_2017-03-21_1612"><img src="https://avatars.githubusercontent.com/u/18706709?v=4" width="50"><a href="https://github.com/John-Leone">John-Leone</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288130641">2017-03-21 16:12</a>:<a class="headerlink" href="#john-leone_commented_at_2017-03-21_1612" title="Permanent link">&para;</a></h4>
<p>@gozora<br />
Here is the output:</p>
<pre>
[root@xrearm1d ~]# ls -al /lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic/cnic.ko
lrwxrwxrwx 1 root root 58 Mar 18 13:25 /lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic/cnic.ko -> /lib/modules/2.6.32-220.13.1.el6.x86_64/extra/cnic/cnic.ko
</pre>

<h4 id="gozora_commented_at_2017-03-21_1625"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288134803">2017-03-21 16:25</a>:<a class="headerlink" href="#gozora_commented_at_2017-03-21_1625" title="Permanent link">&para;</a></h4>
<p>Hmm, nothing strange about that ...<br />
can you run <code>rear -d -D mkrescue</code> and post created logfile from
/var/log/rear here?</p>
<h4 id="john-leone_commented_at_2017-03-21_1646"><img src="https://avatars.githubusercontent.com/u/18706709?v=4" width="50"><a href="https://github.com/John-Leone">John-Leone</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288141422">2017-03-21 16:46</a>:<a class="headerlink" href="#john-leone_commented_at_2017-03-21_1646" title="Permanent link">&para;</a></h4>
<p>@gozora<br />
Sure, I have attached the file.<br />
<a href="https://github.com/rear/rear/files/858952/rear-xrearm1d-log.txt">rear-xrearm1d-log.txt</a></p>
<h4 id="gozora_commented_at_2017-03-21_1735"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288158159">2017-03-21 17:35</a>:<a class="headerlink" href="#gozora_commented_at_2017-03-21_1735" title="Permanent link">&para;</a></h4>
<p>Thanks!<br />
Can you please show output of
<code>ls -al  /lib/modules/2.6.32-220.13.1.el6.x86_64/extra/cnic/cnic.ko</code> ?</p>
<h4 id="john-leone_commented_at_2017-03-21_1739"><img src="https://avatars.githubusercontent.com/u/18706709?v=4" width="50"><a href="https://github.com/John-Leone">John-Leone</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288159443">2017-03-21 17:39</a>:<a class="headerlink" href="#john-leone_commented_at_2017-03-21_1739" title="Permanent link">&para;</a></h4>
<p>@gozora<br />
Thanks for your help.</p>
<pre>
[root@xrearm1d ~]# ls -al /lib/modules/2.6.32-220.13.1.el6.x86_64/extra/cnic/cnic.ko
-rw-r--r-- 1 root root 1065518 May  9  2012 /lib/modules/2.6.32-220.13.1.el6.x86_64/extra/cnic/cnic.ko
</pre>

<h4 id="gozora_commented_at_2017-03-21_1934"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288193345">2017-03-21 19:34</a>:<a class="headerlink" href="#gozora_commented_at_2017-03-21_1934" title="Permanent link">&para;</a></h4>
<p>Really strange, I can't reproduce this error even with symlinks :-(.</p>
<p>Could you provide outputs from:</p>
<pre><code>df -h /tmp
ls -ald /tmp/rear.*/rootfs//lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic
la -al /tmp/rear.*/rootfs//lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic
</code></pre>
<p>Thanks</p>
<p>V.</p>
<h4 id="john-leone_commented_at_2017-03-21_2017"><img src="https://avatars.githubusercontent.com/u/18706709?v=4" width="50"><a href="https://github.com/John-Leone">John-Leone</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288204867">2017-03-21 20:17</a>:<a class="headerlink" href="#john-leone_commented_at_2017-03-21_2017" title="Permanent link">&para;</a></h4>
<p>@gozora Thanks again.</p>
<pre><code>[root@xrearm1d tmp]# df -h /tmp
Filesystem            Size  Used Avail Use% Mounted on
/dev/mapper/rootvg-tmp
                      7.8G  510M  7.3G   7% /tmp

[root@xrearm1d tmp]# ls -ald /tmp/rear.*/rootfs//lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic
drwxr-xr-x 2 root root 4096 Mar  6 17:16 /tmp/rear.DSMokqrzrKyZRrO/rootfs/lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic
[root@xrearm1d tmp]# ls -al /tmp/rear.*/rootfs//lib/modules/2.6.32-642.13.1.el6.x86_64/weak-updates/cnic
total 8
drwxr-xr-x 2 root root 4096 Mar  6 17:16 .
drwxr-xr-x 8 root root 4096 Mar  6 17:16 ..
lrwxrwxrwx 1 root root   58 Mar 21 12:35 cnic.ko -&gt; /lib/modules/2.6.32-220.13.1.el6.x86_64/extra/cnic/cnic.ko
</code></pre>
<h4 id="jsmeix_commented_at_2017-03-22_0910"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288339008">2017-03-22 09:10</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-03-22_0910" title="Permanent link">&para;</a></h4>
<p>In the ModulesCopyTo function in lib/linux-functions.sh<br />
I wonder about why there is "cp -a" used</p>
<pre>
cp $v -a -L "$1" "$dest/$dir" >&2
</pre>

<p>because '-a' is 'same as -dR --preserve=all'<br />
and '-d' is '--no-dereference --preserve=links'<br />
but '-L' is '--dereference' which contradicts '-d'<br />
and '-R' copies directories recursively<br />
where I wonder why that is needed?</p>
<p>I have the dim feeling the whole modules copying code<br />
may deserve some revision - at least I do not understand it.</p>
<p>@gozora<br />
do you understand the modules copying code?</p>
<h4 id="gozora_commented_at_2017-03-22_1116"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288368389">2017-03-22 11:16</a>:<a class="headerlink" href="#gozora_commented_at_2017-03-22_1116" title="Permanent link">&para;</a></h4>
<p>@jsmeix all I was trying yesterday was to find out why we have
<code>cp: are the same file</code> error, without actually looking at module
copying code.<br />
But looking at
<a href="https://github.com/rear/rear/issues/1253#issuecomment-288204867">https://github.com/rear/rear/issues/1253#issuecomment-288204867</a>
it looks like that some ReaR code did copy symlink
<code>/lib/modules/2.6.32-220.13.1.el6.x86_64/extra/cnic/cnic.ko</code> to ReaR
build area and some other code try to copy <code>cnic.ko</code> in next step which
caused <code>cp: are the same file</code>.<br />
I'll try to find guilty code later today.</p>
<p>V.</p>
<h4 id="john-leone_commented_at_2017-03-23_1406"><img src="https://avatars.githubusercontent.com/u/18706709?v=4" width="50"><a href="https://github.com/John-Leone">John-Leone</a> commented at <a href="https://github.com/rear/rear/issues/1253#issuecomment-288729773">2017-03-23 14:06</a>:<a class="headerlink" href="#john-leone_commented_at_2017-03-23_1406" title="Permanent link">&para;</a></h4>
<p>@gdha @jsmeix @gozora I was able to successfully complete a recovery in
the DMZ with local.conf using BACKUP_URL=file:///midrange/backups. As
recommended by gdha I added MODULES_LOAD=${MODULES_LOAD[@] fuse } to
local.conf but this doesn't work unless you "modprobe fuse" before you
run "rear mkbackup" then for sshfs to work I added
REQUIRED_PROGS=("${REQUIRED_PROGS[@]}" 'sshfs')<br />
Like I said before on the internal network we use
BACKUP_URL=sshfs://root@xxx.xxx.xxx.xxx/dbar/ and never have problems
with missing modules so I think it would be good if all the modules are
available in the recovery shell when BACKUP_URL=file is used in
local.conf</p>
<p>Thanks to everyone for helping.</p>
<p>[root@xrearm1d ~]# cat /etc/rear/local.conf<br />
OUTPUT=ISO<br />
BACKUP=NETFS<br />
OUTPUT_URL=file:///midrange/backups<br />
BACKUP_URL=file:///midrange/backups<br />
BACKUP_PROG_EXCLUDE=("${BACKUP_PROG_EXCLUDE[@]}" '/u01' '/u02'
'/u03')<br />
MODULES_LOAD=${MODULES_LOAD[@] fuse }<br />
REQUIRED_PROGS=("${REQUIRED_PROGS[@]}" 'sshfs')</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2017-03-18.1253.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
