<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2695 Issue closed: RFC: No longer hardcoded enforced Error() exit - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2695 Issue closed: RFC: No longer hardcoded enforced Error() exit";
        var mkdocs_page_input_path = "issues/2021-10-12.2695.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2695 Issue closed: RFC: No longer hardcoded enforced Error() exit</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2695_issue_closed_rfc_no_longer_hardcoded_enforced_error_exit"><a href="https://github.com/rear/rear/issues/2695">#2695 Issue</a> <code>closed</code>: RFC: No longer hardcoded enforced Error() exit<a class="headerlink" href="#2695_issue_closed_rfc_no_longer_hardcoded_enforced_error_exit" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>discuss / RFC</code>, <code>severe improvement</code></p>
<h4 id="jsmeix_opened_issue_at_2021-10-12_1111"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> opened issue at <a href="https://github.com/rear/rear/issues/2695">2021-10-12 11:11</a>:<a class="headerlink" href="#jsmeix_opened_issue_at_2021-10-12_1111" title="Permanent link">&para;</a></h4>
<p>Currently Error() exits the whole running rear program with all its
child processes.</p>
<p>This is right in particular during "rear mkrescue/mkbackup",<br />
cf. "better abort than to blindly proceed" in the section<br />
"Try hard to care about possible errors" in<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a></p>
<p>But during "rear recover" things could be different, cf.<br />
<a href="https://github.com/rear/rear/pull/2691#discussion_r726997737">https://github.com/rear/rear/pull/2691#discussion_r726997737</a></p>
<p>Currently we do not Error() exit the whole ReaR in case of errors<br />
after the backup was restored (e.g. errors during bootloader
installation), cf.<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/finalize/Linux-i386/660_install_grub2.sh">https://github.com/rear/rear/blob/master/usr/share/rear/finalize/Linux-i386/660_install_grub2.sh</a></p>
<pre><code># This script does not error out because at this late state of "rear recover"
# (i.e. after the backup was restored) I &lt;jsmeix@suse.de&gt; consider it too hard
# to abort "rear recover" when it failed to install GRUB2 because in this case
# the user gets an explicit WARNING via finalize/default/890_finish_checks.sh
# so that after "rear recover" finished he can manually install the bootloader
# as appropriate for his particular system.
</code></pre>
<p>Because restoring the backup could be rather time consuming task,<br />
Error() exit the whole ReaR in case of errors after the backup was
restored<br />
makes all what was recreated and restored up to that point useless<br />
and the user is forced to redo all that from the very beginning<br />
provided he had a good idea how to avoid that Error() exit,<br />
otherwise he would be lost in a "retry and Error() exit" loop.</p>
<p>I think it could be basically always wrong to<br />
exit the whole ReaR during "rear recover" because<br />
that results basically always bad UX for the user.<br />
I think exit the whole ReaR during "rear recover" is basically<br />
never helpful for the user - what should he do in that case?<br />
In contrast clear ERROR messages during "rear recover"<br />
with the option to proceed (cf. "Final power to the user!")<br />
may help the user to shomehow finish "rear recover"<br />
(even with some things that are not recreated right).<br />
Then he may fix the issues that lead to the error messages<br />
or deliberately ignore them, reboot, and hope for the best.<br />
When errors are actually fatal deliberately ignoring them<br />
would let the recovery fatally fail but for the user<br />
that is not as bad as being kicked out from recovery<br />
in any case by a hardcoded enforced Error() exit.</p>
<p>So I suggest to enhance the Error() function<br />
to no longer exit the whole ReaR during "rear recover"<br />
but only show the ERROR message and a user dialog<br />
whether to abort or proceed "bona fide" regardless of the error.</p>
<h4 id="pcahyna_commented_at_2021-10-12_1711"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2695#issuecomment-941207223">2021-10-12 17:11</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-10-12_1711" title="Permanent link">&para;</a></h4>
<p>I have two remarks:</p>
<blockquote>
<p>Because restoring the backup could be rather time consuming task,<br />
Error() exit the whole ReaR in case of errors after the backup was
restored<br />
makes all what was recreated and restored up to that point useless</p>
</blockquote>
<p>note that while the issue seems to be inspired by the behavior discussed
in #2691 (aborting the whole program from inside the generated layout
script), the reasoning above does not apply to it, because the layout
script runs before restoring the backup, so no time-consuming task has
been performed yet.</p>
<blockquote>
<p>So I suggest to enhance the Error() function<br />
to no longer exit the whole ReaR during "rear recover"<br />
but only show the ERROR message and a user dialog<br />
whether to abort or proceed "bona fide" regardless of the error.</p>
</blockquote>
<p>I think the reasoning does not necessarily apply to the <code>BugError()</code>
calls, because they are essentially asserts for conditions that should
never happen and if they are encountered, it is serious. This would
require separating <code>BugError()</code> from <code>Error()</code>, though.</p>
<h4 id="jsmeix_commented_at_2021-10-15_1128"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2695#issuecomment-944223815">2021-10-15 11:28</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-10-15_1128" title="Permanent link">&para;</a></h4>
<p>@pcahyna<br />
I do not see why BugError is actually different from Error.<br />
Both are just errors.<br />
How severe an error is does not depend on<br />
if it is a BugError or an Error.</p>
<p>BugError only additionally indicates the root cause is a bug in ReaR.<br />
Error does not do that.<br />
Its root cause could still be a bug in ReaR (e.g. in some script
before)<br />
or a bug in whatever program that is called by ReaR<br />
or a normal error where the user is responsible.</p>
<p>Think about BugError in some non-essential functionality<br />
(non-essential for the user's specific use case)<br />
versus Error during essential functionality.</p>
<p>E.g. think about a BugError when recreating a swap partition<br />
versus an Error when recreating a '/home' partition<br />
versus an Error when recreating the root '/' partition.</p>
<p>A recreated system without swap or /home partition<br />
could be acceptable for the user (better a somewhat running system<br />
without swap or with /home in the root partition than no system at all<br />
and later when there is time for it the user can fix things).</p>
<p>What I have in mind is the following use case or "user story":</p>
<p>When the user runs "rear recover" for an actual real disaster recovery<br />
then all is already lost for his original system he tries to recreate.</p>
<p>His original system is lost.<br />
What could go more wrong for him when he can ignore errors<br />
during "rear recover" and proceed "bona fide"?<br />
His original system won't get any bit more lost<br />
when "rear recover" terribly fails after he ignored errors.<br />
His replacement hardware will be (re-)installed from scratch.<br />
Whatever there was on his replacement hardware is basically lost<br />
as soon as "rear recover" did run diskrestore.sh at least partially.<br />
His replacement hardware shoudn't get damaged<br />
when "rear recover" terribly fails fails after he ignored errors.</p>
<p>What does an enforced error exit during "rear recover"<br />
(enforced by us on the user because we hardcoded the exit "for him")<br />
actually help the user to somehow get his lost system back<br />
(perhaps somewhat incomplete but at least partially usable)<br />
compared to only show the ERROR message and a user dialog<br />
whether to abort or proceed "bona fide" regardless of the error<br />
so we give the user final power to decide what he wants to do<br />
in his particular case in his specific error situation?</p>
<h4 id="jsmeix_commented_at_2021-10-15_1135"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2695#issuecomment-944227279">2021-10-15 11:35</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-10-15_1135" title="Permanent link">&para;</a></h4>
<p>Ha!<br />
Simple solution:</p>
<p>Have a new config variable that specifies<br />
if Error (and BugError) should exit<br />
or Error (and BugError) should<br />
only show the ERROR message and a user dialog<br />
whether to abort or proceed "bona fide" regardless of the error.</p>
<p>If this config variable is unset we could have any default we like<br />
e.g. error exit during "rear mkrescue/mkbackup/..."<br />
but error exit dialog during "rear recover" or anything else as we like.</p>
<p>For example when this config variable is empty or unset<br />
we could during "rear recover" error exit until the backup gets
restored<br />
and switch to "user dialog abort/proceed" before the backup gets
restored<br />
or after the backup was restored as we think what is best by default.<br />
Or this config variable could be an array that could contain those<br />
workflow names and/or stage names where "user dialog abort/proceed"<br />
should happen.</p>
<p>The crucial point is that such a config variable or array<br />
provides final power to the user.</p>
<h4 id="jsmeix_commented_at_2021-10-22_0733"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2695#issuecomment-949366089">2021-10-22 07:33</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-10-22_0733" title="Permanent link">&para;</a></h4>
<p>As always there are exceptions:<br />
There is at least one exception where the user must never ever<br />
ignore errors during "rear recover" and proceed "bona fide":<br />
<a href="https://github.com/rear/rear/pull/2626">https://github.com/rear/rear/pull/2626</a><br />
"Stop ReaR from overwriting its own disk and backup drives"</p>
<p>The solution to that is to use the above mentioned<br />
config variable with ternary semantics like:</p>
<pre><code># Always let Error() exit the whole running rear program:
ERROR_WITHOUT_EXIT=( no )
# Never let Error() exit the whole running rear program:
ERROR_WITHOUT_EXIT=( yes )
# Do not let Error() exit the whole running rear program during
# the whole recover workflow,
# the restore and wrapup stages (used in the restoreonly workflow),
# the backup stage (used in the mkbackup and mkbackuponly workflows):
ERROR_WITHOUT_EXIT=( recover restore wrapup backup )
</code></pre>
<p>and set <code>ERROR_WITHOUT_EXIT=( no )</code><br />
before Error() is called to<br />
"Stop ReaR from overwriting its own disk and backup drives"</p>
<h4 id="github-actions_commented_at_2021-12-22_0222"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2695#issuecomment-999232948">2021-12-22 02:22</a>:<a class="headerlink" href="#github-actions_commented_at_2021-12-22_0222" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="github-actions_commented_at_2022-02-21_0209"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2695#issuecomment-1046402922">2022-02-21 02:09</a>:<a class="headerlink" href="#github-actions_commented_at_2022-02-21_0209" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="jsmeix_commented_at_2022-02-28_0838"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2695#issuecomment-1054016005">2022-02-28 08:38</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-02-28_0838" title="Permanent link">&para;</a></h4>
<p>Not for the next ReaR version<br />
but perhaps after the next ReaR version was released.</p>
<h4 id="github-actions_commented_at_2022-04-30_0306"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2695#issuecomment-1113900455">2022-04-30 03:06</a>:<a class="headerlink" href="#github-actions_commented_at_2022-04-30_0306" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="github-actions_commented_at_2022-07-02_0330"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2695#issuecomment-1172824755">2022-07-02 03:30</a>:<a class="headerlink" href="#github-actions_commented_at_2022-07-02_0330" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2021-10-12.2695.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
