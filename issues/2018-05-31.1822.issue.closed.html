<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1822 Issue closed: Restore from burned ISO fails at or soon after "Running mkinitrd..." - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1822 Issue closed: Restore from burned ISO fails at or soon after \"Running mkinitrd...\"";
        var mkdocs_page_input_path = "issues/2018-05-31.1822.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1822 Issue closed: Restore from burned ISO fails at or soon after "Running mkinitrd..."</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1822_issue_closed_restore_from_burned_iso_fails_at_or_soon_after_running_mkinitrd"><a href="https://github.com/rear/rear/issues/1822">#1822 Issue</a> <code>closed</code>: Restore from burned ISO fails at or soon after "Running mkinitrd..."<a class="headerlink" href="#1822_issue_closed_restore_from_burned_iso_fails_at_or_soon_after_running_mkinitrd" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="exedor_opened_issue_at_2018-05-31_1655"><img src="https://avatars.githubusercontent.com/u/6391864?u=f29593e509021c433bdf23c37efbe71f8ced8a6e&v=4" width="50"><a href="https://github.com/exedor">exedor</a> opened issue at <a href="https://github.com/rear/rear/issues/1822">2018-05-31 16:55</a>:<a class="headerlink" href="#exedor_opened_issue_at_2018-05-31_1655" title="Permanent link">&para;</a></h4>
<p>Hello, I posted this a while back under issue #1592. I tried to reopen
that one but couldn't. I'm still having the same problem even with the
latest versions. It works on one of my platforms, but not on the rest of
them. I'm happy to do what it takes to track down the problem, but there
doesn't seem to be much info in the log files. It was suggested that I
use an alternate "window" (I'm assuming that meant linux virtual
console) while it is running. I tired switching to another virtual
console when the restore hangs, but either none were active or the OS
wouldn't let me do it at that time. If I hit Ctrl-C, it does stop and
then try to run mkinitrd again but just immediately hangs at that step.
If I hit Ctrl-C a second time, it finishes, but will not finish booting
after the reboot.</p>
<p>Relax-and-Recover (ReaR) Issue Template<br />
Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<p>rear version (/usr/sbin/rear -V): 2.1 through latest github</p>
<p>OS version (cat /etc/rear/os.conf or lsb_release -a): Fedora 26</p>
<p>rear configuration files (cat /etc/rear/site.conf or cat
/etc/rear/local.conf):<br />
/etc/rear/local.conf:</p>
<pre>
OUTPUT=ISO
BACKUP=NETFS
BACKUP_URL=iso://backup
OUTPUT_URL=file:///home/exedor/images/
ISO_MAX_SIZE=4400
BACKUP_PROG_EXCLUDE=( "${BACKUP_PROG_EXCLUDE[@]}"
'/backup'
'/home/exedor/images' )
COPY_AS_IS_EXCLUDE=( ${copy_as_is_exclude[@]}
'/backup'
'/home/exedor/images' )
</pre>

<p>Are you using legacy BIOS or UEFI boot?<br />
Legacy BIOS</p>
<p>Brief description of the issue:<br />
The ISO image is created. When I burn it to disk and then try and use
it, the restore process gets to "Running mkinitrd..." and then gets
stuck and does not proceed. There is no activity of any kind from system
LEDs. It just gets stuck. I left it that way for a half hour, just to be
sure.</p>
<p>Work-around, if any:<br />
USB backup and restore works flawlessly so right now, that's the work
around but I would really like to get the ISO working. I'm pretty sure
it's hardware platform dependent. I have this problem on both a Gigabyte
GA-Q170M-D3H-GSM motherboard and an ASUS Prime H270M-PLUS.</p>
<h4 id="jsmeix_commented_at_2018-06-05_1344"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1822#issuecomment-394714066">2018-06-05 13:44</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-06-05_1344" title="Permanent link">&para;</a></h4>
<p>@exedor<br />
without a "rear -d -D recover" debug log file<br />
(at least the whole content after "Running mkinitrd...")<br />
we cannot know what goes on on your particular system<br />
in your particular environment, cf.<br />
<a href="https://github.com/rear/rear/issues/1592#issuecomment-346265248">https://github.com/rear/rear/issues/1592#issuecomment-346265248</a></p>
<p>See "Debugging issues with Relax-and-Recover" at<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>I don't know what<br />
<code>rear version (/usr/sbin/rear -V): 2.1 through latest github</code><br />
actually is.</p>
<p>I recommend to use our current ReaR upstream GitHub master code<br />
because that is the only place where we fix bugs - i.e. bugs in older<br />
ReaR versions are not fixed by us (i.e. by ReaR upstream).<br />
Bugs in older ReaR versions that got fixed in current ReaR upstream<br />
GitHub master code might be fixed (if the fix can be backported)<br />
by the Linux distributor wherefrom you got your older ReaR version.</p>
<p>To use our current ReaR upstream GitHub master code<br />
do the following:</p>
<p>Basically "git clone" it into a separated directory and then<br />
configure and run ReaR from within that directory like:</p>
<pre>
# git clone https://github.com/rear/rear.git

# mv rear rear.github.master

# cd rear.github.master

# vi etc/rear/local.conf

# usr/sbin/rear -D mkbackup
</pre>

<p>Note the relative paths "etc/rear/" and "usr/sbin/".</p>
<h4 id="jsmeix_commented_at_2018-06-05_1408"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1822#issuecomment-394722955">2018-06-05 14:08</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-06-05_1408" title="Permanent link">&para;</a></h4>
<p>@exedor<br />
in current ReaR there is the config variable REBUILD_INITRAMFS, see<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L2326">https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L2326</a><br />
so that with <code>REBUILD_INITRAMFS="no"</code> you could explicitly skip<br />
rebuilding the initramfs/initrd as a workaround for this issue.<br />
When you do "rear recover" on fully compatible hardware it often works<br />
without rebuilding the initramfs/initrd - then the initramfs/initrd<br />
that was restored form the backup gets used (i.e. the exact same<br />
initramfs/initrd that was used on the original system).</p>
<h4 id="jsmeix_commented_at_2018-06-11_1257"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1822#issuecomment-396233862">2018-06-11 12:57</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-06-11_1257" title="Permanent link">&para;</a></h4>
<p>@exedor<br />
because of your "thumbs up" emoji I assume<br />
the issue is sufficiently fixed for your particular case<br />
so that I close it hereby.<br />
It can be reopened if this particular issue is not yet fixed.<br />
But new separated issues should be reported separatedly.</p>
<h4 id="exedor_commented_at_2018-06-11_1632"><img src="https://avatars.githubusercontent.com/u/6391864?u=f29593e509021c433bdf23c37efbe71f8ced8a6e&v=4" width="50"><a href="https://github.com/exedor">exedor</a> commented at <a href="https://github.com/rear/rear/issues/1822#issuecomment-396304632">2018-06-11 16:32</a>:<a class="headerlink" href="#exedor_commented_at_2018-06-11_1632" title="Permanent link">&para;</a></h4>
<p>No, not fixed. The thumbs up was that there was even a work-around
available. Nevertheless, I do need to resolve the problem because I do
restores to multiple platforms and the initrd generated for one doesn't
work on the others.</p>
<p>I tried the latest git, but couldn't use it because it currently isn't
resizing properly when restored into drives smaller than the original
used to create the backup.</p>
<p>Sorry for the confusion. By "2.1 through latest github" I meant the
affected rear versions are 2.1 through latest on github (or at least the
latest usable.) I am currently running 2.3-1 stable RPM.</p>
<p>I'll get a log file and update the ticket.</p>
<h4 id="jsmeix_commented_at_2018-06-12_0726"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1822#issuecomment-396492635">2018-06-12 07:26</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-06-12_0726" title="Permanent link">&para;</a></h4>
<p>@exedor<br />
we (i.e. at ReaR upstream) won't fix issues in released ReaR versions<br />
so that you basically must use our current ReaR upstream GitHub master
code<br />
if you like to get things properly fixed by us here.</p>
<p>I cannot understand what you mean with "currently isn't resizing
properly<br />
when restored into drives smaller than the original used" because<br />
I intentionally made major changes to the partition resizing code<br />
in current ReaR upstream GitHub master code to avoid really bad<br />
automated resizing results that had happened before, see<br />
<a href="https://github.com/rear/rear/issues/1731">https://github.com/rear/rear/issues/1731</a><br />
<a href="https://github.com/rear/rear/pull/1733">https://github.com/rear/rear/pull/1733</a><br />
<a href="https://github.com/rear/rear/issues/102">https://github.com/rear/rear/issues/102</a></p>
<p>For a summary see the ReaR 2.4 release notes<br />
<a href="https://github.com/rear/rear.github.com/blob/master/documentation/release-notes-2-4.md">https://github.com/rear/rear.github.com/blob/master/documentation/release-notes-2-4.md</a><br />
that read (excerpts)</p>
<pre>
Version 2.4 (June 2018)
...
New features, bigger enhancements, and possibly backward incompatible changes:

Major rework and changed default behaviour how ReaR behaves
in migration mode when partitions can or must be resized
to fit on replacement disks with different size.
The new default behaviour is that only the partition end value
of the last partition on a disk (and therefore its partition size)
may get changed if really needed but no partition start value
gets changed to avoid changes of the partition alignment.
The new 420_autoresize_last_partitions script implements
the new behaviour and the old 400_autoresize_disks was
renamed into 430_autoresize_all_partitions to still provide
the old behaviour if that is explicitly requested by the user
but the old behaviour may result unexpected changes of
arbitrary partitions on a disk.
The new config variables
AUTORESIZE_PARTITIONS
AUTORESIZE_EXCLUDE_PARTITIONS
AUTOSHRINK_DISK_SIZE_LIMIT_PERCENTAGE
AUTOINCREASE_DISK_SIZE_THRESHOLD_PERCENTAGE
determine how ReaR behaves in migration mode
when partitions can or must be resized.
With AUTORESIZE_PARTITIONS='yes' the old behaviour is done.
With AUTORESIZE_PARTITIONS='no' no partition is resized by ReaR.
With the default AUTORESIZE_PARTITIONS='' at most the last active
partition on each active disk gets resized but only if really needed which
also depends on the settings of the other config variables above.
For details see default.conf and the two 'autoresize' scripts.
For some examples see
https://github.com/rear/rear/pull/1733
</pre>

<p>If you are unable to make partition resizing work as you need it<br />
with our current ReaR upstream GitHub master code and<br />
(as needed) with the new config variables<br />
AUTORESIZE_PARTITIONS<br />
AUTORESIZE_EXCLUDE_PARTITIONS<br />
AUTOSHRINK_DISK_SIZE_LIMIT_PERCENTAGE<br />
AUTOINCREASE_DISK_SIZE_THRESHOLD_PERCENTAGE<br />
things must be fixed in our current ReaR upstream GitHub master code.</p>
<h4 id="jsmeix_commented_at_2018-07-17_0840"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1822#issuecomment-405505923">2018-07-17 08:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-07-17_0840" title="Permanent link">&para;</a></h4>
<p>@exedor<br />
regarding your<br />
<a href="https://github.com/rear/rear/issues/1822#issuecomment-396304632">https://github.com/rear/rear/issues/1822#issuecomment-396304632</a><br />
where you wrote</p>
<pre>
I do restores to multiple platforms and the initrd generated
for one doesn't work on the others
</pre>

<p>In general this does not work and is not supported by ReaR<br />
where "not supported" means here that ReaR is not intended<br />
to make this "just work".</p>
<p>In general migrating a system onto different hardware<br />
does not "just work", cf. "Inappropriate expectations" at<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>On the other hand ReaR supports to migrate a system onto different
hardware<br />
but here "supports" means that ReaR provides a lot that should help
you<br />
to get such a task done but it does not mean that it would "just work"
without<br />
possibly laborious manual settings and adaptions with trial and error
legwork<br />
until you made things work for you in your particular case.</p>
<p>ReaR could be too laborious to migrate a single system onto different
hardware.<br />
I think in this case a new installation from scratch is perhaps
easier.<br />
But when you have to migrate many old systems onto new (different)
hardware<br />
where the new hardware is basically same for all those systems, then
ReaR<br />
could help you a lot to somewhat automate such a migration.</p>
<p>In general it does not work when you made the recovery ISO image<br />
on one kind of machine and try to use that on another kind of machine.<br />
In general it does not work to boot or use a ReaR recovery system<br />
that was created on one kind of machine on another kind of machine.</p>
<p>In general the ReaR recovery system is specific for the machine<br />
where it was created, see the section<br />
"Fully compatible replacement hardware is needed" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>When you intend to recreate a system on a different platform<br />
you do a migration - i.e. you use ReaR in its migration mode.</p>
<p>To make the ReaR recovery system work on different hardware<br />
you should at least have all kernel modules and firmware files<br />
included in the ReaR recovery system, cf. the sections about<br />
MODULES and FIRMWARE_FILES in usr/share/rear/conf/default.conf</p>
<p>I never tried but I think things will not at all work when you change<br />
the way how the system boots for example from BIOS to UEFI, cf.<br />
<a href="https://github.com/rear/rear/issues/1437">https://github.com/rear/rear/issues/1437</a></p>
<p>In general regarding migrating a system you may have a look at<br />
<a href="http://lists.relax-and-recover.org/pipermail/rear-users/2018-February/003528.html">http://lists.relax-and-recover.org/pipermail/rear-users/2018-February/003528.html</a><br />
and follow the links therein.</p>
<h4 id="jsmeix_commented_at_2018-09-28_0726"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1822#issuecomment-425347102">2018-09-28 07:26</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-09-28_0726" title="Permanent link">&para;</a></h4>
<p>I assume things were sufficiently explained.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2018-05-31.1822.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
