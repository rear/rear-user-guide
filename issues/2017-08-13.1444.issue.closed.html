<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1444 Issue closed: Not able to recover encypted OS - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1444 Issue closed: Not able to recover encypted OS";
        var mkdocs_page_input_path = "issues/2017-08-13.1444.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rsync.html">External Backup using BACKUP=RSYNC method</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/duplicity.html">External Backup using duplicity</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1444 Issue closed: Not able to recover encypted OS</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1444_issue_closed_not_able_to_recover_encypted_os"><a href="https://github.com/rear/rear/issues/1444">#1444 Issue</a> <code>closed</code>: Not able to recover encypted OS<a class="headerlink" href="#1444_issue_closed_not_able_to_recover_encypted_os" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="metro1234_opened_issue_at_2017-08-13_1712"><img src="https://avatars.githubusercontent.com/u/26995144?v=4" width="50"><a href="https://github.com/metro1234">metro1234</a> opened issue at <a href="https://github.com/rear/rear/issues/1444">2017-08-13 17:12</a>:<a class="headerlink" href="#metro1234_opened_issue_at_2017-08-13_1712" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>rear version (/usr/sbin/rear -V): 1.17.2</li>
<li>OS version (cat /etc/rear/os.conf or lsb_release -a):Redhat 7.2</li>
<li>rear configuration files (cat /etc/rear/site.conf or cat
    /etc/rear/local.conf):</li>
</ul>
<pre>
OUTPUT=ISO
OUTPUT_URL=nfs://192.168.56.1/storage
BACKUP=NETFS
BACKUP_URL=nfs://192.168.56.1/storage
BACKUP_PROG_EXCLUDE=("${BACKUP_PROG_EXCLUDE[@]}" '/media' '/var/tmp' '/var/crash')
NETFS_KEEP_OLD_BACKUP_COPY=
</pre>

<ul>
<li>Are you using legacy BIOS or UEFI boot?<br />
    BIOS</li>
<li>Brief description of the issue:</li>
</ul>
<p>OS Is encrypted with luks.</p>
<p>I have tried to restore using below command<br />
rear -v recover</p>
<p>Asked Passphrase of key (Encryption key) and entered correct password</p>
<p>and it failed for layout recreation</p>
<p>log file error:</p>
<pre>
cryptsetup luksFormat -q --cipher aeAn error occured s-xts-plain64 --hash sha1 --uuid efd9xxxxxxxxxx /dev/sda5/
Password quality check failed:
The password fails the directory check -error loading dictionary
an error occurred during layout recreation
</pre>

<ul>
<li>Work-around, if any: I did not found any work arround</li>
</ul>
<h4 id="metro1234_commented_at_2017-08-20_1253"><img src="https://avatars.githubusercontent.com/u/26995144?v=4" width="50"><a href="https://github.com/metro1234">metro1234</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-323583259">2017-08-20 12:53</a>:<a class="headerlink" href="#metro1234_commented_at_2017-08-20_1253" title="Permanent link">&para;</a></h4>
<p>Hi Team,</p>
<p>Is it a bug or I am doing anything wrong configuration?.</p>
<p>Below are few more test results:</p>
<ol>
<li>Tried with latest 2.2.X version and not able to restore</li>
<li>Tried only with one file system encrypt (/project) and not able to
    restore</li>
</ol>
<h4 id="gozora_commented_at_2017-08-20_1622"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-323595576">2017-08-20 16:22</a>:<a class="headerlink" href="#gozora_commented_at_2017-08-20_1622" title="Permanent link">&para;</a></h4>
<p>Hi @metro1234,</p>
<p>I doubt that this is your fault.<br />
Just from plain looking at your error:</p>
<pre><code>cryptsetup luksFormat -q --cipher aeAn error occured s-xts-plain64 --hash sha1 --uuid efd9xxxxxxxxxx /dev/sda5/
</code></pre>
<p>It looks that something went wrong during <code>rear mkbackup</code>.</p>
<p>It would be interesting to see following files</p>
<ol>
<li><em>/var/lib/rear/layout/disklayout.conf</em> from your original system</li>
<li><em>/var/log/rear/rear-&lt;hostname&gt;.log</em> created during
    <code>rear -d -D recover</code> session</li>
</ol>
<p>Can you please provide these two files?</p>
<p>Thanks</p>
<p>V.</p>
<h4 id="metro1234_commented_at_2017-08-22_0556"><img src="https://avatars.githubusercontent.com/u/26995144?v=4" width="50"><a href="https://github.com/metro1234">metro1234</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-323926794">2017-08-22 05:56</a>:<a class="headerlink" href="#metro1234_commented_at_2017-08-22_0556" title="Permanent link">&para;</a></h4>
<p>Hi Gozora,</p>
<p>/var/lib/rear/layout/disklayout.conf</p>
<pre><code># Disk /dev/sda
# Format: disk &lt;devname&gt; &lt;size(bytes)&gt; &lt;partition label type&gt;
disk /dev/sda 42949672960 msdos
# Partitions on /dev/sda
# Format: part &lt;device&gt; &lt;partition size(bytes)&gt; &lt;partition start(bytes)&gt; &lt;partition type|name&gt; &lt;flags&gt; /dev/&lt;partition&gt;
part /dev/sda 511705088 1048576 primary boot /dev/sda1
part /dev/sda 10001317888 512753664 primary none /dev/sda2
part /dev/sda 10001317888 10514071552 primary none /dev/sda3
part /dev/sda 1024 20515389440 extended none /dev/sda4
part /dev/sda 1999634432 20516438016 logical none /dev/sda5
# Filesystems (only ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs are supported).
# Format: fs &lt;device&gt; &lt;mountpoint&gt; &lt;fstype&gt; [uuid=&lt;uuid&gt;] [label=&lt;label&gt;] [&lt;attributes&gt;]
fs /dev/mapper/luks-3828ec1d-fe65-4ffe-a09c-dff15b0fb3d7 / xfs uuid=cacafb5f-b6a0-46f6-a126-a13f4d7aa9ab label=root  options=rw,relatime,attr2,inode64,noquota
fs /dev/mapper/luks-a6fed55d-e3ae-4e45-8115-6dbfd343a70e /data1 xfs uuid=93ef016b-4423-4c60-8c55-f34e820fc445 label=data1  options=rw,relatime,attr2,inode64,noquota
fs /dev/sda1 /boot xfs uuid=b3dd4c45-848d-4e32-9f7e-3b8732e4d992 label=  options=rw,relatime,attr2,inode64,noquota
# Swap partitions or swap files
# Format: swap &lt;filename&gt; uuid=&lt;uuid&gt; label=&lt;label&gt;
swap /dev/sda5 uuid=0d62fd69-3ea8-4533-acb4-413e0f17176f label=
crypt /dev/mapper/luks-a6fed55d-e3ae-4e45-8115-6dbfd343a70e /dev/sda3 cipher=aes mode=xts-plain64 hash=sha1 uuid=a6fed55d-e3ae-4e45-8115-6dbfd343a70e
crypt /dev/mapper/luks-3828ec1d-fe65-4ffe-a09c-dff15b0fb3d7 /dev/sda2 cipher=aes mode=xts-plain64 hash=sha1 uuid=3828ec1d-fe65-4ffe-a09c-dff15b0fb3d7
</code></pre>
<p>/var/log/rear/rear-<hostname>.log created during rear -d -D recover
session is attached<br />
<a href="https://github.com/rear/rear/files/1240963/rear-reartest.zip">rear-reartest.zip</a></p>
<p>Thanks</p>
<h4 id="gozora_commented_at_2017-08-22_0619"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-323930299">2017-08-22 06:19</a>:<a class="headerlink" href="#gozora_commented_at_2017-08-22_0619" title="Permanent link">&para;</a></h4>
<p>@metro1234,</p>
<p>At first glance I don't see anything wrong neither in disklayout.conf
nor in log file.<br />
I'd need to install similar setup to yours and try to reproduce your
problem.</p>
<p>V.</p>
<h4 id="gozora_commented_at_2017-08-22_1324"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324024844">2017-08-22 13:24</a>:<a class="headerlink" href="#gozora_commented_at_2017-08-22_1324" title="Permanent link">&para;</a></h4>
<p>@metro1234</p>
<p>I just successfully finished ReaR (2.2) restore of Centos 7.3, with
setup similar to yours:</p>
<pre><code># Disk /dev/sda
# Format: disk &lt;devname&gt; &lt;size(bytes)&gt; &lt;partition label type&gt;
disk /dev/sda 8589934592 msdos
# Partitions on /dev/sda
# Format: part &lt;device&gt; &lt;partition size(bytes)&gt; &lt;partition start(bytes)&gt; &lt;partition type|name&gt; &lt;flags&gt; /dev/&lt;partition&gt;
part /dev/sda 209715200 1048576 primary boot /dev/sda1
part /dev/sda 5368709120 210763776 primary none /dev/sda2
part /dev/sda 2936012800 5579472896 primary none /dev/sda3
part /dev/sda 1024 8515485696 extended none /dev/sda4
part /dev/sda 73400320 8516534272 logical none /dev/sda5
# Filesystems (only ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs are supported).
# Format: fs &lt;device&gt; &lt;mountpoint&gt; &lt;fstype&gt; [uuid=&lt;uuid&gt;] [label=&lt;label&gt;] [&lt;attributes&gt;]
fs /dev/mapper/Cdata1 /data1 xfs uuid=8e9e5841-9f8d-4de0-85fb-184143874484 label=  options=rw,relatime,attr2,inode64,noquota
fs /dev/mapper/luks-0ef6a905-e6a2-4a3d-92ab-caa541f9306a / xfs uuid=9a819074-d24c-477d-804e-6e7edbae8305 label=  options=rw,relatime,attr2,inode64,noquota
fs /dev/sda1 /boot ext3 uuid=c90282da-c159-45d9-85d4-6869e265f26d label= blocksize=1024 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=4096 default_mount_options=user_xattr,acl options=rw,relatime,data=ordered
# Swap partitions or swap files
# Format: swap &lt;filename&gt; uuid=&lt;uuid&gt; label=&lt;label&gt;
swap /dev/sda5 uuid=5d0a9255-f0b8-408d-8a30-86fbaa2be704 label=
crypt /dev/mapper/Cdata1 /dev/sda3 cipher=aes mode=xts-plain64 hash=sha256 uuid=acd42bd9-53d0-41b5-8d31-f03d320d2b75
crypt /dev/mapper/luks-0ef6a905-e6a2-4a3d-92ab-caa541f9306a /dev/sda2 cipher=aes mode=xts-plain64 hash=sha256 uuid=0ef6a905-e6a2-4a3d-92ab-caa541f9306a
</code></pre>
<p>Your problem is rather simple to solve.<br />
Prompt for password you see after launch of <code>rear recover</code> is not asking
you for password you've used prior <code>rear recover</code>, but for NEW password
that will be set on newly created partitions for encryption. (which just
give perfect sense, if you think about it ...)<br />
So all you have to do is enter (and later re-enter) some STRONG password
that will be accepted by password quality check of cryptsetup ...<br />
Once <code>rear recover</code> finishes, you will use this password to decrypt
restored partitions (a.k.a boot ;-) ).</p>
<p>V.</p>
<h4 id="schlomo_commented_at_2017-08-22_1409"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324038017">2017-08-22 14:09</a>:<a class="headerlink" href="#schlomo_commented_at_2017-08-22_1409" title="Permanent link">&para;</a></h4>
<p>Thanks @gozora for trying out that setup.</p>
<p>What about <code>error loading dictionary</code>? Can it be that <code>cryptsetup</code> wants
to check the quality of the passphrase with the help of an external
tool?</p>
<p>Can it be that we need to improve the user guidance in ReaR so that it
will show the user a short help text before running <code>cryptsetup</code>?</p>
<p>Maybe we should also actively handle the case that <code>cryptsetup</code> fails
due to bad user input, maybe show the <code>crypsetup</code> error to the user and
give him a chance to try again?</p>
<h4 id="gozora_commented_at_2017-08-22_1558"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324071821">2017-08-22 15:58</a>:<a class="headerlink" href="#gozora_commented_at_2017-08-22_1558" title="Permanent link">&para;</a></h4>
<p>Hi @schlomo,</p>
<blockquote>
<p>Thanks @gozora for trying out that setup.</p>
</blockquote>
<p>No problem, I was curious about how ReaR works with LUKS ...</p>
<blockquote>
<p>What about error loading dictionary? Can it be that cryptsetup wants
to check the quality of the passphrase with the help of an external
tool?</p>
</blockquote>
<p>I have no idea where this is coming from ... Maybe missing cracklib ? I
really can't tell unless I have more information ...</p>
<blockquote>
<p>Can it be that we need to improve the user guidance in ReaR so that it
will show the user a short help text before running cryptsetup?</p>
</blockquote>
<p>Today it was first time in my life I've was configuring LUKS. I must say
that neither configuring LUKS nor ReaR was "brain surgery or rocket
science". So I'd conclude that if user have some basic understanding how
LUKS works, he can handle such setups + basic troubleshooting.</p>
<blockquote>
<p>Maybe we should also actively handle the case that cryptsetup fails
due to bad user input, maybe show the crypsetup error to the user and
give him a chance to try again?</p>
</blockquote>
<p>You have this chance even now by running <code>rear recover</code> again ...</p>
<p>Like I already said, LUKS + ReaR works well enough for me. Only thing I
would add is recovery of keys that were used on original system.<br />
Currently you have to enter NEW passphrase for every LUKS partition.
Problem with such approach is that original LUKS partition could have up
to 8 passphrases/keys for unlocking (various users can do unlock). This
creates some additional work for administrator after recovery like
configure additional passphrases/keys or setup automatic unlocking.</p>
<p>@metro1234 if you still have trouble with restore, maybe you could share
with me your recovery ISO so I can see what is wrong.</p>
<p>V.</p>
<h4 id="gozora_commented_at_2017-08-22_1605"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324073954">2017-08-22 16:05</a>:<a class="headerlink" href="#gozora_commented_at_2017-08-22_1605" title="Permanent link">&para;</a></h4>
<blockquote>
<p>Like I already said, LUKS + ReaR works well enough for me. Only thing
I would add is recovery of keys that were used on original system.</p>
</blockquote>
<p>Thinking of it, this is not such a good idea ... It would require to
store original passphrases/keys somewhere very very safely, so NO
Vladimir don't even think about it! :-)</p>
<h4 id="schlomo_commented_at_2017-08-22_1611"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324075701">2017-08-22 16:11</a>:<a class="headerlink" href="#schlomo_commented_at_2017-08-22_1611" title="Permanent link">&para;</a></h4>
<p>IMHO crypto disks are, by <strong>design</strong>, not meant for automated disaster
recovery as long as the crypto secrets are entered by a human on the
source system. ReaR cannot automate more than is already automated in
the source system.</p>
<p>That means that it could be automated if the entire crypto setup is
automated on the source system, e.g. by retrieving the keys from a key
server during booting (and yes, this is probably not a typical setup).</p>
<p>If you all agree that ReaR doesn't require any improvement for this use
case then please close the issue.</p>
<h4 id="jsmeix_commented_at_2017-08-23_1057"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324294539">2017-08-23 10:57</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-08-23_1057" title="Permanent link">&para;</a></h4>
<p>I think the issue is sufficiently answered so that I close it.</p>
<p>For the future we might use my new grandiose UserInput function<br />
where the user can predefine user input values to get them<br />
automatically input (for an unattended "rear recover")<br />
to get the LUKS passwords from the user.</p>
<p>This way it is the user who can predefine his LUKS passwords<br />
input values as he likes it before he runs "rear recover"<br />
and no secret needs to be stored by ReaR.</p>
<p>For example the user can predefine his LUKS passwords<br />
input values manually in the running ReaR recovery system<br />
before he runs "rear recover" to achieve that the actual<br />
"rear recover" runs unattended.</p>
<p>Alternatively - if the user really likes it - he could predefine<br />
his LUKS passwords input values manually in /etc/rear/local.conf<br />
and keep his /etc/rear/local.conf sufficiently secure as he needs<br />
it in his particular use case.</p>
<h4 id="metro1234_commented_at_2017-08-24_1044"><img src="https://avatars.githubusercontent.com/u/26995144?v=4" width="50"><a href="https://github.com/metro1234">metro1234</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324600673">2017-08-24 10:44</a>:<a class="headerlink" href="#metro1234_commented_at_2017-08-24_1044" title="Permanent link">&para;</a></h4>
<p>@gozora ,</p>
<p>For some reasons I have not able to recover. I have used different
password no luck and used difficult password no luck. How do i share
files. Do you have any link?</p>
<p>Thanks</p>
<h4 id="gozora_commented_at_2017-08-24_1056"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324603017">2017-08-24 10:56</a>:<a class="headerlink" href="#gozora_commented_at_2017-08-24_1056" title="Permanent link">&para;</a></h4>
<p>@metro1234<br />
You can upload it to Dropbox and share (c(at)gozora.sk).</p>
<h4 id="metro1234_commented_at_2017-08-24_1335"><img src="https://avatars.githubusercontent.com/u/26995144?v=4" width="50"><a href="https://github.com/metro1234">metro1234</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324636901">2017-08-24 13:35</a>:<a class="headerlink" href="#metro1234_commented_at_2017-08-24_1335" title="Permanent link">&para;</a></h4>
<p>Hi,</p>
<p>I have shared it. Could you please confirm you have received it.</p>
<h4 id="gozora_commented_at_2017-08-24_1432"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324652873">2017-08-24 14:32</a>:<a class="headerlink" href="#gozora_commented_at_2017-08-24_1432" title="Permanent link">&para;</a></h4>
<p>Got it.</p>
<pre><code># /usr/bin/sha256sum rox1.zip                                                                                                                                                
770bb5464385502d1f6d01c0effb394dfd1944c1bea4e68d951b2fcffce46d52  rox1.zip
</code></pre>
<p>You can remove it if checksum matches ...</p>
<p>V,</p>
<h4 id="gozora_commented_at_2017-08-24_1450"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324658423">2017-08-24 14:50</a>:<a class="headerlink" href="#gozora_commented_at_2017-08-24_1450" title="Permanent link">&para;</a></h4>
<p>@metro1234<br />
Just to clarify things a bit, wasn't your problem accidentally that once
you've entered passphrase <code>rear recover</code> just hanged?</p>
<p>V.</p>
<h4 id="metro1234_commented_at_2017-08-24_1726"><img src="https://avatars.githubusercontent.com/u/26995144?v=4" width="50"><a href="https://github.com/metro1234">metro1234</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324702076">2017-08-24 17:26</a>:<a class="headerlink" href="#metro1234_commented_at_2017-08-24_1726" title="Permanent link">&para;</a></h4>
<p>Yes Exactly</p>
<h4 id="metro1234_commented_at_2017-08-25_1400"><img src="https://avatars.githubusercontent.com/u/26995144?v=4" width="50"><a href="https://github.com/metro1234">metro1234</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324928782">2017-08-25 14:00</a>:<a class="headerlink" href="#metro1234_commented_at_2017-08-25_1400" title="Permanent link">&para;</a></h4>
<p>@gozora ,</p>
<p>Just curious. How did you encrypt the file system? Did you encrypt
during installation or Did you encrypt after OS Installation. Could you
Please share steps you performed during encryption. I will try same
setup here. I have tried cent OS,RHEL 7.2 for both version It will hung
after passphrases password enter.</p>
<h4 id="gozora_commented_at_2017-08-25_1427"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-324936347">2017-08-25 14:27</a>:<a class="headerlink" href="#gozora_commented_at_2017-08-25_1427" title="Permanent link">&para;</a></h4>
<p>I've let installer to setup and encrypt <em>/</em> and once installation was
done, I've manually configured encryption for <em>/data1</em>, this however
does not matter.<br />
You need to adapt your config to make things work.</p>
<ol>
<li>There looks to be some dependency (which I did not had time to
    investigate further) between <em>cryptsetup</em> and <em>dmsetup</em>.</li>
<li>You will need to have existing <em>/var/tmp</em> in order to let ReaR do
    its post installation steps (this is currently discussed in #1455).</li>
</ol>
<p>So your ReaR config should look something like:</p>
<pre><code>...
BACKUP_PROG_EXCLUDE=("${BACKUP_PROG_EXCLUDE[@]}" '/media' '/var/tmp/*' '/var/crash')
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" /usr/sbin/dmsetup )
...
</code></pre>
<p>After you run <code>rear mkbackup</code>, you should be able to boot and restore
from your <strong>newly</strong> created ISO without any further problems.</p>
<p>V.</p>
<h4 id="metro1234_commented_at_2017-08-26_0628"><img src="https://avatars.githubusercontent.com/u/26995144?v=4" width="50"><a href="https://github.com/metro1234">metro1234</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-325093349">2017-08-26 06:28</a>:<a class="headerlink" href="#metro1234_commented_at_2017-08-26_0628" title="Permanent link">&para;</a></h4>
<p>@gozora<br />
Great ! , I am able to restore it.</p>
<h4 id="jsmeix_commented_at_2017-08-28_0941"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-325309069">2017-08-28 09:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-08-28_0941" title="Permanent link">&para;</a></h4>
<p>@metro1234<br />
can you post here what specific settings you need<br />
in your /etc/rear/local.conf to make it work for you<br />
on your Red Hat 7.2 system so that also other<br />
Red Hat 7.2 users could benefit from it?</p>
<h4 id="gozora_commented_at_2017-08-28_1025"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1444#issuecomment-325317922">2017-08-28 10:25</a>:<a class="headerlink" href="#gozora_commented_at_2017-08-28_1025" title="Permanent link">&para;</a></h4>
<p>Hello @jsmeix,</p>
<p>In this case it requires to have <em>/var/tmp</em> directory available at
restore time (addressed by your #1457), and <code>dmsetup</code> needs to be
available (addressed by mine #1458).</p>
<p>So with current ReaR 2.2, following needs to be added to _local.conf)</p>
<pre><code>...
BACKUP_PROG_EXCLUDE=("${BACKUP_PROG_EXCLUDE[@]}" '/var/tmp/*')
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" /usr/sbin/dmsetup )
...
</code></pre>
<p>V.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2017-08-13.1444.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
