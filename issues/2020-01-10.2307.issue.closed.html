<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>2020 01 10.2307.issue.closed - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "2020 01 10.2307.issue.closed";
        var mkdocs_page_input_path = "issues/2020-01-10.2307.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', '366986045', 'auto');
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>2020 01 10.2307.issue.closed</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2307_issue_closed_under_special_circumstances_commands_in_rear_scripts_are_not_run_under_bash_but_eg_under_csh"><a href="https://github.com/rear/rear/issues/2307">#2307 Issue</a> <code>closed</code>: Under special circumstances commands in ReaR scripts are not run under bash (but e.g. under csh)<a class="headerlink" href="#2307_issue_closed_under_special_circumstances_commands_in_rear_scripts_are_not_run_under_bash_but_eg_under_csh" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>support / question</code>, <code>minor bug</code>,
<code>no-issue-activity</code></p>
<h4 id="wolfgang6444_opened_issue_at_2020-01-10_1847"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> opened issue at <a href="https://github.com/rear/rear/issues/2307">2020-01-10 18:47</a>:<a class="headerlink" href="#wolfgang6444_opened_issue_at_2020-01-10_1847" title="Permanent link">&para;</a></h4>
<p>Hello,</p>
<p>I am getting the following error message:</p>
<pre><code>ERROR: 
====================
BUG in /usr/share/rear/build/GNU/Linux/390_copy_binaries_libraries.sh line 14:
'copy_binaries destination '/tmp/rear.dzUC1mLbi1DfZ8T/rootfs/bin' is not a directory'
--------------------
Please report this issue at https://github.com/rear/rear/issues
2020-01-10 19:27:32.839047632 ERROR:
====================
BUG in /usr/share/rear/build/GNU/Linux/390_copy_binaries_libraries.sh line 14:
'copy_binaries destination '/tmp/rear.dzUC1mLbi1DfZ8T/rootfs/bin' is not a directory'
--------------------
Please report this issue at https://github.com/rear/rear/issues
and include the relevant parts from /var/log/rear/rear-labpc1.log
preferably with full debug information via 'rear -d -D mkbackup'
====================
==== Stack trace ====
Trace 0: /usr/sbin/rear:543 main
Trace 1: /usr/share/rear/lib/mkbackup-workflow.sh:15 WORKFLOW_mkbackup
Trace 2: /usr/share/rear/lib/framework-functions.sh:101 SourceStage
Trace 3: /usr/share/rear/lib/framework-functions.sh:49 Source
Trace 4: /usr/share/rear/build/GNU/Linux/390_copy_binaries_libraries.sh:62 source
Trace 5: /usr/share/rear/build/GNU/Linux/390_copy_binaries_libraries.sh:14 copy_binaries
Trace 6: /usr/share/rear/lib/_input-output-functions.sh:428 BugError
Message:
====================
BUG in /usr/share/rear/build/GNU/Linux/390_copy_binaries_libraries.sh line 14:
'copy_binaries destination '/tmp/rear.dzUC1mLbi1DfZ8T/rootfs/bin' is not a directory'
--------------------
Please report this issue at https://github.com/rear/rear/issues
and include the relevant parts from /var/log/rear/rear-labpc1.log
preferably with full debug information via 'rear -d -D mkbackup'
====================
== End stack trace ==
2020-01-10 19:27:32.848092905 Exiting rear mkbackup (PID 2929) and its descendant processes
2020-01-10 19:27:33.900679321 rear,2929 /usr/sbin/rear -v mkbackup
  `-rear,6205 /usr/sbin/rear -v mkbackup
      `-pstree,6206 -Aplau 2929
/usr/share/rear/lib/_input-output-functions.sh: line 157: kill: (6209) - No such process
2020-01-10 19:27:33.919365399 Running exit tasks
2020-01-10 19:27:33.920837456 Finished in 7 seconds
2020-01-10 19:27:33.922313608 Removing build area /tmp/rear.dzUC1mLbi1DfZ8T
removed directory '/tmp/rear.dzUC1mLbi1DfZ8T'
2020-01-10 19:27:33.941118026 End of program reached
</code></pre>
<p>Many thanks,</p>
<p>Wolfgang</p>
<h4 id="jsmeix_commented_at_2020-01-13_0823"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-573553580">2020-01-13 08:23</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-13_0823" title="Permanent link">&para;</a></h4>
<p>@wolfgang6444<br />
what about your</p>
<pre><code>full debug information via 'rear -d -D mkbackup'
</code></pre>
<p>and the usually needed general information<br />
<a href="https://raw.githubusercontent.com/rear/rear/master/.github/ISSUE_TEMPLATE.md">https://raw.githubusercontent.com/rear/rear/master/.github/ISSUE_TEMPLATE.md</a><br />
that you get shown when you click on [New issue] on<br />
<a href="https://github.com/rear/rear/issues">https://github.com/rear/rear/issues</a></p>
<h4 id="wolfgang6444_commented_at_2020-01-14_1819"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-574306019">2020-01-14 18:19</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-14_1819" title="Permanent link">&para;</a></h4>
<p>O.k. here is the missing info:</p>
<pre><code>usr/sbin/rear -V
Relax-and-Recover 2.4 / Git

cat /etc/rear/os.conf
OS_VENDOR=RedHatEnterpriseServer
OS_VERSION=8

cat /etc/rear/local.conf
# cat local.conf
export TMPDIR="/tmp"
PROGRESS_MODE="plain"
PROGRESS_WAIT_SECONDS="5"
OUTPUT=ISO
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" ntfsclone hexedit emacs)
#COPY_AS_IS=( "${COPY_AS_IS[@]}" "/sbin/ntfsclone /bin/hexedit /bin/emacs" )
COPY_AS_IS=( "${COPY_AS_IS[@]}" '/bin/hexedit /usr/libexec/emacs/*/*/* /usr/share/emacs/*/*/*')
OUTPUT_URL=file:///mnt/backup/rear/
BACKUP=NETFS
#BACKUP_OPTIONS="nfsvers=3,nolock"
BACKUP_URL=file:///mnt/backup/rear/
NETFS_KEEP_OLD_BACKUP_COPY=yes
BACKUP_PROG_EXCLUDE=( '/run/media/*' '/scr/*' '/tmp/*' '/mnt/backup/*' '/dev/*' '/video/*' )
</code></pre>
<p>Hardware is physical x86</p>
<p>Bootloader : grub2, UEFI</p>
<p>local-disks</p>
<pre><code>lsblk -ipo NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT
NAME                    KNAME     PKNAME    TRAN   TYPE FSTYPE        SIZE MOUNTPOINT
/dev/sda                /dev/sda            sata   disk               1.8T
|-/dev/sda1             /dev/sda1 /dev/sda         part vfat            1G /boot/efi
|-/dev/sda2             /dev/sda2 /dev/sda         part ext4            1G /boot
|-/dev/sda3             /dev/sda3 /dev/sda         part LVM2_member  57.9G
| |-/dev/mapper/cl-root /dev/dm-0 /dev/sda3        lvm  xfs            50G /
| `-/dev/mapper/cl-swap /dev/dm-1 /dev/sda3        lvm  swap          7.9G [SWAP]
`-/dev/sda4             /dev/sda4 /dev/sda         part ext4          200G /var/lib/libvirt/images
/dev/sdb                /dev/sdb            sata   disk             931.5G
|-/dev/sdb1             /dev/sdb1 /dev/sdb         part vfat          500M
|-/dev/sdb2             /dev/sdb2 /dev/sdb         part ntfs         96.7G
`-/dev/sdb3             /dev/sdb3 /dev/sdb         part ntfs          468M
/dev/sr0                /dev/sr0            sata   rom               1024M

rear -d -D 'mkbackup'
Relax-and-Recover 2.4 / Git
Using log file: /var/log/rear/rear-labpc1.log
Using backup archive '/mnt/backup/rear//labpc1/backup.tar.gz'
Using UEFI Boot Loader for Linux (USING_UEFI_BOOTLOADER=1)
Creating disk layout
Excluding component fs:/mnt/backup
Using guessed bootloader 'EFI' (found in first bytes on /dev/sda)
Creating root filesystem layout
To log into the recovery system via ssh set up /root/.ssh/authorized_keys or specify SSH_ROOT_PASSWORD
Trying to find what to use as UEFI bootloader...
Trying to find a 'well known file' to be used as UEFI bootloader...
Using '/boot/efi/EFI/centos/grubx64.efi' as UEFI bootloader file
Copying logfile /var/log/rear/rear-labpc1.log into initramfs as '/tmp/rear-labpc1-partial-2020-01-14T19:14:28+01:00.log'
Copying files and directories
Copying binaries and libraries
ERROR:
====================
BUG in /usr/share/rear/build/GNU/Linux/390_copy_binaries_libraries.sh line 14:
'copy_binaries destination '/tmp/rear.5dKsEA56dwxIt31/rootfs/bin' is not a directory'
--------------------
Please report this issue at https://github.com/rear/rear/issues
and include the relevant parts from /var/log/rear/rear-labpc1.log
preferably with full debug information via 'rear -d -D mkbackup'
====================
Aborting due to an error, check /var/log/rear/rear-labpc1.log for details
Exiting rear mkbackup (PID 30626) and its descendant processes
Running exit tasks
You should also rm -Rf /tmp/rear.5dKsEA56dwxIt31
Terminated
</code></pre>
<p>Wolfgang</p>
<h4 id="jsmeix_commented_at_2020-01-15_0816"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-574546466">2020-01-15 08:16</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-15_0816" title="Permanent link">&para;</a></h4>
<p>@wolfgang6444<br />
we need your actual log file <code>/var/log/rear/rear-labpc1.log</code> cf.</p>
<pre><code>rear -d -D 'mkbackup'
Relax-and-Recover 2.4 / Git
Using log file: /var/log/rear/rear-labpc1.log
...
... include the relevant parts from /var/log/rear/rear-labpc1.log
</code></pre>
<p>to be able to analyze what caused that BugError in your particular
case.<br />
Your terminal output does not show anything that could be the reason.</p>
<h4 id="jsmeix_commented_at_2020-01-15_0818"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-574547242">2020-01-15 08:18</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-15_0818" title="Permanent link">&para;</a></h4>
<p>@rmetrich @pcahyna<br />
FYI because this one is about RHEL8<br />
perhaps you could also have a look here<br />
(of course only as your time permits).</p>
<h4 id="wolfgang6444_commented_at_2020-01-15_1941"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-574823151">2020-01-15 19:41</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-15_1941" title="Permanent link">&para;</a></h4>
<p>here is the required log-file.<br />
Where should I look?</p>
<p>Wolfgang</p>
<p><a href="">Uploading rear-labpc1.log…</a></p>
<h4 id="wolfgang6444_commented_at_2020-01-15_1944"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-574825281">2020-01-15 19:44</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-15_1944" title="Permanent link">&para;</a></h4>
<p>uploading does not seem to work ...<br />
here is another attempt ...</p>
<p><a href="https://github.com/rear/rear/files/4067155/rear-labpc1.log">rear-labpc1.log</a></p>
<h4 id="wolfgang6444_commented_at_2020-01-16_1229"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-575130366">2020-01-16 12:29</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-16_1229" title="Permanent link">&para;</a></h4>
<p>Why is this closed?</p>
<h4 id="rmetrich_commented_at_2020-01-16_1230"><img src="https://avatars.githubusercontent.com/u/1163635?u=36b5e32e1dd55f1ce77cad431a5683fce40a7934&v=4" width="50"><a href="https://github.com/rmetrich">rmetrich</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-575130764">2020-01-16 12:30</a>:<a class="headerlink" href="#rmetrich_commented_at_2020-01-16_1230" title="Permanent link">&para;</a></h4>
<p>I"m looking into this, I guess you closed the issue by mistake when
submitting the log.</p>
<h4 id="jsmeix_commented_at_2020-01-16_1255"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-575138640">2020-01-16 12:55</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-16_1255" title="Permanent link">&para;</a></h4>
<p>@wolfgang6444<br />
FYI: This issue was closed because you had closed it by<br />
<a href="https://github.com/rear/rear/issues/2307#event-2952088288">https://github.com/rear/rear/issues/2307#event-2952088288</a></p>
<h4 id="rmetrich_commented_at_2020-01-16_1257"><img src="https://avatars.githubusercontent.com/u/1163635?u=36b5e32e1dd55f1ce77cad431a5683fce40a7934&v=4" width="50"><a href="https://github.com/rmetrich">rmetrich</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-575139595">2020-01-16 12:57</a>:<a class="headerlink" href="#rmetrich_commented_at_2020-01-16_1257" title="Permanent link">&para;</a></h4>
<p>Hello,<br />
the issue is there:</p>
<pre><code>+ source /usr/share/rear/build/GNU/Linux/005_create_symlinks.sh
++ ln -sf -v bin/init /tmp/rear.5dKsEA56dwxIt31/rootfs/init
'/tmp/rear.5dKsEA56dwxIt31/rootfs/init' -&gt; 'bin/init'
++ ln -sf -v bin /tmp/rear.5dKsEA56dwxIt31/rootfs/sbin
'/tmp/rear.5dKsEA56dwxIt31/rootfs/sbin' -&gt; 'bin' 
++ ln -sf -v bash /tmp/rear.5dKsEA56dwxIt31/rootfs/bin/sh
ln: failed to create symbolic link '/tmp/rear.5dKsEA56dwxIt31/rootfs/bin/sh': No such file or directory
</code></pre>
<p>It's not related to having RHEL8. Apparently there is a <strong>bin</strong> file
from your system being integrated into the ISO as
<code>/tmp/rear.XXX/rootfs/bin</code>.</p>
<p>It's unclear to me how this happens. I can see that your
<strong>COPY_AS_IS</strong> variable is broken (see the single quotes) but I cannot
reproduce with latest ReaR 2.5:</p>
<pre><code>COPY_AS_IS=( "${COPY_AS_IS[@]}" '/bin/hexedit /usr/libexec/emacs/*/*/* /usr/share/emacs/*/*/*')
</code></pre>
<p>should be</p>
<pre><code>COPY_AS_IS=( "${COPY_AS_IS[@]}" /bin/hexedit /usr/libexec/emacs/*/*/* /usr/share/emacs/*/*/*)
</code></pre>
<p>Note that including emacs in the ISO along with hexedit looks odd to me,
this <strong>COPY_AS_IS</strong> variable isn't necessary since you already added
these as <strong>REQUIRED_PROGS</strong></p>
<h4 id="jsmeix_commented_at_2020-01-16_1315"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-575145677">2020-01-16 13:15</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-16_1315" title="Permanent link">&para;</a></h4>
<p>From a quick look at<br />
<a href="https://github.com/rear/rear/files/4067155/rear-labpc1.log">https://github.com/rear/rear/files/4067155/rear-labpc1.log</a><br />
I guess</p>
<pre><code>+ source /usr/share/rear/rescue/default/010_merge_skeletons.sh
++ LogPrint 'Creating root filesystem layout'
...
++ Log 'Adding '\''default'\'''
+++ date '+%Y-%m-%d %H:%M:%S.%N '
++ local 'timestamp=2020-01-14 19:14:27.562949775 '
++ test 1 -gt 0
++ echo '2020-01-14 19:14:27.562949775 Adding '\''default'\'''
2020-01-14 19:14:27.562949775 Adding 'default'
++ tar -C default -c .
++ tar -C /tmp/rear.5dKsEA56dwxIt31/rootfs -xv
tar: This does not look like a tar archive
tar: Exiting with failure status due to previous errors
</code></pre>
<p>points to the root cause.</p>
<p>For comparison on my openSUSE Leap 15.0 system<br />
where it works for me with current ReaR master code I get</p>
<pre><code>+ source /root/rear.github.master/usr/share/rear/rescue/default/010_merge_skeletons.sh
++ LogPrint 'Creating root filesystem layout'
...
++ Log 'Adding '\''default'\'''
++ echo '2020-01-16 13:58:20.856116395 Adding '\''default'\'''
2020-01-16 13:58:20.856116395 Adding 'default'
++ tar -C default -c .
++ tar -C /tmp/rear.FVc35OU0oJxtZwU/rootfs -xv
</code></pre>
<h4 id="jsmeix_commented_at_2020-01-16_1320"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-575147630">2020-01-16 13:20</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-16_1320" title="Permanent link">&para;</a></h4>
<p>@rmetrich<br />
I did my last comment in parallel with your previous comment<br />
(i.e. I did not read your comment while I made mine)<br />
so perhaps your's is the actual root cause<br />
or both are even somehow related.</p>
<h4 id="jsmeix_commented_at_2020-01-16_1322"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-575148754">2020-01-16 13:22</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-16_1322" title="Permanent link">&para;</a></h4>
<p>@rmetrich<br />
do you think "rear mkrescue" should error out in<br />
usr/share/rear/rescue/default/010_merge_skeletons.sh<br />
when it failed to at least copy the <code>default</code> stuff<br />
instead of ignoring such errors and blindly proceed there<br />
and let things fail later at another place?</p>
<h4 id="wolfgang6444_commented_at_2020-01-16_1913"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-575300897">2020-01-16 19:13</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-16_1913" title="Permanent link">&para;</a></h4>
<p>I tried to comment out</p>
<p>COPY_AS_IS= ...<br />
and<br />
BACKUP_PROG_EXCLUDE=...</p>
<p>in /etc/rear/local.conf</p>
<p>=&gt; no change in behaviour</p>
<h4 id="wolfgang6444_commented_at_2020-01-20_0856"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-576172690">2020-01-20 08:56</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-20_0856" title="Permanent link">&para;</a></h4>
<p>Any news?<br />
Anything I should try?</p>
<p>Kind regards,</p>
<p>Wolfgang</p>
<h4 id="rmetrich_commented_at_2020-01-20_1010"><img src="https://avatars.githubusercontent.com/u/1163635?u=36b5e32e1dd55f1ce77cad431a5683fce40a7934&v=4" width="50"><a href="https://github.com/rmetrich">rmetrich</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-576202051">2020-01-20 10:10</a>:<a class="headerlink" href="#rmetrich_commented_at_2020-01-20_1010" title="Permanent link">&para;</a></h4>
<p>Hi @wolfgang6444 , could you provide the output of</p>
<pre><code># ls -l /tmp/rear.XXX/rootfs/
</code></pre>
<p>Where XXX is the temporary directory used by ReaR.</p>
<h4 id="wolfgang6444_commented_at_2020-01-20_1801"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-576380159">2020-01-20 18:01</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-20_1801" title="Permanent link">&para;</a></h4>
<p>Hello,</p>
<p>pwd<br />
/tmp/rear.5dKsEA56dwxIt31/rootfs<br />
[root@labpc1 rootfs]# ls -ltr<br />
total 0<br />
drwxr-xr-x. 5 root root 41 Nov 12 10:59 var<br />
drwxr-xr-x. 4 root root 154 Nov 12 10:59 etc<br />
drwxr-xr-x. 2 root root 63 Jan 14 19:14 tmp<br />
lrwxrwxrwx. 1 root root 8 Jan 14 19:14 init -&gt; bin/init<br />
lrwxrwxrwx. 1 root root 3 Jan 14 19:14 sbin -&gt; bin<br />
lrwxrwxrwx. 1 root root 7 Jan 14 19:14 lib -&gt; usr/lib<br />
lrwxrwxrwx. 1 root root 9 Jan 14 19:14 lib64 -&gt; usr/lib64<br />
drwxr-xr-x. 5 root root 45 Jan 14 19:14 usr</p>
<p>updating 010_merge_skeletons.sh did not help.</p>
<p>I will reinstall rear alltogether</p>
<p>Wolfgang</p>
<h4 id="rmetrich_commented_at_2020-01-21_0713"><img src="https://avatars.githubusercontent.com/u/1163635?u=36b5e32e1dd55f1ce77cad431a5683fce40a7934&v=4" width="50"><a href="https://github.com/rmetrich">rmetrich</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-576549062">2020-01-21 07:13</a>:<a class="headerlink" href="#rmetrich_commented_at_2020-01-21_0713" title="Permanent link">&para;</a></h4>
<p>@wolfgang6444 Apparently you don't have the files or directories in
/usr/share/rear/skel/default, explaining the issue.<br />
Please try indeed reinstalling ReaR.</p>
<h4 id="wolfgang6444_commented_at_2020-01-21_2016"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-576861288">2020-01-21 20:16</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-21_2016" title="Permanent link">&para;</a></h4>
<p>O.K.,</p>
<p>so I tried to reinstall rear as rpm from the repo: same behaviour.<br />
so I tried to downloading rear-2.5.tar.gz from soureforge:</p>
<pre><code>make rpm
rm -Rf dist build
rm -f build-stamp
make -C doc clean
make[1]: Entering directory '/scr/rear-2.5/doc'
rm -f unconv.8 *.html *.xml
make -C user-guide clean
make[2]: Entering directory '/scr/rear-2.5/doc/user-guide'
rm -f *.html *.svg *.xml
make[2]: Leaving directory '/scr/rear-2.5/doc/user-guide'
make[1]: Leaving directory '/scr/rear-2.5/doc'
== Validating scripts and configuration ==
find etc/ usr/share/rear/conf/ -name '*.conf' | xargs -n 1 bash -n
bash -n usr/sbin/rear
find . -name '*.sh' | xargs -n 1 bash -O extglob -O nullglob -n
find usr/share/rear -name '*.sh' | grep -v -E '(lib|skel|conf)' | while read FILE ; do \
        num=$(echo ${FILE##*/} | cut -c1-3); \
        if [[ "$num" = "000" || "$num" = "999" ]] ; then \
                echo "ERROR: script $FILE may not start with $num"; \
                exit 1; \
        else \
                if $( grep '[_[:alpha:]]' &lt;&lt;&lt; $num &gt;/dev/null 2&gt;&amp;1 ) ; then \
                        echo "ERROR: script $FILE must start with 3 digits"; \
                        exit 1; \
                fi; \
        fi; \
done
== Prepare manual ==
make -C doc man
make[1]: Entering directory '/scr/rear-2.5/doc'
make[1]: Nothing to be done for 'man'.
make[1]: Leaving directory '/scr/rear-2.5/doc'
== Building archive rear-2.5-git.0.0.unknown ==
rm -Rf build/rear-2.5-git.0.0.unknown
mkdir -p dist build/rear-2.5-git.0.0.unknown
tar -c --exclude-from=.gitignore --exclude=.gitignore --exclude=".??*" * | \
        tar -C build/rear-2.5-git.0.0.unknown -x
tar: .gitignoretar: This does not look like a tar archive
: No such file or directory
tar: Exiting with failure status due to previous errors
tar: Error is not recoverable: exiting now
make: *** [Makefile:170: dist/rear-2.5-git.0.0.unknown.tar.gz] Error 2
</code></pre>
<p>what is going on here?</p>
<p>Wolfgang</p>
<h4 id="jsmeix_commented_at_2020-01-22_0925"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-577088492">2020-01-22 09:25</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-22_0925" title="Permanent link">&para;</a></h4>
<p>@wolfgang6444<br />
could you describe what exactly "rear as rpm from the repo" is?<br />
I.e. which exact RPM package, provide the output of</p>
<pre><code>rpm -qip path/to/your/rear.rpm
rpm -q --changelog -p path/to/your/rear.rpm | head
</code></pre>
<p>and from what exact repository, i.e. provide appropriate<br />
output from your package installation program<br />
so that @rmetrich has a better chance to imagine<br />
what goes on at your place.</p>
<p>Regarding making things from a <code>tar.gz</code>:<br />
I would instead recommend<br />
"Testing current ReaR upstream GitHub master code"<br />
as described at<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a><br />
see also<br />
"Version upgrades with Relax-and-Recover" in the same article.</p>
<p>Regarding your current ReaR installation:<br />
What do you have in your <code>usr/share/rear/skel/</code> directory?<br />
I have what we have at ReaR upstream<br />
<a href="https://github.com/rear/rear/tree/master/usr/share/rear/skel">https://github.com/rear/rear/tree/master/usr/share/rear/skel</a><br />
in particular all in <code>usr/share/rear/skel/default</code><br />
<a href="https://github.com/rear/rear/tree/master/usr/share/rear/skel/default">https://github.com/rear/rear/tree/master/usr/share/rear/skel/default</a></p>
<h4 id="wolfgang6444_commented_at_2020-01-22_1305"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-577172462">2020-01-22 13:05</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-22_1305" title="Permanent link">&para;</a></h4>
<p>Installed:<br />
rear-2.4-10.el8.x86_64<br />
from<br />
AppStream CentOS-8 - AppStream</p>
<pre><code>rpm -qip /var/cache/PackageKit/8/metadata/AppStream-8-x86_64/packages/rear-2.4-10.el8.x86_64.rpm
Name        : rear
Version     : 2.4
Release     : 10.el8
Architecture: x86_64
Install Date: (not installed)
Group       : Applications/File
Size        : 2148628
License     : GPLv3
Signature   : RSA/SHA256, Thu 05 Dec 2019 04:23:28 AM CET, Key ID 05b555b38483c65d
Source RPM  : rear-2.4-10.el8.src.rpm
Build Date  : Fri 08 Nov 2019 11:52:49 PM CET
Build Host  : x86-01.mbox.centos.org
Relocations : (not relocatable)
Packager    : CentOS Buildsys &lt;bugs@centos.org&gt;
Vendor      : CentOS
URL         : http://relax-and-recover.org/
Summary     : Relax-and-Recover is a Linux disaster recovery and system migration tool
Description :
Relax-and-Recover is the leading Open Source disaster recovery and system
migration solution. It comprises of a modular
frame-work and ready-to-go workflows for many common situations to produce
a bootable image and restore from backup using this image. As a benefit,
it allows to restore to different hardware and can therefore be used as
a migration tool as well.

Currently Relax-and-Recover supports various boot media (incl. ISO, PXE,
OBDR tape, USB or eSATA storage), a variety of network protocols (incl.
sftp, ftp, http, nfs, cifs) as well as a multitude of backup strategies
(incl.  IBM TSM, HP DataProtector, Symantec NetBackup, EMC NetWorker,
Bacula, Bareos, BORG, Duplicity, rsync).

Relax-and-Recover was designed to be easy to set up, requires no maintenance
and is there to assist when disaster strikes. Its setup-and-forget nature
removes any excuse for not having a disaster recovery solution implemented.

Professional services and support are available.

 rpm -q --changelog -p /var/cache/PackageKit/8/metadata/AppStream-8-x86_64/packages/rear-2.4-10.el8.x86_64.rpm | head
* Tue Jun 04 2019 Pavel Cahyna &lt;pcahyna@redhat.com&gt; - 2.4-10
- Apply upstream patch PR1993
  Automatically exclude $BUILD_DIR from the backup
  Resolves: rhbz1677733

* Mon Jun 03 2019 Pavel Cahyna &lt;pcahyna@redhat.com&gt; - 2.4-9
- Update fix for bz#1657725. Previous fix was not correct, bootlist was still
  invoked only with one partition argument due to incorrect array expansion.
  See upstream PR2096, 2097, 2098.

 ls -l /usr/share/rear/skel/
total 0
drwxr-xr-x.  4 root root  28 Jan 22 13:53 BACULA
drwxr-xr-x.  4 root root  28 Jan 22 13:53 BAREOS
drwxr-xr-x.  2 root root  28 Jan 22 13:53 Debian
drwxr-xr-x. 14 root root 144 Jan 22 13:53 default
drwxr-xr-x.  5 root root  39 Jan 22 13:53 DP
drwxr-xr-x.  5 root root  41 Jan 22 13:53 Fedora
drwxr-xr-x.  3 root root  17 Jan 22 13:53 GALAXY
drwxr-xr-x.  3 root root  17 Jan 22 13:53 GALAXY10
drwxr-xr-x.  3 root root  17 Jan 22 13:53 GALAXY7
drwxr-xr-x.  3 root root  17 Jan 22 13:53 Linux-ia64
drwxr-xr-x.  3 root root  17 Jan 22 13:53 Linux-ppc64
drwxr-xr-x.  3 root root  17 Jan 22 13:53 NBKDC
drwxr-xr-x.  4 root root  28 Jan 22 13:53 NBU
drwxr-xr-x.  3 root root  17 Jan 22 13:53 NSR
drwxr-xr-x.  3 root root  17 Jan 22 13:53 OBDR
drwxr-xr-x.  3 root root  17 Jan 22 13:53 OPALPBA
drwxr-xr-x.  4 root root  28 Jan 22 13:53 SESAM
</code></pre>
<p>Wolfgang</p>
<h4 id="wolfgang6444_commented_at_2020-01-22_1343"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-577187794">2020-01-22 13:43</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-22_1343" title="Permanent link">&para;</a></h4>
<p>O.K.<br />
I clone it from github:</p>
<pre><code>git clone https://github.com/rear/rear.git
mv rear rear.github.master
cd rear.github.master
## created simple local.conf, see below ##
usr/sbin/rear -D mkbackup
Relax-and-Recover 2.5 / Git
Running rear mkbackup (PID 20440)
Using log file: /scr/rear.github.master/var/log/rear/rear-labpc1.log
Using backup archive '/mnt/backup/junk/labpc1/backup.tar.gz'
Found EFI system partition /dev/sda1 on /boot/efi type vfat
Using UEFI Boot Loader for Linux (USING_UEFI_BOOTLOADER=1)
Using autodetected kernel '/boot/vmlinuz-4.18.0-147.3.1.el8_1.x86_64' as kernel in the recovery system
Creating disk layout
Overwriting existing disk layout file /scr/rear.github.master/var/lib/rear/layout/disklayout.conf
Excluding component fs:/mnt/backup
Using guessed bootloader 'EFI' (found in first bytes on /dev/sda)
Verifying that the entries in /scr/rear.github.master/var/lib/rear/layout/disklayout.conf are correct ...
Creating root filesystem layout
To log into the recovery system via ssh set up /root/.ssh/authorized_keys or specify SSH_ROOT_PASSWORD
Trying to find what to use as UEFI bootloader...
Trying to find a 'well known file' to be used as UEFI bootloader...
Using '/boot/efi/EFI/centos/grubx64.efi' as UEFI bootloader file
Copying logfile /scr/rear.github.master/var/log/rear/rear-labpc1.log into initramfs as '/tmp/rear-labpc1-partial-2020-01-22T14:38:28+01:00.log'
Copying files and directories
Copying binaries and libraries
ERROR: 
====================
BUG in /scr/rear.github.master/usr/share/rear/build/GNU/Linux/390_copy_binaries_libraries.sh line 14:
'copy_binaries destination '/tmp/rear.jPSjWoK6t2lLuLb/rootfs/bin' is not a directory'
--------------------
Please report this issue at https://github.com/rear/rear/issues
and include the relevant parts from /scr/rear.github.master/var/log/rear/rear-labpc1.log
preferably with full debug information via 'rear -D mkbackup'
====================
Some latest log messages since the last called script 390_copy_binaries_libraries.sh:
  2020-01-22 14:38:29.238635145 Found binary /sbin/mkfs.xfs
  2020-01-22 14:38:29.240472098 Found binary /sbin/mke2fs
  2020-01-22 14:38:29.242359696 Found binary /sbin/xfs_admin
  2020-01-22 14:38:29.244259082 Found binary /sbin/mkswap
  2020-01-22 14:38:29.246186745 Found binary /sbin/cryptsetup
  2020-01-22 14:38:29.248443115 Found binary /sbin/dmsetup
  2020-01-22 14:38:29.250467490 Found binary /sbin/ldconfig
  2020-01-22 14:38:29.252973788 Binaries being copied: /bin/attr /bin/awk /bin/basename /bin/bash /bin/bc /bin/bzip2 /bin/cat /bin/chacl /bin/chmod /bin/chown /bin/clear /bin/cmp /bin/cp /bin/cpio /bi
Aborting due to an error, check /scr/rear.github.master/var/log/rear/rear-labpc1.log for details
Exiting rear mkbackup (PID 20440) and its descendant processes ...
Running exit tasks
You should also rm -Rf /tmp/rear.jPSjWoK6t2lLuLb
Terminated

cat etc/rear/local.conf 
# This file etc/rear/local.conf is intended for the user's
# manual configuration of Relax-and-Recover (ReaR).
# For configuration through packages and other automated means
# we recommend a separated file named site.conf next to this file
# and leave local.conf as is (ReaR upstream will never ship a site.conf).
# The default OUTPUT=ISO creates the ReaR rescue medium as ISO image.
# You need to specify your particular backup and restore method for your data
# as the default BACKUP=REQUESTRESTORE does not really do that (see "man rear").
# Configuration variables are documented in /usr/share/rear/conf/default.conf
# and the examples in /usr/share/rear/conf/examples/ can be used as templates.
# ReaR reads the configuration files via the bash builtin command 'source'
# so bash syntax like VARIABLE="value" (no spaces at '=') is mandatory.
# Because 'source' executes the content as bash scripts you can run commands
# within your configuration files, in particular commands to set different
# configuration values depending on certain conditions as you need like
# CONDITION_COMMAND &amp;&amp; VARIABLE="special_value" || VARIABLE="usual_value"
# but that means CONDITION_COMMAND gets always executed when 'rear' is run
# so ensure nothing can go wrong if you run commands in configuration files.
export TMPDIR="/tmp"
PROGRESS_MODE="plain"
PROGRESS_WAIT_SECONDS="5"
OUTPUT=ISO
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}")
COPY_AS_IS=( "${COPY_AS_IS[@]}" )
OUTPUT_URL=file:///scr/
BACKUP=NETFS
BACKUP_URL=file:///mnt/backup/junk
</code></pre>
<p>Always the same error.<br />
This used to work without problems for years on centos 7<br />
Now it seems to be completely skewed up.</p>
<p>B.T.W: How about a nice little make install or something in the
git-repository?</p>
<p>Wolfgang</p>
<h4 id="jsmeix_commented_at_2020-01-22_1403"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-577195412">2020-01-22 14:03</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-22_1403" title="Permanent link">&para;</a></h4>
<p>I guess in your ReaR debug log file you still see something like</p>
<pre><code>2020-01 ... Adding 'default'
++ tar -C default -c .
++ tar -C /tmp/rear.../rootfs -xv
tar: This does not look like a tar archive
tar: Exiting with failure status due to previous errors
</code></pre>
<p>cf.
<a href="https://github.com/rear/rear/issues/2307#issuecomment-575145677">https://github.com/rear/rear/issues/2307#issuecomment-575145677</a></p>
<p>So I guess something could be special with <code>tar</code> on your system?</p>
<p>What do you get for</p>
<pre><code># mkdir /tmp/testy

# pushd /scr/rear.github.master/usr/share/rear/skel/

# tar -C default -c . | tar -C /tmp/testy -x

# popd
</code></pre>
<h4 id="wolfgang6444_commented_at_2020-01-22_1503"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-577226038">2020-01-22 15:03</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-22_1503" title="Permanent link">&para;</a></h4>
<p>Yes:</p>
<pre><code>2020-01-22 15:59:39.950699024 Adding 'Fedora/default'                                                                                         |sbin/xfs_growfs /sbin/xfs_info /sbin/xfs_repair /usr/libexec/openssh/sftp-server /usr/sbin/rear
++ tar -C Fedora/default -c .                                                                                                                 |2020-01-22 14:06:24.887531386 ERROR:
++ tar -C /tmp/rear.WYNFDt49c3TwV5j/rootfs -xv                                                                                                |====================
tar: This does not look like a tar archive                                                                                                    |BUG in /usr/share/rear/build/GNU/Linux/390_copy_binaries_libraries.sh line 14:
tar: Exiting with failure status due to previous errors                                                                                       |'copy_binaries destination '/tmp/rear.ZKPCbIDhIOnAnHR/rootfs/bin' is not a directory'
++ for dir in default "$ARCH" "$OS" "$OS_MASTER_VENDOR/default" "$OS_MASTER_VENDOR_ARCH" "$OS_MASTER_VENDOR_VERSION" "$OS_VENDOR/default" "$O\|--------------------
S_VENDOR_ARCH" "$OS_VENDOR_VERSION" "$BACKUP" "$OUTPUT"

buesser &gt;mkdir /tmp/testy
buesser &gt;pushd /scr/rear.github.master/usr/share/rear/skel/
/scr/rear.github.master/usr/share/rear/skel ~ 
buesser &gt;tar -C default -c . | tar -C /tmp/testy -x
buesser &gt;popd
~
</code></pre>
<p>looks quite o.k. to me ?</p>
<h4 id="jsmeix_commented_at_2020-01-22_1547"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-577249415">2020-01-22 15:47</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-22_1547" title="Permanent link">&para;</a></h4>
<p>So it seems <code>tar</code> behaves different when called from within ReaR<br />
compared to when called on the command line<br />
which is something that I can neither explain right now<br />
nor do I have a useful idea where to search for the root cause<br />
of that different behaviour.</p>
<p>The "usual suspect" is that within ReaR some bash options<br />
are set to non-standard values in usr/sbin/rear</p>
<pre><code>shopt -s nullglob extglob
</code></pre>
<p><a href="https://github.com/rear/rear/blob/master/usr/sbin/rear#L296">https://github.com/rear/rear/blob/master/usr/sbin/rear#L296</a><br />
so to verify if that makes a difference for you<br />
you could try</p>
<pre><code># mkdir /tmp/testy

# pushd /scr/rear.github.master/usr/share/rear/skel/

# ( shopt -s nullglob extglob ; tar -C default -c . | tar -C /tmp/testy -x )

# popd
</code></pre>
<p>that runs <code>tar</code> in a subshell where <code>shopt -s nullglob extglob</code> is
set.<br />
The subshell is primarily there so that <code>shopt -s nullglob extglob</code><br />
does not get set in your "outer" shell where you run your commands<br />
i.e. to not "pollute" your "outer" shell with unusual bash settings.</p>
<p>FYI for comparison on my openSUSE Leap 15.0 system<br />
things "just work" for me (I am not a CentOS or RHEL user):</p>
<pre><code>rear.github.master # mkdir /tmp/testy

rear.github.master # pushd usr/share/rear/skel/
rear.github.master/usr/share/rear/skel ~/rear.github.master

rear.github.master/usr/share/rear/skel # ( shopt -s nullglob extglob ; tar -C default -c . | tar -C /tmp/testy -x )

rear.github.master/usr/share/rear/skel # popd
~/rear.github.master

rear.github.master # diff -rq usr/share/rear/skel/default /tmp/testy
[no output so no differences]
</code></pre>
<h4 id="jsmeix_commented_at_2020-01-23_0855"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-577586149">2020-01-23 08:55</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-23_0855" title="Permanent link">&para;</a></h4>
<p>I got the following email which belongs to this issue<br />
so here a fullquote</p>
<pre><code>Date: Wed, 22 Jan 2020 07:55:32 -0800
From: wolfgang6444 &lt;notifications@github.com&gt;
Reply-To: rear/rear &lt;reply+AANUVQAV4UUEEXUDLKRAAVN4GWRPJEVBNHHCBLLDWQ@reply.github.com&gt;
To: rear/rear &lt;rear@noreply.github.com&gt;
Cc: Johannes Meixner &lt;jsmeix@suse.de&gt;, Comment &lt;comment@noreply.github.com&gt;
Subject: Re: [rear/rear] BugError: copy_binaries destination '/tmp/rear.dzUC1mLbi1DfZ8T/rootfs/bin' is not a directory (#2307)
Parts/Attachments:
   1 Shown    12 lines  Text (charset: UTF-8)
   2   OK     25 lines  Text (charset: UTF-8)
----------------------------------------

talking of bash ...
as root I am using csh as default shell.
switching to bash before starting rear seems to fix the problem (I need to dig further ...)

Did you REALLY hardcode bash into the software ?

Wolfgang

-- 
You are receiving this because you commented.
Reply to this email directly or view it on GitHub:
https://github.com/rear/rear/issues/2307#issuecomment-577253522
</code></pre>
<p>But there is no<br />
<a href="https://github.com/rear/rear/issues/2307#issuecomment-577253522">https://github.com/rear/rear/issues/2307#issuecomment-577253522</a><br />
here.</p>
<p>It looks like a bug in GitHub because the same kind of issue<br />
had also happened recently, cf.<br />
<a href="https://github.com/rear/rear/issues/2305#issuecomment-572025723">https://github.com/rear/rear/issues/2305#issuecomment-572025723</a></p>
<h4 id="jsmeix_commented_at_2020-01-23_0909"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-577591217">2020-01-23 09:09</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-23_0909" title="Permanent link">&para;</a></h4>
<p>@wolfgang6444<br />
my offhanded expectation is that the very first line</p>
<pre><code>#!/bin/bash
</code></pre>
<p>in usr/sbin/rear<br />
<a href="https://github.com/rear/rear/blob/master/usr/sbin/rear#L1">https://github.com/rear/rear/blob/master/usr/sbin/rear#L1</a><br />
ensures that explicitly <code>/bin/bash</code> is used as interpreter<br />
for the ReaR scripts.</p>
<p>At least this is what usual documentation indicate<br />
how those "shebang" thingy should normally work<br />
but I guess there are special exceptions...</p>
<h4 id="wolfgang6444_commented_at_2020-01-23_0946"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-577604885">2020-01-23 09:46</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-23_0946" title="Permanent link">&para;</a></h4>
<p>Hello,<br />
my post about bash vs csh. was by mistake - so I removed it.<br />
Unfortunately the behaviour is identical (bug) when using bash.</p>
<p>I will test shopt this evening.</p>
<p>Sorry for the confusion,</p>
<p>Wolfgang</p>
<h4 id="jsmeix_commented_at_2020-01-23_1134"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-577643548">2020-01-23 11:34</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-23_1134" title="Permanent link">&para;</a></h4>
<p>@wolfgang6444<br />
thank you for your explanation!</p>
<p>So I think my additional special checks in<br />
<a href="https://github.com/rear/rear/pull/2322">https://github.com/rear/rear/pull/2322</a><br />
are not really needed.</p>
<p>I had the dim feeling that on your system perhaps<br />
<code>/bin/bash</code> is not actually <code>bash</code> but "something else".</p>
<h4 id="wolfgang6444_commented_at_2020-01-24_0800"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-578029983">2020-01-24 08:00</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-24_0800" title="Permanent link">&para;</a></h4>
<p>I may have expressed my self unclearly:<br />
The problem is still present, even when using bash as 'starting
shell'.<br />
My 'success-message' was by mistake, at least I could not reproduce it
... so I removed the comment.</p>
<p>I just didn't have the time yet to dig further ...</p>
<h4 id="wolfgang6444_commented_at_2020-01-24_1646"><img src="https://avatars.githubusercontent.com/u/24933061?v=4" width="50"><a href="https://github.com/wolfgang6444">wolfgang6444</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-578208997">2020-01-24 16:46</a>:<a class="headerlink" href="#wolfgang6444_commented_at_2020-01-24_1646" title="Permanent link">&para;</a></h4>
<p>I tried it out:</p>
<ul>
<li>It is not sufficient to just start rear from bash if the entry in
    /etc/passwd still specifies csh as default shell for root.<br />
    -If the entry for root in /etc/passwd is changed to /usr/bin/bash,
    and rear is started from a 'fresh shell', it seems to work.</li>
</ul>
<p>So there probably is something wrong with the shebang in some scripts
...</p>
<p>BTW: 'which bash' returns /usr/bin/bash on centos 8.<br />
For some weird reason there also is /bin/bash.<br />
None of the two is a link.<br />
I don't get the purpose of that ...</p>
<p>Both return bash on echo $0</p>
<p>I currently use /usr/bin/bash in /etc/passwd</p>
<p>I think it is probably not a good idea to change the default shell for
root anyway, so for me the issue is solved.</p>
<h4 id="jsmeix_commented_at_2020-01-27_1403"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-578760362">2020-01-27 14:03</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-01-27_1403" title="Permanent link">&para;</a></h4>
<p>@wolfgang6444<br />
thank you for your analysis<br />
what the root cause was in your case.<br />
It is much appreciated.</p>
<p>Now I can try to reproduce how ReaR behaves<br />
when root does not use bash as default shell<br />
and what could be done to detect or avoid that case and<br />
perhaps even how to ensure bash is always used in ReaR scripts.</p>
<p>I also think that it is in practice not a good idea<br />
to have a different shell than bash as default shell for root.<br />
In theory everything should "just work"<br />
regardless of root's default shell but:</p>
<pre><code>In theory, theory and practice are the same.
In practice, they are not
</code></pre>
<p>cf.
<a href="https://quoteinvestigator.com/2018/04/14/theory/">https://quoteinvestigator.com/2018/04/14/theory/</a></p>
<h4 id="github-actions_commented_at_2020-06-29_0137"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2307#issuecomment-650857740">2020-06-29 01:37</a>:<a class="headerlink" href="#github-actions_commented_at_2020-06-29_0137" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2022 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2020-01-10.2307.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
