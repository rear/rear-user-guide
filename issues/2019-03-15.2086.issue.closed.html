<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>2019 03 15.2086.issue.closed - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "2019 03 15.2086.issue.closed";
        var mkdocs_page_input_path = "issues/2019-03-15.2086.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', '366986045', 'auto');
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>2019 03 15.2086.issue.closed</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2086_issue_closed_support_also_appropriate_dirdiskrestoresh_similar_as_config_dirdisklayoutconf"><a href="https://github.com/rear/rear/issues/2086">#2086 Issue</a> <code>closed</code>: Support also appropriate_dir/diskrestore.sh (similar as CONFIG_DIR/disklayout.conf)<a class="headerlink" href="#2086_issue_closed_support_also_appropriate_dirdiskrestoresh_similar_as_config_dirdisklayoutconf" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>no-issue-activity</code></p>
<h4 id="jsmeix_opened_issue_at_2019-03-15_1521"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> opened issue at <a href="https://github.com/rear/rear/issues/2086">2019-03-15 15:21</a>:<a class="headerlink" href="#jsmeix_opened_issue_at_2019-03-15_1521" title="Permanent link">&para;</a></h4>
<p>Currently layout/prepare/default/010_prepare_files.sh<br />
supports CONFIG_DIR/disklayout.conf</p>
<p>I suggest that also appropriate_dir/diskrestore.sh<br />
should be supported in basically the same way.</p>
<p>Reason:</p>
<p>I would like to be able to provide a prepared
appropriate_dir/diskrestore.sh<br />
script that can get used as is for "rear recover"<br />
or such a script can be manually adapted as needed which means<br />
when appropriate_dir/diskrestore.sh exists during "rear recover"<br />
MIGRATION_MODE is set to 'true' so that the user gets the<br />
matching dialog where he can adapt it (i.e. same behaviour<br />
as currently when CONFIG_DIR/disklayout.conf exists).</p>
<p>Why I like to provide a prepared appropriate_dir/diskrestore.sh?</p>
<p>I like to be able to use ReaR to quickly set up an arbitrary disk
layout<br />
via plain commands that I enter into my selfmade diskrestore.sh
script,<br />
provide that as appropriate_dir/diskrestore.sh and get that disk layout
directly<br />
via "rear recover" without any indirection via disklayout.conf.</p>
<p>Basically that means it must be possible to do "rear recover"<br />
only with a diskrestore.sh and without any content in disklayout.conf.</p>
<p>I need to find out if that is possible with reasonable effort with
current ReaR.</p>
<p>I fear there could be subtle dependencies on the contents in
disklayout.conf<br />
in various scripts in ReaR that run during "rear recover" so that it is
not<br />
possible in practice (with reasonable effort) to do "rear recover"
without<br />
the content in disklayout.conf.</p>
<p>For example currently 'LAYOUT_FILE' is used in the finalize scripts<br />
that install the bootloader:</p>
<pre><code>finalize/Linux-ppc64/540_check_lilo_path.sh
finalize/Linux-ppc64/540_check_yaboot_path.sh
finalize/Linux-ppc64le/680_install_PPC_bootlist.sh
finalize/Linux-ppc64le/660_install_grub2.sh
finalize/GNU/Linux/240_reassign_luks_keyfiles.sh
finalize/Linux-i386/630_install_grub.sh
finalize/Linux-i386/640_install_lilo.sh
finalize/Linux-i386/650_install_elilo.sh
finalize/Linux-i386/660_install_grub2.sh
</code></pre>
<p>so some adaptions will be needed there<br />
but at least what I see on first glance in<br />
finalize/Linux-i386/660_install_grub2.sh<br />
at laset GRUB2 installation should work without disklayout.conf<br />
when GRUB2_INSTALL_DEVICES is specified...</p>
<h4 id="gdha_commented_at_2019-03-15_1538"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2086#issuecomment-473334495">2019-03-15 15:38</a>:<a class="headerlink" href="#gdha_commented_at_2019-03-15_1538" title="Permanent link">&para;</a></h4>
<p>@jsmeix I would move the script to $CONFIG_DIR/scripts sub-directory to
distinguish clearly between config files and scripts (albeit that
everything is a script within rear)</p>
<h4 id="jsmeix_commented_at_2019-03-18_0811"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2086#issuecomment-473809654">2019-03-18 08:11</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-03-18_0811" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
it is perfectly fine with me to have "real scripts" in a sub-directory<br />
to distinguish them from "config scripts".<br />
But I would like to understand what your reason behind is<br />
why you like to keep them separated.<br />
I mean what would be actually wrong or bad in this case when<br />
different kind of files are in one same directory?</p>
<h4 id="gdha_commented_at_2019-03-19_1600"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2086#issuecomment-474442634">2019-03-19 16:00</a>:<a class="headerlink" href="#gdha_commented_at_2019-03-19_1600" title="Permanent link">&para;</a></h4>
<p>@jsmeix basically that is already possible via
<a href="http://www.it3.be/2016/06/08/rear-diskrestore/">http://www.it3.be/2016/06/08/rear-diskrestore/</a><br />
Well to be honest I do not like to see any <code>*.sh</code> in the <strong>/etc/rear/</strong>
directory as it is forbidden by RPM building rules.</p>
<h4 id="jsmeix_commented_at_2019-03-20_1021"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2086#issuecomment-474770186">2019-03-20 10:21</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-03-20_1021" title="Permanent link">&para;</a></h4>
<p>@jsmeix<br />
thank you for the explanation why we cannot have executables in /etc<br />
so I will find and use another directory.</p>
<p>Perhaps I could simply use the var/lib/rear/layout/ directory<br />
and if therein is already a diskrestore.sh during "rear recover"<br />
then (to be on the safe side) go into MIGRATION_MODE and<br />
show a user dialog where the user must decide to<br />
either use the existing var/lib/rear/layout/diskrestore.sh as is<br />
or let it be recreated anew by the layout/prepare stage.</p>
<p>In the past (when you had mentioned it somewhere) I had already a look
at<br />
<a href="http://www.it3.be/2016/06/08/rear-diskrestore/">http://www.it3.be/2016/06/08/rear-diskrestore/</a><br />
but as far as I understand the description that one is about<br />
to create diskrestore.sh from disklayout.conf<br />
i.e. basically "rear recover" but aborted just before<br />
layout/recreate/default/200_run_layout_code.sh is run<br />
or in other words only run the layout/prepare stage.</p>
<p>But this issue here is about to be able to manually make a
diskrestore.sh<br />
and use that during "rear recover" (without any disklayout.conf).</p>
<h4 id="jsmeix_commented_at_2019-03-29_0825"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2086#issuecomment-477911450">2019-03-29 08:25</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-03-29_0825" title="Permanent link">&para;</a></h4>
<p>I like to have that in ReaR 2.6 because I do need it<br />
for efficient testing ReaR with arbitrary disk layouts, cf.<br />
<a href="https://github.com/rear/rear/issues/2023#issuecomment-456866405">https://github.com/rear/rear/issues/2023#issuecomment-456866405</a></p>
<p>It is just such a boring annoyance for me to install<br />
a test system with a special disk layout setup<br />
with indirectly working tools like YaST<br />
when on the other hand I know that with ReaR<br />
one could do that directly and much faster and 100% reproducible<br />
if one could provide a ready-made diskrestore.sh to "rear recover"<br />
that creates the disk layout directly without any indirection.</p>
<p>The basic idea behind is exactly the same as in the sections<br />
"Generic usage of the plain SUSE installation system for backup and
recovery" and<br />
"Generic system installation with the plain SUSE installation system"
and<br />
"Using ReaR as generic installer in the ReaR recovery system" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a><br />
that reads (excerpts)</p>
<pre><code>An experienced admin makes a script that calls
his specifically appropriate low-level commands directly.
...
this is working in compliance with the KISS principle
"keep it simple and straightforward" ...
and it avoids what is best described in RFC1925 ... as
"It is always possible to add another level of indirection"
because the primary intent ... is simplicity and control
</code></pre>
<h4 id="github-actions_commented_at_2020-06-30_0133"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2086#issuecomment-651464882">2020-06-30 01:33</a>:<a class="headerlink" href="#github-actions_commented_at_2020-06-30_0133" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2022 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2019-03-15.2086.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
