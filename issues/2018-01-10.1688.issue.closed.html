<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1688 Issue closed: Mkrescue fails on 2.3 with missing libraries for TSM when files exist. - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1688 Issue closed: Mkrescue fails on 2.3 with missing libraries for TSM when files exist.";
        var mkdocs_page_input_path = "issues/2018-01-10.1688.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1688 Issue closed: Mkrescue fails on 2.3 with missing libraries for TSM when files exist.</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1688_issue_closed_mkrescue_fails_on_23_with_missing_libraries_for_tsm_when_files_exist"><a href="https://github.com/rear/rear/issues/1688">#1688 Issue</a> <code>closed</code>: Mkrescue fails on 2.3 with missing libraries for TSM when files exist.<a class="headerlink" href="#1688_issue_closed_mkrescue_fails_on_23_with_missing_libraries_for_tsm_when_files_exist" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="mogiepete_opened_issue_at_2018-01-10_2008"><img src="https://avatars.githubusercontent.com/u/2382464?v=4" width="50"><a href="https://github.com/MogiePete">MogiePete</a> opened issue at <a href="https://github.com/rear/rear/issues/1688">2018-01-10 20:08</a>:<a class="headerlink" href="#mogiepete_opened_issue_at_2018-01-10_2008" title="Permanent link">&para;</a></h4>
<ul>
<li>rear version (/usr/sbin/rear -V): Relax-and-Recover 2.3 / 2017-12-20</li>
<li>OS version (cat /etc/rear/os.conf or lsb_release -a): Red Hat
    Enterprise Linux Server release 7.4</li>
<li>rear configuration files (cat /etc/rear/site.conf or cat
    /etc/rear/local.conf):<br />
    OUTPUT=ISO<br />
    BACKUP=TSM</li>
<li>Are you using legacy BIOS or UEFI boot? BIOS</li>
<li>Brief description of the issue: Rescue Media fails to create and
    produces report that files are missing.</li>
<li>Work-around, if any: None at this time. Rolled back to
    Relax-and-Recover 2.2 / 2017-07-20 and rear mkrescue completes
    without error.</li>
</ul>
<p>TSM Version: Client Version 8, Release 1, Level 0.0</p>
<p>Error when running rear mkrescue:</p>
<p>/usr/local/ibm/gsk8_64/bin/gsk8capicmd_64 requires additional
libraries (fatal error)<br />
libgsk8km_64.so =&gt; not found<br />
/usr/local/ibm/gsk8_64/bin/gsk8ver_64 requires additional libraries
(fatal error)<br />
libgsk8sys_64.so =&gt; not found</p>
<h4 id="jsmeix_commented_at_2018-01-11_0758"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-356855155">2018-01-11 07:58</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-01-11_0758" title="Permanent link">&para;</a></h4>
<p>This kind of issue and how to work around it<br />
is described in the release notes of the 2.3 release.</p>
<h4 id="schabrolles_commented_at_2018-01-11_0826"><img src="https://avatars.githubusercontent.com/u/19491077?u=0021b16ab426902cbe676f6831f41607bbe4d441&v=4" width="50"><a href="https://github.com/schabrolles">schabrolles</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-356861040">2018-01-11 08:26</a>:<a class="headerlink" href="#schabrolles_commented_at_2018-01-11_0826" title="Permanent link">&para;</a></h4>
<p>@MogiePete ,<br />
Could you try with the following variable added in your <code>local.conf</code>
file</p>
<pre><code>COPY_AS_IS_TSM=( /etc/adsm /opt/tivoli/tsm/client /usr/local/ibm/gsk8* /lib*/libgsk* )
</code></pre>
<h4 id="mogiepete_commented_at_2018-01-11_2223"><img src="https://avatars.githubusercontent.com/u/2382464?v=4" width="50"><a href="https://github.com/MogiePete">MogiePete</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-357081281">2018-01-11 22:23</a>:<a class="headerlink" href="#mogiepete_commented_at_2018-01-11_2223" title="Permanent link">&para;</a></h4>
<p>@jsmeix I do not believe NON_FATAL_BINARIES_WITH_MISSING_LIBRARY
being added would resolve the issue due to the fact that the libraries
are needed by dsmc to run.</p>
<p>@schabrolles When added to the local.conf file the mkrescue completed.
Thank you.</p>
<h4 id="jsmeix_commented_at_2018-01-12_1340"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-357240807">2018-01-12 13:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-01-12_1340" title="Permanent link">&para;</a></h4>
<p>@MogiePete</p>
<p>I see!</p>
<p>The NON_FATAL_BINARIES_WITH_MISSING_LIBRARY<br />
description in default.conf is insufficient, see<br />
<a href="https://github.com/rear/rear/issues/1693">https://github.com/rear/rear/issues/1693</a></p>
<h4 id="jsmeix_commented_at_2018-01-12_1347"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-357242417">2018-01-12 13:47</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-01-12_1347" title="Permanent link">&para;</a></h4>
<p>@schabrolles<br />
according to the above it seems an enhancement is needed<br />
for the COPY_AS_IS_TSM default value to be enhanced<br />
from the current</p>
<pre>
COPY_AS_IS_TSM=( /etc/adsm /opt/tivoli/tsm/client /usr/local/ibm/gsk8* )
</pre>

<p>to</p>
<pre>
COPY_AS_IS_TSM=( /etc/adsm /opt/tivoli/tsm/client /usr/local/ibm/gsk8* /lib*/libgsk* )
</pre>

<h4 id="schabrolles_commented_at_2018-01-12_1412"><img src="https://avatars.githubusercontent.com/u/19491077?u=0021b16ab426902cbe676f6831f41607bbe4d441&v=4" width="50"><a href="https://github.com/schabrolles">schabrolles</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-357248210">2018-01-12 14:12</a>:<a class="headerlink" href="#schabrolles_commented_at_2018-01-12_1412" title="Permanent link">&para;</a></h4>
<p>@jsmeix, I'm currently working on it.<br />
The libgsk are located in <code>/usr/local/ibm/gsk8</code> for (sles and redhat)<br />
but there is some symlink in /lib64 for RedHat distro.<br />
This mean libgsk are actually copied into the rescue image.</p>
<p>I would prefer to update the <code>TSM_LD_LIBRARY_PATH</code> with
<code>/usr/local/ibm/gsk8/lib64</code></p>
<h4 id="jsmeix_commented_at_2018-01-12_1431"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-357252945">2018-01-12 14:31</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-01-12_1431" title="Permanent link">&para;</a></h4>
<p>Adding something to TSM_LD_LIBRARY_PATH<br />
only makes the ldd test in build/default/980_verify_rootfs.sh<br />
find more libraries via LD_LIBRARY_PATH<br />
while in contrast<br />
adding something to COPY_AS_IS_TSM<br />
only gets more stuff into the recovery system.</p>
<p>If adding something to TSM_LD_LIBRARY_PATH helps<br />
it shows that the needed libraries are already in the recovery system<br />
as described in<br />
<a href="https://github.com/rear/rear/issues/1688#issuecomment-357248210">https://github.com/rear/rear/issues/1688#issuecomment-357248210</a></p>
<p>But then
<a href="https://github.com/rear/rear/issues/1688#issuecomment-357081281">https://github.com/rear/rear/issues/1688#issuecomment-357081281</a><br />
seems to contradict because there @MogiePete seems to report<br />
that those libraries were actually missing in his recovery system?</p>
<p>@MogiePete<br />
does it also work for you when you leave COPY_AS_IS_TSM as is by
default i.e.</p>
<pre>
COPY_AS_IS_TSM=( /etc/adsm /opt/tivoli/tsm/client /usr/local/ibm/gsk8* )
</pre>

<p>but only add <code>:/usr/local/ibm/gsk8/lib64</code> to TSM_LD_LIBRARY_PATH as
in<br />
<a href="https://github.com/rear/rear/pull/1694/files">https://github.com/rear/rear/pull/1694/files</a></p>
<h4 id="schabrolles_commented_at_2018-01-12_1450"><img src="https://avatars.githubusercontent.com/u/19491077?u=0021b16ab426902cbe676f6831f41607bbe4d441&v=4" width="50"><a href="https://github.com/schabrolles">schabrolles</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-357257956">2018-01-12 14:50</a>:<a class="headerlink" href="#schabrolles_commented_at_2018-01-12_1450" title="Permanent link">&para;</a></h4>
<p>@MogiePete ,</p>
<p>Could you please test again by modifying your /etc/local.conf.</p>
<ul>
<li>remove <code>COPY_AS_IS_TSM</code></li>
<li>and instead, add
    <code>TSM_LD_LIBRARY_PATH=$TSM_LD_LIBRARY_PATH:/usr/local/ibm/gsk8/lib64</code></li>
</ul>
<h4 id="mogiepete_commented_at_2018-01-19_1639"><img src="https://avatars.githubusercontent.com/u/2382464?v=4" width="50"><a href="https://github.com/MogiePete">MogiePete</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-359020644">2018-01-19 16:39</a>:<a class="headerlink" href="#mogiepete_commented_at_2018-01-19_1639" title="Permanent link">&para;</a></h4>
<p>@schabrolles</p>
<p>I made the change you requested and the error has returned:</p>
<pre>
There are binaries or libraries in the ReaR recovery system that need additional libraries
/usr/local/ibm/gsk8_64/bin/gsk8capicmd_64 requires additional libraries (fatal error)
        libgsk8km_64.so => not found
/usr/local/ibm/gsk8_64/bin/gsk8ver_64 requires additional libraries (fatal error)
        libgsk8sys_64.so => not found
ERROR: ReaR recovery system in '/tmp/rear.BAzCqmpLv4Qs8Wh/rootfs' not usable
Aborting due to an error, check /var/log/rear/rear-tsmtestserver.log for details
Terminated
</pre>

<h4 id="schabrolles_commented_at_2018-02-27_1729"><img src="https://avatars.githubusercontent.com/u/19491077?u=0021b16ab426902cbe676f6831f41607bbe4d441&v=4" width="50"><a href="https://github.com/schabrolles">schabrolles</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-368959063">2018-02-27 17:29</a>:<a class="headerlink" href="#schabrolles_commented_at_2018-02-27_1729" title="Permanent link">&para;</a></h4>
<p>@MogiePete,</p>
<p>Could you test again with the current version of ReaR. I just merged
<a href="https://github.com/rear/rear/pull/1694">https://github.com/rear/rear/pull/1694</a>
which should solve your issue. It worked for me, but I would like to
verify it on your environment.</p>
<h4 id="mogiepete_commented_at_2018-02-27_2029"><img src="https://avatars.githubusercontent.com/u/2382464?v=4" width="50"><a href="https://github.com/MogiePete">MogiePete</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-369015538">2018-02-27 20:29</a>:<a class="headerlink" href="#mogiepete_commented_at_2018-02-27_2029" title="Permanent link">&para;</a></h4>
<p>@schabrolles,</p>
<p>As previously mentioned, adding the path did not work. The path listed
in the merge is incorrect according to my system. It should be
/usr/local/ibm/gsk8_64/lib64.</p>
<p>Adding COPY_AS_IS_TSM to my /etc/local.conf resolved the issues I was
having with 2.3 on a RHEL 7 server running TSM 8.1.</p>
<h4 id="schabrolles_commented_at_2018-02-28_0920"><img src="https://avatars.githubusercontent.com/u/19491077?u=0021b16ab426902cbe676f6831f41607bbe4d441&v=4" width="50"><a href="https://github.com/schabrolles">schabrolles</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-369172832">2018-02-28 09:20</a>:<a class="headerlink" href="#schabrolles_commented_at_2018-02-28_0920" title="Permanent link">&para;</a></h4>
<p>@MogiePete,</p>
<p>I see... thanks for the clarification. It is strange, because gsk libs
are located in <code>/usr/local/ibm/gsk8/lib64</code> on my ppc64le system.<br />
I made a change proposal
(<a href="https://github.com/rear/rear/pull/1744">https://github.com/rear/rear/pull/1744</a>)
to detect the real gsk PATH to add into <code>TSM_LD_LIBRARY_PATH</code> for system
like intel which could have it in 64 or 32 bits.</p>
<p>I'm waiting for other ReaR member to review it before merging.</p>
<h4 id="schabrolles_commented_at_2018-02-28_1231"><img src="https://avatars.githubusercontent.com/u/19491077?u=0021b16ab426902cbe676f6831f41607bbe4d441&v=4" width="50"><a href="https://github.com/schabrolles">schabrolles</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-369225115">2018-02-28 12:31</a>:<a class="headerlink" href="#schabrolles_commented_at_2018-02-28_1231" title="Permanent link">&para;</a></h4>
<p>@MogiePete,</p>
<p>change is now merged into master. Could you test and confirm the issue
can be closed.</p>
<p>Thanks.</p>
<h4 id="schabrolles_commented_at_2018-04-08_1143"><img src="https://avatars.githubusercontent.com/u/19491077?u=0021b16ab426902cbe676f6831f41607bbe4d441&v=4" width="50"><a href="https://github.com/schabrolles">schabrolles</a> commented at <a href="https://github.com/rear/rear/issues/1688#issuecomment-379543772">2018-04-08 11:43</a>:<a class="headerlink" href="#schabrolles_commented_at_2018-04-08_1143" title="Permanent link">&para;</a></h4>
<p>No news is Good news... then, I close this one.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2018-01-10.1688.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
