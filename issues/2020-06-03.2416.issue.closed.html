<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2416 Issue closed: Redirect stdout and stderr to the log only in debug modes - normally discard them to /dev/null - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2416 Issue closed: Redirect stdout and stderr to the log only in debug modes - normally discard them to /dev/null";
        var mkdocs_page_input_path = "issues/2020-06-03.2416.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2416 Issue closed: Redirect stdout and stderr to the log only in debug modes - normally discard them to /dev/null</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2416_issue_closed_redirect_stdout_and_stderr_to_the_log_only_in_debug_modes_-_normally_discard_them_to_devnull"><a href="https://github.com/rear/rear/issues/2416">#2416 Issue</a> <code>closed</code>: Redirect stdout and stderr to the log only in debug modes - normally discard them to /dev/null<a class="headerlink" href="#2416_issue_closed_redirect_stdout_and_stderr_to_the_log_only_in_debug_modes_-_normally_discard_them_to_devnull" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>cleanup</code>, <code>fixed / solved / done</code></p>
<h4 id="jsmeix_opened_issue_at_2020-06-03_0829"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> opened issue at <a href="https://github.com/rear/rear/issues/2416">2020-06-03 08:29</a>:<a class="headerlink" href="#jsmeix_opened_issue_at_2020-06-03_0829" title="Permanent link">&para;</a></h4>
<p>Currently stdout and stderr are redirected to the log file in any case.</p>
<p>The reason behind is that all what could be useful for later debugging<br />
in case of issues must appear in ReaR's log file, cf.<br />
"What to do with stdin, stdout, and stderr" in<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a></p>
<p>But this means that also error messages from commands<br />
that fail when a possible failure is expected and handled in ReaR<br />
appear in the log file.</p>
<p>I.e. for code of the general form like</p>
<pre><code>TRY_COMMAND || FALLBACK_COMMAND || Error "..."
</code></pre>
<p>a failing TRY_COMMAND error message appears in the log file<br />
which may confuse the user regardless that all works well<br />
because it is only a "false alarm" message.</p>
<p>On the other hand the TRY_COMMAND error message must appear<br />
in the log file because for later debugging in case of issues it is
needed<br />
to see how TRY_COMMAND had failed i.e. what its exact error message
was<br />
because it makes a difference to understand the root cause of an issue<br />
if the TRY_COMMAND error message shows that its failure is OK<br />
(and FALLBACK_COMMAND does "the right thing")<br />
or if the TRY_COMMAND error message points to the root cause of an
issue<br />
(e.g. because TRY_COMMAND should have worked in a particular case<br />
and FALLBACK_COMMAND should not have been run in that case).</p>
<p>So there is a dilemma between suppressing error messages<br />
to not confuse the user with "false alarm" error messages<br />
versus having all what could be useful for later debugging in the log
file.</p>
<p>Perhaps a possible way out of that dilemma could be<br />
to only redirect stdout and stderr to the log file<br />
when <code>rear</code> is run in verbose mode (<code>-v</code>) or in debug modes (<code>-d</code>
<code>-D</code>)<br />
to avoid that such messages appear in the log and confuse the user<br />
when the user has called <code>rear</code> in a "normal operation" mode and<br />
in "normal operation" mode stdout and stderr are redirected to
/dev/null.</p>
<p>Perhaps the best way might be:</p>
<p>In "normal operation" mode stdout and stderr are redirected to
/dev/null.<br />
In verbose mode stderr is still /dev/null but stdout is redirected to
the log.<br />
In debug modes stdout and stderr are redirected to the log.</p>
<p>It seems this would be in compliance with our <code>$v</code> <code>$verbose</code> usage</p>
<pre><code># touch foo

# cp -v foo foo.cp 2&gt;/dev/null
'foo' -&gt; 'foo.cp'

# mv -v foo.cp foo.mv 2&gt;/dev/null
renamed 'foo.cp' -&gt; 'foo.mv'
</code></pre>
<p>because it seems command verbose output happens usually on stdout.</p>
<p>I do no longer think that my above described "best way" works OK in
practice, see<br />
<a href="https://github.com/rear/rear/issues/2416#issuecomment-702142588">https://github.com/rear/rear/issues/2416#issuecomment-702142588</a></p>
<h4 id="github-actions_commented_at_2020-08-03_0134"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2416#issuecomment-667758910">2020-08-03 01:34</a>:<a class="headerlink" href="#github-actions_commented_at_2020-08-03_0134" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="jsmeix_commented_at_2020-09-30_1322"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2416#issuecomment-701387219">2020-09-30 13:22</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-09-30_1322" title="Permanent link">&para;</a></h4>
<p>I will do a pull request right now:</p>
<h4 id="jsmeix_commented_at_2020-10-01_1340"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2416#issuecomment-702142588">2020-10-01 13:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-10-01_1340" title="Permanent link">&para;</a></h4>
<p>With the current changes in<br />
<a href="https://github.com/rear/rear/pull/2498">https://github.com/rear/rear/pull/2498</a><br />
i.e. with<br />
<a href="https://github.com/rear/rear/pull/2498/commits/0f63d43236a0b28e020f5cb6cd2ff933438a481b">https://github.com/rear/rear/pull/2498/commits/0f63d43236a0b28e020f5cb6cd2ff933438a481b</a><br />
I do no longer think that our our <code>$v</code> <code>$verbose</code> usage is helpful for
the user.</p>
<p>I think we should set the <code>$v</code> and <code>$verbose</code> variables in debug modes<br />
but not in verbose mode.</p>
<p>Perhaps we may even set the <code>$v</code> and <code>$verbose</code> variables only in
debugscript <code>-D</code> mode<br />
because additional command verbose messages are mostly useless without
context<br />
in particular without the info what exact command was called<br />
and that info is only provided in debugscript mode.</p>
<p>Reasoning:</p>
<p>Calling ReaR in verbose mode should make only ReaR itself verbose<br />
in particular to show ReaR messages on the user's termial<br />
but it should not also transitively make things that are called by ReaR
verbose<br />
because I think when the user likes to get such internal details of
information<br />
then the user is more in debugging state (i.e. looking for the cause of
an issue).</p>
<p>Explanation:</p>
<p>Currently we do in usr/sbin/rear</p>
<pre><code># Set the variables v and verbose to be used in called programs
# that support the '-v' or '--verbose' options like
# "cp $v ..." or "rm $verbose ..." and so on:
v=""
verbose=""
if test "$VERBOSE" ; then
    v="-v"
    verbose="--verbose"
fi
</code></pre>
<p>so that in verbose mode many commands are run with verbose output<br />
as described in "man rear"<br />
<a href="https://github.com/rear/rear/blob/master/doc/rear.8.adoc">https://github.com/rear/rear/blob/master/doc/rear.8.adoc</a></p>
<pre><code>-v
    verbose mode (show more output and run many commands in verbose mode)
</code></pre>
<p>But from my point of view the commands verbose output in the log<br />
is mainly confusing and does not actually help the user at all.</p>
<p>For example what additional commands verbose output I get in my log<br />
during "rear -v recover" compared to "rear recover"<br />
(excerpts from a <code>diff</code> output with long lines cut after 150
characters):</p>
<pre><code> Saving filesystem layout (using the findmnt command).
+- Docker Application Container Engine
+ Loaded: loaded (/usr/lib/systemd/system/docker.service; disabled; vendor preset: disabled)
+ Active: inactive (dead)
+   Docs: http://docs.docker.com
 Processing filesystem 'ext4' on '/dev/mapper/cr_ata-TOSHIBA_MQ01ABF050_Y2PLP02CT-part3' mounted at '/'
...
 Verifying that the 'disk' entries in /root/rear.github.master/var/lib/rear/layout/disklayout.conf are correct
+500107862016
 Verifying that the 'part' entries for /dev/sda in /root/rear.github.master/var/lib/rear/layout/disklayout.conf are correct
+8388608
+1048576
+4294967296
+9437184
+214748364800
+4304404480
+107374182400
+219052769280
+161061273600
+326426951680
+8589934592
+487488225280
+1073741824
+496078159872
+1073741824
+497151901696
 Verifying that the 'part' entries for /dev/sda in /root/rear.github.master/var/lib/rear/layout/disklayout.conf specify consecutive partitions
...
 Adding required libfreeblpriv3.so to LIBS
+directory '/tmp/rear.ocKP41xM43hJugw/rootfs//var/lib/sshd'
+'/tmp/rear.ocKP41xM43hJugw/rootfs//var/lib/sshd' changed from 0755 (rwxr-xr-x) to 0700 (rwx------)
 Including rescue/GNU/Linux/550_copy_ldconfig.sh
...
 Copying ReaR configuration directory
+'/tmp/rear.ocKP41xM43hJugw/rootfs/etc/rear/./local.conf'
+'/tmp/rear.ocKP41xM43hJugw/rootfs/etc/rear/./os.conf'
 Including build/GNU/Linux/110_touch_empty_files.sh
 Including build/GNU/Linux/130_create_dotfiles.sh
+'/tmp/rear.ocKP41xM43hJugw/rootfs//root/.bash_history' retained as 0644 (rw-r--r--)
 Including build/GNU/Linux/150_adjust_permissions.sh
...
 Including build/default/490_fix_broken_links.sh
+
+'./usr/lib/os-release'
+directory './usr/share/zoneinfo'
+directory './usr/share/zoneinfo/Europe'
+'./usr/share/zoneinfo/Europe/Berlin'
+'./usr/share/misc/termcap'
+~/rear.github.master
 Including build/default/500_ssh_setup.sh
 Including build/default/501_check_ssh_keys.sh
+
+~/rear.github.master
 Including build/default/502_include_mdadm_conf.sh
...
 Including build/GNU/Linux/630_verify_resolv_conf_file.sh
+'/tmp/rear.ocKP41xM43hJugw/rootfs/etc/resolv.conf'
 Supposedly valid nameserver 'fd00::7eff:4dff:fe5d:42b1' in /tmp/rear.ocKP41xM43hJugw/rootfs/etc/resolv.conf
...
 Testing that each program in the PROGS array can be found as executable command within the recovery system
+/usr/sbin/partprobe
+/sbin/partprobe
+/sbin/fdisk
...
+hashed (/usr/bin/rmdir)
...
+a shell builtin
...
+/usr/lib/ssh/sftp-server
+/sbin/sftp-server
 Testing that each program in the REQUIRED_PROGS array can be found as executable command within the recovery system
+/sbin/rear
+/sbin/awk
...
+a shell builtin
...
+/sbin/dmsetup
+/sbin/ldconfig
 Including build/default/995_md5sums_rootfs.sh
...
 Copying resulting files to file location
+'/tmp/rear.ocKP41xM43hJugw/tmp/README'
 Saving /root/rear.github.master/var/log/rear/rear-linux-h9wr.log as rear-linux-h9wr.log to file location
/tmp/VERSION /tmp/rear.0qMwd9fdzyhPbY
 Copying result files '/root/rear.github.master/var/lib/rear/output/rear-linux-h9wr.iso /tmp/rear.ocKP41xM43hJugw/tmp/VERSION /tmp/rear.ocKP41xM43hJug
+'/other/linux-h9wr/rear-linux-h9wr.iso'
+'/other/linux-h9wr/VERSION'
+'/other/linux-h9wr/README'
+'/other/linux-h9wr/rear-linux-h9wr.log'
 Including output/default/950_email_result_files.sh
</code></pre>
<p>All those <code>+</code> lines are completely useless from my point of view.<br />
At least I do not understand anything what those additional command
verbose messages mean<br />
without context (in particular without the info what exact command was
called).</p>
<h4 id="jsmeix_commented_at_2020-10-01_1405"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2416#issuecomment-702159687">2020-10-01 14:05</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-10-01_1405" title="Permanent link">&para;</a></h4>
<p>All the time since I had written in<br />
<a href="https://github.com/rear/rear/issues/2416#issue-629800799">https://github.com/rear/rear/issues/2416#issue-629800799</a></p>
<pre><code>In verbose mode stderr is still /dev/null but stdout is redirected to the log.
</code></pre>
<p>I had some bad feeling to handle stderr and stdout differently.</p>
<p>Now I know it is a bad idea to handle stderr and stdout differently.</p>
<p>Most of the useless <code>+</code> lines in the log file excerpts in the above<br />
<a href="https://github.com/rear/rear/issues/2416#issuecomment-702142588">https://github.com/rear/rear/issues/2416#issuecomment-702142588</a><br />
are not because of additionally requested command verbose messages<br />
but just normal command stdout messages that appear in the log<br />
when in verbose mode stdout is redirected to the log.</p>
<p>E.g. the above</p>
<pre><code>+- Docker Application Container Engine
+ Loaded: loaded (/usr/lib/systemd/system/docker.service; disabled; vendor preset: disabled)
+ Active: inactive (dead)
+   Docs: http://docs.docker.com
</code></pre>
<p>comes from layout/save/GNU/Linux/230_filesystem_layout.sh</p>
<pre><code>if service docker status ; then
</code></pre>
<p>and for debugging purposes the <code>service docker status</code> message<br />
must be in the log so that one could see at any time later whether or
not<br />
there have been issues with the <code>service docker status</code> command<br />
at the time when ReaR was running (e.g. late at night), cf.<br />
"What to do with stdin, stdout, and stderr" in<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a></p>
<h4 id="jsmeix_commented_at_2020-10-06_1322"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2416#issuecomment-704265435">2020-10-06 13:22</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-10-06_1322" title="Permanent link">&para;</a></h4>
<p>With
<a href="https://github.com/rear/rear/pull/2498">https://github.com/rear/rear/pull/2498</a>
merged this issue should be done.</p>
<h4 id="olivero2_commented_at_2020-12-11_1937"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/2416#issuecomment-743387866">2020-12-11 19:37</a>:<a class="headerlink" href="#olivero2_commented_at_2020-12-11_1937" title="Permanent link">&para;</a></h4>
<p>As described in
<a href="https://github.com/rear/rear/pull/2538#issuecomment-743365322">https://github.com/rear/rear/pull/2538#issuecomment-743365322</a>,
I had an issue with <code>dd</code> failing due to a missing input file.</p>
<p>Before considering the effects of #2498, my code would look like this:</p>
<pre><code>dd if="$boot_partition" bs=1024 of="$install_partition" || Error "Could not copy the EFI rescue system to partition '$install_partition'"
</code></pre>
<p>producing output like this:</p>
<pre><code>ERROR: Could not copy the EFI rescue system to partition '/dev/sda2'
Some latest log messages since the last called script 280_create_bootable_disk_image.sh:
  [...]
  2020-12-11 18:37:31.509370807 Installing the EFI rescue system to partition '/dev/sda2'
</code></pre>
<p>There is no detailed information about the cause of the problem.</p>
<p>Now I have changed it to:</p>
<pre><code>dd if="$boot_partition" bs=1024 of="$install_partition" 2&gt;&gt;"$RUNTIME_LOGFILE" || Error "Could not copy the EFI rescue system to partition '$install_partition'"
</code></pre>
<p>which produces this output:</p>
<pre><code>ERROR: Could not copy the EFI rescue system to partition '/dev/sda2'
Some latest log messages since the last called script 280_create_bootable_disk_image.sh:
  [...]
  2020-12-11 18:37:31.509370807 Installing the EFI rescue system to partition '/dev/sda2'
  dd: failed to open '/dev/loop6p1': No such file or directory
</code></pre>
<p>Now there is detailed information about the cause of the problem without
requiring the user to enable debugscript mode.</p>
<p>So what is the better solution?</p>
<ol>
<li>Leave everything as is, suppressing <code>stderr</code> messages giving details
    about the cause of an underlying error, requiring another invocation
    with <code>-D</code> (if the problem reproduces).</li>
<li>Change code like above to use <code>2&gt;&gt;"$RUNTIME_LOGFILE"</code> redirections
    before error checks (<code>|| Error "..."</code>).</li>
<li>Redirect <code>stderr</code> to the log file again at all times and use
    <code>2&gt;&gt;/dev/$DISPENSABLE_OUTPUT_DEV</code> in places expected to produce
    (lots of) stderr output under normal circumstances (false
    positives).</li>
</ol>
<p>My considerations:</p>
<ul>
<li>I appreciate the effort to reduce unnecessary messages in the ReaR
    log, in particular lots of 'false positives'.</li>
<li>In case of real errors, I would like to have as much detail as
    possible instantly (not in a second invocation).</li>
<li>I am always a bit wary of posting large logs like those produced in
    debugscript mode, as I find it hard to screen them for sensitive
    information, which I would not like to leak.</li>
</ul>
<h4 id="jsmeix_commented_at_2021-06-07_1353"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2416#issuecomment-855949302">2021-06-07 13:53</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-06-07_1353" title="Permanent link">&para;</a></h4>
<p>@OliverO2<br />
Wow!<br />
What a great analysis - as usual from you - much appreciated!</p>
<p>I prefer very much using</p>
<pre><code>COMMAND ... 2&gt;&gt;"$RUNTIME_LOGFILE" || Error "..."
</code></pre>
<p>at specific places where we (i.e. the ReaR developers) know<br />
(to some extent as far as possible with reasonable effort for us)<br />
that this particular COMMAND call only outputs on stderr<br />
when there is a real error so that ReaR exits with <code>Error</code>.</p>
<h4 id="jsmeix_commented_at_2021-06-07_1402"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2416#issuecomment-855956701">2021-06-07 14:02</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-06-07_1402" title="Permanent link">&para;</a></h4>
<p>@OliverO2<br />
I think <code>-D</code> debugscript mode can easily leak sensitive information into
the log file<br />
in this or that special circumstaces so I would not use <code>-D</code> in
environments<br />
where ReaR's log file is not sufficiently safe.<br />
But I think normal debug mode <code>-d</code> should be very much safer<br />
against leaking sensitive information into the log file<br />
but normal debug mode cannot be 100% safe because<br />
we cannot know what arbitrary programs may output<br />
on stdout or stderr under this or that special circumstances cf.<br />
<a href="https://github.com/rear/rear/issues/2416#issuecomment-702159687">https://github.com/rear/rear/issues/2416#issuecomment-702159687</a><br />
in particular when programs are called in verbose mode, cf.<br />
<a href="https://github.com/rear/rear/issues/2416#issuecomment-702142588">https://github.com/rear/rear/issues/2416#issuecomment-702142588</a></p>
<h4 id="jsmeix_commented_at_2021-06-07_1407"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2416#issuecomment-855960979">2021-06-07 14:07</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-06-07_1407" title="Permanent link">&para;</a></h4>
<p>Hmmm - after reading again my<br />
<a href="https://github.com/rear/rear/issues/2416#issuecomment-855956701">https://github.com/rear/rear/issues/2416#issuecomment-855956701</a><br />
I even think now that<br />
"Redirect stdout and stderr to the log only in debug modes - normally
discard them to /dev/null"<br />
(in particular with calling programs in verbose mode also only in debug
modes)<br />
is also a security feature because it avoids that whatever unexpected
program output<br />
may leak sensitive information into the log file - probably no secrets
like passwords<br />
but "internal" information that could be misused by someone who should
not know that.</p>
<h4 id="pcahyna_commented_at_2021-06-07_1526"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2416#issuecomment-856034599">2021-06-07 15:26</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-06-07_1526" title="Permanent link">&para;</a></h4>
<blockquote>
<p>(...) security feature because it avoids that whatever unexpected
program output<br />
may leak sensitive information into the log file</p>
</blockquote>
<p>Is the log file world-readable? Apparently it is, but probably it should
not be. (Files under <code>/etc/rear</code> are not.)</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2020-06-03.2416.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
