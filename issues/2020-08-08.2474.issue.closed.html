<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>2020 08 08.2474.issue.closed - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "2020 08 08.2474.issue.closed";
        var mkdocs_page_input_path = "issues/2020-08-08.2474.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', '366986045', 'auto');
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>2020 08 08.2474.issue.closed</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2474_issue_closed_opal_pba_does_not_boot_on_amd_apugpu_systems_missing_firmware_for_amdgpu_module"><a href="https://github.com/rear/rear/issues/2474">#2474 Issue</a> <code>closed</code>: Opal PBA does not boot on AMD APU/GPU systems: Missing firmware for amdgpu module<a class="headerlink" href="#2474_issue_closed_opal_pba_does_not_boot_on_amd_apugpu_systems_missing_firmware_for_amdgpu_module" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>fixed / solved / done</code></p>
<h4 id="bmastenbrook_opened_issue_at_2020-08-08_2143"><img src="https://avatars.githubusercontent.com/u/1457527?u=aff86cda77b6bc37fa09a0233ea68d397ed31b10&v=4" width="50"><a href="https://github.com/bmastenbrook">bmastenbrook</a> opened issue at <a href="https://github.com/rear/rear/issues/2474">2020-08-08 21:43</a>:<a class="headerlink" href="#bmastenbrook_opened_issue_at_2020-08-08_2143" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"):<br />
    Relax-and-Recover 2.6-git.4108.0f2f4a02.master / 2020-08-07</p>
</li>
<li>
<p>OS version ("cat /etc/os-release" or "lsb_release -a" or "cat
    /etc/rear/os.conf"):<br />
    Ubuntu 20.04.1 LTS (Focal Fossa)</p>
</li>
<li>
<p>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):<br />
    N/A without workaround described below</p>
</li>
<li>
<p>Hardware (PC or PowerNV BareMetal or ARM) or virtual machine (KVM
    guest or PoverVM LPAR):<br />
    PC (ThinkPad X395)</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device):<br />
    x86</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot):<br />
    UEFI / GRUB</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe):<br />
    NVMe WDC PC SN730 SDBQNTY-256G-1001</p>
</li>
<li>
<p>Storage layout ("lsblk -ipo
    NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT" or "lsblk" as
    makeshift):</p>
</li>
</ul>
<!-- -->

<pre><code>NAME           MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT
nvme0n1        259:0    0 238.5G  0 disk  
â”œâ”€nvme0n1p1    259:1    0    94M  0 part  /boot/efi
â”œâ”€nvme0n1p2    259:2    0  15.3G  0 part  
â”‚ â””â”€swap_crypt 253:0    0  15.3G  0 crypt [SWAP]
â””â”€nvme0n1p3    259:3    0 223.1G  0 part  /home
</code></pre>
<ul>
<li>Description of the issue (ideally so that others can reproduce it):</li>
</ul>
<p>The Opal PBA image includes modules from the running system but omits
firmware. During boot, KMS is enabled by default, and the amdgpu module
attempts to enable it. However, without firmware, this process hangs,
resulting in an unusable PBA.</p>
<ul>
<li>Workaround, if any:</li>
</ul>
<p><code>OPAL_PBA_KERNEL_CMDLINE="nomodeset"</code> in local.conf prevents amdgpu from
attempting to configure KMS and prevents the hang. Alternatively,
editing <code>prep/OPALPBA/Linux-i386/001_configure_workflow.sh</code> to prevent
<code>FIRMWARE_FILES</code> from being set to <code>no</code> results in a raw image that
works when booted off of a flash drive, but which is too large to be
used as a PBA.</p>
<ul>
<li>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files):</li>
</ul>
<p>N/A</p>
<h4 id="jsmeix_commented_at_2020-08-10_1013"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2474#issuecomment-671272445">2020-08-10 10:13</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-08-10_1013" title="Permanent link">&para;</a></h4>
<p>I know nothing about Opal PBA but I guess some code as in<br />
usr/share/rear/build/GNU/Linux/420_copy_firmware_files.sh<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/build/GNU/Linux/420_copy_firmware_files.sh">https://github.com/rear/rear/blob/master/usr/share/rear/build/GNU/Linux/420_copy_firmware_files.sh</a><br />
might be also useful when creating the Opal PBA image?</p>
<p>@OliverO2<br />
could you have a look at this issue here?</p>
<h4 id="olivero2_commented_at_2020-08-10_1025"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/2474#issuecomment-671277106">2020-08-10 10:25</a>:<a class="headerlink" href="#olivero2_commented_at_2020-08-10_1025" title="Permanent link">&para;</a></h4>
<p>@bmastenbrook Thanks for this detailed report and @jsmeix thanks for
pinging me. I'll look into this.</p>
<h4 id="olivero2_commented_at_2020-08-10_1045"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/2474#issuecomment-671284425">2020-08-10 10:45</a>:<a class="headerlink" href="#olivero2_commented_at_2020-08-10_1045" title="Permanent link">&para;</a></h4>
<p>My first idea would be to edit
<code>usr/share/rear/prep/OPALPBA/Linux-i386/001_configure_workflow.sh</code> as
follows:</p>
<ul>
<li>change <code>FIRMWARE_FILES=( 'no' )</code></li>
<li>to <code>FIRMWARE_FILES=( 'amdgpu' )</code></li>
</ul>
<p>@bmastenbrook Could you check if this change works?</p>
<p>If so, I'd envision to introduce a variable <code>OPAL_PBA_FIRMWARE_FILES</code>
which would enable overriding the current configuration for the PBA
only. In addition, maybe it would be a good idea to set
<code>FIRMWARE_FILES=( 'no' )</code> only if the initial setting has been
<code>FIRMWARE_FILES=( 'yes' )</code> or <code>FIRMWARE_FILES=()</code> as these would make
the PBA become too large.</p>
<h4 id="olivero2_commented_at_2020-08-23_2005"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/2474#issuecomment-678818442">2020-08-23 20:05</a>:<a class="headerlink" href="#olivero2_commented_at_2020-08-23_2005" title="Permanent link">&para;</a></h4>
<p>@bmastenbrook Thanks again for opening this issue. Just a friendly
reminder: Could you please respond to the suggested solution above or
state if you have lost interest, so that we have an idea on how to
proceed?</p>
<h4 id="bmastenbrook_commented_at_2020-09-03_0159"><img src="https://avatars.githubusercontent.com/u/1457527?u=aff86cda77b6bc37fa09a0233ea68d397ed31b10&v=4" width="50"><a href="https://github.com/bmastenbrook">bmastenbrook</a> commented at <a href="https://github.com/rear/rear/issues/2474#issuecomment-686186344">2020-09-03 01:59</a>:<a class="headerlink" href="#bmastenbrook_commented_at_2020-09-03_0159" title="Permanent link">&para;</a></h4>
<p>@OliverO2 Sorry, I've been pretty busy. I'll give this a try next week,
but I can't promise anything sooner. Apologies for the issue-and-run ðŸ™ƒ</p>
<h4 id="olivero2_commented_at_2020-09-04_0827"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/2474#issuecomment-687005951">2020-09-04 08:27</a>:<a class="headerlink" href="#olivero2_commented_at_2020-09-04_0827" title="Permanent link">&para;</a></h4>
<p>@bmastenbrook That's OK ðŸ˜Š. As you came up with a high quality issue
report and seems a permanent fix is just a few steps ahead, I justed
wanted to grab the occasion. Take your time, it would still be great if
you could test the above suggestion. Maybe you could even report the
output of <code>lspci | grep VGA</code>. If we could auto-configure the
<code>FIRMWARE_FILES</code> setting you (and others) would never have to worry
about this again.</p>
<h4 id="github-actions_commented_at_2020-11-04_0134"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2474#issuecomment-721463249">2020-11-04 01:34</a>:<a class="headerlink" href="#github-actions_commented_at_2020-11-04_0134" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="jsmeix_commented_at_2020-11-05_1358"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2474#issuecomment-722394552">2020-11-05 13:58</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-11-05_1358" title="Permanent link">&para;</a></h4>
<p>With
<a href="https://github.com/rear/rear/pull/2507">https://github.com/rear/rear/pull/2507</a>
merged<br />
this issue should be fixed.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2022 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2020-08-08.2474.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
