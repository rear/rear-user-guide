<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2177 Issue closed: rear runs ldd on vdso.so kernel module which segfaults and generates a memory error - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2177 Issue closed: rear runs ldd on vdso.so kernel module which segfaults and generates a memory error";
        var mkdocs_page_input_path = "issues/2019-07-08.2177.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2177 Issue closed: rear runs ldd on vdso.so kernel module which segfaults and generates a memory error</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2177_issue_closed_rear_runs_ldd_on_vdsoso_kernel_module_which_segfaults_and_generates_a_memory_error"><a href="https://github.com/rear/rear/issues/2177">#2177 Issue</a> <code>closed</code>: rear runs ldd on vdso.so kernel module which segfaults and generates a memory error<a class="headerlink" href="#2177_issue_closed_rear_runs_ldd_on_vdsoso_kernel_module_which_segfaults_and_generates_a_memory_error" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>cleanup</code>, <code>support / question</code>,
<code>fixed / solved / done</code>, <code>external tool</code></p>
<h4 id="rolfweilen_opened_issue_at_2019-07-08_1000"><img src="https://avatars.githubusercontent.com/u/20532944?v=4" width="50"><a href="https://github.com/RolfWeilen">RolfWeilen</a> opened issue at <a href="https://github.com/rear/rear/issues/2177">2019-07-08 10:00</a>:<a class="headerlink" href="#rolfweilen_opened_issue_at_2019-07-08_1000" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"):<br />
    Relax-and-Recover 2.5-git.0.a60d619.unknown.changed / 2019-06-07</p>
</li>
<li>
<p>OS version ("cat /etc/rear/os.conf" or "lsb_release -a" or "cat
    /etc/os-release"):<br />
    Red Hat Enterprise Linux Server 7.6 (Maipo)</p>
</li>
<li>
<p>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):</p>
</li>
</ul>
<!-- -->

<pre><code>AUTOEXCLUDE_MULTIPATH=N
OUTPUT=ISO
OUTPUT_URL=null
ISO_DEFAULT=manuel
TIMESYNC=NTP
BACKUP=TSM
TSM_RESULT_SAVE=n
TSM_RESULT_FILE_PATH=
USE_DHCLIENT=y
USE_STATIC_NETWORKING=
ONLY_INCLUDE_VG=(h50ll60vg00)
GRUB_RESCUE=n
WAIT_SECS=31104000
SSH_ROOT_PASSWORD=rear
</code></pre>
<ul>
<li>
<p>Hardware (PC or PowerNV BareMetal or ARM) or virtual machine (KVM
    guest or PoverVM LPAR):<br />
    KVM / RHV Guest</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device):<br />
    x86 compatible</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot):</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe):<br />
    local disk</p>
</li>
<li>
<p>Description of the issue (ideally so that others can reproduce
    it):<br />
    This question was already posted: ld-2.17.so killed by SIGSEGV
    #2056<br />
    I know its not a rear problem. The error in the message.debug
    appears when rear check the vdso.so with the ldd command. Our SAP
    System check this messages and ask us for help. The rear itself and
    restore works without any problem.</p>
</li>
</ul>
<p>rear log:</p>
<pre><code>++ chroot /tmp/rear.LPs6ioTnMixguCJ/rootfs /bin/bash --login -c 'cd /usr/lib/modules/3.10.0-957.12.1.el7.x86_64/vdso &amp;&amp; ldd /usr/lib/modules/3.10.0-957.12.1.el7.x86_64/vdso/vdso.so'
ldd: exited with unknown exit code (139)
</code></pre>
<p>Error in message.debug</p>
<pre><code>Jul  8 11:47:48 h50ll60 auth.info audispd:node=h50ll60 type=ANOM_ABEND msg=audit(1562579268.632:385404): auid=0 uid=0 gid=0 ses=36704 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 pid=25090 comm="ld-linux-x86-64" reason="memory violation" sig=11
</code></pre>
<p>Question: To prevent checking rear this library, can we define a exclude
for some libraries?</p>
<ul>
<li>
<p>Workaround, if any:</p>
</li>
<li>
<p>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files):<br />
<a href="https://github.com/rear/rear/files/3367780/rear-h50ll60.log">rear-h50ll60.log</a></p>
</li>
</ul>
<h4 id="jsmeix_commented_at_2019-07-08_1340"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509229320">2019-07-08 13:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-07-08_1340" title="Permanent link">&para;</a></h4>
<p>@RolfWeilen<br />
normally NON_FATAL_BINARIES_WITH_MISSING_LIBRARY<br />
is meant to exclude things from the <code>ldd</code> test, cf.<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L1399">https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L1399</a></p>
<p>I would think</p>
<pre><code>NON_FATAL_BINARIES_WITH_MISSING_LIBRARY='vdso'
</code></pre>
<p>should work to exclude any <code>vdso</code> stuff from being fatal for the <code>ldd</code>
test.</p>
<p>Doesn't it?</p>
<h4 id="jsmeix_commented_at_2019-07-08_1404"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509238760">2019-07-08 14:04</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-07-08_1404" title="Permanent link">&para;</a></h4>
<p>@RolfWeilen<br />
I do not understand your issue.<br />
From what I see in your rear-h50ll60.log<br />
the ldd segfault was (by accident) ignored<br />
and in the end all went fine as far as I see what you got<br />
as terminal output when you run <code>rear -D mkrescue</code>:</p>
<pre><code># egrep '+ Print |+ PrintError ' rear-h50ll60.log | cut -d ' ' -f3-
'Using autodetected kernel '\''/boot/vmlinuz-3.10.0-957.12.1.el7.x86_64'\'' as kernel in the recovery system'
'Creating disk layout'
'Excluding Volume Group h50ll60vg01'
'Using guessed bootloader '\''GRUB'\'' (found in first bytes on /dev/vda)'
'Verifying that the entries in /var/lib/rear/layout/disklayout.conf are correct ...'
'Creating root filesystem layout'
'Handling network interface '\''eth0'\'''
'eth0 is a physical device'
'Handled network interface '\''eth0'\'''
'Handling network interface '\''eth1'\'''
'eth1 is a physical device'
'Handled network interface '\''eth1'\'''
'Copying logfile /var/log/rear/rear-h50ll60.log into initramfs as '\''/tmp/rear-h50ll60-partial-2019-07-08T11:47:34+0200.log'\'''
'Copying files and directories'
'Copying binaries and libraries'
'Copying all kernel modules in /lib/modules/3.10.0-957.12.1.el7.x86_64 (MODULES contains '\''all_modules'\'')'
'Copying all files in /lib*/firmware/'
'Skip copying broken symlink '\''/etc/mtab'\'' target '\''/proc/18260/mounts'\'' on /proc/ /sys/ /dev/ or /run/'
'Broken symlink '\''/usr/lib/modules/3.10.0-957.12.1.el7.x86_64/build'\'' in recovery system because '\''readlink'\'' cannot determine its link target'
'Broken symlink '\''/usr/lib/modules/3.10.0-957.12.1.el7.x86_64/source'\'' in recovery system because '\''readlink'\'' cannot determine its link target'
'Testing that the recovery system in /tmp/rear.LPs6ioTnMixguCJ/rootfs contains a usable system'
'Creating recovery/rescue system initramfs/initrd initrd.cgz with gzip default compression'
'Created initrd.cgz with gzip default compression (448972701 bytes) in 43 seconds'
'Making ISO image'
'Wrote ISO image: /var/lib/rear/output/rear-h50ll60.iso (512M)'
'Exiting rear mkrescue (PID 8961) and its descendant processes ...'
'Running exit tasks'
'You should also rm -Rf /tmp/rear.LPs6ioTnMixguCJ'
</code></pre>
<p>And in particular what happened while<br />
usr/share/rear/build/default/990_verify_rootfs.sh<br />
was running (excerpt)</p>
<pre><code>+ source /usr/share/rear/build/default/990_verify_rootfs.sh
...
++ for binary in '$( find $ROOTFS_DIR -type f -executable -printf '\''/%P\n'\'' )'
++ grep -q 'not found'
+++ dirname /usr/lib/modules/3.10.0-957.12.1.el7.x86_64/vdso/vdso.so
++ chroot /tmp/rear.LPs6ioTnMixguCJ/rootfs /bin/bash --login -c 'cd /usr/lib/modules/3.10.0-957.12.1.el7.x86_64/vdso &amp;&amp; ldd /usr/lib/modules/3.10.0-957.12.1.el7.x86_64/vdso/vdso.so'
ldd: exited with unknown exit code (139)
++ for binary in '$( find $ROOTFS_DIR -type f -executable -printf '\''/%P\n'\'' )'
+++ dirname /usr/lib/modules/3.10.0-957.12.1.el7.x86_64/vdso/vdso32-int80.so
++ chroot /tmp/rear.LPs6ioTnMixguCJ/rootfs /bin/bash --login -c 'cd /usr/lib/modules/3.10.0-957.12.1.el7.x86_64/vdso &amp;&amp; ldd /usr/lib/modules/3.10.0-957.12.1.el7.x86_64/vdso/vdso32-int80.so'
++ grep -q 'not found'
++ for binary in '$( find $ROOTFS_DIR -type f -executable -printf '\''/%P\n'\'' )'
...
++ local fatal_missing_library=
++ contains_visible_char ''
...
++ true
+ source_return_code=0
...
+ source /usr/share/rear/build/default/995_md5sums_rootfs.sh
</code></pre>
<p>so <code>ldd /usr/lib/modules/3.10.0-957.12.1.el7.x86_64/vdso/vdso.so</code><br />
segfaults but that does not let ReaR error out but it just proceeds<br />
in this case (by accident because of how that pipe status<br />
is checked by that code).</p>
<p>So where is the actual problem?</p>
<h4 id="jsmeix_commented_at_2019-07-08_1409"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509241059">2019-07-08 14:09</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-07-08_1409" title="Permanent link">&para;</a></h4>
<p>@RolfWeilen<br />
I do not know what that <code>message.debug</code> file is.</p>
<h4 id="jsmeix_commented_at_2019-07-08_1411"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509241685">2019-07-08 14:11</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-07-08_1411" title="Permanent link">&para;</a></h4>
<p>@RolfWeilen<br />
forget my
<a href="https://github.com/rear/rear/issues/2177#issuecomment-509238760">https://github.com/rear/rear/issues/2177#issuecomment-509238760</a><br />
now I even see that you wrote</p>
<pre><code>The rear itself and restore works without any problem.
</code></pre>
<h4 id="rolfweilen_commented_at_2019-07-08_1412"><img src="https://avatars.githubusercontent.com/u/20532944?v=4" width="50"><a href="https://github.com/RolfWeilen">RolfWeilen</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509242167">2019-07-08 14:12</a>:<a class="headerlink" href="#rolfweilen_commented_at_2019-07-08_1412" title="Permanent link">&para;</a></h4>
<p>Hi<br />
Thanks for your answer. Yes everything is working, as i wrote in the
case.<br />
Just the ldd command generates an error to /var/log/messages witch is
tracked and controlled by guard system.</p>
<pre><code>Jul  8 15:50:39 h50ll60 auth.info audispd:node=h50ll60 type=ANOM_ABEND msg=audit(1562593839.903:389401): auid=0 uid=0 gid=0 ses=37105 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 pid=8105 comm="ld-linux-x86-64" reason="memory violation" sig=11
</code></pre>
<h4 id="jsmeix_commented_at_2019-07-08_1417"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509244020">2019-07-08 14:17</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-07-08_1417" title="Permanent link">&para;</a></h4>
<p>Now I think I understand what the actual problem is:</p>
<p>All you like is to not get that error message in that <code>message.debug</code>
file<br />
which leads to some false alarm by an automated tool.</p>
<p>For this <code>NON_FATAL_BINARIES_WITH_MISSING_LIBRARY</code><br />
won't work because it does not skip the segfaulting <code>ldd</code> test<br />
but it only specifies what <code>ldd</code> tests that result a 'not found'
thingy<br />
are considered to be not fatal.</p>
<p>So to work around that <code>ldd</code> segfault you need a special<br />
workaround in usr/share/rear/build/default/990_verify_rootfs.sh<br />
for your particular case - i.e. you need to modify that script<br />
as you need it in your particular case, cf.<br />
"Disaster recovery with Relax-and-Recover (ReaR)" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a><br />
that reads (excerpt)</p>
<pre><code>Experienced users and system admins can adapt or extend
the ReaR scripts to make it work for their particular cases
and - if the worst comes to the worst - even temporary
quick and dirty workarounds are relatively easily possible
</code></pre>
<h4 id="jsmeix_commented_at_2019-07-08_1424"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509247114">2019-07-08 14:24</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-07-08_1424" title="Permanent link">&para;</a></h4>
<p>Perhaps running <code>ldd</code> on kernel modules is in general nonsense<br />
so we may skip that <code>ldd</code> test on kernel modules in general?</p>
<h4 id="jsmeix_commented_at_2019-07-08_1429"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509248802">2019-07-08 14:29</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-07-08_1429" title="Permanent link">&para;</a></h4>
<p>@rear/contributors<br />
what do you think about<br />
<a href="https://github.com/rear/rear/issues/2177#issuecomment-509247114">https://github.com/rear/rear/issues/2177#issuecomment-509247114</a></p>
<h4 id="rolfweilen_commented_at_2019-07-09_0559"><img src="https://avatars.githubusercontent.com/u/20532944?v=4" width="50"><a href="https://github.com/RolfWeilen">RolfWeilen</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509500782">2019-07-09 05:59</a>:<a class="headerlink" href="#rolfweilen_commented_at_2019-07-09_0559" title="Permanent link">&para;</a></h4>
<p>Hi I have changed the script 990_verify_rootfs.sh as you recomended
for our case.<br />
Thanks a lot for this hint.</p>
<pre><code>#for binary in $( find $ROOTFS_DIR -type f -executable -printf '/%P\n' ); do
#SUVA Change
for binary in $( find $ROOTFS_DIR ! -name '*vdso*.so' -type f -executable -printf '/%P\n' ); do
</code></pre>
<h4 id="gdha_commented_at_2019-07-09_0629"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509507994">2019-07-09 06:29</a>:<a class="headerlink" href="#gdha_commented_at_2019-07-09_0629" title="Permanent link">&para;</a></h4>
<blockquote>
<p>@rear/contributors<br />
what do you think about<br />
<a href="https://github.com/rear/rear/issues/2177#issuecomment-509247114">#2177
(comment)</a><br />
@jsmeix Indeed not a bad idea to exclude kernel modules from the ldd
output.</p>
</blockquote>
<h4 id="jsmeix_commented_at_2019-07-09_0802"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509535978">2019-07-09 08:02</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-07-09_0802" title="Permanent link">&para;</a></h4>
<p>I will exclude kernel modules from the <code>ldd</code> test in<br />
usr/share/rear/build/default/990_verify_rootfs.sh</p>
<h4 id="jsmeix_commented_at_2019-07-09_0805"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509536763">2019-07-09 08:05</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-07-09_0805" title="Permanent link">&para;</a></h4>
<p>@RolfWeilen<br />
thank you for your prompt feedback what "quick and dirty workaround"<br />
made things work in your particular case.</p>
<h4 id="jsmeix_commented_at_2019-07-09_1150"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509610631">2019-07-09 11:50</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-07-09_1150" title="Permanent link">&para;</a></h4>
<p>@RolfWeilen</p>
<p>FYI:</p>
<p>I was wondering why in your particular case<br />
you have kernel modules in <code>/usr/lib/modules/</code><br />
instead of the normal directory <code>/lib/modules/</code>.</p>
<p>You may have a look at the output of e.g.</p>
<pre><code># egrep ' source |vdso|usr/lib/modules' rear-h50ll60.log
</code></pre>
<p>of your rear-h50ll60.log file that results in particular (excerpts)</p>
<pre><code>+ source /usr/share/rear/build/default/985_fix_broken_links.sh
/usr/lib/modules/3.10.0-957.12.1.el7.x86_64/weak-updates/kmod-kvdo/uds/uds.ko
/usr/lib/modules/3.10.0-957.12.1.el7.x86_64/weak-updates/kmod-kvdo/vdo/kvdo.ko
/usr/lib/modules/3.10.0-957.12.1.el7.x86_64/build
/usr/lib/modules/3.10.0-957.12.1.el7.x86_64/source
...
mkdir: created directory './usr/lib/modules/3.10.0-948.el7.x86_64'
mkdir: created directory './usr/lib/modules/3.10.0-948.el7.x86_64/extra'
mkdir: created directory './usr/lib/modules/3.10.0-948.el7.x86_64/extra/kmod-kvdo'
mkdir: created directory './usr/lib/modules/3.10.0-948.el7.x86_64/extra/kmod-kvdo/uds'
...
++ PrintError 'Broken symlink '\''/usr/lib/modules/3.10.0-957.12.1.el7.x86_64/build'\'' in recovery system because '\''readlink'\'' cannot determine its link target'
...
++ PrintError 'Broken symlink '\''/usr/lib/modules/3.10.0-957.12.1.el7.x86_64/source'\'' in recovery system because '\''readlink'\'' cannot determine its link target'
</code></pre>
<p>I think there could be something wrong on your original system<br />
when you have <code>/usr/lib/modules/3.10.0-957.12.1.el7.x86_64/</code> there.</p>
<h4 id="rolfweilen_commented_at_2019-07-10_0823"><img src="https://avatars.githubusercontent.com/u/20532944?v=4" width="50"><a href="https://github.com/RolfWeilen">RolfWeilen</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509962514">2019-07-10 08:23</a>:<a class="headerlink" href="#rolfweilen_commented_at_2019-07-10_0823" title="Permanent link">&para;</a></h4>
<p>Hi<br />
On our redhat server's the /lib and /usr/lib seems to be the same. Just
a link.<br />
I try to install a redhat from iso image and not from the satelite
install server.<br />
Redhat 7.6 and Redhat 8:</p>
<pre><code># ls -ld /lib
lrwxrwxrwx. 1 root root 7 Aug 30  2018 /lib -&gt; usr/lib

# ls -ld  /lib64
lrwxrwxrwx. 1 root root 9 Aug 30  2018 /lib64 -&gt; usr/lib64
</code></pre>
<h4 id="jsmeix_commented_at_2019-07-10_0919"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509982906">2019-07-10 09:19</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-07-10_0919" title="Permanent link">&para;</a></h4>
<p>@RolfWeilen<br />
thank you for the info how things are on Red Hat.</p>
<p>A side note:</p>
<p>Let's hope that no Linux distribution uses something new<br />
like <code>lib64/modules</code> or whatever else for kernel modules<br />
(the usual suspect for unexpected fancy deviations is Arch Linux ;-)<br />
because ReaR only looks at <code>/lib/modules/$KERNEL_VERSION</code><br />
(cf. usr/share/rear/build/GNU/Linux/400_copy_modules.sh and other
scripts)<br />
where <code>KERNEL_VERSION="$( uname -r )"</code> by default<br />
(cf. usr/share/rear/conf/default.conf but see also <code>-r</code> in "man rear")<br />
which matches what "man modprobe" reads</p>
<pre><code>modprobe looks in the module directory
/lib/modules/`uname -r` for all the modules
</code></pre>
<p>at least on my old SLES11 and also on my<br />
newer SLES15-like openSUSE Leap 15.0.</p>
<h4 id="rolfweilen_commented_at_2019-07-10_0928"><img src="https://avatars.githubusercontent.com/u/20532944?v=4" width="50"><a href="https://github.com/RolfWeilen">RolfWeilen</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-509986207">2019-07-10 09:28</a>:<a class="headerlink" href="#rolfweilen_commented_at_2019-07-10_0928" title="Permanent link">&para;</a></h4>
<p>Hi<br />
I installed a redhat server 7.6 from dvd with same result. /lib is a
link to /usr/lib.<br />
regards<br />
rolf</p>
<h4 id="jsmeix_commented_at_2019-07-10_1241"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2177#issuecomment-510044152">2019-07-10 12:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-07-10_1241" title="Permanent link">&para;</a></h4>
<p>With
<a href="https://github.com/rear/rear/pull/2179">https://github.com/rear/rear/pull/2179</a>
merged<br />
this issue should be avoided.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2019-07-08.2177.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
