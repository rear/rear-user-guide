<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2625 PR merged: Fix backup removal in exit task and cleanup handling of URL mountpoints - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2625 PR merged: Fix backup removal in exit task and cleanup handling of URL mountpoints";
        var mkdocs_page_input_path = "issues/2021-06-04.2625.pr.merged.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2625 PR merged: Fix backup removal in exit task and cleanup handling of URL mountpoints</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2625_pr_merged_fix_backup_removal_in_exit_task_and_cleanup_handling_of_url_mountpoints"><a href="https://github.com/rear/rear/pull/2625">#2625 PR</a> <code>merged</code>: Fix backup removal in exit task and cleanup handling of URL mountpoints<a class="headerlink" href="#2625_pr_merged_fix_backup_removal_in_exit_task_and_cleanup_handling_of_url_mountpoints" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>cleanup</code>, <code>fixed / solved / done</code>,
<code>critical / security / legal</code></p>
<h4 id="pcahyna_opened_issue_at_2021-06-04_1808"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> opened issue at <a href="https://github.com/rear/rear/pull/2625">2021-06-04 18:08</a>:<a class="headerlink" href="#pcahyna_opened_issue_at_2021-06-04_1808" title="Permanent link">&para;</a></h4>
<h5 id="pull_request_details">Pull Request Details:<a class="headerlink" href="#pull_request_details" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p>Type: <strong>Bug Fix</strong> / <strong>Cleanup</strong></p>
</li>
<li>
<p>Impact: <strong>Critical</strong></p>
</li>
<li>
<p>Reference to related issue (URL): #2611 #782 #465</p>
</li>
<li>
<p>How was this pull request tested?<br />
    On CentOS 7 or CentOS 8:</p>
<ul>
<li>backup and restore with backup on ISO and ISO stored on
    <code>OUTPUT_URL=sftp://</code></li>
<li>backup to NFS with several reproducers for #2611 :<ul>
<li>overriding <code>umount</code> by a function that does nothing and
    inserting a script that kills ReaR before unmounting URLs,
    thus triggering the exit tasks<ul>
<li>both in backup and output stages (bug was present only
    in the output stage)</li>
</ul>
</li>
<li>inserting a script that blocks umount by spawning a long
    running process with its cwd inside the temporary mountpoint
    <code>$BUILD_DIR/outputfs</code><ul>
<li>both in backup and output stages (bug was present only
    in the output stage)</li>
</ul>
</li>
<li>overriding <code>umount</code> by a function that does nothing and
    returns an error<ul>
<li>only in the output stage</li>
</ul>
</li>
</ul>
</li>
<li>backup to NFS without any bug reproducer</li>
<li>complete backup and restore with rsync over ssh (<code>BACKUP=RSYNC</code>)</li>
<li>backup to sshfs (<code>BACKUP=NETFS</code> <code>BACKUP_URL=sshfs://...</code>)</li>
<li>mkrescue with <code>OUTPUT=PXE</code> and several reproducers<br />
<code>PXE_TFTP_URL: nfs://...</code>, <code>PXE_CONFIG_URL: nfs://</code>. Reproducers
    consist of overriding <code>umount</code> by a function that does nothing
    and returns an error<ul>
<li>before <code>800_copy_to_tftp.sh</code></li>
<li>before <code>810_create_pxelinux_cfg.sh</code></li>
</ul>
</li>
<li>mkrescue with <code>OUTPUT=PXE</code> and no bug reproducer<br />
<code>PXE_TFTP_URL: nfs://...</code>, <code>PXE_CONFIG_URL: nfs://</code></li>
</ul>
</li>
</ul>
<p>In the case of reproducers I chceked that other directories under the
mountpoint do not get removed. In the case of no reproducers I checked
that the proces completes successfully, and also that the build dir is
correctly removed and that ReaR does not create and remove useless
<code>$BUILD_DIR/outputfs</code> with URL schemes that do not need it (<code>rsync://</code>,
<code>sftp://</code>).</p>
<ul>
<li>Brief description of the changes in this pull request:</li>
</ul>
<p>Cleanup of temporary mount point handling, particularly for output.
Unification of mount point umount and cleanup - move to the
<code>mount_url()</code> and <code>umount_url()</code> functions, callers do not need to worry
about it, resulting in huge deduplication (demultiplication), this
concerns both the normal path and the error path (exit tasks). Replaced
the various <code>rm -rf</code> of the mountpoint by <code>rmdir</code> (this fixes #2611)
and added lazy umount in case normal umount does not succeed. If build
dir is kept, propose a safe way to remove it to the user
(<code>rm -Rf --one-file-system</code> instead of just <code>rm -Rf</code> where the user
would risk to remove everything in their mounted filesystem if still
mounted.)</p>
<p>Stop creating the empty mountpoint (<code>$BUILD_DIR/outputfs</code>) for schemes
that do not need to mount anything (<code>rsync://</code> or anything "ftp-like".)</p>
<p>Fixes also some other bugs noted in the process: filesystem-specific
umount command not called
(<a href="https://github.com/rear/rear/commit/20359a987662cc0c3fcfa52d62d1feac7cd55850#r51319634">https://github.com/rear/rear/commit/20359a987662cc0c3fcfa52d62d1feac7cd55850#r51319634</a>)
, unknown schemes considered invalid (noted in discussion under #932).</p>
<p>Identical scripts under <code>DUPLICITY</code> and <code>YUM</code> were replaced by symlinks
to increase code sharing.</p>
<p>Reverts #782 (the change that introduced bug #2611) and #578 - it is
not clear how .lockfile can exist in the unmounted filesystem, and if it
does, it is a bug.</p>
<h4 id="pcahyna_commented_at_2021-06-07_0749"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-855687261">2021-06-07 07:49</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-06-07_0749" title="Permanent link">&para;</a></h4>
<p>@N3WWN hello, please review the part that touches YUM (the second, third
and fourth commit in the series).</p>
<h4 id="pcahyna_commented_at_2021-06-07_1038"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-855815719">2021-06-07 10:38</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-06-07_1038" title="Permanent link">&para;</a></h4>
<p>During the work on this branch I have found many other issues that are
not fixed in this PR (to keep the amount changes manageable). They are:</p>
<ol>
<li>Unexpected use of <code>local</code> backup scheme in RBME:
    5d85fc250232921bf314643e22b210b71996884f</li>
<li>Probably wrong symlink in BLOCKCLONE: PR #1172 , commit
    a4ab7406e653406c010c58a232f898d1ea85e592 @gozora</li>
<li>Duplicate script in PXE: d850c4094238a03c9b926b88d7e1582ecd28af52</li>
<li>UEFI seems to have broken OBDR support:
    41efc97eb7141c30455df45a871b98cd08e09fa7</li>
<li>OBDR probably got broken on ppc64le:
    4ef0f30156f0afea4a02d12f40c2c9d18cbe5e43, PR #1383</li>
<li><code>OUTPUT_MOUNTCMD</code> got broken by commit
    6cd218ae30601eb56098b22581345f6ea8fe0aa2, see
    <a href="https://github.com/rear/rear/commit/20359a987662cc0c3fcfa52d62d1feac7cd55850#r51375233">https://github.com/rear/rear/commit/20359a987662cc0c3fcfa52d62d1feac7cd55850#r51375233</a></li>
<li><code>OUTPUT_UMOUNTCMD</code> is not called in exit tasks on error</li>
<li>Possible problems with <code>.lockfile</code>: PR #578 - what is <code>.lockfile</code>
    actually used for? What if <code>$OUTPUT_URL = $BACKUP_URL</code> but
    <code>$OUTPUT_PREFIX != $NETFS_PREFIX</code> ? What if
    <code>NETFS_KEEP_OLD_BACKUP_COPY</code> is set and <code>KEEP_OLD_OUTPUT_COPY</code> is
    unset? Also, it seems that <code>opath.old</code> created by a run that aborts
    will then be removed entirely by a subsequent run, because the
    lockfile will get removed by <code>150_save_copy_of_prefix_dir.sh</code>,
    resulting in no working backup.
    <code>backup/NETFS/default/250_create_lock.sh</code> claims that it "creates a
    lockfile in $NETFS_PREFIX to avoid that mkrescue overwrites
    ISO/LOGFILE made by a previous mkbackup run when the variable
    NETFS_KEEP_OLD_BACKUP_COPY has been set", but it is not clear
    how this gets achieved in the code.</li>
<li>backup log gets copied to <code>${opath}</code> even if <code>${opath}</code> is an empty
    string (can happen when backing up to a tape), resulting in dropping
    the log to the root directory:
    <a href="https://github.com/rear/rear/blob/2433c72f614af5b22547d6bd873ff4d224901a2c/usr/share/rear/backup/NETFS/default/500_make_backup.sh#L357">https://github.com/rear/rear/blob/2433c72f614af5b22547d6bd873ff4d224901a2c/usr/share/rear/backup/NETFS/default/500_make_backup.sh#L357</a></li>
<li>FDRUPSTREAM seems to copy a file to the output location when it is
    not mounted yet: #2142 @mutable-dan</li>
</ol>
<h4 id="jsmeix_commented_at_2021-06-08_1131"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-856684954">2021-06-08 11:31</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-06-08_1131" title="Permanent link">&para;</a></h4>
<p>@pcahyna<br />
thank you so much for that huge cleanup and severe bugfix work!</p>
<p>I will have a look as time permits but possibly it gets delayed until
next week.</p>
<p>@gdha @rmetrich and all @rear/contributors<br />
I would much appreciate it if you find some time and have a look.<br />
Perhaps you spot this or that issue by plain looking at the code?</p>
<p>Regarding "Impact: Urgent (Is Urgent higher than Critical?)"<br />
Personally I think Urgent issues have higher timing priority than
Critical issues<br />
because Urgent means actual time pressure right now while Critical does
not<br />
necessarily imply time pressure but Critical could imply time pressure
indirectly.<br />
In this particular case I think the issue is Critical (because possible
loss of data)<br />
but not actually Urgent (because no current end-user case who has the
issue).</p>
<h4 id="n3wwn_commented_at_2021-06-08_1300"><img src="https://avatars.githubusercontent.com/u/19431804?v=4" width="50"><a href="https://github.com/N3WWN">N3WWN</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-856745716">2021-06-08 13:00</a>:<a class="headerlink" href="#n3wwn_commented_at_2021-06-08_1300" title="Permanent link">&para;</a></h4>
<blockquote>
<p>@N3WWN hello, please review the part that touches YUM (the second,
third and fourth commit in the series).</p>
</blockquote>
<p>@pcahyna LGTM! I recall explicitly copying the files instead of using
symlinks in case the files were still in a state of flux (the ZIPPER
method was pretty new at the time) and I didn't want to force others to
test the YUM method. Now that these methods have been shown to be out of
active change/development, I think it's safe to convert the files to
symlinks. Thanks!</p>
<h4 id="pcahyna_commented_at_2021-06-08_1314"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-856756461">2021-06-08 13:14</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-06-08_1314" title="Permanent link">&para;</a></h4>
<p>@N3WWN thanks for the review. Note though that the symlinked files are
not those copied from ZYPPER (those usually have some modifications, al
least s/ZYPPER/YUM/), but from NETFS. It would be nice to share files
between ZYPPER and YUM, but it would take more work.</p>
<h4 id="n3wwn_commented_at_2021-06-08_1333"><img src="https://avatars.githubusercontent.com/u/19431804?v=4" width="50"><a href="https://github.com/N3WWN">N3WWN</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-856772089">2021-06-08 13:33</a>:<a class="headerlink" href="#n3wwn_commented_at_2021-06-08_1333" title="Permanent link">&para;</a></h4>
<blockquote>
<p>@N3WWN thanks for the review. Note though that the symlinked files are
not those copied from ZYPPER (those usually have some modifications,
al least s/ZYPPER/YUM/), but from NETFS. It would be nice to share
files between ZYPPER and YUM, but it would take more work.</p>
</blockquote>
<p>Yes, you're correct. It's been a minute since I've really looked at the
code, but still LGTM even after my mistaken reference ;)</p>
<h4 id="gdha_commented_at_2021-06-11_0707"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-859335712">2021-06-11 07:07</a>:<a class="headerlink" href="#gdha_commented_at_2021-06-11_0707" title="Permanent link">&para;</a></h4>
<p>@pcahyna concerning OBDR - I cannot recall anyone ever used this
(besides myself when I implemented this &gt;10yrs ago and since then
never used nor tested). I would even vote to remove this from ReaR (why
maintaining if not used)?<br />
Lots of changes - so we will see how these behave after a while ;-)<br />
The problem with ReaR is/was it tries to do good for too many people
without the needed backup/help from the community and then small
mistakes creep in... It is good to clean up the code.<br />
And for that a big kudo for @pcahyna and @jsmeix</p>
<h4 id="pcahyna_commented_at_2021-06-11_0801"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-859368278">2021-06-11 08:01</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-06-11_0801" title="Permanent link">&para;</a></h4>
<p>@gdha thank you for your review. Could you please have a look at the
problems reported above, especially item 3. (apparently redundant script
under PXE) and item 8. (intent of .lockfile)?</p>
<h4 id="pcahyna_commented_at_2021-06-18_1021"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-863932670">2021-06-18 10:21</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-06-18_1021" title="Permanent link">&para;</a></h4>
<p>I am going to push some commits to address what you have found and
rebase. I will revert d850c4094238a03c9b926b88d7e1582ecd28af52 as well.</p>
<h4 id="jsmeix_commented_at_2021-06-18_1042"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-863945024">2021-06-18 10:42</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-06-18_1042" title="Permanent link">&para;</a></h4>
<p>@pcahyna<br />
if you like you may do as a "by the way" addon in this pull request<br />
<a href="https://github.com/rear/rear/pull/2608#issuecomment-832939131">https://github.com/rear/rear/pull/2608#issuecomment-832939131</a><br />
<a href="https://github.com/rear/rear/pull/2608#issuecomment-834219708">https://github.com/rear/rear/pull/2608#issuecomment-834219708</a></p>
<h4 id="pcahyna_commented_at_2021-06-18_1117"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-863964139">2021-06-18 11:17</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-06-18_1117" title="Permanent link">&para;</a></h4>
<p>@jsmeix all the updates pushed. If it looks ok, I will rebase one more
time to squash a fixup commit into its ancestor and then you can merge
the PR.</p>
<h4 id="pcahyna_commented_at_2021-06-18_1120"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-863965520">2021-06-18 11:20</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-06-18_1120" title="Permanent link">&para;</a></h4>
<blockquote>
<p>concerning OBDR - I cannot recall anyone ever used this (besides
myself when I implemented this &gt;10yrs ago and since then never used
nor tested). I would even vote to remove this from ReaR (why
maintaining if not used)?</p>
</blockquote>
<p>@gdha Do new tape drives support OBDR, or is it something that HP
dropped a long time ago? If it got dropped, I am for removing it. If it
is still supported on reasonably modern hardware, I could try
resurrecting it.</p>
<h4 id="jsmeix_commented_at_2021-06-18_1132"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-863972251">2021-06-18 11:32</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-06-18_1132" title="Permanent link">&para;</a></h4>
<p>From plain looking at the changes all looks good to me<br />
so @pcahyna you can rebase and squash as you need.</p>
<h4 id="pcahyna_commented_at_2021-06-18_1157"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-863984533">2021-06-18 11:57</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-06-18_1157" title="Permanent link">&para;</a></h4>
<p>rebase finished.</p>
<h4 id="jsmeix_commented_at_2021-06-18_1157"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-863984556">2021-06-18 11:57</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-06-18_1157" title="Permanent link">&para;</a></h4>
<p>FYI regarding OBDR:<br />
At SUSE we got in July 2018 a customer issue report about</p>
<pre><code>ReaR OUTPUT=OBDR support missing for PPC64LE (needs to be implemented)
</code></pre>
<p>on SLES12 SP2 with SAP on PPC64LE using ReaR 1.18 which resulted<br />
<a href="https://github.com/rear/rear/issues/1868">https://github.com/rear/rear/issues/1868</a></p>
<p>In our SUSE internal issue report I found this piece of information:</p>
<pre><code>Tape drive is a IBM 7226 multimedia enclosure
It is not clear at this time if it supports OBDR ...
since 7226 multimedia enclosure seems
no function of OBDR(not sure)
</code></pre>
<p>cf.
<a href="https://www.ibm.com/products/7226-multimedia-enclosure">https://www.ibm.com/products/7226-multimedia-enclosure</a><br />
and
<a href="https://www.ibm.com/downloads/cas/XQ1DVZJP">https://www.ibm.com/downloads/cas/XQ1DVZJP</a><br />
where none of them contain <code>OBDR</code> so it seems<br />
a IBM 7226 multimedia enclosure does not support OBDR.</p>
<p>There was no further info whether or not that drive actually supports
OBDR<br />
or any further info how far OBDR actually worked for them, cf.<br />
<a href="https://github.com/rear/rear/issues/1868#issuecomment-406592866">https://github.com/rear/rear/issues/1868#issuecomment-406592866</a></p>
<h4 id="pcahyna_commented_at_2021-06-18_1159"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-863985923">2021-06-18 11:59</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-06-18_1159" title="Permanent link">&para;</a></h4>
<p>rebased again to fix a typo in commit message</p>
<h4 id="pcahyna_commented_at_2021-06-18_1200"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-863986548">2021-06-18 12:00</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-06-18_1200" title="Permanent link">&para;</a></h4>
<p>I thought that OBDR was HP-specific, but maybe it got implemented by
other vendors as well.</p>
<h4 id="jsmeix_commented_at_2021-06-18_1203"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-863988241">2021-06-18 12:03</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-06-18_1203" title="Permanent link">&para;</a></h4>
<p>If there are no objections right now<br />
I would like to merge it in about half an hour.</p>
<h4 id="jsmeix_commented_at_2021-06-18_1205"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-863988957">2021-06-18 12:05</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-06-18_1205" title="Permanent link">&para;</a></h4>
<p>When OBDR is/was HP-specific it explains why IBM documents don't mention
it.</p>
<h4 id="pcahyna_commented_at_2021-06-18_1213"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-863993973">2021-06-18 12:13</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-06-18_1213" title="Permanent link">&para;</a></h4>
<p>I pushed again to fix another tiny commit message mistake, no functional
difference.</p>
<h4 id="gdha_commented_at_2021-06-18_1227"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-864002011">2021-06-18 12:27</a>:<a class="headerlink" href="#gdha_commented_at_2021-06-18_1227" title="Permanent link">&para;</a></h4>
<p>@pcahyna Yes, OBDR is HPE specific - see the included PDF file.</p>
<blockquote>
<p>I thought that OBDR was HP-specific, but maybe it got implemented by
other vendors as well.</p>
</blockquote>
<p><a href="https://github.com/rear/rear/files/6676977/Compatibility_Matrices.pdf">Compatibility_Matrices.pdf</a></p>
<p>That being said we never got a complaint it wasn't working (and I'm
pretty sure it is broken in the meantime) - IMHO I'm in favor of
removing it altogether. @dagwieers Do you mind if it was gone as you
were the only one ever used by my knowledge?</p>
<h4 id="jsmeix_commented_at_2021-06-18_1305"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2625#issuecomment-864023989">2021-06-18 13:05</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-06-18_1305" title="Permanent link">&para;</a></h4>
<p>@pcahyna<br />
again many thanks for your huge bugfix and cleanup work!</p>
<p>I wish you and all ReaR contributors and users<br />
a relaxed and recovering weekend!</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2021-06-04.2625.pr.merged.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
