<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#172 Issue closed: Could not stat device /dev/hda - No such file or directory with Citrix XenCenter - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#172 Issue closed: Could not stat device /dev/hda - No such file or directory with Citrix XenCenter";
        var mkdocs_page_input_path = "issues/2012-10-31.172.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#172 Issue closed: Could not stat device /dev/hda - No such file or directory with Citrix XenCenter</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="172_issue_closed_could_not_stat_device_devhda_-_no_such_file_or_directory_with_citrix_xencenter"><a href="https://github.com/rear/rear/issues/172">#172 Issue</a> <code>closed</code>: Could not stat device /dev/hda - No such file or directory with Citrix XenCenter<a class="headerlink" href="#172_issue_closed_could_not_stat_device_devhda_-_no_such_file_or_directory_with_citrix_xencenter" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code></p>
<h4 id="unknown_opened_issue_at_2012-10-31_1537"><img src="(unknown)" width="50"><a href="(unknown)">(unknown)</a> opened issue at <a href="https://github.com/rear/rear/issues/172">2012-10-31 15:37</a>:<a class="headerlink" href="#unknown_opened_issue_at_2012-10-31_1537" title="Permanent link">&para;</a></h4>
<p>*** 2012/10/30 ***</p>
<p>Hello,</p>
<p>I am trying to P2V a Debian 4.0 machine (with rear 1.12.0) to Citrix<br />
XenServer.</p>
<p>When trying "rear restore" after some time the script stops telling:</p>
<p>Could not stat device /dev/hda - No such file or directory<br />
An error occured during layout creation.</p>
<p>In some step before, /dev/sda has already mapped to /dev/hda.</p>
<p>The last part of the log, reguarding this step says:</p>
<pre><code>2012-10-30 12:25:38.993558424 User selected: 5) Continue recovery
2012-10-30 12:25:40.333447853 Including
layout/recreate/default/20_run_script.sh
2012-10-30 12:25:40.335624542 Start system layout restoration.
/var/lib/rear/layout/diskrestore.sh: line 7: lvm: command not found
+++ create_component /dev/hda disk
+++ local device=/dev/hda
+++ local type=disk
+++ local touchfile=disk--dev-hda
+++ '[' -e /tmp/rear.abjwAhPplwL1638/tmp/touch/disk--dev-hda ']'
+++ return 0
+++ LogPrint 'Creating partitions for disk /dev/hda (msdos)'
+++ Log 'Creating partitions for disk /dev/hda (msdos)'
+++ test 1 -gt 0
++++ Stamp
++++ date '+%Y-%m-%d %H:%M:%S.%N '
+++ echo '2012-10-30 12:25:40.341070133 Creating partitions for disk
/dev/hda (msdos)'
2012-10-30 12:25:40.341070133 Creating partitions for disk /dev/hda (msdos)
+++ Print 'Creating partitions for disk /dev/hda (msdos)'
+++ test 1
+++ echo -e 'Creating partitions for disk /dev/hda (msdos)'
+++ parted -s /dev/hda mklabel msdos
Error: Could not stat device /dev/hda - No such file or directory.
2012-10-30 12:25:40.346433585 An error occured during layout recreation.
2012-10-30 12:36:54.834035743 User selected: 6) Abort Rear
2012-10-30 12:36:54.835396707 Error detected during restore.
2012-10-30 12:36:54.836574105 Restoring backup of
/var/lib/rear/layout/disklayout.conf
PROGRESS: caller is a shell builtin
Trace: 63 source /usr/share/rear/layout/recreate/default/20_run_script.sh
Trace: 40 Source /usr/share/rear/lib/framework-functions.sh
Trace: 79 SourceStage /usr/share/rear/lib/framework-functions.sh
Trace: 31 WORKFLOW_recover /usr/share/rear/lib/recover-workflow.sh
Trace: 242 main /bin/rear
PROGRESS: /usr/share/rear/lib/_input-output-functions.sh: line 108: [:
too many arguments
2012-10-30 12:36:54.840476633 ERROR: There was an error restoring the
system layout. See /tmp/rear-localhost.log for details.
2012-10-30 12:36:54.846231867 Running exit tasks.
2012-10-30 12:36:54.847995959 Exit task 'umount -f -v
'/tmp/rear.abjwAhPplwL1638/outputfs' &gt;&amp;2'
192.168.0.104:/home/install/images/rear/ umounted
2012-10-30 12:36:54.930050524 Exit task 'rmdir -v
/tmp/rear.abjwAhPplwL1638/outputfs &gt;&amp;2'
rmdir: removing directory, /tmp/rear.abjwAhPplwL1638/outputfs
2012-10-30 12:36:54.932048695 Exit task 'cleanup_build_area_and_end_program'
2012-10-30 12:36:54.933460974 Finished in 981 seconds
2012-10-30 12:36:54.936060437 You should also rm -Rf
/tmp/rear.abjwAhPplwL1638
2012-10-30 12:36:54.938824880 End of program reached
2012-10-30 12:36:54.940213950 Exit task 'exec 8&gt;&amp;-'
2012-10-30 12:36:54.941681278 Exit task 'exec 7&gt;&amp;-'
</code></pre>
<p>Any ideas?</p>
<p>Thanks!</p>
<p>Regards,<br />
Ivan</p>
<p>*** 2012/10/31 ***</p>
<blockquote>
<p>Hi Ivan,</p>
<p>Before starting the recover check if device /dev/hda is really
available, e.g.<br />
with fdisk -l /dev/hda<br />
I also noticed that "lvm" command was not copied? Can you check this
in the<br />
log file (of rear mkbackup process) on the original system?<br />
If the problem persist pls. open an issue tracker so it's easier for
us to follow<br />
up.<br />
thanks for using rear,<br />
Gratien</p>
</blockquote>
<p>Hi Gratien,</p>
<p>thanks for your help!</p>
<p>I tried fdisk /dev/hda (with option -l gave me no output) and rear
tells<br />
me that it is unable to open /dev/hda.</p>
<p>It is quite strange, because I have a device /dev/hda assigned to this<br />
machine in Citrix XenCenter.</p>
<p>I also tried mounting and partitioning this device with "parted magic"<br />
for example - that was no problem!</p>
<p>Regards,<br />
Ivan</p>
<h4 id="unknown_commented_at_2012-11-01_1153"><img src="(unknown)" width="50"><a href="(unknown)">(unknown)</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-9977845">2012-11-01 11:53</a>:<a class="headerlink" href="#unknown_commented_at_2012-11-01_1153" title="Permanent link">&para;</a></h4>
<p>This is the rear-partial.log when the image was created:</p>
<pre><code>2012-10-29 22:43:44 Relax and Recover 1.12.0 / 2011-11-22 10:21:35 +0100
2012-10-29 22:43:44 Command line options: /usr/sbin/rear -v mkbackup
2012-10-29 22:43:45 Including conf/Linux-i386.conf
2012-10-29 22:43:45 Including conf/GNU/Linux.conf
2012-10-29 22:43:45 Including /etc/rear/local.conf
/etc/rear/local.conf: line 149: backup: command not found
2012-10-29 22:43:45 Using build area '/tmp/rear.dRJFvPczrt31105'
mkdir: created directory `/tmp/rear.dRJFvPczrt31105/rootfs'
mkdir: created directory `/tmp/rear.dRJFvPczrt31105/tmp'
2012-10-29 22:43:45 Running mkbackup workflow
2012-10-29 22:43:45 Running 'prep' stage
2012-10-29 22:43:45 Including prep/default/02_translate_url.sh
2012-10-29 22:43:45 Using NETFS_URL is deprecated. Use BACKUP_URL instead.
2012-10-29 22:43:46 Including prep/NETFS/default/05_check_NETFS_requirements.sh
2012-10-29 22:43:46 Skipping ping test
2012-10-29 22:43:46 Including prep/NETFS/default/15_save_rsync_version.sh
2012-10-29 22:43:46 Including prep/GNU/Linux/20_include_agetty.sh
2012-10-29 22:43:46 Including prep/NETFS/GNU/Linux/20_selinux_in_use.sh
2012-10-29 22:43:46 Including prep/GNU/Linux/21_include_dhclient.sh
2012-10-29 22:43:46 Including prep/GNU/Linux/22_include_lvm_tools.sh
2012-10-29 22:43:46 Including prep/GNU/Linux/23_include_md_tools.sh
2012-10-29 22:43:46 Including prep/GNU/Linux/28_include_systemd.sh
2012-10-29 22:43:46 Including prep/GNU/Linux/28_include_vmware_tools.sh
2012-10-29 22:43:46 Including prep/GNU/Linux/29_include_drbd.sh
2012-10-29 22:43:46 Including prep/ISO/default/30_check_iso_dir.sh
2012-10-29 22:43:46 Including prep/GNU/Linux/30_include_grub_tools.sh
2012-10-29 22:43:46 Including prep/ISO/default/32_check_cdrom_size.sh
2012-10-29 22:43:46 ISO Directory '/tmp' [/dev/sda3] has 17249 MB free space
2012-10-29 22:43:46 Including prep/ISO/GNU/Linux/32_verify_mkisofs.sh
2012-10-29 22:43:46 Using '/usr/bin/mkisofs' to create ISO images
2012-10-29 22:43:46 Including prep/ISO/Linux-i386/33_find_isolinux.sh
2012-10-29 22:43:46 Including prep/NETFS/default/40_automatic_exclude_recreate.sh
2012-10-29 22:43:46 Finished running 'prep' stage in 1 seconds
2012-10-29 22:43:46 Running 'layout/save' stage
2012-10-29 22:43:46 Including layout/save/GNU/Linux/10_create_layout_file.sh
2012-10-29 22:43:46 Creating disk layout
2012-10-29 22:43:46 Preparing layout directory.
2012-10-29 22:43:46 Removing old layout file.
2012-10-29 22:43:46 Including layout/save/GNU/Linux/20_partition_layout.sh
2012-10-29 22:43:46 Saving disk partitions.
Error: Error opening /dev/hda: No medium found
Error: Error opening /dev/hda: No medium found
2012-10-29 22:43:47 Unsupported disk label  on hda.
2012-10-29 22:43:48 Including layout/save/GNU/Linux/21_raid_layout.sh
2012-10-29 22:43:48 Including layout/save/GNU/Linux/22_lvm_layout.sh
2012-10-29 22:43:48 Including layout/save/GNU/Linux/23_filesystem_layout.sh
2012-10-29 22:43:48 Saving Filesystem layout.
2012-10-29 22:43:49 Including layout/save/GNU/Linux/24_swaps_layout.sh
2012-10-29 22:43:49 Saving Swap information.
2012-10-29 22:43:49 Including layout/save/GNU/Linux/25_drbd_layout.sh
2012-10-29 22:43:49 Including layout/save/GNU/Linux/26_crypt_layout.sh
2012-10-29 22:43:49 Including layout/save/GNU/Linux/27_hpraid_layout.sh
2012-10-29 22:43:49 Including layout/save/GNU/Linux/28_multipath_layout.sh
/usr/share/rear/layout/save/GNU/Linux/28_multipath_layout.sh: line 23: dmsetup: command not found
2012-10-29 22:43:49 Including layout/save/default/30_list_dependencies.sh
2012-10-29 22:43:50 Including layout/save/default/31_include_exclude.sh
2012-10-29 22:43:50 Including layout/save/default/32_autoexclude.sh
2012-10-29 22:43:50 Automatically excluding removable device /dev/hda
2012-10-29 22:43:50 Marking /dev/hda as done.
2012-10-29 22:43:50 Disk /dev/hda is not used by any mounted filesystem. Excluding.
2012-10-29 22:43:50 Marking /dev/hda as done.
2012-10-29 22:43:50 Including layout/save/default/33_remove_exclusions.sh
2012-10-29 22:43:50 Including layout/save/default/34_generate_mountpoint_device.sh
2012-10-29 22:43:52 Including layout/save/GNU/Linux/35_copy_drbdtab.sh
2012-10-29 22:43:52 Including layout/save/GNU/Linux/50_extract_vgcfg.sh
2012-10-29 22:43:52 Including layout/save/GNU/Linux/51_current_disk_usage.sh
2012-10-29 22:43:52 Including layout/save/default/60_snapshot_files.sh
2012-10-29 22:43:52 Finished running 'layout/save' stage in 6 seconds
2012-10-29 22:43:52 Running 'rescue' stage
2012-10-29 22:43:52 Including rescue/default/00_remove_workflow_conf.sh
mkdir: created directory `/tmp/rear.dRJFvPczrt31105/rootfs/etc'
mkdir: created directory `/tmp/rear.dRJFvPczrt31105/rootfs/etc/rear'
2012-10-29 22:43:52 Including rescue/default/01_merge_skeletons.sh
2012-10-29 22:43:52 Creating root FS layout
2012-10-29 22:43:52 Adding 'default'
2012-10-29 22:43:52 Adding 'Debian/default.tar.gz'
2012-10-29 22:43:52 Including rescue/default/10_hostname.sh
2012-10-29 22:43:52 Including rescue/default/20_etc_issue.sh
2012-10-29 22:43:52 Including rescue/GNU/Linux/23_storage_and_network_modules.sh
find: /lib/modules/2.6.18-6-486/extra: No such file or directory
find: /lib/modules/2.6.18-6-486/weak-updates: No such file or directory
2012-10-29 22:43:52 Including rescue/GNU/Linux/24_kernel_modules.sh
2012-10-29 22:43:52 Including rescue/GNU/Linux/25_udev.sh
2012-10-29 22:43:52 Including rescue/GNU/Linux/26_storage_drivers.sh
2012-10-29 22:43:52 Including rescue/GNU/Linux/30_dns.sh
2012-10-29 22:43:52 Including rescue/GNU/Linux/31_network_devices.sh
mkdir: created directory `/tmp/rear.dRJFvPczrt31105/tmp/mappings'
2012-10-29 22:43:53 Including rescue/GNU/Linux/35_routing.sh
2012-10-29 22:43:53 Including rescue/NETFS/default/39_check_crypto_modules.sh
2012-10-29 22:43:53 Additional modules to load: vmxnet
2012-10-29 22:43:53 Including rescue/GNU/Linux/39_check_usb_modules.sh
2012-10-29 22:43:53 Including rescue/GNU/Linux/40_use_serial_console.sh
2012-10-29 22:43:53 Modified kernel commandline to: 'selinux=0 console=ttyS0,9600 console=ttyS1,9600 console=tty0'
2012-10-29 22:43:53 Including rescue/GNU/Linux/41_use_xen_console.sh
2012-10-29 22:43:53 Including rescue/default/43_prepare_timesync.sh
mode of `/tmp/rear.dRJFvPczrt31105/rootfs/etc/scripts/system-setup.d/90-timesync.sh' changed to 0755 (rwxr-xr-x)
2012-10-29 22:43:53 Including rescue/GNU/Linux/50_clone_keyboard_mappings.sh
2012-10-29 22:43:53 Including rescue/default/50_ssh.sh
mkdir: created directory `/tmp/rear.dRJFvPczrt31105/rootfs/var/run/sshd'
ownership of `/tmp/rear.dRJFvPczrt31105/rootfs/var/run/sshd' retained as root:root
2012-10-29 22:43:53 Including rescue/NETFS/default/60_store_NETFS_variables.sh
2012-10-29 22:43:53 Including rescue/default/90_clone_users_and_groups.sh
2012-10-29 22:43:53 Cloning users: daemon rpc usbmuxd usbmux vcsa nobody
2012-10-29 22:43:53 Cloning groups: group disk cdrom floppy tape audio video lp tty dialout kmem uucp ssh_keys tty usbmuxd usbmux fuse 65534 1 65534
2012-10-29 22:43:53 Including rescue/default/91_copy_logfile.sh
2012-10-29 22:43:53 Copying logfile /tmp/rear-localhost.log into initramfs as '/tmp/rear-partial-2012-10-29T22:43:53+0100.log'
</code></pre>
<p>Here is the complete output of the rear-localhost.log when trying to
restore:</p>
<pre><code>2012-11-01 12:38:45 Relax and Recover 1.12.0 / 2011-11-22 10:21:35 +0100
2012-11-01 12:38:45 Command line options: /bin/rear -v recover
2012-11-01 12:38:45 Including /etc/rear/os.conf
2012-11-01 12:38:45 Including conf/Linux-i386.conf
2012-11-01 12:38:45 Including conf/GNU/Linux.conf
2012-11-01 12:38:45 Including /etc/rear/local.conf
/etc/rear/local.conf: line 149: backup: command not found
2012-11-01 12:38:45 Including /etc/rear/rescue.conf
2012-11-01 12:38:45 Using build area '/tmp/rear.CXmEPlqGdKH1233'
mkdir: created directory `/tmp/rear.CXmEPlqGdKH1233/rootfs'
mkdir: created directory `/tmp/rear.CXmEPlqGdKH1233/tmp'
2012-11-01 12:38:45 Running recover workflow
2012-11-01 12:38:45 Running 'setup' stage
2012-11-01 12:38:45 Including setup/default/01_pre_recovery_script.sh
2012-11-01 12:38:45 Including setup/GNU/Linux/80_setup_hp_raid.sh
2012-11-01 12:38:45 Finished running 'setup' stage in 0 seconds
2012-11-01 12:38:45 Running 'verify' stage
2012-11-01 12:38:45 Including verify/default/02_cciss_scsi_engage.sh
2012-11-01 12:38:45 Including verify/default/02_translate_url.sh
2012-11-01 12:38:45 Using NETFS_URL is deprecated. Use BACKUP_URL instead.
2012-11-01 12:38:45 Including verify/NETFS/default/05_check_NETFS_requirements.sh
2012-11-01 12:38:45 Skipping ping test
2012-11-01 12:38:45 Including verify/GNU/Linux/05_sane_recovery_check.sh
2012-11-01 12:38:45 Including verify/NETFS/default/08_start_required_daemons.sh
2012-11-01 12:38:45 Including verify/NETFS/default/09_set_readonly_options.sh
2012-11-01 12:38:45 Including verify/GNU/Linux/10_describe_physical_devices.sh
2012-11-01 12:38:45 Including verify/NETFS/default/10_mount_NETFS_path.sh
mkdir: created directory `/tmp/rear.CXmEPlqGdKH1233/outputfs'
2012-11-01 12:38:45 Mounting with 'mount -v -t nfs -o ro 192.168.0.104:/home/install/images/rear/ /tmp/rear.CXmEPlqGdKH1233/outputfs'
192.168.0.104:/home/install/images/rear/ on /tmp/rear.CXmEPlqGdKH1233/outputfs type nfs (ro,addr=192.168.0.104)
2012-11-01 12:38:45 Including verify/Linux-i386/11_describe_device_properties.sh
2012-11-01 12:38:45 Including verify/GNU/Linux/12_compare_physical_devices.sh
2012-11-01 12:38:45 Including verify/GNU/Linux/21_migrate_recovery_configuration.sh
2012-11-01 12:38:45 Including verify/GNU/Linux/23_storage_and_network_modules.sh
find: /lib/modules/2.6.18-6-486/extra: No such file or directory
find: /lib/modules/2.6.18-6-486/weak-updates: No such file or directory
2012-11-01 12:38:45 Including verify/GNU/Linux/26_recovery_storage_drivers.sh
find: /tmp/rear.CXmEPlqGdKH1233/tmp/dev: No such file or directory
3,5c3 &lt; scsi_mod &lt; sd_mod &lt; sis5513 --- &gt; piix
2012-11-01 12:38:45 NOTICE: Will do driver migration
2012-11-01 12:38:45 Including verify/NETFS/default/55_check_backup_archive.sh
2012-11-01 12:38:45 Calculating backup archive size
2012-11-01 12:38:45 Backup archive size is 22G (compressed)
2012-11-01 12:38:45 Finished running 'verify' stage in 0 seconds
2012-11-01 12:38:45 Running 'layout/prepare' stage
2012-11-01 12:38:45 Including layout/prepare/default/01_prepare_files.sh
2012-11-01 12:38:45 Including layout/prepare/GNU/Linux/10_include_partition_code.sh
2012-11-01 12:38:45 Including layout/prepare/GNU/Linux/11_include_lvm_code.sh
2012-11-01 12:38:45 Including layout/prepare/GNU/Linux/12_include_raid_code.sh
2012-11-01 12:38:45 Including layout/prepare/GNU/Linux/13_include_filesystem_code.sh
2012-11-01 12:38:45 Including layout/prepare/GNU/Linux/14_include_swap_code.sh
2012-11-01 12:38:45 Including layout/prepare/GNU/Linux/15_include_drbd_code.sh
2012-11-01 12:38:45 Including layout/prepare/GNU/Linux/16_include_luks_code.sh
2012-11-01 12:38:45 Including layout/prepare/GNU/Linux/17_include_hpraid_code.sh
2012-11-01 12:38:45 Including layout/prepare/default/20_recreate_hpraid.sh
2012-11-01 12:38:45 Including layout/prepare/GNU/Linux/21_load_multipath.sh
2012-11-01 12:38:45 Including layout/prepare/default/25_compare_disks.sh
2012-11-01 12:38:45 Comparing disks.
2012-11-01 12:38:45 Looking for sda...
2012-11-01 12:38:45 Device sda does not exist.
2012-11-01 12:38:45 Switching to manual disk layout configuration.
2012-11-01 12:38:45 Including layout/prepare/default/30_map_disks.sh
2012-11-01 12:38:45 Disk sda does not exist in the target system. Please choose the appropriate replacement.
2012-11-01 12:38:58 Including layout/prepare/default/31_remove_exclusions.sh
2012-11-01 12:38:58 Including layout/prepare/default/32_apply_mappings.sh
2012-11-01 12:38:58 This is the disk mapping table:
2012-11-01 12:38:58 Including layout/prepare/default/40_autoresize_disks.sh
2012-11-01 12:38:58 Total resize of -114089263104B
2012-11-01 12:38:58 Searching for resizeable partitions on disk /dev/hda (85899345920)B
2012-11-01 12:38:58 No resizeable partitions found.
2012-11-01 12:38:58 Including layout/prepare/default/50_confirm_layout.sh
2012-11-01 12:38:58 Please confirm that '/var/lib/rear/layout/disklayout.conf' is as you expect.
2012-11-01 12:39:07 User selected: 5) Continue recovery
2012-11-01 12:39:07 Including layout/prepare/default/51_list_dependencies.sh
2012-11-01 12:39:08 Including layout/prepare/default/52_exclude_components.sh
2012-11-01 12:39:08 Including layout/prepare/default/54_generate_device_code.sh
2012-11-01 12:39:08 Partition /dev/hda5 size reduced to fit on disk.
2012-11-01 12:39:08 Marking /dev/hda as done.
2012-11-01 12:39:08 Marking /dev/hda1 as done.
2012-11-01 12:39:08 Marking /dev/hda2 as done.
2012-11-01 12:39:08 Marking /dev/hda3 as done.
2012-11-01 12:39:08 Marking /dev/hda4 as done.
2012-11-01 12:39:08 Marking /dev/hda5 as done.
2012-11-01 12:39:08 Marking /dev/hda6 as done.
2012-11-01 12:39:08 Marking /dev/hda7 as done.
2012-11-01 12:39:08 Marking fs:/ as done.
2012-11-01 12:39:08 Marking fs:/boot as done.
2012-11-01 12:39:08 Marking fs:/home as done.
2012-11-01 12:39:08 Marking fs:/usr as done.
2012-11-01 12:39:08 Marking fs:/var as done.
2012-11-01 12:39:08 Marking swap:/dev/hda2 as done.
2012-11-01 12:39:08 Including layout/prepare/default/55_finalize_script.sh
2012-11-01 12:39:08 Including layout/prepare/default/60_show_unprocessed.sh
2012-11-01 12:39:08 Including layout/prepare/default/61_exclude_from_restore.sh
2012-11-01 12:39:08 Finished running 'layout/prepare' stage in 23 seconds
2012-11-01 12:39:08 Running 'layout/recreate' stage
2012-11-01 12:39:08 Including layout/recreate/default/10_ask_confirmation.sh
2012-11-01 12:39:08 Please confirm that '/var/lib/rear/layout/diskrestore.sh' is as you expect.
2012-11-01 12:39:18 User selected: 5) Continue recovery
2012-11-01 12:39:18 Including layout/recreate/default/20_run_script.sh
2012-11-01 12:39:18 Start system layout restoration.
/var/lib/rear/layout/diskrestore.sh: line 7: lvm: command not found
+++ create_component /dev/hda disk
+++ local device=/dev/hda
+++ local type=disk
+++ local touchfile=disk--dev-hda
+++ '[' -e /tmp/rear.CXmEPlqGdKH1233/tmp/touch/disk--dev-hda ']'
+++ return 0
+++ LogPrint 'Creating partitions for disk /dev/hda (msdos)'
+++ Log 'Creating partitions for disk /dev/hda (msdos)'
+++ test 1 -gt 0
++++ Stamp
++++ date '+%Y-%m-%d %H:%M:%S '
+++ echo '2012-11-01 12:39:18 Creating partitions for disk /dev/hda (msdos)'
2012-11-01 12:39:18 Creating partitions for disk /dev/hda (msdos)
+++ Print 'Creating partitions for disk /dev/hda (msdos)'
+++ test 1
+++ echo -e 'Creating partitions for disk /dev/hda (msdos)'
+++ parted -s /dev/hda mklabel msdos
Error: Could not stat device /dev/hda - No such file or directory.
2012-11-01 12:39:18 An error occured during layout recreation.
2012-11-01 12:39:35 User selected: 6) Abort Rear
2012-11-01 12:39:35 Error detected during restore.
2012-11-01 12:39:35 Restoring backup of /var/lib/rear/layout/disklayout.conf
Trace: 63 source /usr/share/rear/layout/recreate/default/20_run_script.sh
Trace: 40 Source /usr/share/rear/lib/framework-functions.sh
Trace: 79 SourceStage /usr/share/rear/lib/framework-functions.sh
Trace: 31 WORKFLOW_recover /usr/share/rear/lib/recover-workflow.sh
Trace: 242 main /bin/rear
2012-11-01 12:39:35 ERROR: There was an error restoring the system layout. See /tmp/rear-localhost.log for details.
2012-11-01 12:39:35 Running exit tasks.
192.168.0.104:/home/install/images/rear/ umounted
rmdir: removing directory, /tmp/rear.CXmEPlqGdKH1233/outputfs
2012-11-01 12:39:35 Finished in 50 seconds
2012-11-01 12:39:35 Removing build area /tmp/rear.CXmEPlqGdKH1233
rmdir: removing directory, /tmp/rear.CXmEPlqGdKH1233
2012-11-01 12:39:35 End of program reached
</code></pre>
<p>Machine data:<br />
It is a physical Debian 4.0 (x86) machine i want to restore/migrate to a
CitrixXenServer 6.0.0<br />
A disk for this vitual machine has been created with Citrix XenCenter
(/dev/hda) and can be found be other tools like "parted magic"</p>
<p>If you need more information let me know. Thanks!</p>
<p>Regards,<br />
Ivan</p>
<h4 id="gdha_commented_at_2012-11-01_2101"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-9995795">2012-11-01 21:01</a>:<a class="headerlink" href="#gdha_commented_at_2012-11-01_2101" title="Permanent link">&para;</a></h4>
<p>Some additional requests:<br />
1/ <code>cat /etc/rear/local.conf</code><br />
/etc/rear/local.conf: line 149: backup: command not found<br />
2/ <code>cat /var/lib/rear/layout/disklayout.conf</code><br />
3/ what kernel module is required for /dev/hda with Citrix XenCenter?
And, was this loaded automatically by the rescue images?<br />
4/ was device /dev/hda created? Was udevd running?</p>
<h4 id="unknown_commented_at_2012-11-02_1457"><img src="(unknown)" width="50"><a href="(unknown)">(unknown)</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-10016909">2012-11-02 14:57</a>:<a class="headerlink" href="#unknown_commented_at_2012-11-02_1457" title="Permanent link">&para;</a></h4>
<p>/etc/rear/local.conf</p>
<pre><code># Create ReaR rescue media as ISO image
OUTPUT=ISO

# Target location of ISO image
# Uses the same format as NETFS_URL
# If not set, the value for NETFS_URL will be used
OUTPUT_URL=nfs://192.168.0.104/home/install/images/rear

# Options to add to the default mount command for the OUTPUT_URL
#OUTPUT_OPTIONS=

# Specify a custom command to mount/umount a directory for output.
# ReaR will append the output path to the command.
# If not set, the values for NETFS will be used
#OUTPUT_MOUNTCMD=
#OUTPUT_UMOUNTCMD=

# optionally define (non-default) backup software, e.g. TSM, NBU, DP, BACULA
# BACKUP=TSM
BACKUP=NETFS

# the following is required on older VMware VMs
MODULES_LOAD=( vmxnet )

# to see boot messages on the serial console (uncomment next line)
# KERNEL_CMDLINE="console=tty0 console=ttyS1"
# line below was automatically added by 21_include_dhclient.sh
DHCLIENT_BIN=dhclient
# line below was automatically added by 21_include_dhclient.sh
DHCLIENT6_BIN=dhclient6

# time synchronisation, could be NTP, RDATE or empty
TIMESYNC=NTP
# set a timesync source, mostly needed for RDATE
TIMESYNC_SOURCE=192.168.0.254

# disk layout
USE_LAYOUT=n


##
# BACKUP=NETFS stuff
##
# NETFS is an internal backup method that saves the backup into a mounted directory.
# This is usually a network share, but can also be used to create a backup to a local
# disk (by providing your own NETFS_MOUNTCMD and NETFS_UMOUNTCMD commands that mount the
# local disk. Please note that a backup to a local disk is not a disaster recovery backup.
#
# NETFS saves the system to a network file system. Supported are all filesystems that your
# system can handle, for some exotic filesystems you might have to extend ReaR to correctly
# handle the URL or provide custom mount/umount commands.
#
# The URL defines the remote share as &lt;proto&gt;://&lt;host&gt;/&lt;share&gt; like these examples:
# nfs://host.domain/path/path/path
# cifs://server.domain/share
# others might also work, if they can be mounted with mount -t &lt;proto&gt; &lt;host&gt;:/&lt;share&gt;
NETFS_URL=nfs://192.168.0.104/home/install/images/rear/
# set options for mount, depends on proto
# NFS example: rsize=8192,wsize=8192
# CIFS example: user=&lt;username&gt;,pass=&lt;password&gt;,dom=&lt;domain&gt; (see mount.cifs for full info)
# for CIFS you should also consider to use credentials=/path/to/credentials-file so that
# the password won't be so visible. In that file you put lines with the options 
# (user=, pass=, ...) to mount -t cifs. Don't forget to include the credentials file
# in a COPY_AS_IS statement like 
# COPY_AS_IS=( "${COPY_AS_IS[@]}" /path/to/credentials-file)
# in your configuration
NETFS_OPTIONS=
# you can specify the full mount/umount commands including the server path and options, if
# your network filesystem does not work with the NETFS_URL mechanism. The MOUNTCMD and UMOUNTCMD
# options override NETFS_URL. The local mountpoint will be appended to the command line you specify !
# example: NETFS_MOUNTCMD=ncpmount -A &lt;server-ip&gt; -V &lt;volid&gt;
# example: NETFS_UMOUNTCMD=ncpumount
NETFS_MOUNTCMD=
NETFS_UMOUNTCMD=

# path to where the ISO image should be stored relative to the OUTPUT_URL.
# This is left blank in the default to provide backwards compatibility with
# older ReaR versions which only had NETFS_PREFIX
# If left blank it will default to NETFS_PREFIX if set, otherwise $(uname -n)
# prefix directory to create under the network filesystem share
OUTPUT_PREFIX="rear/$(uname -n)/$(date +%Y%m%d.%H%M)"
# keep an older copy of the backup (mv $NETFS_PREFIX $NETFS_PREFIX.old before we copy the new version)
# empty means only keep current backup
NETFS_KEEP_OLD_BACKUP_COPY=

##
# How to exclude something ----- EXCLUDES -------
#
# You cannot exclude a device (e.g. /dev/sdg) directly. Instead you have to exclude everything
# ON that device and then the dependancy tracker will automatically exclude the device from the
# recovery (because there won't be any recovery information for that "unnecessary" device).
#
# Furthermore, you have to exclude MD devices and LVM2 volume groups separately as there is no
# automatic detection of these dependancies (yet, please write and submit it !)

# Exclude filesystems by specifying their mountpoints. Will be automatically added to the
# $BACKUP_PROG_EXCLUDE array during backup to prevent the excluded filesystems' data to
# be backed up
# examples: /tmp
#           /media/bigdisk
EXCLUDE_MOUNTPOINTS=()

# Exclude MD devices
# examples: /dev/md0
#           /dev/md/0
EXCLUDE_MD=()

# Exclude LVM2 volume groups. This will automatically exclude also the creation of the corresponding
# physical and logical volumes that belong to the excluded volume group.
#
# NOTE: YOU MUST ALSO EXCLUDE THE CORRESPONDING MOUNTPOINTS IN EXCLUDE_MOUNTPOINTS (see above)
#       OTHERWISE THE RECOVERY ***WILL*** TRY TO RECREATE THE FILESYSTEMS ONTO NON-EXISTING LVs
#
#       Y O U   H A V E   B E E N   W A R N E D  ! ! !
EXCLUDE_VG=()

####
# Only include LVM2 volume groups - the opposite of EXCLUDE_VG (handy if you only want vg00 to be included)
# EXCLUDE_VG and EXCLUDE_MOUNTPOINTS will get populated automatically, if needed
# syntax : e.g. ONLY_INCLUDE_VG=( "vg00" "vg01" )
ONLY_INCLUDE_VG=()

# Automatically exclude disks that are not used by mounted filesystems
# Explicitly excluding/including devices is generally a safer option.
AUTOEXCLUDE_DISKS=y

##
# advanced handling of ReaR result (boot image)
##
# ReaR can do something with the resulting files, here we say what
#

# create a list of result files that make up the ReaR DR boot environment
# initially this list is empty, but a user could add his own files here
RESULT_FILES=()

# we can send a mail with the resulting files. We even support multiple recipients,
# each array variable is one recipient. When you set this variable to a value without
# using an array, it will still work.
RESULT_MAILTO=(it-support@asta.tu-darmstadt.de)

# set the sender, your local sendmail will expand this to a FQDN if you don't
# supply a full name here.
RESULT_MAILFROM=root

# set the subject to empty here, later script will fill in our default
RESULT_MAILSUBJECT=REAR backup complete!

# path to your sendmail
RESULT_SENDMAIL="$( type -p sendmail || echo /usr/lib/sendmail )"

# extra sendmail options. On my system -t makes sendmail read the recipients 
# from the mail headers
# Use array to properly handle args with spaces ("some arg")
RESULT_SENDMAIL_OPTIONS=( -oi -t )

# Number of rescue environments/backups to retain
RETAIN_BACKUP_NR=2

##
# PXE stuff
##
# PXE produces files suitable for booting with pxelinux.

# where should I place the PXE configuration ? 
PXE_CONFIG_PATH=/tmp

# put this before the hostname on the PXE server
PXE_CONFIG_PREFIX=rear-

# where should we put the TFTP files ? 
PXE_TFTP_PATH=/tmp

# prefix for PXE files, e.g. the hostname
PXE_TFTP_PREFIX=$(uname -n).

# Create pxelinux config symlinks for MAC addresses or for IP addresses ? [MAC|IP|'']
PXE_CREATE_LINKS=MAC

# Should I remove old symlinks for this host ? [BOOL]
PXE_REMOVE_OLD_LINKS=
</code></pre>
<p>/var/lib/rear/layout/disklayout.conf</p>
<pre><code># disk /dev/hda 4294965248 
disk /dev/sda 199988609024 msdos
part /dev/sda 148022784 32256 primary none /dev/sda1
part /dev/sda 699148800 148055040 primary none /dev/sda2
part /dev/sda 20003880960 847203840 primary none /dev/sda3
part /dev/sda 1024 20851084800 extended none /dev/sda4
part /dev/sda 100002921984 20851117056 logical none /dev/sda5
part /dev/sda 39999504384 120854071296 logical none /dev/sda6
part /dev/sda 39127624704 160853607936 logical none /dev/sda7
fs /dev/sda3 / ext3 uuid=4554aff3-d82b-43c8-9863-aecc39e52173 label= blocksize=4096 reserved_blocks=244188 max_mounts=20 check_interval=180d options=rw,errors=remount-ro
fs /dev/sda1 /boot ext3 uuid=7ecbf9ca-dc5f-4de4-ba52-9db736519c7a label= blocksize=1024 reserved_blocks=7227 max_mounts=21 check_interval=180d options=rw
fs /dev/sda5 /home ext3 uuid=1c06caea-48ed-478e-93f1-df87e0d31d5d label= blocksize=4096 reserved_blocks=1220738 max_mounts=35 check_interval=180d options=rw
fs /dev/sda6 /usr ext3 uuid=5a411abc-338f-4654-be62-489b65eae120 label= blocksize=4096 reserved_blocks=488275 max_mounts=24 check_interval=180d options=rw
fs /dev/sda7 /var ext3 uuid=fcec991e-00c3-4e3b-9e32-9d31bcf816d2 label= blocksize=4096 reserved_blocks=477632 max_mounts=25 check_interval=180d options=rw
swap /dev/sda2 uuid= label=
</code></pre>
<blockquote>
<p>3/ what kernel module is required for /dev/hda with Citrix XenCenter?
And, was this loaded automatically by the &gt;rescue images?</p>
</blockquote>
<p>I'm not sure about that. I already was wondering that XenCenter labeled
that disk /dev/hda when it was created. When trying to modify the device
with other tools, it was shown as /dev/sda. But in XenCenter it is
still/always shown as /dev/hda. That's also what the rescue image
recognizes.</p>
<blockquote>
<p>4/ was device /dev/hda created?</p>
</blockquote>
<p>The device was created with XenCenter.</p>
<blockquote>
<p>Was udevd running?</p>
</blockquote>
<p>I think so, 'udevd' tells me 'another udevd daemon already running'</p>
<h4 id="gdha_commented_at_2012-11-07_1423"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-10149651">2012-11-07 14:23</a>:<a class="headerlink" href="#gdha_commented_at_2012-11-07_1423" title="Permanent link">&para;</a></h4>
<p>Noticed that you're still using logical rear-1.12 with <code>USE_LAYOUT=n</code><br />
Would it be possible to use the latest stable release rear-1.14 and do
not change the default <code>USE_LAYOUT=y</code><br />
Once you booted from the rear rescue image and logged in as root, check
if the device /dev/hda has been created. You should also see this in the
output of <code>dmesg</code></p>
<h4 id="unknown_commented_at_2012-11-09_1432"><img src="(unknown)" width="50"><a href="(unknown)">(unknown)</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-10228115">2012-11-09 14:32</a>:<a class="headerlink" href="#unknown_commented_at_2012-11-09_1432" title="Permanent link">&para;</a></h4>
<p>Hi,</p>
<p>now I installed rear-1.14, changed "USE_LAYOUT=y", made another backup
and when trying to recover the complete process stops earlier, after
confirming the disklayout.conf:</p>
<pre><code>ERROR: BUG BUG BUG! Disk /dev/hda is not a block device.
</code></pre>
<p>rear.log says:</p>
<pre><code>2012-11-09 15:23:38.775770049 Relax-and-Recover 1.14 / Git
2012-11-09 15:23:38.777875743 Command line options: /bin/rear -d recover
2012-11-09 15:23:38.778490266 Using log file: /var/log/rear/rear-localhost.log
2012-11-09 15:23:38.781002665 Combining configuration files
2012-11-09 15:23:38.781709301 Including /etc/rear/os.conf
2012-11-09 15:23:38.782473477 Skipping /etc/rear/recover.conf (file not found or empty)
2012-11-09 15:23:38.783317080 Including conf/Linux-i386.conf
2012-11-09 15:23:38.784197803 Including conf/GNU/Linux.conf
2012-11-09 15:23:38.786250804 Skipping /usr/share/rear/conf/Debian.conf (file not found or empty)
2012-11-09 15:23:38.786991603 Skipping /usr/share/rear/conf/Debian/i386.conf (file not found or empty)
2012-11-09 15:23:38.787745637 Skipping /usr/share/rear/conf/Debian/4.0.conf (file not found or empty)
2012-11-09 15:23:38.788486494 Skipping /usr/share/rear/conf/Debian/4.0/i386.conf (file not found or empty)
2012-11-09 15:23:38.789238501 Skipping /etc/rear/site.conf (file not found or empty)
2012-11-09 15:23:38.789975495 Including /etc/rear/local.conf
/etc/rear/local.conf: line 149: backup: command not found
2012-11-09 15:23:38.793363925 Including /etc/rear/rescue.conf
2012-11-09 15:23:38.796223608 Using build area '/tmp/rear.DYYdWXXzAYZ1981'
mkdir: created directory `/tmp/rear.DYYdWXXzAYZ1981/rootfs'
mkdir: created directory `/tmp/rear.DYYdWXXzAYZ1981/tmp'
2012-11-09 15:23:38.797814172 Running recover workflow
2012-11-09 15:23:38.798487138 Running 'setup' stage
2012-11-09 15:23:38.801665338 Including setup/default/01_pre_recovery_script.sh
2012-11-09 15:23:38.802348738 Finished running 'setup' stage in 0 seconds
2012-11-09 15:23:38.802994053 Running 'verify' stage
2012-11-09 15:23:38.806256158 Including verify/default/02_cciss_scsi_engage.sh
2012-11-09 15:23:38.807388923 Including verify/default/02_translate_url.sh
2012-11-09 15:23:38.808049585 Using NETFS_URL is deprecated. Use BACKUP_URL instead.
2012-11-09 15:23:38.809052862 Including verify/default/03_translate_tape.sh
2012-11-09 15:23:38.810824705 Including verify/NETFS/default/05_check_NETFS_requirements.sh
2012-11-09 15:23:38.812931170 Skipping ping test
2012-11-09 15:23:38.817310022 Including verify/GNU/Linux/05_sane_recovery_check.sh
2012-11-09 15:23:38.818218604 Including verify/NETFS/default/07_set_backup_archive.sh
2012-11-09 15:23:38.819927722 Including verify/NETFS/default/08_start_required_daemons.sh
2012-11-09 15:23:38.823610372 Including verify/NETFS/default/09_set_readonly_options.sh
2012-11-09 15:23:38.824441801 Including verify/NETFS/default/10_mount_NETFS_path.sh
mkdir: created directory `/tmp/rear.DYYdWXXzAYZ1981/outputfs'
2012-11-09 15:23:38.825599545 Added 'rmdir -v /tmp/rear.DYYdWXXzAYZ1981/outputfs &gt;&amp;2' as an exit task
2012-11-09 15:23:38.828337033 Mounting with 'mount -v -t nfs -o ro 192.168.0.104:/home/install/images/rear/ /tmp/rear.DYYdWXXzAYZ1981/outputfs'
192.168.0.104:/home/install/images/rear/ on /tmp/rear.DYYdWXXzAYZ1981/outputfs type nfs (ro,addr=192.168.0.104)
2012-11-09 15:23:40.173616821 Added 'umount -f -v '/tmp/rear.DYYdWXXzAYZ1981/outputfs' &gt;&amp;2' as an exit task
2012-11-09 15:23:40.175189334 Including verify/GNU/Linux/23_storage_and_network_modules.sh
find: /lib/modules/2.6.18-6-486/kernel/drivers/firewire: No such file or directory
find: /lib/modules/2.6.18-6-486/kernel/drivers/ata: No such file or directory
find: /lib/modules/2.6.18-6-486/kernel/drivers/virtio: No such file or directory
find: /lib/modules/2.6.18-6-486/kernel/drivers/xen: No such file or directory
find: /lib/modules/2.6.18-6-486/extra: No such file or directory
find: /lib/modules/2.6.18-6-486/weak-updates: No such file or directory
2012-11-09 15:23:40.191777358 Including verify/GNU/Linux/26_recovery_storage_drivers.sh
find: /tmp/rear.DYYdWXXzAYZ1981/tmp/dev: No such file or directory
3,5c3
&lt; scsi_mod
&lt; sd_mod
&lt; sis5513
---
&gt; piix
2012-11-09 15:23:40.247827150 NOTICE: Will do driver migration
2012-11-09 15:23:40.250128877 Including verify/NETFS/default/55_check_backup_archive.sh
2012-11-09 15:23:40.253851393 Calculating backup archive size
2012-11-09 15:23:40.256290167 Backup archive size is 22G (compressed)
2012-11-09 15:23:40.258411922 Finished running 'verify' stage in 2 seconds
2012-11-09 15:23:40.259099295 Running 'layout/prepare' stage
2012-11-09 15:23:40.262583566 Including layout/prepare/default/01_prepare_files.sh
2012-11-09 15:23:40.264614415 Including layout/prepare/GNU/Linux/10_include_partition_code.sh
2012-11-09 15:23:40.269722257 Including layout/prepare/GNU/Linux/11_include_lvm_code.sh
2012-11-09 15:23:40.270615846 Including layout/prepare/GNU/Linux/12_include_raid_code.sh
2012-11-09 15:23:40.271509556 Including layout/prepare/GNU/Linux/13_include_filesystem_code.sh
2012-11-09 15:23:40.272847138 Including layout/prepare/GNU/Linux/14_include_swap_code.sh
2012-11-09 15:23:40.275800116 Including layout/prepare/GNU/Linux/15_include_drbd_code.sh
2012-11-09 15:23:40.276717944 Including layout/prepare/GNU/Linux/16_include_luks_code.sh
2012-11-09 15:23:40.277800020 Including layout/prepare/GNU/Linux/17_include_hpraid_code.sh
2012-11-09 15:23:40.278852401 Including layout/prepare/default/20_recreate_hpraid.sh
2012-11-09 15:23:40.280053737 Including layout/prepare/GNU/Linux/21_load_multipath.sh
2012-11-09 15:23:40.281285148 Including layout/prepare/default/25_compare_disks.sh
2012-11-09 15:23:40.281993182 Comparing disks.
2012-11-09 15:23:40.285072697 Looking for hda...
2012-11-09 15:23:40.285711597 Device hda exists.
2012-11-09 15:23:40.287186120 Device hda has size 85899345920, 199988609024 expected
2012-11-09 15:23:40.289277750 Switching to manual disk layout configuration.
2012-11-09 15:23:40.291716665 Including layout/prepare/default/30_map_disks.sh
2012-11-09 15:23:40.329903431 Original disk /dev/hda does not exist in the target system. Please choose an appropriate replacement.
2012-11-09 15:23:45.448347405 This is the disk mapping table:
2012-11-09 15:23:45.452090852     /dev/hda /dev/hda
2012-11-09 15:23:45.457000843 Including layout/prepare/default/31_remove_exclusions.sh
2012-11-09 15:23:45.461040308 Including layout/prepare/default/32_apply_mappings.sh
2012-11-09 15:23:45.466939454 Including layout/prepare/default/40_autoresize_disks.sh
2012-11-09 15:23:45.470238270 Total resize of -114089263104B
2012-11-09 15:23:45.470855981 Searching for resizeable partitions on disk /dev/hda (85899345920B)
2012-11-09 15:23:45.472174863 Will resize partition /dev/hda1.
2012-11-09 15:23:45.472868862 Will resize partition /dev/hda2.
2012-11-09 15:23:45.473580455 Will resize partition /dev/hda3.
2012-11-09 15:23:45.474284101 Will resize partition /dev/hda4.
2012-11-09 15:23:45.474988472 Will resize partition /dev/hda5.
2012-11-09 15:23:45.475721227 Will resize partition /dev/hda6.
2012-11-09 15:23:45.476433218 Will resize partition /dev/hda7.
2012-11-09 15:23:45.479064409 Resized partition /dev/hda1 from 63581308B to 609973017B.
2012-11-09 15:23:45.481611714 Resized partition /dev/hda2 from 300310495B to 2147483647B.
2012-11-09 15:23:45.484208982 Resized partition /dev/hda3 from 2147483647B to 2147483647B.
2012-11-09 15:23:45.486736898 Resized partition /dev/hda4 from 439B to 4211B.
2012-11-09 15:23:45.489392216 Resized partition /dev/hda5 from 2147483647B to 2147483647B.
2012-11-09 15:23:45.491901630 Resized partition /dev/hda6 from 2147483647B to 2147483647B.
2012-11-09 15:23:45.494399699 Resized partition /dev/hda7 from 2147483647B to 2147483647B.
2012-11-09 15:23:45.495643207 Including layout/prepare/default/50_confirm_layout.sh
2012-11-09 15:23:45.496327677 Please confirm that '/var/lib/rear/layout/disklayout.conf' is as you expect.
2012-11-09 15:23:47.809772274 User selected: 5) Continue recovery
2012-11-09 15:23:47.811331477 Including layout/prepare/default/51_list_dependencies.sh
2012-11-09 15:23:47.840566506 Including layout/prepare/default/52_exclude_components.sh
2012-11-09 15:23:47.841980860 Including layout/prepare/default/54_generate_device_code.sh
2012-11-09 15:23:47.844809794 Testing /dev/hda for dependencies...
2012-11-09 15:23:47.846287338 deps (0): 
2012-11-09 15:23:47.846938816 All dependencies for /dev/hda are present, processing...
2012-11-09 15:23:47.849086585 ERROR: BUG BUG BUG!  Disk /dev/hda is not a block device. 
=== Issue report ===
Please report this unexpected issue at: https://github.com/rear/rear/issues
Also include the relevant bits from /var/log/rear/rear-localhost.log

HINT: If you can reproduce the issue, try using the -d or -D option !
====================
=== Stack trace ===
Trace 0: /bin/rear:245 main
Trace 1: /usr/share/rear/lib/recover-workflow.sh:29 WORKFLOW_recover
Trace 2: /usr/share/rear/lib/framework-functions.sh:79 SourceStage
Trace 3: /usr/share/rear/lib/framework-functions.sh:40 Source
Trace 4: /usr/share/rear/layout/prepare/default/54_generate_device_code.sh:52 source
Trace 5: /usr/share/rear/lib/layout-functions.sh:34 create_device
Trace 6: /usr/share/rear/layout/prepare/GNU/Linux/10_include_partition_code.sh:35 create_disk
Trace 7: /usr/share/rear/lib/_input-output-functions.sh:155 BugIfError
Trace 8: /usr/share/rear/lib/_input-output-functions.sh:143 BugError
Message: BUG BUG BUG!  Disk /dev/hda is not a block device. 
=== Issue report ===
Please report this unexpected issue at: https://github.com/rear/rear/issues
Also include the relevant bits from /var/log/rear/rear-localhost.log

HINT: If you can reproduce the issue, try using the -d or -D option !
====================
===================
2012-11-09 15:23:47.860445261 Running exit tasks.
2012-11-09 15:23:47.861285796 Exit task 'umount -f -v '/tmp/rear.DYYdWXXzAYZ1981/outputfs' &gt;&amp;2'
192.168.0.104:/home/install/images/rear/ umounted
2012-11-09 15:23:48.026048726 Exit task 'rmdir -v /tmp/rear.DYYdWXXzAYZ1981/outputfs &gt;&amp;2'
rmdir: removing directory, /tmp/rear.DYYdWXXzAYZ1981/outputfs
2012-11-09 15:23:48.027924480 Exit task 'cleanup_build_area_and_end_program'
2012-11-09 15:23:48.029224468 Finished in 10 seconds
2012-11-09 15:23:48.030487732 You should also rm -Rf /tmp/rear.DYYdWXXzAYZ1981
2012-11-09 15:23:48.033388382 End of program reached
2012-11-09 15:23:48.034659112 Exit task 'exec 8&gt;&amp;-'
2012-11-09 15:23:48.036067657 Exit task 'exec 7&gt;&amp;-'
</code></pre>
<h4 id="dagwieers_commented_at_2012-11-09_1710"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-10236794">2012-11-09 17:10</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-11-09_1710" title="Permanent link">&para;</a></h4>
<p>Maybe something silly, but I though Xen uses /dev/xvda for disks, and
/dev/hda for IDE CD-ROM devices ?</p>
<p>Is it possible we are mapping to an IDE CD-ROM device, rather than the
local disk ?</p>
<h4 id="unknown_commented_at_2012-11-09_1824"><img src="(unknown)" width="50"><a href="(unknown)">(unknown)</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-10239253">2012-11-09 18:24</a>:<a class="headerlink" href="#unknown_commented_at_2012-11-09_1824" title="Permanent link">&para;</a></h4>
<p>No that isn't silly at all ;-)</p>
<p>As I mentioned before, I'm also used to see disks inside Xen as
/dev/xvda or /dev/sda, but this one created with Citrix Xen Center is
always displayed as /dev/hda on the storage repository of Xenserver.<br />
I also tried 'rear recover' inside that virtual machine without
attaching a disk to that machine, to see if rear was able to determine
and create it's own disk needed - no way!<br />
Maybe I have to create and attach the disk for that machine in some
other way? I'll test that on the console on monday and report here.</p>
<h4 id="gdha_commented_at_2012-11-12_0718"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-10278905">2012-11-12 07:18</a>:<a class="headerlink" href="#gdha_commented_at_2012-11-12_0718" title="Permanent link">&para;</a></h4>
<p>what worries me are the errors messages in the log file:</p>
<pre><code>find: /lib/modules/2.6.18-6-486/kernel/drivers/firewire: No such file or directory
find: /lib/modules/2.6.18-6-486/kernel/drivers/ata: No such file or directory
find: /lib/modules/2.6.18-6-486/kernel/drivers/virtio: No such file or directory
find: /lib/modules/2.6.18-6-486/kernel/drivers/xen: No such file or directory
</code></pre>
<p>Looks to me that some important modules were not loaded (or copied) into
the rescue image.<br />
Is it possible to check in the log file (of the creation of the image)
that these modules were copied, or not?<br />
If these were copied, check on the recovery image (after booting) if
these are available and if they can be loaded?</p>
<h4 id="unknown_commented_at_2012-11-15_1627"><img src="(unknown)" width="50"><a href="(unknown)">(unknown)</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-10414679">2012-11-15 16:27</a>:<a class="headerlink" href="#unknown_commented_at_2012-11-15_1627" title="Permanent link">&para;</a></h4>
<p>Hi,</p>
<p>I checked the backup.log and those files were not copied, BUT they even
don't exist on the source system. So it's logical that they can't be
copied and I'm wondering where and why rear get's the information of
those files.<br />
Do they really matter as a reason why rear can't mount the created
volume for this vm? Still have to test the creation of that volume by
hand, without Citrix XenCenter tool...</p>
<p>Regards,<br />
Ivan</p>
<h4 id="dagwieers_commented_at_2012-11-16_1051"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-10443390">2012-11-16 10:51</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-11-16_1051" title="Permanent link">&para;</a></h4>
<p>Ivan,</p>
<p>I guess we can improve the script that tries to include as much drivers
we know are needed so that it does not report when certain locations do
not exist, however that's not fatal unless of course we don't pick up
(other) drivers that you <em>do</em> need on Citrix Xen.</p>
<p>But it would help if you can determine if you got all the required
drivers (kernel modules) during recovery. Does your Debian ship with a
kernel that has Xen drivers installed, and if so, where are these
located ?</p>
<p>PS In you configuration file I noticed this line:</p>
<pre><code>RESULT_MAILSUBJECT=REAR backup complete!
</code></pre>
<p>this is not what you intend to do, you probably want:</p>
<pre><code>RESULT_MAILSUBJECT="REAR backup complete\!"
</code></pre>
<h4 id="gdha_commented_at_2013-04-05_0929"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-15946364">2013-04-05 09:29</a>:<a class="headerlink" href="#gdha_commented_at_2013-04-05_0929" title="Permanent link">&para;</a></h4>
<p>@ASTA-TU-DA did you try with the latest git sources to see if the result
is better or the same?</p>
<h4 id="unknown_commented_at_2013-04-05_1133"><img src="(unknown)" width="50"><a href="(unknown)">(unknown)</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-15950986">2013-04-05 11:33</a>:<a class="headerlink" href="#unknown_commented_at_2013-04-05_1133" title="Permanent link">&para;</a></h4>
<p>@gdha: Hi, unfortunately not. I had no time left for more testing,
because this special machine had to be migrated quickly. But in generell
it's still of interest for me and when possible I will do some more
testing and report here.<br />
Are the .deb-packages the same version as the git sources?<br />
Best wishes</p>
<h4 id="unknown_commented_at_2013-07-02_0910"><img src="(unknown)" width="50"><a href="(unknown)">(unknown)</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-20334786">2013-07-02 09:10</a>:<a class="headerlink" href="#unknown_commented_at_2013-07-02_0910" title="Permanent link">&para;</a></h4>
<p>So, finally I would try going forward with this "project" migrating to
Citrix Xen / Xenserver ;-)<br />
Is there some documentation how to install latest snapshot from tarball
or git?</p>
<p>Thanks!</p>
<p>UPDATE: OK, I see now that I have to start it out of the directory
itself. So I'll give it another try!</p>
<h4 id="dagwieers_commented_at_2013-07-11_2330"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-20849842">2013-07-11 23:30</a>:<a class="headerlink" href="#dagwieers_commented_at_2013-07-11_2330" title="Permanent link">&para;</a></h4>
<p>@ASTA-TU-DA Feedback is welcome and with your help we'd be happy to
support you in this specific environment.</p>
<h4 id="gdha_commented_at_2013-10-04_1202"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-25693712">2013-10-04 12:02</a>:<a class="headerlink" href="#gdha_commented_at_2013-10-04_1202" title="Permanent link">&para;</a></h4>
<p>@ASTA-TU-DA What is the current status? Or may we close this issue?</p>
<h4 id="unknown_commented_at_2013-10-07_1147"><img src="(unknown)" width="50"><a href="(unknown)">(unknown)</a> commented at <a href="https://github.com/rear/rear/issues/172#issuecomment-25802251">2013-10-07 11:47</a>:<a class="headerlink" href="#unknown_commented_at_2013-10-07_1147" title="Permanent link">&para;</a></h4>
<p>Am 04.10.2013 14:02, schrieb gdha:</p>
<blockquote>
<p>@ASTA-TU-DA
<a href="https://github.com/ASTA-TU-DA">https://github.com/ASTA-TU-DA</a> What is
the current status?<br />
Or may we close this issue?</p>
<p>—<br />
Reply to this email directly or view it on GitHub<br />
<a href="https://github.com/rear/rear/issues/172#issuecomment-25693712">https://github.com/rear/rear/issues/172#issuecomment-25693712</a>.</p>
</blockquote>
<p>Hello,</p>
<p>I did not succeed. I'm sorry, but I don't have the time for further<br />
testing. Also changed to XCP...</p>
<p>So I think it's better to close this issue.</p>
<p>Thanks!</p>
<p>Regrads</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2012-10-31.172.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
