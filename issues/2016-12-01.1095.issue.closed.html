<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1095 Issue closed: Rear recover doesn't work with SLES 12 SP1 btrfs subvolume - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1095 Issue closed: Rear recover doesn\u0027t work with SLES 12 SP1 btrfs subvolume";
        var mkdocs_page_input_path = "issues/2016-12-01.1095.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1095 Issue closed: Rear recover doesn't work with SLES 12 SP1 btrfs subvolume</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1095_issue_closed_rear_recover_doesnt_work_with_sles_12_sp1_btrfs_subvolume"><a href="https://github.com/rear/rear/issues/1095">#1095 Issue</a> <code>closed</code>: Rear recover doesn't work with SLES 12 SP1 btrfs subvolume<a class="headerlink" href="#1095_issue_closed_rear_recover_doesnt_work_with_sles_12_sp1_btrfs_subvolume" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="vishualways_opened_issue_at_2016-12-01_1308"><img src="https://avatars.githubusercontent.com/u/10653517?v=4" width="50"><a href="https://github.com/vishualways">vishualways</a> opened issue at <a href="https://github.com/rear/rear/issues/1095">2016-12-01 13:08</a>:<a class="headerlink" href="#vishualways_opened_issue_at_2016-12-01_1308" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (rear) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Please fill in the following items before submitting a new issue (quick
response is not guaranteed with free support):</p>
<ul>
<li>rear version (/usr/sbin/rear -V): 1.19</li>
<li>OS version (cat /etc/rear/os.conf or lsb_release -a): SLES 12 SP1</li>
</ul>
<p><a href="https://github.com/rear/rear/files/624628/rear-ulvwasaw01.txt">rear-ulvwasaw01.txt</a></p>
<p>Could you please let us know what can we do to get this working on
SLES12 SP1? is there any specific patch or update need to be installed?
We are stuck on a project where acceptable DR process needs to be hand
over. if there is a workaround then kindly let us know.</p>
<p>Thanking in advance.<br />
Vish</p>
<h4 id="jsmeix_commented_at_2016-12-01_1409"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1095#issuecomment-264181874">2016-12-01 14:09</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-01_1409" title="Permanent link">&para;</a></h4>
<p>Regardless of "quick response is not guaranteed with free support"<br />
you ask for urgent help but think I have time to manually pull out<br />
information from your file that does not "just display" in my browser<br />
(I will of course not download foreign data).</p>
<p>Just write the basics as plain text here and I may have a look<br />
when I have time.</p>
<p>In case of real urgency use the official SUSE support contact<br />
according to your SUSE Linux Enterprise support contract.</p>
<h4 id="vishualways_commented_at_2016-12-01_1452"><img src="https://avatars.githubusercontent.com/u/10653517?v=4" width="50"><a href="https://github.com/vishualways">vishualways</a> commented at <a href="https://github.com/rear/rear/issues/1095#issuecomment-264192868">2016-12-01 14:52</a>:<a class="headerlink" href="#vishualways_commented_at_2016-12-01_1452" title="Permanent link">&para;</a></h4>
<p>I mean 'urgency' is at our end so please see if you can help us in
getting this resolved. I came across some patch you have released but it
seems currently its not in the download archive unless I am seeing it
somethign different completely.<br />
once again Thanks a lot for looking into it.<br />
Vish</p>
<h4 id="vishualways_commented_at_2016-12-01_1623"><img src="https://avatars.githubusercontent.com/u/10653517?v=4" width="50"><a href="https://github.com/vishualways">vishualways</a> commented at <a href="https://github.com/rear/rear/issues/1095#issuecomment-264219177">2016-12-01 16:23</a>:<a class="headerlink" href="#vishualways_commented_at_2016-12-01_1623" title="Permanent link">&para;</a></h4>
<p>Hi, I will need help in fidning any workaround to get this working on
SLES 12 SP1. Could you please review below log files while recovering
through rear image? Your help would be much appreciable. Thanks and
regards,Vish</p>
<p><a href="https://github.com/rear/rear/files/625164/rear-ulvwasaw01.txt">rear-ulvwasaw01.txt</a></p>
<p><a href="https://github.com/rear/rear/files/625168/rear-sles12_test.txt">rear-sles12_test.txt</a>
-----&gt; this is after trying snapper and try to recover the image but
still failed</p>
<h4 id="gozora_commented_at_2016-12-01_1643"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1095#issuecomment-264225063">2016-12-01 16:43</a>:<a class="headerlink" href="#gozora_commented_at_2016-12-01_1643" title="Permanent link">&para;</a></h4>
<p>Yes, agree that it failed, but this time it failed with:<br />
<code>+++ btrfs subvolume set-default /mnt/local/home</code><br />
Try to manually enable snapper for <strong>each</strong> LVM lvol with BTRFS like:</p>
<pre><code>snapper -c home create-config /home
snapper -c opt create-config /opt
snapper -c perflog create-config /perflog
...

snapper create
rear mkrescue
</code></pre>
<p>Let me warn you about possible implications though, guys in SuSE
certainly had a reason for <a href="https://www.suse.com/documentation/sled-12/book_sle_admin/data/sec_snapper_setup.html">not enabling <em>snapper</em> for small partitions
by
default</a>.</p>
<h4 id="vishualways_commented_at_2016-12-01_1725"><img src="https://avatars.githubusercontent.com/u/10653517?v=4" width="50"><a href="https://github.com/vishualways">vishualways</a> commented at <a href="https://github.com/rear/rear/issues/1095#issuecomment-264236824">2016-12-01 17:25</a>:<a class="headerlink" href="#vishualways_commented_at_2016-12-01_1725" title="Permanent link">&para;</a></h4>
<p>@gozora, Yes we tried this solution from -
<a href="https://github.com/rear/rear/issues/1036">https://github.com/rear/rear/issues/1036</a>
- by enabling snapper for each LVM vol and then ran it and as you can
see it ( test VM log) progressed from stopping at lvroot and then stuck
in lvhome. Just wondering if we are missing anything in base OS, which
is needed to complete BMR recovery.<br />
Thanks a lot for coming back to me, I will try again on a new VM
tomorrow and keep you posted</p>
<h4 id="gozora_commented_at_2016-12-01_1746"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1095#issuecomment-264242418">2016-12-01 17:46</a>:<a class="headerlink" href="#gozora_commented_at_2016-12-01_1746" title="Permanent link">&para;</a></h4>
<p>Whether you are missing something in base OS or not, is something I
can't answer.<br />
You can setup Linux in many ways, and in general there are no rights or
wrongs (only bigger or smaller compromises).</p>
<p>I for example consider using btrfs on top of LVM as useless redundancy.
Yes it works, but IMHO it just introduces another layer of complexity.
see <a href="https://tools.ietf.org/html/rfc1925#section-2">RFC: 1925 point 3</a></p>
<h4 id="vishualways_commented_at_2016-12-02_1437"><img src="https://avatars.githubusercontent.com/u/10653517?v=4" width="50"><a href="https://github.com/vishualways">vishualways</a> commented at <a href="https://github.com/rear/rear/issues/1095#issuecomment-264467678">2016-12-02 14:37</a>:<a class="headerlink" href="#vishualways_commented_at_2016-12-02_1437" title="Permanent link">&para;</a></h4>
<p>@gozora We had ran this using snapper for each FS/vol as attached in
here. I have attached the log for your analysis and error is still same
where it stuck in mounting /home while recovering.</p>
<pre>
+++ btrfs subvolume set-default /mnt/local/home
btrfs subvolume set-default: too few arguments
usage: btrfs subvolume set-default <subvolid> <path>

    Set the default subvolume of a filesystem

2016-11-18 12:01:11 An error occurred during layout recreation.
</pre>

<p><a href="https://github.com/rear/rear/files/627385/rear_manualsetup-119.txt">rear_manualsetup-119.txt</a><br />
<a href="https://github.com/rear/rear/files/627384/rear-sles12_test.txt">rear-sles12_test.txt</a></p>
<h4 id="jsmeix_commented_at_2016-12-02_1540"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1095#issuecomment-264483328">2016-12-02 15:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-02_1540" title="Permanent link">&para;</a></h4>
<p>Ahh!<br />
First plain text error message here that I can "just read".</p>
<p>The error message in the above<br />
<a href="https://github.com/rear/rear/issues/1095#issuecomment-264467678">https://github.com/rear/rear/issues/1095#issuecomment-264467678</a><br />
is the same as in<br />
<a href="https://github.com/rear/rear/issues/1057#issuecomment-260920515">https://github.com/rear/rear/issues/1057#issuecomment-260920515</a></p>
<p>In both cases the partitioning and filesystems layout<br />
is rather complicated.</p>
<p>Unfortunately in both cases I have currently no time<br />
to dig into that (on a voluntary base - of course when<br />
you pay SUSE for official support, things change ;-)<br />
see also<br />
<a href="http://relax-and-recover.org/support/">http://relax-and-recover.org/support/</a></p>
<p>In general:</p>
<p>When one likes to use ReaR for disaster recovery<br />
one must set up the system in a way that is supported<br />
by the current ReaR code - or one must adapt and<br />
enhance the ReaR scripts to make it work for one's<br />
particular use case.</p>
<p>One can set up a system in zillions of ways<br />
where one gets into trouble with ReaR.</p>
<p>Regarding "VM" in<br />
<a href="https://github.com/rear/rear/issues/1095#issuecomment-264236824">https://github.com/rear/rear/issues/1095#issuecomment-264236824</a></p>
<p>In particular on virtual machines I do not understand<br />
why to use such a complicated setup, cf.<br />
<a href="https://github.com/rear/rear/issues/1057#issuecomment-259640399">https://github.com/rear/rear/issues/1057#issuecomment-259640399</a></p>
<p>For example on KVM/QEMU with the qcow2<br />
file type for the virtual disk images one can specify<br />
e.g. a 2TB virtual disk size to have more than enough space<br />
but on the host system the qcow2 virtual disk image file<br />
will only be as big as the actually used space on the<br />
virtual disk.</p>
<p>I wonder about all that complicated stuff with<br />
tons of virtual disks and tons of partitions<br />
plus LVM on top of them plus several btrfs<br />
filesystems on top of LVM that becomes<br />
a monstrosity from my point of view.</p>
<p>At least I currently fail to understand<br />
what the real advantage of all that<br />
could be on a virtual machine?</p>
<p>In general see<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>In particular therein see the sections<br />
about "Inappropriate expectations" and the<br />
subsequent "Recommendations".</p>
<h4 id="jsmeix_commented_at_2017-01-18_1303"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1095#issuecomment-273469740">2017-01-18 13:03</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-01-18_1303" title="Permanent link">&para;</a></h4>
<p>The error message in the above<br />
<a href="https://github.com/rear/rear/issues/1095#issuecomment-264467678">https://github.com/rear/rear/issues/1095#issuecomment-264467678</a><br />
is the same as in<br />
<a href="https://github.com/rear/rear/issues/1036#issuecomment-273049971">https://github.com/rear/rear/issues/1036#issuecomment-273049971</a><br />
so that this issue is a duplicate of<br />
<a href="https://github.com/rear/rear/issues/1036">https://github.com/rear/rear/issues/1036</a></p>
<h4 id="jsmeix_commented_at_2017-11-28_1132"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1095#issuecomment-347495869">2017-11-28 11:32</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-11-28_1132" title="Permanent link">&para;</a></h4>
<p>Also this issue should be fixed as described in<br />
<a href="https://github.com/rear/rear/issues/1036#issuecomment-319049462">https://github.com/rear/rear/issues/1036#issuecomment-319049462</a></p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-12-01.1095.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
