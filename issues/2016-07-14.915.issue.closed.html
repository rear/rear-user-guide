<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#915 Issue closed: RFE: usecase: automatically clone new virtual machine - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#915 Issue closed: RFE: usecase: automatically clone new virtual machine";
        var mkdocs_page_input_path = "issues/2016-07-14.915.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li class="breadcrumb-item active">#915 Issue closed: RFE: usecase: automatically clone new virtual machine</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="915_issue_closed_rfe_usecase_automatically_clone_new_virtual_machine"><a href="https://github.com/rear/rear/issues/915">#915 Issue</a> <code>closed</code>: RFE: usecase: automatically clone new virtual machine<a class="headerlink" href="#915_issue_closed_rfe_usecase_automatically_clone_new_virtual_machine" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>needs sponsorship</code></p>
<h4 id="jscotka_opened_issue_at_2016-07-14_1113"><img src="https://avatars.githubusercontent.com/u/8735467?u=7357836b201965a3debf653c3b9d27c557711c80&v=4" width="50"><a href="https://github.com/jscotka">jscotka</a> opened issue at <a href="https://github.com/rear/rear/issues/915">2016-07-14 11:13</a>:<a class="headerlink" href="#jscotka_opened_issue_at_2016-07-14_1113" title="Permanent link">&para;</a></h4>
<p>Hi,<br />
I've tested rear and I wanted to use rear for cloning one virt machine
to anither one:<br />
cat /etc/rear/local.conf<br />
OUTPUT=ISO<br />
OUTPUT_URL="file:///issoo.iso"<br />
BACKUP=NETFS<br />
BACKUP_URL="iso:///bbbb/"</p>
<p>then using virt-install like:<br />
virt-install -r 2048 -n newrear -f new.img --cdrom rear-rearclient.iso</p>
<p>it is working moreless perfect, but it needs to click in boot menu that
I want automatical recovery, and then click 1 that I want to use disc
/dev/sda and then 5 to allow resizing of partitions.</p>
<p>I would suggest to have there some option for command rear -v mkbackup<br />
what creates ISO what will be tolerant and fully automated (something
like kickstart for installation), no asking, just boot from iso and
recover and config first possible disc (in most cases there is one disc,
so it could be acceptable)<br />
like: option --force<br />
Regards<br />
Honza</p>
<h4 id="jsmeix_commented_at_2016-07-15_1100"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/915#issuecomment-232922941">2016-07-15 11:00</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-15_1100" title="Permanent link">&para;</a></h4>
<p>@jscotka<br />
FYI what it means that this issue is set<br />
to "looking for sponsorship" see<br />
<a href="http://relax-and-recover.org/support/sponsors">http://relax-and-recover.org/support/sponsors</a></p>
<p>In general regarding contributing see<br />
<a href="http://relax-and-recover.org/development/">http://relax-and-recover.org/development/</a><br />
and<br />
"How to contribute to Relax-and-Recover (rear)" at<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>Here my current personal offhanded opinion regarding<br />
ISOs that do a fully automated system installation<br />
(disaster recovery is system re-installation):</p>
<p>I do not like such ISOs because I think<br />
they behave too easily as a descructive pitfall<br />
(just boot with that ISO and your old system is gone).</p>
<p>I would prefer that an explicit confirmation action is needed<br />
by the user before he gets his system re-installed.</p>
<p>I mean not something like "rear mkrescue autorecover"<br />
that has the 'autorecover' confirmation at ISO creation time.</p>
<p>I mean some confirmation at ISO boot time, i.e. something<br />
that is not already hardcoded on the ISO but something<br />
that must be provided "from outside" that makes the ISO<br />
do an automated "rear recover".</p>
<p>But I don't know if one can provide such kind of<br />
confirmation "from outside" at ISO boot time<br />
in an automated way so that in the end you<br />
could get a full automated "rear recover".</p>
<p>For example if one could simulate some keyboard input<br />
via virt-install command line then the virt-install command<br />
could provide that confirmation "from outside".</p>
<p>But this is only some offhanded thoughts because<br />
I am not at all an expert in those areas.</p>
<h4 id="jsmeix_commented_at_2016-07-15_1110"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/915#issuecomment-232924658">2016-07-15 11:10</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-15_1110" title="Permanent link">&para;</a></h4>
<p>A totally different idea:</p>
<p>A "rear recover" on a "new virtual machine" means<br />
all harddisks on the target system (the "new virtual machine")<br />
are empty (except the disk/CDROM where the ISO is).</p>
<p>Accordingly a full automated "rear recover" might be<br />
possible with reasonably limited risk when there is<br />
a test implemented that errors out if it detects<br />
any data on the harddisks on the target system.</p>
<p>This could make those possibly descructive ISOs<br />
reasonable safe against actually causing damage<br />
(i.e. safe against automatically overwriting a system).</p>
<h4 id="jscotka_commented_at_2016-07-19_1308"><img src="https://avatars.githubusercontent.com/u/8735467?u=7357836b201965a3debf653c3b9d27c557711c80&v=4" width="50"><a href="https://github.com/jscotka">jscotka</a> commented at <a href="https://github.com/rear/rear/issues/915#issuecomment-233626663">2016-07-19 13:08</a>:<a class="headerlink" href="#jscotka_commented_at_2016-07-19_1308" title="Permanent link">&para;</a></h4>
<p>I agree with your views, yep, it can be destructive, but I know what I'm
doing and in case I add some option like "rear mkbackup --autorecover"
or whatever, it should accept my will, that I know what I'm doing.<br />
Your detection if disc is empty or does not contain any partitions also
could work.<br />
It is not easy to pass some clicks/keyboard input to virt machine
automatically.<br />
I need some way how to do it fully automatic, it is also important for
automatic testing of rear. In case there will be some option or method
what will detect that disc is empty, it enable possibility to create
machine via virt-install, run there some config, run rear, delete
machine, create empty disc, use virt-install with ISO and boot machine
again.</p>
<h4 id="jsmeix_commented_at_2016-07-22_1107"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/915#issuecomment-234517457">2016-07-22 11:07</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-22_1107" title="Permanent link">&para;</a></h4>
<p>Only FYI regarding "detect that disc is empty":</p>
<p>I think there could be a relation to
<a href="https://github.com/rear/rear/issues/799">https://github.com/rear/rear/issues/799</a><br />
which is about a "cleanupdisk" script.</p>
<p>When such a "cleanupdisk" script does not find<br />
anything that needs to be cleaned up on the disk<br />
(in particular not any partition on the disk)<br />
then it should mean that the disk is empty.</p>
<p>In short:<br />
Such a "cleanupdisk" script might be somehow usable<br />
to determine whether or not a disk is empty.</p>
<h4 id="gdha_commented_at_2016-07-25_1256"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/915#issuecomment-234945253">2016-07-25 12:56</a>:<a class="headerlink" href="#gdha_commented_at_2016-07-25_1256" title="Permanent link">&para;</a></h4>
<p>@jscotka to autostart the ISO you can define in <code>/etc/rear/local.conf</code>
the variable <code>ISO_DEFAULT=automatic</code> which fixes your first problem.<br />
@jsmeix Perhaps if with above setting we can force a cleanupdisk script
then we're all set, no? We can add an additional precaution setting (via
the command line or variable).</p>
<h4 id="jsmeix_commented_at_2016-07-26_0742"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/915#issuecomment-235187319">2016-07-26 07:42</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-26_0742" title="Permanent link">&para;</a></h4>
<p>My plan for the "cleanupdisk" script is that it is run<br />
in any case (i.e. no need to enforce it) but currently<br />
I do not have sufficient understanding to make such<br />
a "cleanupdisk" script in a good way because currently it seems<br />
there are too many uncertainties - at least for my understanding.</p>
<p>Perhaps after rear 1.19 was released I should implement<br />
a first version of such a "cleanupdisk" script so that we can<br />
get user feedback how it works.</p>
<p>I assume such a "cleanupdisk" script cannot cause any harm<br />
(in particular no regression) because I cannot imagine<br />
what could be wrong when such a "cleanupdisk" script<br />
does some first steps to remove step by step stuff<br />
from a used harddisk to make a used harddisk<br />
more and more appear as if it was a new harddisk.</p>
<p>In the end the goal of such a "cleanupdisk" script is<br />
to eliminate the difference between a used harddisk<br />
and a new harddisk.</p>
<p>Because "rear recover" must work at least on a<br />
new replacement harddisk (with same type and size<br />
as the original harddisk was), such a "cleanupdisk" script<br />
should help to avoid issues in "rear recover" that<br />
happen because of leftover stuff on a used harddisk.</p>
<h4 id="jscotka_commented_at_2016-07-28_0933"><img src="https://avatars.githubusercontent.com/u/8735467?u=7357836b201965a3debf653c3b9d27c557711c80&v=4" width="50"><a href="https://github.com/jscotka">jscotka</a> commented at <a href="https://github.com/rear/rear/issues/915#issuecomment-235846563">2016-07-28 09:33</a>:<a class="headerlink" href="#jscotka_commented_at_2016-07-28_0933" title="Permanent link">&para;</a></h4>
<p>I'm not sure if it should only work on disc of same type and size. From
my POV It would work on any empty HDD size and type are more less
irrelevant, or better to say size is important, but size could be same
or bigger, but I prefer to autostart recovering without any asking on
any type and size.</p>
<h4 id="jsmeix_commented_at_2016-07-28_1141"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/915#issuecomment-235871606">2016-07-28 11:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-28_1141" title="Permanent link">&para;</a></h4>
<p>I think when the target disks (i.e. those disks<br />
were "rear recover" would do partitioning and so on)<br />
are empty, then no existing data would be overwritten,<br />
so that it should be safe to "just do it".</p>
<h4 id="gdha_commented_at_2017-01-19_0936"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/915#issuecomment-273724555">2017-01-19 09:36</a>:<a class="headerlink" href="#gdha_commented_at_2017-01-19_0936" title="Permanent link">&para;</a></h4>
<p>@jscotka @jsmeix Will check it out within the rear-automated-testing
(<a href="https://github.com/gdha/rear-automated-testing">https://github.com/gdha/rear-automated-testing</a>)
project. Currently using PXE, but ISO is in scope as well (but not yet
fully implemented). Need some more time.</p>
<h4 id="gdha_commented_at_2017-08-16_0932"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/915#issuecomment-322717270">2017-08-16 09:32</a>:<a class="headerlink" href="#gdha_commented_at_2017-08-16_0932" title="Permanent link">&para;</a></h4>
<p>@jscotka @jsmeix PXE and ISO can now do an <strong>unattended</strong> recovery - see
as example the config file
<a href="https://github.com/gdha/rear-automated-testing/blob/master/templates/ISO-booting-with-NETFS-NFS.conf">https://github.com/gdha/rear-automated-testing/blob/master/templates/ISO-booting-with-NETFS-NFS.conf</a></p>
<h4 id="jsmeix_commented_at_2017-08-23_1611"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/915#issuecomment-324385240">2017-08-23 16:11</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-08-23_1611" title="Permanent link">&para;</a></h4>
<p>@jscotka @gdha<br />
to be precise 'an unattended recovery' means here that<br />
after booting the ReaR recovery system "rear recover"<br />
is run automatically which is what is requested here.</p>
<p>But this does not mean that "rear recover" can<br />
run unattended in any case.</p>
<p>For example when the disk size is different<br />
"rear recover" will go into its so called migration mode<br />
and then user dialogs appear to confirm the disk migration.</p>
<p>Also when the network interface has changed there<br />
could be a user dialog to let the user chose the right<br />
network interface in the ReaR recovery system.</p>
<p>Running "rear recover" fully unattended<br />
is something for the future, see in particular<br />
<a href="https://github.com/rear/rear/issues/1399">https://github.com/rear/rear/issues/1399</a></p>
<h4 id="gdha_commented_at_2017-10-03_1535"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/915#issuecomment-333881156">2017-10-03 15:35</a>:<a class="headerlink" href="#gdha_commented_at_2017-10-03_1535" title="Permanent link">&para;</a></h4>
<p>@jscotka Is your question sufficient answered?</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2023 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-07-14.915.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
