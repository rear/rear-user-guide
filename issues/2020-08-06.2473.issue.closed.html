<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2473 Issue closed: function has_binary sends misleading “type: foo: not found” messages to the log - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2473 Issue closed: function has_binary sends misleading \u201ctype: foo: not found\u201d messages to the log";
        var mkdocs_page_input_path = "issues/2020-08-06.2473.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2473 Issue closed: function has_binary sends misleading “type: foo: not found” messages to the log</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2473_issue_closed_function_has_binary_sends_misleading_type_foo_not_found_messages_to_the_log"><a href="https://github.com/rear/rear/issues/2473">#2473 Issue</a> <code>closed</code>: function has_binary sends misleading “type: foo: not found” messages to the log<a class="headerlink" href="#2473_issue_closed_function_has_binary_sends_misleading_type_foo_not_found_messages_to_the_log" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="casantos_opened_issue_at_2020-08-06_1702"><img src="https://avatars.githubusercontent.com/u/1591398?u=ec6f9b129fc68c2f63b6bdeac9faeab8f2e4f0df&v=4" width="50"><a href="https://github.com/casantos">casantos</a> opened issue at <a href="https://github.com/rear/rear/issues/2473">2020-08-06 17:02</a>:<a class="headerlink" href="#casantos_opened_issue_at_2020-08-06_1702" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"): Relax-and-Recover 2.4 / Git</p>
</li>
<li>
<p>OS version ("cat /etc/os-release" or "lsb_release -a" or "cat
    /etc/rear/os.conf"): Red Hat Enterprise Linux release 8.1 (Ootpa)</p>
</li>
<li>
<p>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):</p>
</li>
<li>
<p>Hardware (PC or PowerNV BareMetal or ARM) or virtual machine (KVM
    guest or PoverVM LPAR): KVM Guest</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device): x86_64</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot): UEFI</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe): VirtIO disk</p>
</li>
<li>
<p>Storage layout ("lsblk -ipo
    NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT" or "lsblk" as
    makeshift):</p>
</li>
</ul>
<!-- -->

<pre><code># lsblk -ipo NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT
NAME                                     KNAME      PKNAME    TRAN   TYPE FSTYPE       SIZE MOUNTPOINT
/dev/sr0                                 /dev/sr0             sata   rom  iso9660      7.3G 
/dev/vda                                 /dev/vda                    disk               20G 
|-/dev/vda1                              /dev/vda1  /dev/vda         part vfat          50M /boot/efi
|-/dev/vda2                              /dev/vda2  /dev/vda         part xfs          512M /boot
`-/dev/vda3                              /dev/vda3  /dev/vda         part LVM2_member 19.5G 
  |-/dev/mapper/rootvg-pool00_tmeta      /dev/dm-0  /dev/vda3        lvm                 4M 
  | `-/dev/mapper/rootvg-pool00-tpool    /dev/dm-2  /dev/dm-0        lvm              13.4G 
  |   |-/dev/mapper/rootvg-root          /dev/dm-3  /dev/dm-2        lvm  xfs           48M /
  |   |-/dev/mapper/rootvg-usr           /dev/dm-5  /dev/dm-2        lvm  xfs            4G /usr
  |   |-/dev/mapper/rootvg-pool00        /dev/dm-6  /dev/dm-2        lvm              13.4G 
  |   |-/dev/mapper/rootvg-tmp           /dev/dm-7  /dev/dm-2        lvm  xfs            4G /tmp
  |   |-/dev/mapper/rootvg-opt           /dev/dm-8  /dev/dm-2        lvm  xfs          512M /opt
  |   |-/dev/mapper/rootvg-var_log_audit /dev/dm-9  /dev/dm-2        lvm  xfs          128M /var/log/audit
  |   |-/dev/mapper/rootvg-var_log       /dev/dm-10 /dev/dm-2        lvm  xfs          512M /var/log
  |   |-/dev/mapper/rootvg-home          /dev/dm-11 /dev/dm-2        lvm  xfs          256M /home
  |   `-/dev/mapper/rootvg-var           /dev/dm-12 /dev/dm-2        lvm  xfs            4G /var
  |-/dev/mapper/rootvg-pool00_tdata      /dev/dm-1  /dev/vda3        lvm              13.4G 
  | `-/dev/mapper/rootvg-pool00-tpool    /dev/dm-2  /dev/dm-1        lvm              13.4G 
  |   |-/dev/mapper/rootvg-root          /dev/dm-3  /dev/dm-2        lvm  xfs           48M /
  |   |-/dev/mapper/rootvg-usr           /dev/dm-5  /dev/dm-2        lvm  xfs            4G /usr
  |   |-/dev/mapper/rootvg-pool00        /dev/dm-6  /dev/dm-2        lvm              13.4G 
  |   |-/dev/mapper/rootvg-tmp           /dev/dm-7  /dev/dm-2        lvm  xfs            4G /tmp
  |   |-/dev/mapper/rootvg-opt           /dev/dm-8  /dev/dm-2        lvm  xfs          512M /opt
  |   |-/dev/mapper/rootvg-var_log_audit /dev/dm-9  /dev/dm-2        lvm  xfs          128M /var/log/audit
  |   |-/dev/mapper/rootvg-var_log       /dev/dm-10 /dev/dm-2        lvm  xfs          512M /var/log
  |   |-/dev/mapper/rootvg-home          /dev/dm-11 /dev/dm-2        lvm  xfs          256M /home
  |   `-/dev/mapper/rootvg-var           /dev/dm-12 /dev/dm-2        lvm  xfs            4G /var
  `-/dev/mapper/rootvg-swap              /dev/dm-4  /dev/vda3        lvm  swap         2.1G [SWAP]
</code></pre>
<ul>
<li>Description of the issue (ideally so that others can reproduce
    it):<br />
    The log contains lots of messages like these:</li>
</ul>
<!-- -->

<pre><code># grep 'type: .*: not found' /var/log/rear/rear-$(hostname -s).log
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: getty: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: dhcpcd: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: dhcp6c: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: dhclient6: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: grub-probe: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: sedutil-cli: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: sedutil-cli: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: cryptsetup: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: hpacucli: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: hpssacli: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: ssacli: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: multipath: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: grub-mkstandalone: not found
/usr/share/rear/lib/_input-output-functions.sh: line 331: type: grub-probe: not found
</code></pre>
<p>The messages induce the user to think that there is an error when in
fact there is nothing wrong.</p>
<ul>
<li>Workaround, if any:<br />
    Edit <code>/usr/share/rear/lib/_input-output-functions.sh</code>and in function
    <code>has_binary</code> replace</li>
</ul>
<!-- -->

<pre><code>type $bin 1&gt;/dev/null &amp;&amp; return 0
</code></pre>
<p>by</p>
<pre><code>type -t $bin 1&gt;/dev/null &amp;&amp; return 0
</code></pre>
<ul>
<li>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files): not required</li>
</ul>
<h4 id="jsmeix_commented_at_2020-08-07_1020"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2473#issuecomment-670446349">2020-08-07 10:20</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-08-07_1020" title="Permanent link">&para;</a></h4>
<p>This issue is an example case of our general issue<br />
<a href="https://github.com/rear/rear/issues/2416">https://github.com/rear/rear/issues/2416</a></p>
<p>The proposed change from plain <code>type</code> to <code>type -t</code><br />
conflicts with what is descibed in the comment<br />
of the has_binary function which reads</p>
<pre><code># Suppress success output via stdout which is crucial when has_binary is called
# in other functions that provide their intended function results via stdout
# to not pollute intended function results with intermixed has_binary stdout
# (e.g. the RequiredSharedObjects function) but keep failure output via stderr:
type $bin 1&gt;/dev/null &amp;&amp; return 0
</code></pre>
<p>because - as far as I see - essentially the proposed change results the
same<br />
as if both stdout and stderr were suppressed like</p>
<pre><code>type $bin &amp;&gt;/dev/null &amp;&amp; return 0
</code></pre>
<p>But stderr is intentionaly not suppressed because<br />
filtering stdout or stderr directly in the program call is in general
not wanted,<br />
cf. the section "What to do with stdin, stdout, and stderr" in<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a><br />
that reads (excerpt):</p>
<pre><code>All what could be useful for later debugging in case of issues
must appear in ReaR's log file. Usually command output
should not appear on the user's terminal but in ReaR's log file.
Because stdout and stderr are redirected into ReaR's log file
you should omit things like '1&gt;/dev/null' or '2&gt;/dev/null'
or '&amp;&gt;/dev/null' to have all messages in the log file
where they help to identify the root cause of a problem.
On the other hand if a program is needlessly verbose
you may use '1&gt;/dev/null' or '2&gt;/dev/null' or '&amp;&gt;/dev/null'
as appropriate to avoid that the log file is "polluted" with
useless messages ...
</code></pre>
<p>cf.
<a href="https://github.com/rear/rear/pull/2466#discussion_r466410087">https://github.com/rear/rear/pull/2466#discussion_r466410087</a></p>
<h4 id="casantos_commented_at_2020-08-07_1204"><img src="https://avatars.githubusercontent.com/u/1591398?u=ec6f9b129fc68c2f63b6bdeac9faeab8f2e4f0df&v=4" width="50"><a href="https://github.com/casantos">casantos</a> commented at <a href="https://github.com/rear/rear/issues/2473#issuecomment-670483657">2020-08-07 12:04</a>:<a class="headerlink" href="#casantos_commented_at_2020-08-07_1204" title="Permanent link">&para;</a></h4>
<p>The genera approach is reasonable but in this case the failure is not an
error. Compare with the test for the existence of <code>pidof</code>in
<code>/usr/sbin/rear</code>, for instance. A possible alternative would be to make
<code>has_binary</code> show the messages only in debug mode.</p>
<h4 id="jsmeix_commented_at_2020-08-07_1211"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2473#issuecomment-670486233">2020-08-07 12:11</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-08-07_1211" title="Permanent link">&para;</a></h4>
<p>That <code>type: COMMAND: not found</code> is not an error is visible to the user<br />
because that message does not contain a word like "error" or "failure"<br />
so the particular user misunderstands the meaning of the message.</p>
<p>The "possible alternative" is<br />
what
<a href="https://github.com/rear/rear/issues/2416">https://github.com/rear/rear/issues/2416</a>
is about.</p>
<h4 id="jsmeix_commented_at_2020-08-07_1218"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2473#issuecomment-670488707">2020-08-07 12:18</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-08-07_1218" title="Permanent link">&para;</a></h4>
<p>The test for the existence of pidof in /usr/sbin/rear<br />
behaves even "worse" compared to the has_binary function<br />
because <code>type pidof 1&gt;/dev/null</code> runs before stdout and stderr<br />
are redirected into the log file so that without <code>pidof</code> one gets on the
terminal</p>
<pre><code># usr/sbin/rear -s mkrescue
usr/sbin/rear: line 366: type: pidof: not found
ERROR: Required program 'pidof' missing, please check your PATH
</code></pre>
<h4 id="jsmeix_commented_at_2020-09-30_1342"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2473#issuecomment-701398704">2020-09-30 13:42</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-09-30_1342" title="Permanent link">&para;</a></h4>
<p>@casantos<br />
could you please test if the changes in<br />
<a href="https://github.com/rear/rear/pull/2498">https://github.com/rear/rear/pull/2498</a><br />
solve this issue sufficiently for you?</p>
<h4 id="jsmeix_commented_at_2020-10-01_1444"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2473#issuecomment-702184834">2020-10-01 14:44</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-10-01_1444" title="Permanent link">&para;</a></h4>
<p>@casantos<br />
I changed
<a href="https://github.com/rear/rear/pull/2498">https://github.com/rear/rear/pull/2498</a>
noticeably,<br />
cf.
<a href="https://github.com/rear/rear/issues/2416#issuecomment-702142588">https://github.com/rear/rear/issues/2416#issuecomment-702142588</a><br />
and
<a href="https://github.com/rear/rear/issues/2416#issuecomment-702159687">https://github.com/rear/rear/issues/2416#issuecomment-702159687</a></p>
<p>Could you please test if the current changes in<br />
<a href="https://github.com/rear/rear/pull/2498">https://github.com/rear/rear/pull/2498</a><br />
i.e. if this changes<br />
<a href="https://github.com/rear/rear/pull/2498/files">https://github.com/rear/rear/pull/2498/files</a><br />
solve this issue sufficiently for you?</p>
<h4 id="jsmeix_commented_at_2020-10-12_1245"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2473#issuecomment-707098031">2020-10-12 12:45</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-10-12_1245" title="Permanent link">&para;</a></h4>
<p>Because no news is good news I assume this issue is done<br />
since
<a href="https://github.com/rear/rear/pull/2498">https://github.com/rear/rear/pull/2498</a>
is merged.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2023 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2020-08-06.2473.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
