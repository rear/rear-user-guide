<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1038 Issue closed: "rear mkrescue" fails with "BUG! Unknown bootloader" for 'GRUB2' and 'GRUB2-EFI' - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1038 Issue closed: \"rear mkrescue\" fails with \"BUG! Unknown bootloader\" for \u0027GRUB2\u0027 and \u0027GRUB2-EFI\u0027";
        var mkdocs_page_input_path = "issues/2016-10-19.1038.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rsync.html">External Backup using BACKUP=RSYNC method</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/duplicity.html">External Backup using duplicity</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1038 Issue closed: "rear mkrescue" fails with "BUG! Unknown bootloader" for 'GRUB2' and 'GRUB2-EFI'</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1038_issue_closed_rear_mkrescue_fails_with_bug_unknown_bootloader_for_grub2_and_grub2-efi"><a href="https://github.com/rear/rear/issues/1038">#1038 Issue</a> <code>closed</code>: "rear mkrescue" fails with "BUG! Unknown bootloader" for 'GRUB2' and 'GRUB2-EFI'<a class="headerlink" href="#1038_issue_closed_rear_mkrescue_fails_with_bug_unknown_bootloader_for_grub2_and_grub2-efi" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>bug</code>, <code>fixed / solved / done</code></p>
<h4 id="gsbit_opened_issue_at_2016-10-19_1124"><img src="https://avatars.githubusercontent.com/u/8384534?v=4" width="50"><a href="https://github.com/gsbit">gsbit</a> opened issue at <a href="https://github.com/rear/rear/issues/1038">2016-10-19 11:24</a>:<a class="headerlink" href="#gsbit_opened_issue_at_2016-10-19_1124" title="Permanent link">&para;</a></h4>
<ul>
<li>rear version (/usr/sbin/rear -V):<br />
    Relax-and-Recover 1.19 / Git</li>
<li>OS version (cat /etc/rear/os.conf or lsb_release -a):<br />
    OS_VENDOR=SUSE_LINUX<br />
    OS_VERSION=12</li>
<li>rear configuration files (cat /etc/rear/site.conf or cat
    /etc/rear/local.conf):</li>
</ul>
<!-- -->

<pre><code>OUTPUT=ISO
BACKUP=NBU
ISO_DIR=/usertmp
TIMESYNC=NTP
GRUB_RESCUE=n
PROGS=( "${PROGS[@]}" "/usr/sbin/vconfig" "/sbin/vconfig" "/sbin/arp" )
TMPDIR=/usertmp
</code></pre>
<ul>
<li>Brief description of the issue:<br />
    Starting rear mkrescue failed with the following error:</li>
</ul>
<!-- -->

<pre><code>$ rear -v mkrescue
Relax-and-Recover 1.19 / Git
Using log file: /var/log/rear/rear-servername.log
Creating disk layout
ERROR: BUG BUG BUG!  Unknown bootloader (GRUB2) - ask for sponsoring to get this fixed 
Aborting due to an error, check /var/log/rear/rear-servername.log for details
Terminated
</code></pre>
<ul>
<li>Work-around, if any:<br />
    Change the following line in the file
    /usr/share/rear/layout/save/default/45_check_bootloader_files.sh</li>
</ul>
<!-- -->

<pre><code>OLD:
GRUB) CHECK_CONFIG_FILES=( ${CHECK_CONFIG_FILES[@]}  /etc/grub.cfg /etc/grub2.cfg /boot/grub2/grub2.cfg /boot/grub/grub.cfg )
NEW:
GRUB|GRUB2) CHECK_CONFIG_FILES=( ${CHECK_CONFIG_FILES[@]}  /etc/grub.cfg /etc/grub2.cfg /boot/grub2/grub2.cfg /boot/grub/grub.cfg )
</code></pre>
<p>Because the variable "myBOOTloader" in SLES 12 is "GRUB2":</p>
<pre><code>$ cat /var/lib/rear/recovery/bootloader 
GRUB2
</code></pre>
<p>After this change it works as expected.</p>
<h4 id="gozora_commented_at_2016-10-19_1156"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-254791284">2016-10-19 11:56</a>:<a class="headerlink" href="#gozora_commented_at_2016-10-19_1156" title="Permanent link">&para;</a></h4>
<p>@gsbit I'm just curious, because I have a feeling I've hit something
similar and forget to report it ...<br />
Can you please post here content of your /etc/sysconfig/bootloaer ?</p>
<p>@jsmeix In my case I had "EFI-GRUB or EFI-GRUB2" (or similar), which
resulted to message like this.<br />
I don't have currently access to this machine, I'll check it later
today.</p>
<h4 id="jsmeix_commented_at_2016-10-19_1213"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-254794490">2016-10-19 12:13</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-19_1213" title="Permanent link">&para;</a></h4>
<p>This is very unexpected because I had run rear<br />
many times on SLE12 systems.</p>
<p>@gsbit<br />
I need a debug log to understand what happens on your system.<br />
Please run "rear -d -D mkrescue" and provide the log file.</p>
<p>In particular I am interested what happens on your system while<br />
/usr/share/rear/prep/default/50_guess_bootloader.sh<br />
runs i.e. what happens on your system that results<br />
that myBOOTloader="GRUB2".</p>
<h4 id="jsmeix_commented_at_2016-10-19_1220"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-254796048">2016-10-19 12:20</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-19_1220" title="Permanent link">&para;</a></h4>
<p>In
<a href="https://github.com/rear/rear/pull/1039">https://github.com/rear/rear/pull/1039</a>
I did<br />
the fix as in
<a href="https://github.com/rear/rear/issues/1038#issue-183934943">https://github.com/rear/rear/issues/1038#issue-183934943</a></p>
<p>@gsbit<br />
nevertheless I like your debug log to understand what goes on.</p>
<h4 id="jsmeix_commented_at_2016-10-19_1322"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-254810538">2016-10-19 13:22</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-19_1322" title="Permanent link">&para;</a></h4>
<p>I can reproduce it.<br />
Some of the latest commits before 1.19 caused it.</p>
<p>It works for me with a bit older git clone with latest<br />
commit 6c31e79dc6a21b891ee644f3ffacd22761b698f9<br />
"Merge pull request #1009 from<br />
jsmeix/correct_misspelled_forms_to_Relax-and-Recover_issue1008"</p>
<p>If fails on the same machine with a git clone of current master.</p>
<p>That machine is SLES12-SP2 with</p>
<pre>
# egrep -v '^#|^$' /etc/sysconfig/bootloader 
LOADER_TYPE="grub2"
SECURE_BOOT="no"
TRUSTED_BOOT="no"
</pre>

<p>In both cases I get</p>
<pre>
# cat var/lib/rear/recovery/bootloader 
GRUB2
</pre>

<p>which indicates the fix in
<a href="https://github.com/rear/rear/pull/1039">https://github.com/rear/rear/pull/1039</a><br />
is actually needed but somehow that did not matter before<br />
the last few commits.</p>
<p>Investigating...</p>
<h4 id="jsmeix_commented_at_2016-10-19_1334"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-254813665">2016-10-19 13:34</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-19_1334" title="Permanent link">&para;</a></h4>
<p>Where it had worked I get in the "rear -d -D mkrescue" log</p>
<pre>
2016-10-19 15:15:30.863200265 Entering debugscripts mode via 'set -x'.
+ source /root/rear.old/usr/share/rear/prep/default/50_guess_bootloader.sh
++ [[ -f /etc/sysconfig/bootloader ]]
+++ cut -d= -f2
+++ sed -e 's/"//g'
+++ grep LOADER_TYPE /etc/sysconfig/bootloader
++ my_bootloader=grub2
++ [[ ! -z grub2 ]]
++ tr '[a-z]' '[A-Z]'
++ echo grub2
++ return
+ test 1
+ Debug 'Leaving debugscripts mode (back to previous bash flags and options settings).'
...
2016-10-19 15:15:31.719738548 Entering debugscripts mode via 'set -x'.
+ source /root/rear.old/usr/share/rear/layout/save/default/45_check_bootloader_files.sh
+++ cat /root/rear.old/var/lib/rear/recovery/bootloader
++ myBOOTloader=GRUB2
++ case $myBOOTloader in
+ test 1
+ Debug 'Leaving debugscripts mode (back to previous bash flags and options settings).'
</pre>

<p>In contrast where it does not work I get in the log:</p>
<pre>
2016-10-19 15:14:37.376125575 Entering debugscripts mode via 'set -x'.
+ source /root/rear/usr/share/rear/prep/default/50_guess_bootloader.sh
++ [[ -f /etc/sysconfig/bootloader ]]
+++ cut -d= -f2
+++ sed -e 's/"//g'
+++ grep LOADER_TYPE /etc/sysconfig/bootloader
++ my_bootloader=grub2
++ [[ ! -z grub2 ]]
++ echo grub2
++ tr '[a-z]' '[A-Z]'
++ return
+ test 1
+ Debug 'Leaving debugscripts mode (back to previous bash flags and options settings).'
...
2016-10-19 15:14:38.438816085 Entering debugscripts mode via 'set -x'.
+ source /root/rear/usr/share/rear/layout/save/default/45_check_bootloader_files.sh
+++ cat /root/rear/var/lib/rear/recovery/bootloader
++ myBOOTloader=GRUB2
++ case $myBOOTloader in
++ BugError 'Unknown bootloader (GRUB2) - ask for sponsoring to get this fixed'
</pre>

<p>Inspecting
usr/share/rear/layout/save/default/45_check_bootloader_files.sh<br />
where it works shows only</p>
<pre>
case $myBOOTloader in
    EFI)  CHECK_CONFIG_FILES=( ${CHECK_CONFIG_FILES[@]} /boot/efi/EFI/*/grub*.cfg )
        ;;
    GRUB) CHECK_CONFIG_FILES=( ${CHECK_CONFIG_FILES[@]}  /etc/grub.cfg /etc/grub2.cfg /boot/grub2/grub2.cfg /boot/grub/grub.cfg )
        ;;
    LILO) CHECK_CONFIG_FILES=( ${CHECK_CONFIG_FILES[@]} /etc/lilo.conf )
        ;;
    ELILO) CHECK_CONFIG_FILES=( ${CHECK_CONFIG_FILES[@]} /etc/elilo.conf )
        ;;
esac
</pre>

<p>i.e. there is not yet a BugError default case.</p>
<p>The BugError default case was added by @gdha in his<br />
commit d15591e65461dfa43df6b7dbf23015d8e5598648<br />
with that non-matching commit message:</p>
<pre>
    All license references are now pointing to the COPYING file (which is the gpl license v3.0).
    REAR should only reference to GPL v3.0 from now on - if otherwise seen, just report it back
    Related to issue #825
</pre>

<p>It seems that additional change (added BugError default case<br />
in 45_check_bootloader_files.sh) slipped somehow in<br />
by accident?</p>
<h4 id="jsmeix_commented_at_2016-10-19_1339"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-254815091">2016-10-19 13:39</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-19_1339" title="Permanent link">&para;</a></h4>
<p>Ha!<br />
That added BugError default case in 45_check_bootloader_files.sh<br />
already caused a regression on POWER based systems, see<br />
<a href="https://github.com/rear/rear/commit/d15591e65461dfa43df6b7dbf23015d8e5598648#commitcomment-19352224">https://github.com/rear/rear/commit/d15591e65461dfa43df6b7dbf23015d8e5598648#commitcomment-19352224</a><br />
which got fixed by<br />
<a href="https://github.com/rear/rear/commit/e8b7614829d534c44eeb918f49c8a00ef303b1d9">https://github.com/rear/rear/commit/e8b7614829d534c44eeb918f49c8a00ef303b1d9</a></p>
<h4 id="jsmeix_commented_at_2016-10-19_1350"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-254818174">2016-10-19 13:50</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-19_1350" title="Permanent link">&para;</a></h4>
<p>With
<a href="https://github.com/rear/rear/pull/1039">https://github.com/rear/rear/pull/1039</a><br />
merged, the issue is fixed.</p>
<p>@gsbit<br />
I do no longer need your debug log to understand what goes on.<br />
Many thanks for your issue report!</p>
<h4 id="jsmeix_commented_at_2016-10-19_1353"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-254819081">2016-10-19 13:53</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-19_1353" title="Permanent link">&para;</a></h4>
<p>Tested with newest rear master code<br />
(with
<a href="https://github.com/rear/rear/pull/1039">https://github.com/rear/rear/pull/1039</a>
merged)<br />
on that same SLE12 system as above<br />
and now it works again.</p>
<h4 id="gsbit_commented_at_2016-10-19_1422"><img src="https://avatars.githubusercontent.com/u/8384534?v=4" width="50"><a href="https://github.com/gsbit">gsbit</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-254827914">2016-10-19 14:22</a>:<a class="headerlink" href="#gsbit_commented_at_2016-10-19_1422" title="Permanent link">&para;</a></h4>
<p>Thank you for the quik fix!</p>
<h4 id="gdha_commented_at_2016-10-19_1447"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-254835556">2016-10-19 14:47</a>:<a class="headerlink" href="#gdha_commented_at_2016-10-19_1447" title="Permanent link">&para;</a></h4>
<p>@jsmeix sorry - I shouldn't have changed the
<code>45_check_bootloader_files.sh</code> while doing the LICENSE/COPYING batch
change, but I couldn't help it as it was stronger then me. A catch all
was too generic IMHO so a <code>BugError</code> was required to be sure we support
the bootloader found.</p>
<h4 id="gozora_commented_at_2016-10-19_1834"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-254901628">2016-10-19 18:34</a>:<a class="headerlink" href="#gozora_commented_at_2016-10-19_1834" title="Permanent link">&para;</a></h4>
<p>Hello @jsmeix<br />
As I've mentioned earlier today, my SLES12 SP1 with UEFI boot, ends up
with similar error:</p>
<pre><code>ERROR: BUG BUG BUG!  Unknown bootloader (GRUB2-EFI) - ask for sponsoring to get this fixed
</code></pre>
<p>This comes from:</p>
<pre><code>suse12:~ # grep LOADER_TYPE /etc/sysconfig/bootloader
LOADER_TYPE="grub2-efi"
</code></pre>
<p>Once I remove <em>/etc/sysconfig/bootloader</em>,
<em>/var/lib/rear/recovery/bootloader</em> contains <strong>EFI</strong> as a bootloader,
which is recognized by ReaR so all works fine.</p>
<h4 id="gdha_commented_at_2016-10-20_0659"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-255024918">2016-10-20 06:59</a>:<a class="headerlink" href="#gdha_commented_at_2016-10-20_0659" title="Permanent link">&para;</a></h4>
<p>I will re-open this issue for now to capture new cases</p>
<h4 id="jsmeix_commented_at_2016-10-20_0807"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-255037584">2016-10-20 08:07</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-20_0807" title="Permanent link">&para;</a></h4>
<p>@gozora<br />
could you do a pull request that adds support for 'GRUB2-EFI'.<br />
I guess it is as easy as
<a href="https://github.com/rear/rear/pull/1039">https://github.com/rear/rear/pull/1039</a><br />
but you can just test it so that I would prefer when you do it.<br />
Many thanks in advance!</p>
<h4 id="gdha_commented_at_2016-10-20_0809"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-255037897">2016-10-20 08:09</a>:<a class="headerlink" href="#gdha_commented_at_2016-10-20_0809" title="Permanent link">&para;</a></h4>
<p>@gozora you were saying that <em>/var/lib/rear/recovery/bootloader</em>
contains <strong>EFI</strong> as bootloader, right?<br />
I think we better keep the <code>LOADER_TYPE="grub2-efi"</code> as bootloader
identification, and adapt script <code>45_check_bootloader_files.sh</code> to
recognize it as a valid bootloader.</p>
<h4 id="jsmeix_commented_at_2016-10-20_0812"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-255038635">2016-10-20 08:12</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-20_0812" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
no worries!</p>
<p>SUSE's official RPM package for SLE12-SP2 customers<br />
is "rear118a" which does not contain those latest commits.<br />
Regarding "rear118a" for SLE12-SP2 see<br />
"rear / rear116 / rear1172a / rear118a" at<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>And SLE12 users that are no SUSE customers<br />
can get voluntary help here.</p>
<h4 id="gozora_commented_at_2016-10-20_0835"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-255043627">2016-10-20 08:35</a>:<a class="headerlink" href="#gozora_commented_at_2016-10-20_0835" title="Permanent link">&para;</a></h4>
<p>@gdha</p>
<blockquote>
<p>you were saying that /var/lib/rear/recovery/bootloader contains EFI as
bootloader, right?<br />
I think we better keep the LOADER_TYPE="grub2-efi" as bootloader
identification, and adapt script 45_check_bootloader_files.sh to
recognize it as a valid bootloader.</p>
</blockquote>
<p>/var/lib/rear/recovery/bootloader contains EFI <strong>only</strong> if I remove
/etc/sysconfig/bootloader prior starting rear mkrescue. This is however
very dirty workaround!<br />
If I used default SLES11 SP1 configuration
/var/lib/rear/recovery/bootloader contains GRUB2-EFI, which is not
recognized by ReaR.<br />
I guess there is some code that first checks for existence of
sysconfig/bootloader and if not found, it tries to guess bootloader by
him self.</p>
<h4 id="gozora_commented_at_2016-10-20_0837"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-255044129">2016-10-20 08:37</a>:<a class="headerlink" href="#gozora_commented_at_2016-10-20_0837" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<blockquote>
<p>could you do a pull request that adds support for 'GRUB2-EFI'.</p>
</blockquote>
<p>Certainly, I'll check the code later today.</p>
<h4 id="gozora_commented_at_2016-10-20_0911"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-255051933">2016-10-20 09:11</a>:<a class="headerlink" href="#gozora_commented_at_2016-10-20_0911" title="Permanent link">&para;</a></h4>
<p>hmm, According comments in my <em>/etc/sysconfig/bootloader</em>, <code>LOADER_TYPE</code>
can be one of following:</p>
<ul>
<li>grub</li>
<li>grub2</li>
<li>grub2-efi</li>
<li>none</li>
</ul>
<p>Guess which option did I try as next :-). Correct, <strong>none</strong>.</p>
<p>And I have even more interesting result in
<em>/var/lib/rear/recovery/bootloader</em>.</p>
<pre><code>sles12:~ # cat /var/lib/rear/recovery/bootloader
GRUB2-EFI
NONE
</code></pre>
<p>which resulted again to:</p>
<pre><code>sles12:~ # rear mkbackuponly
ERROR: BUG BUG BUG!  Unknown bootloader (GRUB2-EFI
NONE) - ask for sponsoring to get this fixed 
=== Issue report ===
Please report this unexpected issue at: https://github.com/rear/rear/issues
Also include the relevant bits from /var/log/rear/rear-sles12.log

HINT: If you can reproduce the issue, try using the -d or -D option !
====================
Aborting due to an error, check /var/log/rear/rear-sles12.log for details
Terminated
</code></pre>
<h4 id="gozora_commented_at_2016-10-20_0914"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-255052653">2016-10-20 09:14</a>:<a class="headerlink" href="#gozora_commented_at_2016-10-20_0914" title="Permanent link">&para;</a></h4>
<p>And one more. having content of <em>/etc/sysconfig/bootloader</em> like:</p>
<pre><code>sles12:~ # grep LOADER_TYPE /etc/sysconfig/bootloader
#LOADER_TYPE="Vladimir"
#LOADER_TYPE="gozora"
#LOADER_TYPE="none"
LOADER_TYPE="none"
</code></pre>
<p>I get:</p>
<pre><code>sles12:~ # cat /var/lib/rear/recovery/bootloader
VLADIMIR
GOZORA
NONE
NONE
</code></pre>
<h4 id="gdha_commented_at_2016-10-20_0931"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-255056501">2016-10-20 09:31</a>:<a class="headerlink" href="#gdha_commented_at_2016-10-20_0931" title="Permanent link">&para;</a></h4>
<p>@gozora Just fixed the issue with multiple <strong>LOADER_TYPE</strong> settings in
<code>/etc/sysconfig/bootloader</code></p>
<h4 id="jsmeix_commented_at_2016-10-20_0947"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-255060430">2016-10-20 09:47</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-20_0947" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
because of @gozora findings I wonder if the current<br />
BugError default case in 45_check_bootloader_files.sh<br />
is really useful.</p>
<p>Perhaps the default case in 45_check_bootloader_files.sh<br />
should better be used as fallback to use GRUB2 and<br />
output a message to the user that GRUB2 is used<br />
as fallback bootloader?</p>
<p>The underlying basic question is if rear could use<br />
reasonable fallbacks when things are not clear<br />
or<br />
if rear should better always error out when things are<br />
not clear to always work strictly on the safe side?</p>
<p>Cf. "Try to care about possible errors" in<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a></p>
<h4 id="jsmeix_commented_at_2016-10-20_1222"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-255090476">2016-10-20 12:22</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-20_1222" title="Permanent link">&para;</a></h4>
<p>I like to even more fix the fix for the issue with multiple<br />
LOADER_TYPE settings in /etc/sysconfig/bootloader:<br />
<a href="https://github.com/rear/rear/pull/1042">https://github.com/rear/rear/pull/1042</a></p>
<h4 id="jsmeix_commented_at_2016-10-20_1336"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-255107663">2016-10-20 13:36</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-20_1336" title="Permanent link">&para;</a></h4>
<p>Only FYI:<br />
I did some further cosmetic improvements<br />
for 45_check_bootloader_files.sh via<br />
<a href="https://github.com/rear/rear/commit/f1bc3b5730d99545fa4d60bcf277bee484262ac6">https://github.com/rear/rear/commit/f1bc3b5730d99545fa4d60bcf277bee484262ac6</a><br />
and<br />
<a href="https://github.com/rear/rear/commit/15bb61e4fc68c4edf2efd5d30187a24f36574071">https://github.com/rear/rear/commit/15bb61e4fc68c4edf2efd5d30187a24f36574071</a></p>
<h4 id="jsmeix_commented_at_2016-11-24_1755"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1038#issuecomment-262825597">2016-11-24 17:55</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-11-24_1755" title="Permanent link">&para;</a></h4>
<p>The issue is marked as "fixed"<br />
so that I asssume it can be closed.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-10-19.1038.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
