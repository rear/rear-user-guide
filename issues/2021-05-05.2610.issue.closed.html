<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2610 Issue closed: Automounted NFS filesystems will cause rear to hang if NFS server fails - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2610 Issue closed: Automounted NFS filesystems will cause rear to hang if NFS server fails";
        var mkdocs_page_input_path = "issues/2021-05-05.2610.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2610 Issue closed: Automounted NFS filesystems will cause rear to hang if NFS server fails</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2610_issue_closed_automounted_nfs_filesystems_will_cause_rear_to_hang_if_nfs_server_fails"><a href="https://github.com/rear/rear/issues/2610">#2610 Issue</a> <code>closed</code>: Automounted NFS filesystems will cause rear to hang if NFS server fails<a class="headerlink" href="#2610_issue_closed_automounted_nfs_filesystems_will_cause_rear_to_hang_if_nfs_server_fails" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>fixed / solved / done</code></p>
<h4 id="hicksdc_opened_issue_at_2021-05-05_1850"><img src="https://avatars.githubusercontent.com/u/64791558?v=4" width="50"><a href="https://github.com/hicksdc">hicksdc</a> opened issue at <a href="https://github.com/rear/rear/issues/2610">2021-05-05 18:50</a>:<a class="headerlink" href="#hicksdc_opened_issue_at_2021-05-05_1850" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"): 2.6-git.4317.be8b6ed.master /
    2021-04-21</p>
</li>
<li>
<p>OS version ("cat /etc/os-release" or "lsb_release -a" or "cat
    /etc/rear/os.conf"):</p>
</li>
</ul>
<!-- -->

<pre><code>NAME="Red Hat Enterprise Linux Server"
VERSION="7.9 (Maipo)"
...
</code></pre>
<ul>
<li>
<p>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"): (unchanged)</p>
</li>
<li>
<p>Hardware (PC or PowerNV BareMetal or ARM) or virtual machine (KVM
    guest or PoverVM LPAR): PC</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device): x86_64</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot): BIOS</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe): local SSD</p>
</li>
<li>
<p>Storage layout ("lsblk -ipo
    NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT" or "lsblk" as
    makeshift):</p>
</li>
</ul>
<!-- -->

<pre><code>sda             8:0    0  20G  0 disk
├─sda1          8:1    0   1G  0 part /boot
└─sda2          8:2    0  19G  0 part
  ├─rhel-root 253:0    0  18G  0 lvm  /
  └─rhel-swap 253:1    0   1G  0 lvm  [SWAP]
</code></pre>
<ul>
<li>Description of the issue (ideally so that others can reproduce
    it):<br />
    Automounted NFS filesystems will cause rear process to hang
    indefinitely if the NFS server becomes unavailable while mount point
    still exists. The problem appears to be due to
    rear/prep/default/400_save_directories.sh collecting info about
    mount points that are owned by the automounter, which in my opinion
    is unnecessary (automount daemon creates these mount points, so why
    include them in a backup?).</li>
</ul>
<p>For example:</p>
<pre><code># mount | grep /apps/unixengdev
uxengnas1:/export/unixengdev on /apps/unixengdev type nfs4 (rw,relatime,vers=4.1,rsize=1048576,wsize=1048576,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=10.0.2.15,local_lock=none,addr=28.97.76.59)
</code></pre>
<p>Walking through the 400_save_directories.sh code manually:</p>
<pre><code># USB_DEVICE_FILESYSTEM_LABEL='REAR-000'
# BUILD_DIR=/tmp/foo
# excluded_fs_types="anon_inodefs|autofs|bdev|cgroup|cgroup2|configfs|cpuset|debugfs|devfs|devpts|devtmpfs|dlmfs|efivarfs|fuse.gvfs-fuse-daemon|fusectl|hugetlbfs|mqueue|nfsd|none|nsfs|overlay|pipefs|proc|pstore|ramfs|rootfs|rpc_pipefs|securityfs|sockfs|spufs|sysfs|tmpfs"
# excluded_other_stuff="/sys/|$BUILD_DIR|$USB_DEVICE_FILESYSTEM_LABEL"
# mountpoints="$( mount | grep -vE "type ($excluded_fs_types) |$excluded_other_stuff" | awk '{print $3}' )"
# echo $mountpoints
/ /boot /vagrant /vagrant /home/vagrant/workspace /apps/unixengdev
</code></pre>
<p>If uxengnas1 NFS server has actually failed at this point, the
subsequent <code>stat ...</code> loop waits indefinitely for the NFS server to
respond.</p>
<ul>
<li>Workaround, if any:<br />
    In my opinion, better behaviour would be for the script to exclude
    mount points managed by the automounter, which isn't all that
    difficult to achieve because automount creates an <code>autofs</code> mount
    table entry for the parent of all of its potential mount points, eg.
    for the /apps/unixengdev example above there is an entry for /apps:</li>
</ul>
<!-- -->

<pre><code># mount | grep /apps
/etc/auto.apps on /apps type autofs (rw,relatime,fd=17,pgrp=1082,timeout=300,minproto=5,maxproto=5,indirect,pipe_ino=29508)
uxengnas1:/export/unixengdev on /apps/unixengdev type nfs4 (rw,relatime,vers=4.1,rsize=1048576,wsize=1048576,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=10.0.2.15,local_lock=none,addr=28.97.76.59)
</code></pre>
<p>So we can exclude all mount points that are direct descendants of all
autofs parents, eg. like this:</p>
<pre><code>local excluded_automounts=$(mount |awk '
  $5 == "autofs" { i++; mp[i]=$3 }
  END {
    if (i &gt; 0) {
      line="^("mp[1]
      for (j=2;j&lt;=i;j++) {line=line"|"mp[j]}
      print line")(/|$)"
    } else {
      print " "
    }
  }')
local mountpoints=$( mount |awk -v x="$excluded_automounts" '$3 !~ x' | grep -vE "type ($excluded_fs_types) |$excluded_other_stuff" | awk '{print $3}' )
</code></pre>
<p>Repeating the above example:</p>
<pre><code># mount | grep /apps/unixengdev
uxengnas1:/export/unixengdev on /apps/unixengdev type nfs4 (rw,relatime,vers=4.1,rsize=1048576,wsize=1048576,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=10.0.2.15,local_lock=none,addr=28.97.76.59)
# mount | grep autofs
systemd-1 on /proc/sys/fs/binfmt_misc type autofs (rw,relatime,fd=34,pgrp=1,timeout=0,minproto=5,maxproto=5,direct,pipe_ino=13393)
/etc/auto.misc on /misc type autofs (rw,relatime,fd=5,pgrp=1082,timeout=300,minproto=5,maxproto=5,indirect,pipe_ino=29495)
-hosts on /net type autofs (rw,relatime,fd=11,pgrp=1082,timeout=300,minproto=5,maxproto=5,indirect,pipe_ino=29504)
/etc/auto.apps on /apps type autofs (rw,relatime,fd=17,pgrp=1082,timeout=300,minproto=5,maxproto=5,indirect,pipe_ino=29508)

# excluded_automounts=$(mount |awk '
&lt;snip&gt;
# echo $excluded_automounts
^(/proc/sys/fs/binfmt_misc|/misc|/net|/apps)(/|$)

# mountpoints=$( mount |awk -v x="$excluded_automounts" '$3 !~ x' | grep -vE "type ($excluded_fs_types) |$excluded_other_stuff" | awk '{print $3}' )
# echo $mountpoints
/ /boot /vagrant /vagrant /home/vagrant/workspace
</code></pre>
<ul>
<li>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files):</li>
</ul>
<h4 id="jsmeix_commented_at_2021-05-06_0911"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2610#issuecomment-833367538">2021-05-06 09:11</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-05-06_0911" title="Permanent link">&para;</a></h4>
<p>@hicksdc<br />
thank you for your issue report and your proposed solution!</p>
<p>I am not at all an autofs and/or NFS expert so I may misunderstand
things.</p>
<p>As far as I understand it the issue is that what <code>mount</code> shows as
<code>type autofs</code><br />
is already automatically excluded but not their descendants<br />
in particular not descendants that are mounted via NFS<br />
as in your example the NFS share<br />
<code>uxengnas1:/export/unixengdev on /apps/unixengdev type nfs4</code></p>
<p>I wonder if it isn't simpler and more straightforward to add<br />
what <code>mount</code> shows as <code>type nfs*</code> to the <code>excluded_fs_types</code> variable<br />
instead of some rather complicated <code>awk</code> scripting?</p>
<p>According to what <code>man 8 mount</code> shows on my oenSUSE Leap 15.2 system<br />
it seems the only <code>type nfs*</code> values are <code>type nfs</code> and <code>type nfs4</code>.</p>
<p>By the way:<br />
I wonder if also other network file system types like <code>cifs</code> <code>smbfs</code>
<code>ncpfs</code><br />
that are mentioned in <code>man 8 mount</code> should get excluded?</p>
<h4 id="hicksdc_commented_at_2021-05-06_0937"><img src="https://avatars.githubusercontent.com/u/64791558?v=4" width="50"><a href="https://github.com/hicksdc">hicksdc</a> commented at <a href="https://github.com/rear/rear/issues/2610#issuecomment-833386130">2021-05-06 09:37</a>:<a class="headerlink" href="#hicksdc_commented_at_2021-05-06_0937" title="Permanent link">&para;</a></h4>
<p>Thanks for the quick response @jsmeix !</p>
<p>I did also think about excluding all <code>nfs*</code> mounts as a simpler
approach, but assumed that would be unpopular because it would also
exclude those mounts that are not being managed by automount, eg. an
explicit /etc/fstab entry for a permanent NFS filesystem, for which I
assume you would want to include the mount point stat in the backup?
(Perhaps this comes down to a misunderstanding on my part of the purpose
of this particular script, which is that it is simply attempting to
capture details of all mount points that would need to be recreated when
restoring the system...?)</p>
<p>The awk solution was just meant to show a working example really, I
agree that its not pretty and am certain there is a far cleaner way (I'm
no developer! ;) ). But yes, as you say, the key point is that the
descendants of the <code>type autofs</code> entries should be excluded <em>regardless
of their type</em>, which leads on to your final point...</p>
<p>Other network filesystems could presumably cause a similar problem, but
I think they should simply be subject to the same logic as I've just
discussed - if their mount points are permanent and not being managed
separately by a service eg. automount, then details of those mount
points should be included in the backup.</p>
<h4 id="jsmeix_commented_at_2021-05-07_1050"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2610#issuecomment-834261934">2021-05-07 10:50</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-05-07_1050" title="Permanent link">&para;</a></h4>
<p>In general I prefer to let others who already did the work<br />
do it again for me instead of implementing it again from scratch<br />
so I think I would prefer to let <code>findmnt</code> show parent with its
descendants like</p>
<pre><code># findmnt -R -M $parent_mountpoint -n -o TARGET --raw
</code></pre>
<p>instead of a selfmade <code>awk</code> script.</p>
<p>@hicksdc<br />
does</p>
<pre><code># parent_mountpoint=/apps
# findmnt -R -M $parent_mountpoint -n -o TARGET --raw | tr -s '[:space:]' ' '
</code></pre>
<p>show the right parent with its descendant mountpoints in your case?</p>
<h4 id="jsmeix_commented_at_2021-05-07_1229"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2610#issuecomment-834332580">2021-05-07 12:29</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-05-07_1229" title="Permanent link">&para;</a></h4>
<p>I made a preliminary proposal that is not yet at all tested by me via<br />
<a href="https://github.com/rear/rear/pull/2613">https://github.com/rear/rear/pull/2613</a></p>
<p>@hicksdc<br />
could you test if my proposed code there works in your case?</p>
<p>FWIW:<br />
My implementation got more complicated than I had expected<br />
so it does not look much simpler than your <code>awk</code> scripting.</p>
<h4 id="jsmeix_commented_at_2021-05-07_1340"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2610#issuecomment-834401199">2021-05-07 13:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-05-07_1340" title="Permanent link">&para;</a></h4>
<p>I wonder if all that additional rather complicated code<br />
is worth the effort only to avoid that "rear mkrescue/mkbackup"<br />
does not hang up when a NFS server becomes unavailable<br />
while its NFS share mountpoint still exists?</p>
<p>I think any other program that tries to access that NFS share<br />
would also hang up - so I wonder why exceptional code in ReaR<br />
to avoid NFS issues outside of in ReaR?</p>
<p>I think only when it makes in general no sense to save and recreate<br />
any mountpoints below mountpoints of "type autofs"<br />
then such mountpoints should be excluded.</p>
<p>So the crucial question for me (I am not an autofs expert) is:<br />
Are any mountpoints below mountpoints of "type autofs"<br />
always owned by the automounter?<br />
Or in other words:<br />
Are all mountpoints below mountpoints of "type autofs"<br />
always created by the automount daemon?</p>
<h4 id="hicksdc_commented_at_2021-05-07_1803"><img src="https://avatars.githubusercontent.com/u/64791558?v=4" width="50"><a href="https://github.com/hicksdc">hicksdc</a> commented at <a href="https://github.com/rear/rear/issues/2610#issuecomment-834661041">2021-05-07 18:03</a>:<a class="headerlink" href="#hicksdc_commented_at_2021-05-07_1803" title="Permanent link">&para;</a></h4>
<blockquote>
<p>Are any mountpoints below mountpoints of "type autofs" always owned by
the automounter?</p>
</blockquote>
<p>Yes, or at least they exist on an ancestor mount point that definitely
<em>is</em> owned/created by the automounter, ie. it is possible to create a
submountpoint on an automounted mountpoint, but the fact that the
submountpoint is not local means it should be excluded from the backup.
For example:</p>
<pre><code># mount /dev/mapper/rootvg-crashvol /apps/unixengdev/path/to/mnt

# mount | grep /apps
auto.apps on /apps type autofs (rw,relatime,fd=5,pgrp=1909,timeout=300,minproto=5,maxproto=5,indirect,pipe_ino=28889)
uxengnas1:/export/unixengdev on /apps/unixengdev type nfs4 (rw,relatime,vers=4.1,rsize=1048576,wsize=1048576,namlen=255,hard,proto=tcp,port=0,timeo=600,retrans=2,sec=sys,clientaddr=28.97.72.19,local_lock=none,addr=28.97.76.59)
/dev/mapper/rootvg-crashvol on /apps/unixengdev/path/to/mnt type xfs (rw,relatime,seclabel,attr2,inode64,noquota)

# findmnt -RT /apps
TARGET                           SOURCE                       FSTYPE OPTIONS
/apps                            auto.apps                    autofs rw,relatime,fd=5,pgrp=1909,timeout=300,minproto=5,maxproto=5,indirect,pipe_ino=28889
└─/apps/unixengdev               uxengnas1:/export/unixengdev nfs4   rw,relatime,vers=4.1,rsize=1048576,wsize=1048576,namlen=255,hard,proto=tcp,port=0,timeo=600,retrans=2
  └─/apps/unixengdev/path/to/mnt /dev/mapper/rootvg-crashvol  xfs    rw,relatime,seclabel,attr2,inode64,noquota
</code></pre>
<p>.../apps/unixengdev/path/to/mnt was not created or mounted by automount
despite being below /apps, but from a backup point of view we're not
interested in it because the mountpoint is not a local file that would
need to be reproduced.</p>
<p>I have tested your <a href="https://github.com/rear/rear/pull/2613">PR 2613</a>
code (with my <code>findmnt -T</code> syntax suggestion) against this scenario and
it correctly excludes /apps/unixengdev/path/to/mnt.</p>
<p>So, going back to this discussion:</p>
<blockquote>
<p>I wonder if all that additional rather complicated code is worth the
effort only to avoid that "rear mkrescue/mkbackup" does not hang up
when a NFS server becomes unavailable while its NFS share mountpoint
still exists?</p>
</blockquote>
<p>The NFS failure scenario was just an example intended to add some
gravitas to the argument for excluding all autofs managed mountpoints,
which is what I hope we are now agreeing should be implemented by your
PR?</p>
<h4 id="jsmeix_commented_at_2021-05-11_0954"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2610#issuecomment-838186013">2021-05-11 09:54</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-05-11_0954" title="Permanent link">&para;</a></h4>
<p>@hicksdc<br />
thank you for your review, your test, your fix, and your explanation<br />
why it is right to exclude all mountpoints below mountpoints of "type
autofs".</p>
<h4 id="hicksdc_commented_at_2021-05-11_1227"><img src="https://avatars.githubusercontent.com/u/64791558?v=4" width="50"><a href="https://github.com/hicksdc">hicksdc</a> commented at <a href="https://github.com/rear/rear/issues/2610#issuecomment-838388203">2021-05-11 12:27</a>:<a class="headerlink" href="#hicksdc_commented_at_2021-05-11_1227" title="Permanent link">&para;</a></h4>
<p>No problem at all. Thank you for the rapid fix!</p>
<h4 id="jsmeix_commented_at_2021-05-12_1011"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2610#issuecomment-839650644">2021-05-12 10:11</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-05-12_1011" title="Permanent link">&para;</a></h4>
<p>With
<a href="https://github.com/rear/rear/pull/2613">https://github.com/rear/rear/pull/2613</a>
merged<br />
this issue should be fixed.</p>
<p>@hicksdc<br />
thank you in particular for your comprehensive descriptions<br />
and explanations that helped me so much to properly<br />
implement this improvement for ReaR.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2021-05-05.2610.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
