<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2543 Issue closed: Feature proposal: Prevent concurrent runs of OS sw package management tools and and ReaR - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2543 Issue closed: Feature proposal: Prevent concurrent runs of OS sw package management tools and and ReaR";
        var mkdocs_page_input_path = "issues/2020-12-12.2543.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2543 Issue closed: Feature proposal: Prevent concurrent runs of OS sw package management tools and and ReaR</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2543_issue_closed_feature_proposal_prevent_concurrent_runs_of_os_sw_package_management_tools_and_and_rear"><a href="https://github.com/rear/rear/issues/2543">#2543 Issue</a> <code>closed</code>: Feature proposal: Prevent concurrent runs of OS sw package management tools and and ReaR<a class="headerlink" href="#2543_issue_closed_feature_proposal_prevent_concurrent_runs_of_os_sw_package_management_tools_and_and_rear" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>needs sponsorship</code>, <code>external tool</code>,
<code>no-issue-activity</code></p>
<h4 id="jk-10_opened_issue_at_2020-12-12_2259"><img src="https://avatars.githubusercontent.com/u/61633779?v=4" width="50"><a href="https://github.com/jk-10">jk-10</a> opened issue at <a href="https://github.com/rear/rear/issues/2543">2020-12-12 22:59</a>:<a class="headerlink" href="#jk-10_opened_issue_at_2020-12-12_2259" title="Permanent link">&para;</a></h4>
<p>At least in Ubuntu security updates default setting is to download and
install updates automatically.<br />
If sw upgrade is running at the same time as ReaR is running, e.g during
mkbackup or mkrescue commands,<br />
the output of those commands can be inconsistent and might cause
failures during recovery.</p>
<p>Also if rear mkbackup or rear mkrescue commands are launched from cron,
it is possible that user accidentally runs package management tasks when
rear is running.</p>
<p>If the system is using LVM, consistent backups are possible with LVM
snapshots but not all systems are using LVM.</p>
<p>My proposal is that ReaR should be capable of preventing simultaneous
run with OS sw management tools.<br />
That means either blocking OS sw management tools (apt, yum, ...) while
rear is running or blocking rear until a running OS sw management tool
has finished.<br />
At least in Ubuntu this can be done by getting exclusive lock on file
/var/lib/dpkg/lock.</p>
<p>This capability could be configured with few new variables, e.g. like
this:</p>
<pre><code># If DISABLE_CONCURRENT_SW_MANAGEMENT="yes" then ReaR checks at startup whether sw package manager is running, 
# if sw package manager is running then ReaR waits until sw package manager has ended.
# If sw package manager is not running then ReaR acquires exclusive lock preventing sw package manager to start 
# and keeps the lock until end of ReaR operation.
# If DISABLE_CONCURRENT_SW_MANAGEMENT="no" then ReaR does not check sw package manager running status at all.
# Default setting DISABLE_CONCURRENT_SW_MANAGEMENT="no" is backward compatible
DISABLE_CONCURRENT_SW_MANAGEMENT="yes"

# TIME_LIMIT_WAIT_SW_MANAGEMENT: Number of seconds ReaR waits for the sw package manager to finish its job 
# if the sw package manager is running when ReaR is started.
# If the sw package manager is still running after time limit has elapsed, then ReaR aborts its operation and exits with error status.
# If TIME_LIMIT_WAIT_SW_MANAGEMENT=0 then wait for indefinitely.
# This setting has no effect if DISABLE_CONCURRENT_SW_MANAGEMENT="no"
TIME_LIMIT_WAIT_SW_MANAGEMENT=0
</code></pre>
<h4 id="gdha_commented_at_2021-01-08_1108"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2543#issuecomment-756697796">2021-01-08 11:08</a>:<a class="headerlink" href="#gdha_commented_at_2021-01-08_1108" title="Permanent link">&para;</a></h4>
<p>@jk-10 interesting idea and as you have given it a good though why not
write a PR yourself?</p>
<h4 id="jsmeix_commented_at_2021-02-22_1512"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2543#issuecomment-783443477">2021-02-22 15:12</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-02-22_1512" title="Permanent link">&para;</a></h4>
<p>@jk-10<br />
a precondition is reliable autodetection of all possible OS sw
management tools<br />
for all Linux distributions and all their various versions where ReaR is
supported.</p>
<p>In general ReaR is neither a backup software nor a backup management
software<br />
and it is not meant to be one, cf. the section<br />
"Relax-and-Recover versus backup and restore" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a><br />
that reads (excerpts):</p>
<pre><code>ReaR only calls an external tool that does the backup
of the files during "rear mkbackup" ...

It is your task to ensure your backup is consistent ...
E.g. you may have to stop certain running programs
(e.g. whatever services or things like that) that could
change files that get included in your backup
before your backup tool is run.
</code></pre>
<p>Another excerpt from<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<pre><code>What "consistent backup" means

Consistent backup means that all files in the backup
are consistent for the user. For example assume the
user is running an application program that changes
several files simultaneously (in the simplest case
think about the user is manually changing several
files simultaneously, e.g. 'root' or a setup tool may change
several config files). When that program is running during
files backup, the backup may contain old data in some files
and new data in other files which could be an inconsistent
state. Such inconsistencies could lead to errors in that
application after such an inconsistent backup was restored
or probably even worse the application blindly continues
to operate on inconsistent data which could make the
overall state more and more inconsistent over time until
at the very end all might be completely messed up.
</code></pre>
<p>I.e. there are zillions of other things that could result<br />
an inconsistent backup.</p>
<h4 id="github-actions_commented_at_2021-04-24_0229"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2543#issuecomment-826020603">2021-04-24 02:29</a>:<a class="headerlink" href="#github-actions_commented_at_2021-04-24_0229" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2020-12-12.2543.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
