<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2720 Issue closed: disk reformatting issue during BMR on linux 7.9 physical server - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2720 Issue closed: disk reformatting issue during BMR on linux 7.9 physical server";
        var mkdocs_page_input_path = "issues/2021-11-22.2720.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rsync.html">Internal Backup using BACKUP=RSYNC method</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2720 Issue closed: disk reformatting issue during BMR on linux 7.9 physical server</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2720_issue_closed_disk_reformatting_issue_during_bmr_on_linux_79_physical_server"><a href="https://github.com/rear/rear/issues/2720">#2720 Issue</a> <code>closed</code>: disk reformatting issue during BMR on linux 7.9 physical server<a class="headerlink" href="#2720_issue_closed_disk_reformatting_issue_during_bmr_on_linux_79_physical_server" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code>,
<code>external tool</code>, <code>not ReaR / invalid</code></p>
<h4 id="nmaheve_opened_issue_at_2021-11-22_1806"><img src="https://avatars.githubusercontent.com/u/89590205?v=4" width="50"><a href="https://github.com/nmaheve">nmaheve</a> opened issue at <a href="https://github.com/rear/rear/issues/2720">2021-11-22 18:06</a>:<a class="headerlink" href="#nmaheve_opened_issue_at_2021-11-22_1806" title="Permanent link">&para;</a></h4>
<p>we are facing issue while doing BMR recovery .</p>
<p>disk reformatting issue during the time of recovery , i have attached
the snapshot of same as well</p>
<p><img alt="error" src="https://user-images.githubusercontent.com/89590205/142912365-6aafca56-5563-40c8-8d32-ce39e70c38e9.png" /></p>
<p><img alt="errror1" src="https://user-images.githubusercontent.com/89590205/142912527-5135dc6f-ec23-4fe8-8d7e-a0a84d0da4e4.png" /></p>
<h4 id="jsmeix_commented_at_2021-11-23_0716"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-976216761">2021-11-23 07:16</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-11-23_0716" title="Permanent link">&para;</a></h4>
<p><a href="https://raw.githubusercontent.com/rear/rear/master/.github/ISSUE_TEMPLATE.md">https://raw.githubusercontent.com/rear/rear/master/.github/ISSUE_TEMPLATE.md</a></p>
<h4 id="nmaheve_commented_at_2021-11-23_1518"><img src="https://avatars.githubusercontent.com/u/89590205?v=4" width="50"><a href="https://github.com/nmaheve">nmaheve</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-976700104">2021-11-23 15:18</a>:<a class="headerlink" href="#nmaheve_commented_at_2021-11-23_1518" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"):</p>
</li>
<li>
<p>OS version ("cat /etc/os-release" or "lsb_release -a" or "cat
    /etc/rear/os.conf"): RHEL7.9</p>
</li>
<li>
<p>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):</p>
</li>
<li>
<p>Hardware vendor/product (PC or PowerNV BareMetal or ARM) or VM (KVM
    guest or PowerVM LPAR): BareMetal</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device): x86_64</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot): UEFI/grub2</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe):DM</p>
</li>
<li>
<p>Storage layout ("lsblk -ipo
    NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT"):</p>
</li>
<li>
<p>Description of the issue (ideally so that others can reproduce it):
    file system is not getting restored</p>
</li>
<li>
<p>Workaround, if any:</p>
</li>
<li>
<p>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files):</p>
</li>
</ul>
<h4 id="suraj952_commented_at_2021-11-29_1735"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-981859180">2021-11-29 17:35</a>:<a class="headerlink" href="#suraj952_commented_at_2021-11-29_1735" title="Permanent link">&para;</a></h4>
<p>Requested details have been sent out over the email as well. do we have
any update on this please.</p>
<h4 id="pcahyna_commented_at_2021-11-29_1744"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-981866185">2021-11-29 17:44</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-11-29_1744" title="Permanent link">&para;</a></h4>
<p>Can you please attach the log of the failing restore, and also the
disklayout.conf file (<code>/var/lib/rear/layout/disklayout.conf</code>)?</p>
<h4 id="pcahyna_commented_at_2021-11-29_1751"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-981871247">2021-11-29 17:51</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-11-29_1751" title="Permanent link">&para;</a></h4>
<p>and do you restore to the same or identical hardware as was the original
system, or is the hardware different? I am especially interested in your
disk sizes, are they same as on the original hardware?</p>
<h4 id="suraj952_commented_at_2021-11-29_1807"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-981883971">2021-11-29 18:07</a>:<a class="headerlink" href="#suraj952_commented_at_2021-11-29_1807" title="Permanent link">&para;</a></h4>
<p>We are trying to recover data on same machine. so there is no hardware
mismatch issue should be occur and the logs we have already provided
what we have handy and currently server is crashed.</p>
<h4 id="pcahyna_commented_at_2021-11-29_1815"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-981890616">2021-11-29 18:15</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-11-29_1815" title="Permanent link">&para;</a></h4>
<p>@suraj952 I am interested in the log file offered in entry 2 on the last
screen (/var/log/rear/rear-test <em>something</em> .log).
<code>/var/lib/rear/layout/disklayout.conf</code> is also present in the rescue
system. The script <code>/var/lib/rear/layout/diskrestore.sh</code> would also be
interesting to have. Please fetch them from the rescue system (it should
be possible to ssh/sftp to it, if the network is configured) and attach
them here.</p>
<h4 id="pcahyna_commented_at_2021-11-29_1824"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-981897713">2021-11-29 18:24</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-11-29_1824" title="Permanent link">&para;</a></h4>
<p>oh and please try to rerun recover with the <code>-D</code> parameter
(<code>rear -D recover</code>) and attach also a log file from this attempt, it
will contain much more detail.</p>
<h4 id="suraj952_commented_at_2021-11-30_1523"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-982739424">2021-11-30 15:23</a>:<a class="headerlink" href="#suraj952_commented_at_2021-11-30_1523" title="Permanent link">&para;</a></h4>
<p>Hi Team,</p>
<p>Please find the attached log files which were requested to debug the
issue.</p>
<h4 id="pcahyna_commented_at_2021-11-30_1541"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-982757675">2021-11-30 15:41</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-11-30_1541" title="Permanent link">&para;</a></h4>
<p>Hello Suraj, I don't see any files here. I think you should reply using
the web interface instead of e-mail. In the web interface there is a bar
titled "Attach files by dragging &amp; dropping, selecting or pasting them."
just below the text comment box. Click on it and upload your files.</p>
<h4 id="suraj952_commented_at_2021-11-30_1550"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-982766334">2021-11-30 15:50</a>:<a class="headerlink" href="#suraj952_commented_at_2021-11-30_1550" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/rear/rear/files/7626963/rear-testl07dc.log">rear-testl07dc.log</a></p>
<p><a href="https://github.com/rear/rear/files/7626999/BMR.log.file.zip">BMR log
file.zip</a></p>
<p>PFA the requested log files in zipped folder.<br />
.</p>
<h4 id="suraj952_commented_at_2021-11-30_1552"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-982767604">2021-11-30 15:52</a>:<a class="headerlink" href="#suraj952_commented_at_2021-11-30_1552" title="Permanent link">&para;</a></h4>
<p>Hi,</p>
<p>All the three files have been attached in zipped folder.</p>
<p>Regards,</p>
<p>Suraj Rawat | Storage Services<br />
Office: +1(408) 722-9387 Extn 0 | Cell: +91-8742939172</p>
<h4 id="pcahyna_commented_at_2021-11-30_1609"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-982783917">2021-11-30 16:09</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-11-30_1609" title="Permanent link">&para;</a></h4>
<p>Thanks, from the log I see that the problem most likely is "A volume
group called rhel already exists." and is due to restoring to the disks
with your original system, so the original volume group is still there.
I can suggest wiping the old data first using <code>wipefs</code>, as mentioned in
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1919989#c5">https://bugzilla.redhat.com/show_bug.cgi?id=1919989#c5</a>.
(that is, you boot the rescue system, and first you wipe data the old
disks and only then you start <code>rear recover</code>. Or, you can restore to
clean disks, if you have some spare disks with the same size as the
original disks, and keep the old disks as backup.)</p>
<p>I also suggest to edit <code>/etc/rear/local.conf</code> in the rescue system and
add the line <code>MIGRATION_MODE=n</code>. It can be seen from your screenshots
that due to the presence of two disks of the same size, ReaR has
switched to the so-called migration mode, which is usually used for
migrating to a different hardware, and the restoration of LVM is then
less faithful. As you are restoring to the same hardware, you don't need
migration mode.</p>
<h4 id="suraj952_commented_at_2021-11-30_1646"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-982818435">2021-11-30 16:46</a>:<a class="headerlink" href="#suraj952_commented_at_2021-11-30_1646" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/rear/rear/files/7627318/latest-log-after_wipefs.zip">latest-log-after_wipefs.zip</a></p>
<p>We have wiped out the data in same way as given in Bugzilla link and did
“rear recover” But still no luck.</p>
<p>Please find the latest logs for the same and let me know if you have any
question related to this issue.</p>
<h4 id="pcahyna_commented_at_2021-11-30_1655"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-982827160">2021-11-30 16:55</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-11-30_1655" title="Permanent link">&para;</a></h4>
<p>Now the layout recreation succeeds and your problem seems to be</p>
<pre><code>Including restore/REQUESTRESTORE/default/200_prompt_user_to_start_restore.sh
2021-11-30 11:30:52.689499158 Please start the restore process on your backup host.

Make sure that you restore the data into /mnt/local (by default '/mnt/local')
instead of '/' because the hard disks of the recovered system are mounted there.

2021-11-30 11:30:52.733135532 Please restore your backup in the provided shell and, when finished, type exit
in the shell to continue recovery.
</code></pre>
<p>Have you restored your backup to the recreated filesystems? It seems
that you have not and your filesystems are empty. What backup software
are you using (what is the value of the <code>BACKUP</code> configuration
variable)?</p>
<h4 id="suraj952_commented_at_2021-11-30_1801"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-982883723">2021-11-30 18:01</a>:<a class="headerlink" href="#suraj952_commented_at_2021-11-30_1801" title="Permanent link">&para;</a></h4>
<p>We are using Rubrik backup software.</p>
<h4 id="suraj952_commented_at_2021-11-30_1940"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-982958161">2021-11-30 19:40</a>:<a class="headerlink" href="#suraj952_commented_at_2021-11-30_1940" title="Permanent link">&para;</a></h4>
<p>yes we have tried to restore backup by running “rear recover” and but
there was issue related to ownership of filesystem. I believe, that
error can be found in log files which we had shared earlier.</p>
<h4 id="damanin_commented_at_2021-11-30_2028"><img src="https://avatars.githubusercontent.com/u/37876601?u=832a55ad26fa192d411932dcf7a9f13187d79380&v=4" width="50"><a href="https://github.com/DamaniN">DamaniN</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-982994017">2021-11-30 20:28</a>:<a class="headerlink" href="#damanin_commented_at_2021-11-30_2028" title="Permanent link">&para;</a></h4>
<p>@suraj952 and @nmaheve, <code>rear recover</code> only prepares the system for data
recovery. You then have to go back to Rubrik and recover the actual
data. The Rubrik agent should now be running on the rescue system, and
you should be able to access it from Rubrik. Remember that when you
recover the actual data from Rubrik to redirect the recover to
<code>/mnt/local</code> instead of <code>/</code>.</p>
<p>See <a href="https://github.com/rear/rear/blob/master/doc/user-guide/16-Rubrik-CDM.adoc">Chapter
16</a>
of the ReaR user guide for more details. You should be around step 11
now.</p>
<h4 id="pcahyna_commented_at_2021-12-01_0916"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-983441577">2021-12-01 09:16</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-12-01_0916" title="Permanent link">&para;</a></h4>
<p>@suraj952 note that Rubrik CDM support was added to ReaR in version 2.6
by @DamaniN in PR #2249, but according to the logs and screenshot, you
are using ReaR 2.4, so you must restore the data manually (not sure how,
I have never used Rubrik CDM).<br />
Concerning</p>
<blockquote>
<p>there was issue related to ownership of filesystem. I believe, that
error can be found in log files</p>
</blockquote>
<p>-if you mean these lines:</p>
<pre><code>2021-11-30 11:31:42.229193058 Recreating directories (with permissions) from /var/lib/rear/recovery/directories_permissions_owner_group
'bin' -&gt; 'usr/bin'
mkdir: created directory 'etc'
mode of 'etc' retained as 0755 (rwxr-xr-x)
chroot: failed to run command '/bin/bash': No such file or directory
2021-11-30 11:31:42.256494605 Failed to 'chown root:root etc'
</code></pre>
<p>then this is not an "issue related to ownership of filesystem", but the
fact that the recreated system is empty, there has been no backup
restored to the reformatted disks. I see this in the log earlier:</p>
<pre><code>Please start the restore process on your backup host.

Make sure that you restore the data into /mnt/local (by default '/mnt/local')
instead of '/' because the hard disks of the recovered system are mounted there.

2021-11-30 11:30:52.733135532 Please restore your backup in the provided shell and, when finished, type exit
in the shell to continue recovery.
</code></pre>
<p>Have you started the restore process when prompted? I suppose this
prompt was shown on the screen as well.</p>
<p>(Anyway, this issue has digressed from the original disk reformatting
issue, which is a known problem when using disks with prior data, and I
believe it is solved already in the development version. For older
versions, wiping the disks manually is an easy workaround, as shown by
your latest log, which records that the disks were reformatted just
fine.)</p>
<h4 id="suraj952_commented_at_2021-12-01_1028"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-983501425">2021-12-01 10:28</a>:<a class="headerlink" href="#suraj952_commented_at_2021-12-01_1028" title="Permanent link">&para;</a></h4>
<p>@pcahyna and @DamaniN Currently server is crashed and as we have ran
Wipe on the system so i think backup services also get wiped from the
host and Rubrik CDM is also not able to communicate with the Host as RBS
status showing disconnected. Can you please share POA per our current
scenario.</p>
<h4 id="pcahyna_commented_at_2021-12-01_1427"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-983694816">2021-12-01 14:27</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-12-01_1427" title="Permanent link">&para;</a></h4>
<p>Sure, everything gets wiped from the host, simply because ReaR reformats
all the disks, as the title of the issue ("disk reformatting issue")
shows. You need to have the software needed for backup restoration in
the rescue system. You haven't added the Rubrik CDM client there when
creating the rescue media (ISO or USB)? If not, I suppose it will be
posible to copy it to the rescue system from somewhere else and thus
resolve your problem, but I can't help you with this, I know nothing
about CDM. By the way, can you paste your <code>/etc/rear/local.conf</code> file
here?</p>
<h4 id="suraj952_commented_at_2021-12-01_1458"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-983723920">2021-12-01 14:58</a>:<a class="headerlink" href="#suraj952_commented_at_2021-12-01_1458" title="Permanent link">&para;</a></h4>
<p>we are not sure about adding the Rubrik CDM client there when creating
the rescue media (ISO or USB) but yes we are trying to install Rubrik
CDM services on rescue system at the moment and will share you the
/etc/rear/local.conf soon.</p>
<h4 id="suraj952_commented_at_2021-12-01_1533"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-983758932">2021-12-01 15:33</a>:<a class="headerlink" href="#suraj952_commented_at_2021-12-01_1533" title="Permanent link">&para;</a></h4>
<p>Hi,</p>
<p>Please see the output below of /etc/rear/local.conf file here.</p>
<p>***@***.***</p>
<p>Regards,</p>
<p>Suraj Rawat | Storage Services<br />
Office: +1(408) 722-9387 Extn 0 | Cell: +91-8742939172</p>
<h4 id="suraj952_commented_at_2021-12-01_1613"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-983799222">2021-12-01 16:13</a>:<a class="headerlink" href="#suraj952_commented_at_2021-12-01_1613" title="Permanent link">&para;</a></h4>
<p>Is it possible if you can join us on virtual session. our linux team can
able to see the file system and you were saying that file syste m is
empty so that would be great help if we can work together on the VR.</p>
<h4 id="damanin_commented_at_2021-12-01_1630"><img src="https://avatars.githubusercontent.com/u/37876601?u=832a55ad26fa192d411932dcf7a9f13187d79380&v=4" width="50"><a href="https://github.com/DamaniN">DamaniN</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-983814120">2021-12-01 16:30</a>:<a class="headerlink" href="#damanin_commented_at_2021-12-01_1630" title="Permanent link">&para;</a></h4>
<p>@suraj952, If you have re-installed the Rubrik CDM agent on the rescue
system, you can register the rescue system with your Rubrik server.
Assuming that you backed up the server in the past, you will be able to
recover the data to it. The rescue system will be registered as a new
host, so you will need to perform a redirected recovery of the data. If
you need help with registration and restoring the data from Rubrik at
this point, please contact Rubrik support.</p>
<p>You may run into a conflict where Rubrik thinks that the rescue system
is the original system because it has the same IP address. Normally, the
CDM integration with ReaR takes care of this. Since the proper version
of ReaR wasn't used, this conflict will have to be taken care of
manually. Rubrik Support can help with that.</p>
<p>As listed in the link I provided above, be sure to recover the data in
<code>/</code> to <code>/mnt/local</code>. After the data recovery, be sure to exit the ReaR
shell prompt and answer the last question. This will allow ReaR to
finalize the rescue, and you will be able to reboot the rescue host
properly.</p>
<h4 id="gdha_commented_at_2021-12-01_1632"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-983816354">2021-12-01 16:32</a>:<a class="headerlink" href="#gdha_commented_at_2021-12-01_1632" title="Permanent link">&para;</a></h4>
<p>@DamaniN Thank you for your wise words.</p>
<h4 id="suraj952_commented_at_2021-12-01_1642"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-983824970">2021-12-01 16:42</a>:<a class="headerlink" href="#suraj952_commented_at_2021-12-01_1642" title="Permanent link">&para;</a></h4>
<p>No @DaminiN we are not able to install rubrik services into server as
server got crashed when we tried to perform recovery from ISO backed up
file. We tried to install Rubrik backup agent in crashed server but it's
not working.</p>
<p>So if you guys can help over the virtual remote session that would be
great. Also see the below snapshot and let us know what next step we
need to perform from here.</p>
<p>***@***.***</p>
<p>Regards,</p>
<p>Suraj Rawat | Storage Services<br />
Office: +1(408) 722-9387 Extn 0 | Cell: +91-8742939172<br />
Email: ***@***.******@***.***&gt; | Web:
<a href="http://www.aarp.org">http://www.aarp.org</a><a href="http://www.aarp.org/">http://www.aarp.org/</a><br />
***@***.***</p>
<p>From: Damani ***@***.***&gt;<br />
Sent: Wednesday, December 1, 2021 10:01 PM<br />
To: rear/rear ***@***.***&gt;<br />
Cc: Rawat, Suraj (TMP) ***@***.***&gt;; Mention
***@***.***&gt;<br />
Subject: Re: [rear/rear] disk reformatting issue during BMR on linux
7.9 physical server (Issue #2720)</p>
<p>@suraj952<a href="https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fsuraj952&amp;data=04%7C01%7Csrawat%40aarp.org%7Ce2727ec02b1f4a60e65708d9b4e7f214%7Ca395e38b4b754e4493499a37de460a33%7C0%7C0%7C637739730555715255%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=qZ%2BIGY7JZ2Q51A1GIc9fHN%2Fq2v6P9q%2BROoW7wlcDfc8%3D&amp;reserved=0">https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fsuraj952&amp;data=04%7C01%7Csrawat%40aarp.org%7Ce2727ec02b1f4a60e65708d9b4e7f214%7Ca395e38b4b754e4493499a37de460a33%7C0%7C0%7C637739730555715255%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=qZ%2BIGY7JZ2Q51A1GIc9fHN%2Fq2v6P9q%2BROoW7wlcDfc8%3D&amp;reserved=0</a>,
If you have re-installed the Rubrik CDM agent on the rescue system, you
can register the rescue system with your Rubrik server. Assuming that
you backed up the server in the past, you will be able to recover the
data to it. The rescue system will be registered as a new host, so you
will need to perform a redirected recovery of the data. If you need help
with registration and restoring the data from Rubrik at this point,
please contact Rubrik support.</p>
<p>You may run into a conflict where Rubrik thinks that the rescue system
is the original system because it has the same IP address. Normally, the
CDM integration with ReaR takes care of this. Since the proper version
of ReaR wasn't used, this conflict will have to be taken care of
manually. Rubrik Support can help with that.</p>
<p>As listed in the link I provided above, be sure to recover the data in /
to /mnt/local. After the data recovery, be sure to exit the ReaR shell
prompt and answer the last question. This will allow ReaR to finalize
the rescue, and you will be able to reboot the rescue host properly.</p>
<ul>
<li></li>
</ul>
<p>You are receiving this because you were mentioned.<br />
Reply to this email directly, view it on
GitHub<a href="https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Frear%2Frear%2Fissues%2F2720%23issuecomment-983814120&amp;data=04%7C01%7Csrawat%40aarp.org%7Ce2727ec02b1f4a60e65708d9b4e7f214%7Ca395e38b4b754e4493499a37de460a33%7C0%7C0%7C637739730555725214%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=bjmR%2Fxhobdwy38%2BYZyRcfjxqI2XlBCnJCZrNu2CccEs%3D&amp;reserved=0">https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Frear%2Frear%2Fissues%2F2720%23issuecomment-983814120&amp;data=04%7C01%7Csrawat%40aarp.org%7Ce2727ec02b1f4a60e65708d9b4e7f214%7Ca395e38b4b754e4493499a37de460a33%7C0%7C0%7C637739730555725214%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=bjmR%2Fxhobdwy38%2BYZyRcfjxqI2XlBCnJCZrNu2CccEs%3D&amp;reserved=0</a>,
or
unsubscribe<a href="https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fnotifications%2Funsubscribe-auth%2FAWGV3USPQLSZWCW2DHZIANLUOZESRANCNFSM5IRUBLZA&amp;data=04%7C01%7Csrawat%40aarp.org%7Ce2727ec02b1f4a60e65708d9b4e7f214%7Ca395e38b4b754e4493499a37de460a33%7C0%7C0%7C637739730555725214%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=fkq4UH5E9o7UAV5M1090zg2vT6aTAgB%2B9I5TjByfAyk%3D&amp;reserved=0">https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fnotifications%2Funsubscribe-auth%2FAWGV3USPQLSZWCW2DHZIANLUOZESRANCNFSM5IRUBLZA&amp;data=04%7C01%7Csrawat%40aarp.org%7Ce2727ec02b1f4a60e65708d9b4e7f214%7Ca395e38b4b754e4493499a37de460a33%7C0%7C0%7C637739730555725214%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=fkq4UH5E9o7UAV5M1090zg2vT6aTAgB%2B9I5TjByfAyk%3D&amp;reserved=0</a>.<br />
Triage notifications on the go with GitHub Mobile for
iOS<a href="https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fapps.apple.com%2Fapp%2Fapple-store%2Fid1477376905%3Fct%3Dnotification-email%26mt%3D8%26pt%3D524675&amp;data=04%7C01%7Csrawat%40aarp.org%7Ce2727ec02b1f4a60e65708d9b4e7f214%7Ca395e38b4b754e4493499a37de460a33%7C0%7C0%7C637739730555735166%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=%2FEl3ClxsGRJfqS0EaNn39J3kIehP0kHYzE6xbIvf0mc%3D&amp;reserved=0">https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fapps.apple.com%2Fapp%2Fapple-store%2Fid1477376905%3Fct%3Dnotification-email%26mt%3D8%26pt%3D524675&amp;data=04%7C01%7Csrawat%40aarp.org%7Ce2727ec02b1f4a60e65708d9b4e7f214%7Ca395e38b4b754e4493499a37de460a33%7C0%7C0%7C637739730555735166%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=%2FEl3ClxsGRJfqS0EaNn39J3kIehP0kHYzE6xbIvf0mc%3D&amp;reserved=0</a>
or
Android<a href="https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.github.android%26referrer%3Dutm_campaign%253Dnotification-email%2526utm_medium%253Demail%2526utm_source%253Dgithub&amp;data=04%7C01%7Csrawat%40aarp.org%7Ce2727ec02b1f4a60e65708d9b4e7f214%7Ca395e38b4b754e4493499a37de460a33%7C0%7C0%7C637739730555735166%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=uFq3Cz5N626kKXChGK6%2BnNbC%2BvLDdvtWy5lWr3Ddw58%3D&amp;reserved=0">https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dcom.github.android%26referrer%3Dutm_campaign%253Dnotification-email%2526utm_medium%253Demail%2526utm_source%253Dgithub&amp;data=04%7C01%7Csrawat%40aarp.org%7Ce2727ec02b1f4a60e65708d9b4e7f214%7Ca395e38b4b754e4493499a37de460a33%7C0%7C0%7C637739730555735166%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=uFq3Cz5N626kKXChGK6%2BnNbC%2BvLDdvtWy5lWr3Ddw58%3D&amp;reserved=0</a>.</p>
<h4 id="damanin_commented_at_2021-12-01_1809"><img src="https://avatars.githubusercontent.com/u/37876601?u=832a55ad26fa192d411932dcf7a9f13187d79380&v=4" width="50"><a href="https://github.com/DamaniN">DamaniN</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-983925084">2021-12-01 18:09</a>:<a class="headerlink" href="#damanin_commented_at_2021-12-01_1809" title="Permanent link">&para;</a></h4>
<p>@suraj952, please create a case with Rubrik support for further help
with re-installing the Rubrik agent on the rescue host.</p>
<h4 id="suraj952_commented_at_2021-12-01_1822"><img src="https://avatars.githubusercontent.com/u/93150674?v=4" width="50"><a href="https://github.com/suraj952">suraj952</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-983935105">2021-12-01 18:22</a>:<a class="headerlink" href="#suraj952_commented_at_2021-12-01_1822" title="Permanent link">&para;</a></h4>
<p>@DamaniN per your suggestion, Case #00286029 have been opened with
Rubrik support for the same.</p>
<h4 id="pcahyna_commented_at_2021-12-02_1154"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-984558433">2021-12-02 11:54</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-12-02_1154" title="Permanent link">&para;</a></h4>
<p>@suraj952</p>
<blockquote>
<p>Hi, Please see the output below of /etc/rear/local.conf file here.
***@***.***</p>
</blockquote>
<p>I don't see anything unfortunately, I suggest to use the web interface.
Anyway, I hope that Rubrik support will be able to help you with CDM. I
have a suggestion for you and maybe the Rubrik support: instead of
trying to get the Rubrik client into the booted rescue system, wouldn't
it be better to restore the entire backup to a different server and then
copy the whole subdirectory to the <code>/mnt/local</code> directory at the rescue
system during the rescue process, when ReaR asks to restore files? This
could be done e.g. via rsync or via tar and ssh, something like
<code>tar cf - . | ssh root@crashed_system "cd /mnt/local; tar xpf -"</code> (of
course tar will need some more parameters to restore all the attributes
properly, but that's the general idea). @DamaniN what do you think?</p>
<h4 id="pcahyna_commented_at_2021-12-02_1346"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-984641916">2021-12-02 13:46</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-12-02_1346" title="Permanent link">&para;</a></h4>
<p>@DamaniN thanks a lot for looking into the issue.</p>
<h4 id="jsmeix_commented_at_2022-01-31_1120"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2720#issuecomment-1025633926">2022-01-31 11:20</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-01-31_1120" title="Permanent link">&para;</a></h4>
<p>I think this is meanwhile fixed or done outside of ReaR.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2021-11-22.2720.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
