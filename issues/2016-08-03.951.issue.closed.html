<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>2016 08 03.951.issue.closed - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "2016 08 03.951.issue.closed";
        var mkdocs_page_input_path = "issues/2016-08-03.951.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', '366986045', 'auto');
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>2016 08 03.951.issue.closed</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="951_issue_closed_on_dell_machines_with_biosdevname_there_is_no_support_for_that_in_rear_recover"><a href="https://github.com/rear/rear/issues/951">#951 Issue</a> <code>closed</code>: On Dell machines with "biosdevname" there is no support for that in "rear recover"<a class="headerlink" href="#951_issue_closed_on_dell_machines_with_biosdevname_there_is_no_support_for_that_in_rear_recover" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>needs sponsorship</code>, <code>special hardware or VM</code></p>
<h4 id="grendelson_opened_issue_at_2016-08-03_2048"><img src="https://avatars.githubusercontent.com/u/1943988?v=4" width="50"><a href="https://github.com/grendelson">grendelson</a> opened issue at <a href="https://github.com/rear/rear/issues/951">2016-08-03 20:48</a>:<a class="headerlink" href="#grendelson_opened_issue_at_2016-08-03_2048" title="Permanent link">&para;</a></h4>
<h1 id="relax-and-recover_rear_issue_template">Relax-and-Recover (rear) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h1>
<p>Please fill in the following items before submitting a new issue:</p>
<ul>
<li>rear version (/usr/sbin/rear -V): Relax-and-Recover 1.17.2 / Git</li>
<li>OS version (cat /etc/rear/os.conf or lsb_release -a):<br />
    OS_VENDOR=OracleServer<br />
    OS_VERSION=6</li>
<li>rear configuration files (cat /etc/rear/site.conf or cat
    /etc/rear/local.conf):</li>
</ul>
<pre>
  OUTPUT=ISO
  OUTPUT_URL=nfs://<nfsserver.server.com>/home/nfsexport
  BACKUP=NETFS
  BACKUP_URL=nfs://<nfsserver.server.com>/home/nfsexport
  TMPDIR=/data/backup/tmp
  BACKUP_PROG_EXCLUDE=( '/tmp/_' '/dev/shm/_' '/data/backup/_' $VAR_DIR/output/\_ )
</pre>

<ul>
<li>Brief description of the issue<br />
    When a rescue disk is used to start a restore OR a clone, the
    devices in our servers ( Dell R720's) under RHEL 6 ( Oracle 6) were
    captured as card slot and card port - so a card in slot 4 on the MB
    and port 2 will appear as ifcfg-p4p2. This p4p2 is not present or
    created when the Live CD is booted. the underlying eth devices are
    found but the backed up OS network devices nor any advanced settings
    ( bond0, vlans etc) are working since the expected devices aren't
    "present". During the backed up OS boot process dmesg shows that
    "eth3 was renamed p4p3" for example - this is NOT present in the
    live CD OS.<br />
    I've tried both NETFS and local backups, restores from NBU and from
    local full backups - the issue appears to be the ability to load and
    rename the ethernet devices to match what is expected when the
    network is brought up.</li>
<li>Work-around, if any</li>
<li>I've been able to use 'ip' and the tools in the Live Env to bring up
    the ethernet devices ( ethtool to find the active devices, enslave
    the devices to my bond and then add the vlan if bringing up a Clone
    with a different IP address). Manually running 'ifenslave' to
    capture ethernet devices or manually adding ip addresses and default
    gateways has worked so far and once a network is present the restore
    continues as expected and upon reboot the original OS works as
    expected.</li>
</ul>
<h4 id="gdha_commented_at_2016-08-05_1538"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-237884332">2016-08-05 15:38</a>:<a class="headerlink" href="#gdha_commented_at_2016-08-05_1538" title="Permanent link">&para;</a></h4>
<p><strong>Note</strong>: This problem also occurs on SLES 11 SP3 with SAP HANA, The
problem has to do with the usage of <em>biosdevnames</em> instead the normal
aliases (like eth). As it also involves SLES I'll add @jsmeix to the
assignees. I remember, I did some research a few months ago (when HPe
did some SAP HANA test restores for one of their customers ; I asked
them to find out how it worked but never got a reply ; so it was
silently dropped) - next week I'll drop my notes into this issue for
further investigation...</p>
<h4 id="gdha_commented_at_2016-08-08_0752"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-238165367">2016-08-08 07:52</a>:<a class="headerlink" href="#gdha_commented_at_2016-08-08_0752" title="Permanent link">&para;</a></h4>
<p>These were the notes I talked about before (not much I must admit):</p>
<pre><code>RHEL 6:

-bash-4.1$ pwd
/usr/share/dracut/modules.d/97biosdevname
-bash-4.1$ more install
# -*- mode: shell-script; indent-tabs-mode: nil; sh-basic-offset: 4; -*-
# ex: ts=8 sw=4 sts=4 et filetype=sh
dracut_install biosdevname
inst_rules 71-biosdevname.rules
inst_hook pre-trigger 30 "$moddir/parse-biosdevname.sh"

# set the default state according to the config
if [[ -e /etc/sysconfig/network ]]; then
    . /etc/sysconfig/network
fi

if [[ "$BIOSDEVNAME" = "yes" ]]; then
    echo "biosdevname=1" &gt;&gt; ${initdir}/etc/cmdline
fi

TIP: by defining BIOSDEVNAME=yes in /etc/sysconfig/network we activate the bios device naming style!


RHEL 7 &amp; Fedora 23: How do we define the name_assign_type value?

/usr/lib/dracut/modules.d/40network/net-lib.sh:

is_persistent_ethernet_name() {
    local _netif="$1"
    local _name_assign_type="0"

    [ -f "/sys/class/net/$_netif/name_assign_type" ] \
        &amp;&amp; _name_assign_type=$(cat "/sys/class/net/$_netif/name_assign_type")

    # NET_NAME_ENUM 1
    [ "$_name_assign_type" = "1" ] &amp;&amp; return 1

    # NET_NAME_PREDICTABLE 2
    [ "$_name_assign_type" = "2" ] &amp;&amp; return 0
        # NET_NAME_ENUM 1
        # NET_NAME_PREDICTABLE 2
                # NET_NAME_USER 3
                # NET_NAME_RENAMED 4
    case "$_netif" in
        # udev persistent interface names
        eno[0-9]|eno[0-9][0-9]|eno[0-9][0-9][0-9]*)
            ;;
        ens[0-9]|ens[0-9][0-9]|ens[0-9][0-9][0-9]*)
            ;;
        enp[0-9]s[0-9]*|enp[0-9][0-9]s[0-9]*|enp[0-9][0-9][0-9]*s[0-9]*)
            ;;
        enP*p[0-9]s[0-9]*|enP*p[0-9][0-9]s[0-9]*|enP*p[0-9][0-9][0-9]*s[0-9]*)
            ;;
        # biosdevname
        em[0-9]|em[0-9][0-9]|em[0-9][0-9][0-9]*)
            ;;
        p[0-9]p[0-9]*|p[0-9][0-9]p[0-9]*|p[0-9][0-9][0-9]*p[0-9]*)
            ;;
        *)
            return 1
    esac
    return 0
}


SLES 10: not found....

SLES 11: not found either...

/etc/udev/rules.d/77-network.rules
SUBSYSTEM=="net", ENV{INTERFACE}=="lo*|dummy*|vif*.*|br*|bond*|vlan*|gre*|sit*|tap*|tun*|ipip*|ip6tnl*|ipsec*|ppp*|ippp*|isdn*|modem*|dsl*|plip*|irda*", GOTO="skip_ifup"
SUBSYSTEM=="net", ACTION=="add", RUN+="/sbin/ifup $env{INTERFACE} -o hotplug"
SUBSYSTEM=="net", ACTION=="remove", RUN+="/sbin/ifdown %k -o hotplug"
LABEL="skip_ifup"

/etc/udev/rules.d/70-persistent-net.rules
# PCI device 0x19a2:0x0700 (be2net)
SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="68:b5:99:73:25:b0", ATTR{dev_id}=="0x0", ATTR{type}=="1",

KERNEL=="eth*", NAME="eth1"
...
</code></pre>
<h4 id="jsmeix_commented_at_2016-08-09_1044"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-238517704">2016-08-09 10:44</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-09_1044" title="Permanent link">&para;</a></h4>
<p>@grendelson<br />
only a side note:</p>
<p>I always use on my test systems in etc/rear/local.conf</p>
<pre>
# Let the rear recovery system run dhclient to get an IP address
# instead of using the same IP address as the original system:
USE_DHCLIENT="yes"
</pre>

<p>which avoids networking issues in the recovery system for me.</p>
<p>The reasoning behind is that in the recovery system<br />
it should not matter which IP address it gets and how it<br />
gets its networking config as long as the recovery system<br />
can access the backup.tar.gz.</p>
<p>After "rear recover" when the recovered system is booted<br />
it does its network setup according to the restored<br />
config files from the backup.</p>
<p>@grendelson<br />
I cannot know if also in your case USE_DHCLIENT="yes"<br />
would result a recovery system that can access the backup<br />
(which may not work for complicated network setups with<br />
things like VLAN) but perhaps you could nevertheless<br />
try out if USE_DHCLIENT="yes" is an easier workaround<br />
for you compared to manual network setup.</p>
<h4 id="grendelson_commented_at_2016-08-09_1846"><img src="https://avatars.githubusercontent.com/u/1943988?v=4" width="50"><a href="https://github.com/grendelson">grendelson</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-238651910">2016-08-09 18:46</a>:<a class="headerlink" href="#grendelson_commented_at_2016-08-09_1846" title="Permanent link">&para;</a></h4>
<p>@jsmeix<br />
Unfortunately in our env we do not have DHCP assigned IP addresses and
we MUST use VLAN tagging.<br />
On a restore of the original server I expected the original network
settings to be available and work since the hardware has not changed.</p>
<p>On a CLONE I expect the live cd to fail to get a working network since
the devices do not match - but I should only have to rename the ifcfg
device names, update an ip address and restart networking. Manually
adding devices to the bond is working but is lengthy , fraught with
peril, and unexpected when doing a restore to the original hardware.</p>
<p>Thanks for the USE_DHCLIENT advice however - in a different env ( or
perhaps we create a vlan that DOES use DHCP - a "restore network" ) this
would work IF the underlying devices ( the biosdev names ) was being
detected correctly I think?</p>
<h4 id="gdha_commented_at_2016-08-10_0631"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-238777442">2016-08-10 06:31</a>:<a class="headerlink" href="#gdha_commented_at_2016-08-10_0631" title="Permanent link">&para;</a></h4>
<p>@jsmeix Could you ask internal within SuSe how the biosdevnames are
activated?<br />
@phracek Could you do me a favor and try to find out how biosdevnames
are defined/working on RHEL7?</p>
<h4 id="gozora_commented_at_2016-08-10_0635"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-238777957">2016-08-10 06:35</a>:<a class="headerlink" href="#gozora_commented_at_2016-08-10_0635" title="Permanent link">&para;</a></h4>
<p>@gdha AFAIK it is by setting kernel parameter <strong>biosdevname=1</strong> at boot
time (on my SLES11 SP3 at least ...)</p>
<h4 id="jsmeix_commented_at_2016-08-10_1454"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-238892779">2016-08-10 14:54</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-10_1454" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
I will try to find out something about how network device/interface<br />
naming happens on SUSE but do not expect too much from me<br />
because basically I am a networking noob (guess why I am so<br />
happy that USE_DHCLIENT="yes" moves networking stuff<br />
out of sight for me ;-)</p>
<p>@grendelson<br />
I would very much appreciate it if you could do some<br />
experiments to get it working for your case.<br />
I think the rear source file where you should try to<br />
make adaptions and enhancements is primarily<br />
usr/share/rear/rescue/GNU/Linux/31_network_devices.sh</p>
<p>A side note for the fun of it:</p>
<p>Unfortunately if you run "git blame" for that file is shows<br />
mostly me as if I was the expert who made all that<br />
but
<a href="https://github.com/rear/rear/issues/758#issuecomment-182930790">https://github.com/rear/rear/issues/758#issuecomment-182930790</a><br />
explains how that happened ;-)</p>
<p>Fortunately "git log -p" exists that shows the<br />
whole true history for that file.</p>
<h4 id="grendelson_commented_at_2016-08-10_1850"><img src="https://avatars.githubusercontent.com/u/1943988?v=4" width="50"><a href="https://github.com/grendelson">grendelson</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-238966006">2016-08-10 18:50</a>:<a class="headerlink" href="#grendelson_commented_at_2016-08-10_1850" title="Permanent link">&para;</a></h4>
<p>I won't be able to do anything while I'm away next week - so I haven't
abandoned it - I just won't be able to test anything until after 10
days. I'm also out of test hardware :( I may have to break one of my
existing machine to run rear restore on over and over.<br />
When you say test it - do you mean adding some lines to try to rename
devices or find current eth devices? I know what to do to find the
current active devices with ethtool and then manually add them to bond
and create a vlan - are we trying to make more automation about that or
trying to get the biosdevnames to work? ( that part I have NO idea where
to start.)</p>
<h4 id="jsmeix_commented_at_2016-08-11_1612"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-239210196">2016-08-11 16:12</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-11_1612" title="Permanent link">&para;</a></h4>
<p>In
<a href="https://github.com/rear/rear/pull/960">https://github.com/rear/rear/pull/960</a><br />
I implemended some fixes and addons<br />
for recovery system networking setup.</p>
<p>In particular the new NETWORKING_SETUP_COMMANDS<br />
functionality is intended for issues like this one where<br />
@grendelson knows the commands how to set up<br />
networking manually in the recovery system.</p>
<p>@grendelson<br />
regarding your
<a href="https://github.com/rear/rear/issues/951#issuecomment-238966006">https://github.com/rear/rear/issues/951#issuecomment-238966006</a></p>
<p>Regarding "out of test hardware":<br />
I recommend to use virtual machines for testing,<br />
see the section "First steps with Relax-and-Recover"<br />
in
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>Regarding the rest:<br />
I am afraid, my networking knowledge is not sufficient<br />
to tell you what to do if the automated networking setup<br />
in the recovery system does not work for complicated<br />
network setups.</p>
<p>In general the automated networking setup in the<br />
recovery system is mainly done by running the script<br />
/etc/scripts/system-setup.d/60-network-devices.sh<br />
while booting the recovery system.</p>
<p>That 60-network-devices.sh script is generated<br />
during "rear mkbackup" (or "rear mkrescue")<br />
in the original system by the script<br />
usr/share/rear/rescue/GNU/Linux/31_network_devices.sh</p>
<p>To make the automated networking setup working in<br />
your case you would have to find out what goes wrong<br />
c.f. "Debugging issues with Relax-and-Recover"<br />
in
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>Then (usualy in several trial and error steps)<br />
you can adapt and enhance<br />
usr/share/rear/rescue/GNU/Linux/31_network_devices.sh<br />
so that it finally generates a 60-network-devices.sh script<br />
that works for your case.</p>
<p>Until the automatism is sufficiently adapted and enhanced<br />
one needs some more direct method to set up networking<br />
in the recovery system that can be predefined so that<br />
one does not need to do the networking setup maually<br />
directly in the recovery system.</p>
<p>Therefore I implemented in
<a href="https://github.com/rear/rear/pull/960">https://github.com/rear/rear/pull/960</a><br />
support for manual recovery system networking setup<br />
via NETWORKING_SETUP_COMMANDS, see default.conf.</p>
<p>This functionality is intended to be helpful as some kind of<br />
"last resort" when the automated network devices setup<br />
does not work as it happens here.</p>
<h4 id="jsmeix_commented_at_2016-08-12_1422"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-239459795">2016-08-12 14:22</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-12_1422" title="Permanent link">&para;</a></h4>
<p>With
<a href="https://github.com/rear/rear/pull/960">https://github.com/rear/rear/pull/960</a>
merged<br />
there is now the new support for<br />
NETWORKING_PREPARATION_COMMANDS<br />
which replaces the above mentioned support for<br />
NETWORKING_SETUP_COMMANDS.</p>
<p>See default.conf how NETWORKING_PREPARATION_COMMANDS<br />
is meant to be used and for some simple examples see<br />
<a href="https://github.com/rear/rear/pull/960#issuecomment-239448861">https://github.com/rear/rear/pull/960#issuecomment-239448861</a></p>
<p>@grendelson<br />
with NETWORKING_PREPARATION_COMMANDS you<br />
should (hopefully) be able to specify those comands<br />
that made the recovery system networking setup<br />
work for you so that you do no longer need to type in<br />
those comands manally each time in the recovery system.</p>
<p>Of course NETWORKING_PREPARATION_COMMANDS<br />
will not make it "just work" automatically but it is not meant<br />
this way. It is meant to be helpful to get problems with recovery<br />
system networking setup more easily fixed - or at least to get<br />
more easily a quick and dirty workaround in case of<br />
issues with recovery system networking setup.</p>
<p>In general regarding how to test the currently<br />
newest rear GitHub master code:</p>
<p>Basically "git clone" it into a directory and<br />
then run rear from within that directory.</p>
<pre>
# git clone https://github.com/rear/rear.git
# cd rear
# vi etc/rear/local.conf
# usr/sbin/rear -d -D mkbackup
</pre>

<h4 id="jsmeix_commented_at_2016-08-12_1424"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-239460372">2016-08-12 14:24</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-12_1424" title="Permanent link">&para;</a></h4>
<p>Next week I will try to find out about biosdevnames<br />
versus "normal" network device names (like 'eth0')...</p>
<h4 id="jsmeix_commented_at_2016-08-12_1550"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-239483665">2016-08-12 15:50</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-12_1550" title="Permanent link">&para;</a></h4>
<p>Whoops!<br />
Accidentally I closed this one (hit the wrong button).</p>
<h4 id="jsmeix_commented_at_2016-08-15_1541"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-239836711">2016-08-15 15:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-15_1541" title="Permanent link">&para;</a></h4>
<p>I think there is nothing what I could do here<br />
because I cannot reproduce it.</p>
<p>I installed a SLES12 system with the kernel command line<br />
parameter "biosdevname=1" but nevertheless I only get 'eth0'.</p>
<p>Furthermore the command "/sbin/biosdevname eth0"<br />
returns nothing in my case. Regarding that tool see<br />
<a href="https://build.opensuse.org/package/show/SUSE:SLE-12-SP1:GA/biosdevname">https://build.opensuse.org/package/show/SUSE:SLE-12-SP1:GA/biosdevname</a></p>
<p>I think this matches what is described in the section<br />
"6.5.2 Mapping Network Interface Names to Names<br />
Written on the Chassis (biosdevname)" in<br />
<a href="https://www.suse.com/releasenotes/x86_64/SUSE-SLES/11-SP3/#fate-311333">https://www.suse.com/releasenotes/x86_64/SUSE-SLES/11-SP3/#fate-311333</a></p>
<pre>
... for Dell hardware, which has the corresponding BIOS support ...
The usage of biosdevname can be enforced on every hardware
with "biosdevname=1". If the BIOS has no support, no network
interface names are renamed. 
</pre>

<p>Accordingly I assume my test system has no support for<br />
biosdevname because I do not have such a Dell machine<br />
so that I cannot reproduce anything here.</p>
<p>Furthermore my assumption is proved by what I read in<br />
/usr/share/doc/packages/biosdevname/README<br />
of the installed biosdevname RPM package:</p>
<pre>
biosdevname
Copyright (c) 2006, 2007 Dell, Inc.  <Matt_Domsch@dell.com>
Licensed under the GNU General Public License, Version 2.
biosdevname in its simplest form takes a kernel device name as an
argument, and returns the BIOS-given name it "should" be.  This is
necessary on systems where the BIOS name for a given device (e.g. the
label on the chassis is "Gb1") doesn't map directly and obviously to
the kernel name (e.g. eth0).
The distro-patches/sles10/ directory contains a patch needed to
integrate biosdevname into the SLES10 udev ethernet naming rules.
This also works as a straight udev rule.  On RHEL4, that looks like:
KERNEL=="eth*", ACTION=="add", PROGRAM="/sbin/biosdevname -i %k", NAME="%c"
This makes use of various BIOS-provided tables:
PCI Confuration Space
PCI IRQ Routing Table ($PIR)
PCMCIA Card Information Structure
SMBIOS 2.6 Type 9, Type 41, and HP OEM-specific types
therefore it's likely that this will only work well on architectures
that provide such information in their BIOS.
</pre>

<p>This means this issue is hardware specific so that only those<br />
who sit in front of such Dell machines can adapt and enhance<br />
Relax-and-Recover to support that particular hardware<br />
out of the box.</p>
<p>@grendelson<br />
perhaps when you do not have only such kind of Dell hardware<br />
and when there is no good reason why you must use their<br />
special naming, you could to simplify things and use on all your<br />
machines the kernel command line parameter "biosdevname=0"<br />
to enforce that also on such kind of Dell hardware the usual naming<br />
is used so that all your machines behave same and you do not need<br />
to make special hacks for special hardware in Relax-and-Recover?</p>
<p>On the other hand:<br />
@grendelson<br />
when you can provide a GitHub pull request that adapts and<br />
enhances Relax-and-Recover so that it even "just works"<br />
for such kind of Dell hardware please do so,<br />
cf. "Dirty hacks welcome" in<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a></p>
<p>I remove the label "bug" from this issue because it is never ever<br />
a bug in Relax-and-Recover when it does not "just work" on<br />
special hardware.</p>
<h4 id="jsmeix_commented_at_2016-08-15_1544"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-239837739">2016-08-15 15:44</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-15_1544" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
I think we should close this issue as "looking for sponsorship".</p>
<h4 id="jsmeix_commented_at_2016-08-15_1605"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-239845666">2016-08-15 16:05</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-15_1605" title="Permanent link">&para;</a></h4>
<p>FYI an addedum for<br />
<a href="https://github.com/rear/rear/issues/951#issuecomment-238165367">https://github.com/rear/rear/issues/951#issuecomment-238165367</a><br />
on my above mentioned SLES12 test system that I installed<br />
with the kernel command line parameter "biosdevname=1":</p>
<pre>
# find /etc | xargs grep -i biosdevname
/etc/default/grub:GRUB_CMDLINE_LINUX_DEFAULT="biosdevname=1 resume=/dev/sda1 splash=silent quiet showopts"
/etc/wicked/server.xml:    &lt;builtin name="biosdevname" library="libwicked-biosname.so" symbol="biosdevname_ns"/&gt;

# find /usr/lib/udev/rules.d | xargs grep -il biosdevname
/usr/lib/udev/rules.d/71-biosdevname.rules

# rpm -qf /usr/lib/udev/rules.d/71-biosdevname.rules
biosdevname-0.7.2-4.3.x86_64

# cat /usr/lib/udev/rules.d/71-biosdevname.rules
SUBSYSTEM!="net", GOTO="netdevicename_end"
ACTION!="add",    GOTO="netdevicename_end"
NAME=="?*",       GOTO="netdevicename_end"
ATTR{type}!="1",  GOTO="netdevicename_end"
ENV{DEVTYPE}=="?*", GOTO="netdevicename_end"
# whitelist all Dell systems
ATTR{[dmi/id]sys_vendor}=="Dell*", ENV{UDEV_BIOSDEVNAME}="1"
# kernel command line "biosdevname={0|1}" can turn off/on biosdevname
IMPORT{cmdline}="biosdevname"
ENV{biosdevname}=="?*", ENV{UDEV_BIOSDEVNAME}="$env{biosdevname}"
# ENV{UDEV_BIOSDEVNAME} can be used for blacklist/whitelist
# but will be overwritten by the kernel command line argument
ENV{UDEV_BIOSDEVNAME}=="0", GOTO="netdevicename_end"
ENV{UDEV_BIOSDEVNAME}=="1", GOTO="netdevicename_start"
# comment the next line for biosdevname to be on by default
GOTO="netdevicename_end"
LABEL="netdevicename_start"
# using NAME= instead of setting INTERFACE_NAME, so that persistent
# names aren't generated for these devices, they are "named" on each boot.
SUBSYSTEMS=="pci", PROGRAM="/sbin/biosdevname --policy physical --smbios 2.6 --nopirq -i %k", NAME="%c",  OPTIONS+="string_escape=replace"
LABEL="netdevicename_end"
</pre>

<h4 id="grendelson_commented_at_2016-08-29_1429"><img src="https://avatars.githubusercontent.com/u/1943988?v=4" width="50"><a href="https://github.com/grendelson">grendelson</a> commented at <a href="https://github.com/rear/rear/issues/951#issuecomment-243140709">2016-08-29 14:29</a>:<a class="headerlink" href="#grendelson_commented_at_2016-08-29_1429" title="Permanent link">&para;</a></h4>
<p>I just got back to this and see the updates. I'll try to find some hacks
- but honestly I like the biosdevname=0 to try to STOP the biosdevname.
I'm going to try that first since it makes the HW work the way we expect
and we can restore to NON DELL HW if we need to. These machines are
being used for Prod rebuilds so I don't have them for much more testing
- once a machine becomes available for testing I'll try to work on this
more but that might be months.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2022 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-08-03.951.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
