<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1854 Issue closed: "Pseudo Migration Mode" needed during "rear recover" with a ReaR recovery disk - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1854 Issue closed: \"Pseudo Migration Mode\" needed during \"rear recover\" with a ReaR recovery disk";
        var mkdocs_page_input_path = "issues/2018-07-06.1854.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1854 Issue closed: "Pseudo Migration Mode" needed during "rear recover" with a ReaR recovery disk</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1854_issue_closed_pseudo_migration_mode_needed_during_rear_recover_with_a_rear_recovery_disk"><a href="https://github.com/rear/rear/issues/1854">#1854 Issue</a> <code>closed</code>: "Pseudo Migration Mode" needed during "rear recover" with a ReaR recovery disk<a class="headerlink" href="#1854_issue_closed_pseudo_migration_mode_needed_during_rear_recover_with_a_rear_recovery_disk" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>documentation</code>, <code>discuss / RFC</code>,
<code>no-issue-activity</code></p>
<h4 id="jsmeix_opened_issue_at_2018-07-06_1020"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> opened issue at <a href="https://github.com/rear/rear/issues/1854">2018-07-06 10:20</a>:<a class="headerlink" href="#jsmeix_opened_issue_at_2018-07-06_1020" title="Permanent link">&para;</a></h4>
<p>I think we have a general problem in current ReaR master code<br />
during "rear recover" when the ReaR recovery system<br />
was booted from a normal disk device like /dev/sda.</p>
<p>See<br />
<a href="https://github.com/rear/rear/issues/1852#issuecomment-402727869">https://github.com/rear/rear/issues/1852#issuecomment-402727869</a><br />
and the section about<br />
<code>... a possible problem with the disk migration ...</code><br />
in<br />
<a href="https://github.com/rear/rear/issues/1852#issuecomment-402512410">https://github.com/rear/rear/issues/1852#issuecomment-402512410</a></p>
<p>I think the following suituation causes a general problem:</p>
<p>1.)<br />
On the original system /dev/sda is the first system disk<br />
(i.e. the disk that usually contains the bootloader and the root
filesystem).<br />
For "rear mkrescue/mkbackup" an additional normal disk device is used
that is<br />
a removable disk (e.g. a USB disk) that appears in the original system
as /dev/sdb<br />
where to the ReaR recovery system (and perhaps also the backup) is
written<br />
so that in particular the disklayout.conf file contains entries for<br />
the system disk /dev/sda.</p>
<p>2.)<br />
On the replacement hardware the ReaR recovery disk is connected<br />
and the replacement hardware is booted from that disk so that<br />
on the replacement hardware the recovery disk could be /dev/sda<br />
and the first target system disk could be /dev/sdb so that<br />
during "rear recover" /dev/sda and /dev/sdb are interchanged<br />
compared to what there was on the original system.</p>
<p>3.)<br />
Because of the interchanged /dev/sda and /dev/sdb "rear recover"<br />
goes into MIGRATION_MODE where the right disk layout mapping<br />
table (source =&gt; target) is <code>/dev/sda</code> =&gt; <code>/dev/sdb</code> and that<br />
disk mapping must be applied to the disklayout.conf file<br />
to recreate the system disk layout on the right target disk /dev/sdb<br />
(otherwise the ReaR recovery disk content would be destroyed).</p>
<p>4.)<br />
After "rear recover" recreated the system disk layout on /dev/sdb<br />
the backup needs to be restored into the filesystems on /dev/sdb<br />
and the bootloader needs to be installed on /dev/sdb.</p>
<p>5.)<br />
After the backup was restored but before the bootloader gets installed<br />
"rear recover" runs in its <code>finalize</code> stage several scripts that
modify<br />
certain restored files where the above disk layout mapping gets
applied<br />
so that in certain restored files <code>/dev/sda</code> gets replaced by
<code>/dev/sdb</code>,<br />
cf. the <code>rear -D recover</code> terminal output at<br />
<a href="https://github.com/rear/rear/issues/1852#issuecomment-402512410">https://github.com/rear/rear/issues/1852#issuecomment-402512410</a><br />
that contains in particular</p>
<pre>
Applying disk layout mappings in /var/lib/rear/layout/disk_mappings to certain restored files...
The original restored files get saved in var/lib/rear/saved_original_files/ (in /mnt/local)
Applied disk layout mappings to restored 'boot/grub2/grub.cfg' (in /mnt/local)
Applied disk layout mappings to restored 'boot/grub2/device.map' (in /mnt/local)
Applied disk layout mappings to restored 'etc/sysconfig/bootloader' (in /mnt/local)
Applied disk layout mappings to restored 'etc/fstab' (in /mnt/local)
Applied disk layout mappings to restored 'etc/mtools.conf' (in /mnt/local)
Applied disk layout mappings to restored 'etc/smartd.conf' (in /mnt/local)
Applied disk layout mappings to restored 'etc/sysconfig/smartmontools' (in /mnt/local)
Patching /etc/default/grub_installdevice: Replacing [/dev/disk/by-id/ata-QEMU_HARDDISK_QM00001] by [/dev/disk/by-id/ata-QEMU_HARDDISK_QM00003]
Updating udev configuration (70-persistent-net.rules)
Running mkinitrd...
Recreated initrd (/sbin/mkinitrd).
Installing GRUB2 boot loader...
</pre>

<p>Modifying certain restored files could be needed because<br />
the bootloader needs to be installed within the target system
environment, cf.<br />
<a href="https://github.com/rear/rear/issues/1828#issuecomment-398717889">https://github.com/rear/rear/issues/1828#issuecomment-398717889</a></p>
<pre>
chroot /mnt/local grub2-mkconfig -o /boot/grub2/grub.cfg
chroot /mnt/local grub2-install /dev/sdb
</pre>

<p>so that in particular bootloader related config files may need to have<br />
the right values that match the target system.</p>
<p>6.)<br />
After "rear recover" finished and before the recreated system is
rebooted<br />
the no longer needed ReaR recovery disk gets disconnected<br />
so that then on the recreated system /dev/sda is again the first system
disk<br />
(i.e. the same disk device node as it was on the original system).</p>
<p>7.)<br />
But now the recreated system boots with the above modified config
files<br />
where in particular <code>/dev/sda</code> was replaced by <code>/dev/sdb</code> which is now
wrong.</p>
<p>Conclusion:</p>
<p>I think a "Pseudo Migration Mode" is needed during "rear recover"<br />
when the ReaR recovery system was booted from a normal disk.</p>
<p>I think because during "rear recover" some config files in the recreated
system<br />
may need to have <code>/dev/sda</code> replaced by <code>/dev/sdb</code> (e.g. for bootloader
installation)<br />
one cannot "just skip" that modification step.</p>
<p>Accordingly my immediate idea how to solve this is to add an optional<br />
very final re-replacement step that re-replaces <code>/dev/sdb</code> by
<code>/dev/sda</code><br />
in those config files in the recreated system to get things right
again<br />
to boot the recreated system without the ReaR recovery disk.</p>
<p>I think it is impossible to automate such a re-replacement step<br />
so that the user must explicitly specify when he wants that
re-replacement<br />
because only the user knows if the recreated system will be booted<br />
with or without the ReaR recovery disk.</p>
<p>I think when the ReaR recovery disk gets a 'late' device node like
/dev/sdb<br />
so that the target system disk is still /dev/sda as it was on the
original system<br />
everything would "just work" because then the right disk layout
mapping<br />
table (source =&gt; target) is <code>/dev/sda</code> =&gt; <code>/dev/sda</code> (i.e. the
identical mapping)<br />
which does nothing and will be no longer applied to disklayout.conf or
other files<br />
when
<a href="https://github.com/rear/rear/issues/1847">https://github.com/rear/rear/issues/1847</a>
gets solved<br />
by merging in
<a href="https://github.com/rear/rear/pull/1848">https://github.com/rear/rear/pull/1848</a>
the commit<br />
<a href="https://github.com/rear/rear/commit/f23c601857a9b8e6cb08892b1e3b67257ad5314a">https://github.com/rear/rear/commit/f23c601857a9b8e6cb08892b1e3b67257ad5314a</a></p>
<h4 id="olivero2_commented_at_2018-07-06_1100"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/1854#issuecomment-403002150">2018-07-06 11:00</a>:<a class="headerlink" href="#olivero2_commented_at_2018-07-06_1100" title="Permanent link">&para;</a></h4>
<p>In my view this is a good overview of problems with temporary hardware
configurations used during recovery, which might lead to an unbootable
system after recovery.</p>
<p>Is it correct to say that ReaR's mispatching of system files only
applies to systems which still use <strong>bus-based naming</strong> for devices in
their configuration while systems using <a href="https://wiki.archlinux.org/index.php/Persistent_block_device_naming">Persistent block device
naming</a>
are not affected as ReaR will preserve UUIDs and labels?</p>
<p>The above explanation uses the USB device as an example. As far as I am
aware, USB storage devices will be initialized after internal (SCSI)
hard disks and always receive "later" device nodes. So a USB storage
device will never displace the original <code>/dev/sda</code>. Or do we have
evidence to the contrary?</p>
<h4 id="jsmeix_commented_at_2018-07-06_1159"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1854#issuecomment-403013334">2018-07-06 11:59</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-07-06_1159" title="Permanent link">&para;</a></h4>
<p>@OliverO2<br />
I never had a closer look at ReaR's modifications of restored files<br />
until
<a href="https://github.com/rear/rear/pull/1843">https://github.com/rear/rear/pull/1843</a><br />
where I got a bit scared because ReaR did that silently<br />
and without saving the original files, cf.<br />
<a href="https://github.com/rear/rear/pull/1843#issuecomment-401042614">https://github.com/rear/rear/pull/1843#issuecomment-401042614</a></p>
<p>For me things had "just worked" because I never had the ReaR recovery
system<br />
on a normal disk /dev/sda - if at all I had it as /dev/sdb on the
replacement hardware<br />
where "hardware" actually was a virtual KVM/QEMU machine where I
attached<br />
such a ReaR recovery system disk as second IDE disk that became
/dev/sdb<br />
so that /dev/sda was always the system disk both on the original
system<br />
and on the replacement hardware.</p>
<p>Because I got no SUSE customer request about this issue here<br />
I assume in business environments it does usually not happen<br />
that the ReaR recovery system is on a normal disk /dev/sda<br />
or perhaps by accident or by some luck things "somehow work"<br />
even in this case or - scaring! - users who have the ReaR recovery<br />
system on a normal disk do not verify that "rear recover" actually<br />
works for them on their replacement hardware, cf.<br />
"No disaster recovery without testing and continuous validation" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>Now since I know about this issue here I can test how current ReaR
behaves<br />
when I attach such a ReaR recovery system disk as first IDE disk
/dev/sda<br />
on the replacement hardware.</p>
<p>I fear the current way how ReaR modifies restored files may need<br />
to be completely overhauled because from my point of view<br />
automated modifying restored files is a very delicate issue<br />
because in general the user's data has to be sacrosanct.</p>
<p>I used the term <code>USB disk</code> only as a template for any removable disk.<br />
To make things more clear I will replace <code>USB disk</code> by <code>removable disk</code>
in<br />
<a href="https://github.com/rear/rear/issues/1854#issue-338886055">https://github.com/rear/rear/issues/1854#issue-338886055</a></p>
<h4 id="jsmeix_commented_at_2018-07-06_1208"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1854#issuecomment-403015226">2018-07-06 12:08</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-07-06_1208" title="Permanent link">&para;</a></h4>
<p>@OliverO2<br />
my losssy mind forgot that we do have evidence that a USB device<br />
can become /dev/sda on the replacement hardware:</p>
<p><a href="https://github.com/rear/rear/issues/1271">https://github.com/rear/rear/issues/1271</a></p>
<p>I even mentioned that issue in my description<br />
about <code>MIGRATION_MODE</code> in default.conf.</p>
<h4 id="jsmeix_commented_at_2018-07-06_1243"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1854#issuecomment-403022906">2018-07-06 12:43</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-07-06_1243" title="Permanent link">&para;</a></h4>
<p>FYI:<br />
Currently only a GRUB2 bootloader installation gets migrated<br />
according to the disk layout mapping, cf.<br />
<a href="https://github.com/rear/rear/issues/1437#issuecomment-403022440">https://github.com/rear/rear/issues/1437#issuecomment-403022440</a></p>
<h4 id="olivero2_commented_at_2018-07-06_1411"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/1854#issuecomment-403046024">2018-07-06 14:11</a>:<a class="headerlink" href="#olivero2_commented_at_2018-07-06_1411" title="Permanent link">&para;</a></h4>
<p>@jsmeix Maybe ReaR could detect when the recovery system was booted from
a device (primarily <code>/dev/sda</code>), which is among the original system's
regular devices. In this case, ReaR could assume that this is only a
temporary situation during recovery and react as follows:</p>
<ol>
<li>Automatically create a temporary mapping which excludes the recovery
    boot device (e.g., mapping <code>/dev/sdb</code> to <code>/dev/sda</code>, <code>/dev/sdc</code> to
    <code>/dev/sdb</code>, ...) even before deciding further about migration mode.</li>
<li>Do not apply that temporary mapping when patching files on the
    recovered system.</li>
</ol>
<p>In this case ReaR would just behave as if its own recovery system's boot
device just wasn't there.</p>
<p>Note that <code>/dev/sda</code> may be the most common case, but it is also
conceivable that the recovery boot device could insert itself somewhere
else (e.g. where an original system has <code>sda</code>, <code>sdb</code>, <code>sdc</code>, ReaR might
boot from <code>sdb</code>, displacing <code>sdb</code> -&gt; <code>sdc</code> and <code>sdc</code> -&gt; <code>sdd</code>).</p>
<h4 id="jsmeix_commented_at_2018-07-09_1001"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1854#issuecomment-403427245">2018-07-09 10:01</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-07-09_1001" title="Permanent link">&para;</a></h4>
<p>@OliverO2<br />
regarding your above</p>
<pre>
Do not apply that temporary mapping when patching files on the recovered system
</pre>

<p>see item 5.) in my initial comment:</p>
<pre>
Modifying certain restored files could be needed because
the bootloader needs to be installed within the target system environment, cf.
https://github.com/rear/rear/issues/1828#issuecomment-398717889

chroot /mnt/local grub2-mkconfig -o /boot/grub2/grub.cfg
chroot /mnt/local grub2-install /dev/sdb

so that in particular bootloader related config files may need to have
the right values that match the target system.
</pre>

<p>Also the initrd/initramfs is built within the target system environment
via</p>
<pre>
chroot $TARGET_FS_ROOT ...
</pre>

<p>See the usr/share/rear/finalize/ scripts for <code>chroot</code> commands.</p>
<p>Currently I don't know which of them may somehow need to have<br />
right disk layout values in some config files in the target system<br />
while they run within the target system environment.</p>
<p>For example I don't know how exactly</p>
<pre>
chroot /mnt/local grub2-mkconfig -o /boot/grub2/grub.cfg
chroot /mnt/local grub2-install /dev/sdb
</pre>

<p>behaves.<br />
The first command should create /boot/grub2/grub.cfg anew<br />
so that the before running<br />
<code>Applied disk layout mappings to restored 'boot/grub2/grub.cfg' (in /mnt/local)</code><br />
should no longer matter here and<br />
the second command should install GRUB2 explicitly on <code>/dev/sdb</code><br />
but currently I don't know if that installed GRUB2 still boots<br />
when <code>/dev/sdb</code> has become <code>/dev/sda</code>.</p>
<p>I will try it out - but not this week because this week is Hack Week,
see<br />
<a href="https://hackweek.suse.com/">https://hackweek.suse.com/</a><br />
and<br />
<a href="https://hackweek.suse.com/17/projects">https://hackweek.suse.com/17/projects</a><br />
and I will work on<br />
<a href="https://hackweek.suse.com/17/projects/get-a-basic-understanding-about-md-software-raid-setup">https://hackweek.suse.com/17/projects/get-a-basic-understanding-about-md-software-raid-setup</a></p>
<h4 id="olivero2_commented_at_2018-07-09_1229"><img src="https://avatars.githubusercontent.com/u/4660803?v=4" width="50"><a href="https://github.com/OliverO2">OliverO2</a> commented at <a href="https://github.com/rear/rear/issues/1854#issuecomment-403462166">2018-07-09 12:29</a>:<a class="headerlink" href="#olivero2_commented_at_2018-07-09_1229" title="Permanent link">&para;</a></h4>
<p>@jsmeix When guessing based on my experiences with grub, I would assume
that</p>
<ul>
<li>grub does not depend on configuration files already present on the
    target system (the bootloader may be installed at a point where
    there are no files at all on the target system, just partitions with
    file systems),</li>
<li>grub/Legacy will probably accept switching device nodes between
    installation and boot without any trouble as the target's boot
    device order will be configured in the BIOS,</li>
<li>with grub/EFI, as long as there is only one disk with an EFI
    partition around when the target system boots, it should also work
    without trouble. When there is more than one such disk, I am not
    sure how exactly grub will set up the EFI boot manager and whether
    the correct boot device will be chosen (cf. <a href="https://blog.uncooperative.org/blog/2014/02/06/the-efi-system-partition/">The EFI System
    Partition and the Default Boot Behavior - The Unco√∂perative
    Organization</a>).</li>
</ul>
<p>Good luck when trying it out and now: Enjoy your hack week!</p>
<h4 id="jsmeix_commented_at_2019-02-22_1549"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1854#issuecomment-466443640">2019-02-22 15:49</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-02-22_1549" title="Permanent link">&para;</a></h4>
<p>For the fun of it:<br />
Such generic issues do not only appear with ReaR.<br />
It also happens with other installers when their installation system<br />
was booted from a normal disk device (e.g. a USB stick) that is
/dev/sda,<br />
e.g. with AutoYaST, see<br />
<a href="https://lists.opensuse.org/opensuse-autoinstall/2019-02/msg00003.html">https://lists.opensuse.org/opensuse-autoinstall/2019-02/msg00003.html</a></p>
<h4 id="github-actions_commented_at_2020-06-30_0133"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/1854#issuecomment-651464921">2020-06-30 01:33</a>:<a class="headerlink" href="#github-actions_commented_at_2020-06-30_0133" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2018-07-06.1854.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
