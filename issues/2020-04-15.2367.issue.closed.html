<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2367 Issue closed: NETWORKER backing up only the ISO file? - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2367 Issue closed: NETWORKER backing up only the ISO file?";
        var mkdocs_page_input_path = "issues/2020-04-15.2367.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2367 Issue closed: NETWORKER backing up only the ISO file?</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2367_issue_closed_networker_backing_up_only_the_iso_file"><a href="https://github.com/rear/rear/issues/2367">#2367 Issue</a> <code>closed</code>: NETWORKER backing up only the ISO file?<a class="headerlink" href="#2367_issue_closed_networker_backing_up_only_the_iso_file" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code>,
<code>external tool</code></p>
<h4 id="it-guy-1973_opened_issue_at_2020-04-15_0034"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> opened issue at <a href="https://github.com/rear/rear/issues/2367">2020-04-15 00:34</a>:<a class="headerlink" href="#it-guy-1973_opened_issue_at_2020-04-15_0034" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"): 1.17.2</p>
</li>
<li>
<p>OS version ("cat /etc/rear/os.conf" or "lsb_release -a" or "cat
    /etc/os-release"):</p>
</li>
<li>
<p>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):</p>
</li>
<li>
<p>Hardware (PC or PowerNV BareMetal or ARM) or virtual machine (KVM
    guest or PoverVM LPAR):</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device):</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot):</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe):</p>
</li>
<li>
<p>Storage layout ("lsblk -ipo
    NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT" or "lsblk" as
    makeshift):</p>
</li>
<li>
<p>Description of the issue (ideally so that others can reproduce
    it):<br />
    I am able to run "rear -vD mkbackup" and see the following messages.</p>
</li>
</ul>
<!-- -->

<pre><code># rear -vD mkbackup
Relax-and-Recover 1.17.2 / Git
Using log file: /var/log/rear/rear-lnxjump01.log
Creating disk layout
Excluding mountpoint /nmon_data. (MANUAL_INCLUDE mode)
Creating root filesystem layout
EMC Networker will recover these filesystems: / /nmon_data /boot
Copying files and directories
Copying binaries and libraries
Copying kernel modules
Creating initramfs
Making ISO image
Wrote ISO image: /var/lib/rear/output/rear-lnxjump01.iso (141M)
Saving result files with NSR (EMC NetWorker)
If the NSR_RETENTION_TIME="3650 days" is too low please add NSR_RETENTION_TIME variable in /etc/rear/local.conf
 pool           retent  name
============================

#
</code></pre>
<p>To me, this looks like it is backing up the
"/var/lib/rear/output/rear-lnxjump01.iso " file only. According to my
site.conf file I should be backing up '/boot' '/' 'swap' '/dev' as well.</p>
<pre><code># cat  site.conf | grep -v "^#"
BACKUP=NSR
OUTPUT=ISO
MODULES_LOAD=(vmxnet)
BACKUP_PROG_INCLUDE=( '/boot'  '/'  'swap' '/dev')
MANUAL_INCLUDE=YES
</code></pre>
<p>Why are those file systems not been backed up?</p>
<ul>
<li>
<p>Workaround, if any:</p>
</li>
<li>
<p>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files):</p>
</li>
</ul>
<h4 id="it-guy-1973_commented_at_2020-04-15_0036"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-613749685">2020-04-15 00:36</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-15_0036" title="Permanent link">&para;</a></h4>
<p>This is the output I see on the Networker logs.</p>
<pre><code>174411:save: Step (1 of 7) for PID-17953: save has been started on the client 'lnxjump01.c1shrd.com'.
175313:save: Step (2 of 7) for PID-17953: Running the backup on the client 'lnxjump01' for the selected save sets.
175318:save: Identifed a save for the backup with PID-17953 on the client 'lnxjump01'. Updating the total number of steps from 7 to 6.
174920:save: Step (3 of 6) for PID-17953: Contacting the NetWorker server through the nsrd process to obtain a handle to the target media device through the nsrmmd process for the save set '/var/lib/rear/output/rear-lnxjump01.iso'.
174908:save: Saving the backup data in the pool 'A0C3-S'.
175019:save: Received the media management binding information on the host 'a0c3us034nve001.usp01.xstream360.cloud'.
174910:save: Connected to the nsrmmd process on the host 'a0c3us034nve001.usp01.xstream360.cloud'.
175295:save: Successfully connected to the Data Domain device.
129292:save: Successfully established Client direct save session for save-set ID '3902163720' (lnxjump01:/var/lib/rear/output/rear-lnxjump01.iso) with Data Domain volume 'A0C3S.010'.
174922:save: Step (4 of 6) for PID-17953: Successfully connected to the target media device through the nsrmmd process on the host 'a0c3us034nve001.usp01.xstream360.cloud' for the save set '/var/lib/rear/output/rear-lnxjump01.iso'.
174422:save: Step (5 of 6) for PID-17953: Reading the save sets and writing to the target device.
/var/lib/rear/output/rear-lnxjump01.iso
174917:save: Step (6 of 6) for PID-17953: Backup has succeeded. Save is exiting.
/var/lib/rear/output/
/var/lib/rear/
/var/lib/
/var/
/

save: /var/lib/rear/output/rear-lnxjump01.iso  143 MB 00:00:03      6 files
94694:save: The backup of save set '/var/lib/rear/output/rear-lnxjump01.iso' succeeded.
</code></pre>
<p>Thank you,<br />
Regards,<br />
Niranjan</p>
<h4 id="it-guy-1973_commented_at_2020-04-15_0051"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-613753665">2020-04-15 00:51</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-15_0051" title="Permanent link">&para;</a></h4>
<p>Hello Support,</p>
<p>So with the same setting when I do a REAR backup to an NFS server it
backs up the system files not only the ISO image.</p>
<p>'/boot' '/' 'swap' '/dev'</p>
<p>Why is Networker backing up these files?</p>
<p>Regards,<br />
Niranjan</p>
<h4 id="gdha_commented_at_2020-04-15_0704"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-613856973">2020-04-15 07:04</a>:<a class="headerlink" href="#gdha_commented_at_2020-04-15_0704" title="Permanent link">&para;</a></h4>
<p>@IT-Guy-1973 First of all 1.17.2 is really old! Please upgrade ReaR to
2.4 or 2.5.<br />
And, yes ReaR will only save the ISO file after the mkbackup and it is
designed in this way (was a sponsored project). With EMC Networker (and
this is also true for all EXTERNAL backup programs) you are responsible
of making your own full backup of the Linux system.</p>
<h4 id="it-guy-1973_commented_at_2020-04-15_1508"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-614096738">2020-04-15 15:08</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-15_1508" title="Permanent link">&para;</a></h4>
<p>@gdha When I ran "yum in rear" on my RedHat v6.10 system it installed
this version. I will look to upgrade it soon. But so far it has been
working great.<br />
When I backed up my VM to an NFS file system and restored it - REAR did
all the work. It created the disk to restore and created the MBR and
everything. Can I expect the same experience when I integrate it with
Networker? Networker currently takes backup of all my file systems on
that server on a daily basis. I am going to try the restore soon but I
just wanted to ask you first.</p>
<p>Some background:<br />
Our larger goal is to implement rear on our 23000 VM's and physical
servers we support. They all run either RedHat (v6 and v7) and SUSE (v11
and v12). So the support you are providing me now by answering all my
questions is really appreciated. Thank you, again.</p>
<p>Regards,<br />
Niranjan</p>
<h4 id="it-guy-1973_commented_at_2020-04-16_1423"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-614685365">2020-04-16 14:23</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-16_1423" title="Permanent link">&para;</a></h4>
<p>Hello Support,</p>
<p>I was able to restore using NSR to another new system (VM) with the same
hard disk sizes. However, when restoring to the new system REAR
identified that the IP was different but it said "Disks are identical"
and started the restore without prompting me. I had two disks on this
system one 80GB and the other 40GB. Both belong to different volume
groups. But REAR restored all data to one disk and (80GB) and kept the
other disk free. The system after restore went to maintenance mode and I
had to manually comment out the file system that belongs to the second
VG to bring the system up.</p>
<p>Regards,<br />
Niranjan</p>
<h4 id="jsmeix_commented_at_2020-04-16_1504"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-614709777">2020-04-16 15:04</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-16_1504" title="Permanent link">&para;</a></h4>
<p>@IT-Guy-1973<br />
see in default.conf the section about<br />
<code>MIGRATION_MODE recovery during "rear recover"</code><br />
how ReaR determines if "Disks are identical"<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L351">https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L351</a><br />
and also the subsequent section about<br />
<code>Resizing partitions in MIGRATION_MODE during "rear recover"</code></p>
<p>You don't have that in your old ReaR 1.17.2 version.<br />
But you really must have that newer and much more fail-safe behaviour.<br />
In particular when you migrate systems.</p>
<p>See the ReaR release notes for some more info<br />
about that newer and much more fail-safe behaviour,<br />
in particular follow the links to some of the scaring issues<br />
that had led to the newer and much more fail-safe behaviour<br />
<a href="https://raw.githubusercontent.com/rear/rear/master/doc/rear-release-notes.txt">https://raw.githubusercontent.com/rear/rear/master/doc/rear-release-notes.txt</a></p>
<p>ReaR version 2.3 has an improved MIGRATION_MODE autodetection<br />
when the disk layout looks ambiguous.</p>
<p>ReaR version 2.4 has major rework and changed default behaviour<br />
how ReaR behaves in migration mode when partitions can or must<br />
be resized to fit on replacement disks with different size.</p>
<p>ReaR version 2.5 has lots of other improvements that are in particular<br />
useful in migration mode i.e. when the replacement system has<br />
non-identical hardware (e.g. <code>MODULES=( 'all_modules' )</code> and<br />
a new config variable <code>GRUB2_INSTALL_DEVICES</code> and so on...).</p>
<p>Newer ReaR will never start the restore without prompting you.<br />
There is always a confirmation dialog with 30 seconds timeout, cf.<br />
<a href="https://github.com/rear/rear/issues/1271#issuecomment-346788244">https://github.com/rear/rear/issues/1271#issuecomment-346788244</a>
and<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/layout/prepare/default/250_compare_disks.sh#L136">https://github.com/rear/rear/blob/master/usr/share/rear/layout/prepare/default/250_compare_disks.sh#L136</a><br />
Only if you do nothing it will start the restore after the timeout.<br />
This is to be backward compatible with automated restore behaviour.</p>
<p>Note that resizing only happens for plain disk partitions<br />
but not for higher level storage objects like logical volumes.<br />
So in general when you have things like LVs it is recommended<br />
to recreate the system without resizing - or you need to manually<br />
and carefully adapt all the related values in disklayout.conf.</p>
<p>Furthermore see the section<br />
"Testing current ReaR upstream GitHub master code" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>Or just better:<br />
Complelety read through that whole long "SDB:Disaster Recovery"
article<br />
(you may leave out YaST and other SUSE specific things ;-)</p>
<h4 id="it-guy-1973_commented_at_2020-04-17_0425"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-615033744">2020-04-17 04:25</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-17_0425" title="Permanent link">&para;</a></h4>
<p>Hello @jsmeix ,<br />
Thank you as always.</p>
<p>I updated the rear to v2.4.</p>
<p>The first thing I noticed with the new version is that it does not
prompt for the network card. The IP is already there of the source
system.</p>
<p>One reason to use REAR for us is to upgrade systems by building another
system. Therefore, we need to restore the system onto another system
while the source system is in production. We cannot afford to have an IP
conflict. Luckily the v2.4 of REAR stops at the prompt. I changed the
original IP that was there with REAR to a different IP so that no IP
conflict happens.</p>
<p>The other option that I am looking for is the list of disks or file
systems that I could select for the restore. We almost all of the time
need only the root disk to be restored. The root disk would be about 30
GB. We have databases on other disks that run to TB's and we should not
restore those with REAR. I do not see the option presented in REAR with
Networker. How can I select what disks o file systems to restore?
Because Networker anyway backs up everything and I cannot stop Networker
from backing all the mounted file systems. How can we select what to
restore when restoring through REAR v2.4?</p>
<p>Thank you,<br />
Regards,<br />
Niranjan</p>
<h4 id="hpannenb_commented_at_2020-04-17_0746"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-615097790">2020-04-17 07:46</a>:<a class="headerlink" href="#hpannenb_commented_at_2020-04-17_0746" title="Permanent link">&para;</a></h4>
<p>Hi @IT-Guy-1973.</p>
<p>Within Legato Networker configuration there are IMHO possibilities to
exclude files/directories based on patterns and wildcards (IMHO named
backup directives) or determine the backup filesystems in the saveset.
So it is - as @gdha pointed to - always the responsibility of the
EXTERNAL backup tool what files will be recovered to the system.<br />
ReaR's part is to "prepare" the to be recovered system to its initial
state (i.e. setup IPs, partitions, filesystems, start the required
daemons etc) and thereafter starts i.e. the EXTERNAL recovery or waits
for the EXTERNAL recovery to do its part. What is included or not is up
to the EXTERNAL backup/recovery tool only.</p>
<p>Cheers,<br />
Holger.</p>
<h4 id="jsmeix_commented_at_2020-04-17_1014"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-615165302">2020-04-17 10:14</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-17_1014" title="Permanent link">&para;</a></h4>
<p>@IT-Guy-1973<br />
regarding</p>
<pre><code>we need to restore the system onto another system
while the source system is in production.
We cannot afford to have an IP conflict.
</code></pre>
<p>see "Some general information FYI" in<br />
<a href="https://github.com/rear/rear/issues/2355#issuecomment-611408518">https://github.com/rear/rear/issues/2355#issuecomment-611408518</a></p>
<p>Additionally see</p>
<pre><code>In general regarding "changing IP address" and ReaR
there are two different things
</code></pre>
<p>in<br />
<a href="https://github.com/rear/rear/issues/2344#issuecomment-601132633">https://github.com/rear/rear/issues/2344#issuecomment-601132633</a></p>
<h4 id="jsmeix_commented_at_2020-04-17_1023"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-615169126">2020-04-17 10:23</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-17_1023" title="Permanent link">&para;</a></h4>
<p>@IT-Guy-1973<br />
regarding</p>
<pre><code>The other option that I am looking for is the list of disks
or file systems that I could select for the restore
</code></pre>
<p>Offhandedly I think the currently best way to do that is<br />
to manually adapt disklayout.conf as you need it<br />
before you run "rear recover"<br />
or<br />
enforce MIGRATION_MODE and manually adapt disklayout.conf<br />
at the matching dialog that appears while running "rear recover"<br />
or<br />
use RECOVERY_UPDATE_URL (cf. below).</p>
<p>What is currently not well supported in ReaR is that the user can<br />
specify exactly what he wants to get included in disklayout.conf<br />
during "rear mkrescue/mkbackup", see<br />
<a href="https://github.com/rear/rear/issues/2229">https://github.com/rear/rear/issues/2229</a></p>
<p>In general regarding system migration with ReaR see<br />
<a href="https://github.com/rear/rear/issues/2339#issuecomment-598067616">https://github.com/rear/rear/issues/2339#issuecomment-598067616</a><br />
and follow the links therein in particular see<br />
<a href="http://lists.relax-and-recover.org/pipermail/rear-users/2018-November/003626.html">http://lists.relax-and-recover.org/pipermail/rear-users/2018-November/003626.html</a><br />
and also follow the links therein in particular read through<br />
<a href="https://github.com/rear/rear/issues/943">https://github.com/rear/rear/issues/943</a><br />
which is a bit older so some things are a bit different now<br />
(e.g. RECOVERY_UPDATE is now called RECOVERY_UPDATE_URL)<br />
but the general topics therein are still relevant, in particular see<br />
<a href="https://github.com/rear/rear/issues/943#issuecomment-237544630">https://github.com/rear/rear/issues/943#issuecomment-237544630</a><br />
how certain directories are different in the ReaR recovery system<br />
when you run usr/sbin/rear from within a sub-directory<br />
e.g. when you try out a GitHub clone via<br />
"Testing current ReaR upstream GitHub master code" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<h4 id="jsmeix_commented_at_2020-04-17_1116"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-615189592">2020-04-17 11:16</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-17_1116" title="Permanent link">&para;</a></h4>
<p>Only as a side note FYI about my "future dream"<br />
you may have a look at<br />
<a href="https://github.com/rear/rear/issues/1085">https://github.com/rear/rear/issues/1085</a><br />
that got a child BACKUP=YUM which already has grown up<br />
bigger than its parent BACKUP=ZYPPER still is, see also<br />
<a href="https://github.com/rear/rear/blob/master/doc/user-guide/14-ZYPPER-and-YUM.adoc">https://github.com/rear/rear/blob/master/doc/user-guide/14-ZYPPER-and-YUM.adoc</a></p>
<h4 id="it-guy-1973_commented_at_2020-04-17_1243"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-615223294">2020-04-17 12:43</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-17_1243" title="Permanent link">&para;</a></h4>
<p>@hpannenb</p>
<p>Hello Holger,</p>
<p>Thank you.</p>
<p>Our systems would normally have a "rootvg" volume group and then data
volume groups that include files systems related to applications and/or
databases. All file systems are backed up by Networker. The goal is to
recover any file or file system if needed.</p>
<p>As a system admin I may have to recover only the rootvg. So I will have
a system where many disks are attached and the ISO image from REAR is
mounted. I boot off the ISO image and when I run "rear recover" I should
ONLY restore everything in rootvg and NOTHING in datavgs.</p>
<p>Can I use this parameter to do it with REAR?</p>
<p>ONLY_INCLUDE_VG=()</p>
<p>Networker will have all the data backed up as their job is to take care
of any data on that system.</p>
<p>Regards,<br />
Niranjan</p>
<h4 id="jsmeix_commented_at_2020-04-17_1308"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-615234342">2020-04-17 13:08</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-17_1308" title="Permanent link">&para;</a></h4>
<p>@IT-Guy-1973<br />
FYI a general method how to get an idea for what a particular<br />
ReaR config variable is actually used:</p>
<pre><code># find usr/share/rear -type f | xargs grep 'ONLY_INCLUDE_VG'

usr/share/rear/conf/default.conf:
# syntax : e.g. ONLY_INCLUDE_VG=( "vg00" "vg01" )
ONLY_INCLUDE_VG=()

usr/share/rear/conf/examples/borg-example.conf:
ONLY_INCLUDE_VG=( "vg00" )

usr/share/rear/conf/examples/RHEL7-ISO-Oracle-example.conf:
#ONLY_INCLUDE_VG=( "vg00" )

usr/share/rear/layout/save/default/310_include_exclude.sh:
if [ ${#ONLY_INCLUDE_VG[@]} -gt 0 ] ; then

usr/share/rear/layout/save/default/310_include_exclude.sh:
        if ! IsInArray "${name#/dev/}" "${ONLY_INCLUDE_VG[@]}" ; then

usr/share/rear/layout/save/default/335_remove_excluded_multipath_vgs.sh:
# If AUTOEXCLUDE_MULTIPATH=n is used in combination with ONLY_INCLUDE_VG or
    # to further investigate if EXCLUDE_VG or ONLY_INCLUDE_VG was respected for multipath devices:
</code></pre>
<p>So there is no code about ONLY_INCLUDE_VG<br />
that is related to Legato Networker i.e. <code>BACKUP=NSR</code><br />
i.e. no file with <code>/NSR/</code> in its path.</p>
<p>Accordingly it seems ONLY_INCLUDE_VG is only used<br />
for what gets included in disklayout.conf<br />
but what is included in the Legato Networker backup<br />
seems to be totally unrelated to that - in particular because<br />
there is no code in ReaR that makes a Legato Networker backup<br />
(there is no usr/share/rear/backup/NSR/ directory).</p>
<p>Therefore I think if your Legato Networker backup contains<br />
for example all files of all VGs or LVs of a system<br />
but you use ONLY_INCLUDE_VG to only get the<br />
"rootvg" volume group included in disklayout.conf then<br />
I would assume you get by "rear recover" a disk layout<br />
recreated that contains only the "rootvg" volume group and<br />
when then the full-system Legato Networker backup gets restored<br />
you get all the files restored into the "rootvg" volume group.<br />
But that is only what I imagine off the top of my head.<br />
I am not a Legato Networker user.<br />
I don't use third-party backup tools (no time for that)<br />
and in particular I cannot use proprietary backup tools.</p>
<h4 id="it-guy-1973_commented_at_2020-04-17_1328"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-615244001">2020-04-17 13:28</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-17_1328" title="Permanent link">&para;</a></h4>
<p>Hello @jsmeix ,</p>
<p>Thank you for your reply above regarding the "ONLY_INCLUDE_VG". I was
thinking of it in terms of restore. Like in - only include vgxx when
restoring. But as you pointed out this parameter is not related to NSR.</p>
<p>Also, I am still going through your earlier responses to my question.</p>
<p>It looks like the options I have is to edit the disk layout files during
restore. But let me carefully read all you posted here before I raise
another question.</p>
<p>Thank you,<br />
Regards,<br />
Niranjan</p>
<h4 id="it-guy-1973_commented_at_2020-04-17_1739"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-615375965">2020-04-17 17:39</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-17_1739" title="Permanent link">&para;</a></h4>
<p>Hello @jsmeix ,</p>
<p>When using Networker with REAR there is absolutely no way to control
what is restored on the VM. With REAR you can select what disks you want
etc ... But when the restore happens it is going to restore everything
Networker backed up.</p>
<p>Example: I have a volume group on disk "/dev/sdb" named nmonvg and a
file system in it name /nmon_data. If I disable the "/dev/sdb" using
REAR the "/nmon_data" will anyway get restored on a directory under /.</p>
<p>@jsmeix Let me know if my understanding of this is correct.</p>
<p>Regards,<br />
Niranjan</p>
<h4 id="it-guy-1973_commented_at_2020-04-18_2010"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-615937532">2020-04-18 20:10</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-18_2010" title="Permanent link">&para;</a></h4>
<blockquote>
<p>Hi @IT-Guy-1973.</p>
<p>Within Legato Networker configuration there are IMHO possibilities to
exclude files/directories based on patterns and wildcards (IMHO named
backup directives) or determine the backup filesystems in the saveset.
So it is - as @gdha pointed to - always the responsibility of the
EXTERNAL backup tool what files will be recovered to the system.<br />
ReaR's part is to "prepare" the to be recovered system to its initial
state (i.e. setup IPs, partitions, filesystems, start the required
daemons etc) and thereafter starts i.e. the EXTERNAL recovery or waits
for the EXTERNAL recovery to do its part. What is included or not is
up to the EXTERNAL backup/recovery tool only.</p>
<p>Cheers,<br />
Holger.</p>
</blockquote>
<p>Yes, you are absolutely correct. I tried to change what needs to be
restored but that cannot be done. Even if I change the disk layout
hoping it will not restore certain volume groups the restore happens on
the rootvg as directories.</p>
<p>Regards,<br />
Niranjan</p>
<h4 id="hpannenb_commented_at_2020-04-19_0758"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-616070604">2020-04-19 07:58</a>:<a class="headerlink" href="#hpannenb_commented_at_2020-04-19_0758" title="Permanent link">&para;</a></h4>
<p>Hi, @IT-Guy-1973.</p>
<p>In my use case EMC Networker backups all data of a (single) server. The
setup backups the dedicated filesystems /, /var/log, etc. instead of
ALL. Furthermore it is possible to exclude all unwanted data i.e. the
database files of a MySQL in /data/mysqldata/ or all logfiles in
/var/log/ and so on.</p>
<p>When it comes to a disaster recovery ReaR prepares my (single) server
with all required filesystems and afterwards EMC Networker is triggered
to restore all the backuped files into them.</p>
<p>Using NSR_CLIENT_MODE=YES it is possible to i.e. execute EMC
Networker's "recovery" tool manually to recover data of dedicated
filessystems or manually select all the data required.
NSR_CLIENT_MODE=YES waits until someone recovered the data with EMC
Networker.</p>
<p>Regards,<br />
Holger.</p>
<h4 id="it-guy-1973_commented_at_2020-04-19_1708"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-616184642">2020-04-19 17:08</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-19_1708" title="Permanent link">&para;</a></h4>
<p>Hello @hpannenb ,</p>
<p>I added NSR_CLIENT_MODE=YES to the site.conf file. Now, as you mention
correctly the restore stops at the "rear&gt;" prompt.</p>
<p>At this point do I need to inform the backup team to initiate a restore
from their end or can I run the "recover" command at my end to perform
the restore?</p>
<p>I have 3 file systems on this system.<br />
/, /boot and /nmon_data</p>
<p>I need to avoid installing /nmon_data. I only need / and /boot only.</p>
<p>On the restore system I see:</p>
<p>/mnt/local/<br />
/mnt/local/boot/</p>
<p>file systems.</p>
<p>I am not very familiar with NSR commands. Please let me know what I need
to do at this point.</p>
<p>Thank you,<br />
Regards,<br />
Niranjan</p>
<h4 id="hpannenb_commented_at_2020-04-20_0700"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-616351064">2020-04-20 07:00</a>:<a class="headerlink" href="#hpannenb_commented_at_2020-04-20_0700" title="Permanent link">&para;</a></h4>
<p>Hi, @IT-Guy-1973</p>
<p>You can handle it as You prefer. Either execute the recovery on Your own
or with the help of Your backup team.</p>
<p>Quiet some time ago I found the required EMC Networker commands at this
page <a href="http://www.ipnom.com/Legato-NetWorker-Commands/">here</a>. You can
look for "recover".</p>
<p>With this and the knowledge from the ReaR sources in
<a href="https://github.com/rear/rear/blob/c5f61051d017b20149041f9376d549e3d311af4c/usr/share/rear/restore/NSR/default/400_restore_with_nsr.sh#L26">https://github.com/rear/rear/blob/c5f61051d017b20149041f9376d549e3d311af4c/usr/share/rear/restore/NSR/default/400_restore_with_nsr.sh#L26</a>
you should be able to (batch) recover the required filesystems i.e.in
Your case with</p>
<pre><code>export VAR_DIR=/var/lib/rear/
recover -s $(cat $VAR_DIR/recovery/nsr_server) -c $(hostname) -d /mnt/local -a / /boot
</code></pre>
<p>I propose You check Your backup strategy if <code>/nmon_data</code> needs to be
backed up for each of the nodes or if it is of no use for a the generic
recovery. It might also be required the filesystem exists so check if
You really need to exclude it in the ReaR config or exclude it in the
external backup tool EMC Networker.</p>
<p>Sincerely,<br />
Holger.</p>
<h4 id="it-guy-1973_commented_at_2020-04-23_0423"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-618168942">2020-04-23 04:23</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-23_0423" title="Permanent link">&para;</a></h4>
<p>Hello @hpannenb ,</p>
<p>Thank you for the information. I have not tried this yet. But hopefully,
I will try this tomorrow. Thank you for sharing the Networker
command-line help page as well. Networker commands are pretty hard to
assemble.</p>
<p>Regards,<br />
Niranjan</p>
<h4 id="it-guy-1973_commented_at_2020-04-23_1602"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-618486347">2020-04-23 16:02</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-23_1602" title="Permanent link">&para;</a></h4>
<p>Hello @hpannenb ,</p>
<p>I ran the commands you had provided. I had to manually add the hostname
and the Networker server name. It worked. However, I did not see the
boot image been created at the end. It is at the "rear&gt;" prompt now
after the restore.</p>
<p>Do I need to run any manual commands at this point to get the boot image
created before I reboot the newly restored system? Please see the
attachment.</p>
<p><img alt="recover" src="https://user-images.githubusercontent.com/63385995/80121427-23e80c80-8541-11ea-96aa-e9eefa73bbe5.JPG" /><br />
@jsmeix @hpannenb</p>
<h4 id="hpannenb_commented_at_2020-04-24_0642"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-618832671">2020-04-24 06:42</a>:<a class="headerlink" href="#hpannenb_commented_at_2020-04-24_0642" title="Permanent link">&para;</a></h4>
<p>Hi, @IT-Guy-1973.</p>
<p>You should have seen a prompt beforehand</p>
<pre><code>Please let the restore process start on Your backup server i.e. $(cat $VAR_DIR/recovery/nsr_server).
Make sure all required data is restored to /mnt/local .

When the restore is finished type 'exit' to continue the recovery.
Info: You can check the recovery process i.e. with the command 'df'.
</code></pre>
<p>I suppose at the prompt You entered the "recover" command. When Your
manual EMC recovery has been completed type "exit"(+ENTER) to continue
the restore process.</p>
<p>Regards,<br />
Holger.</p>
<h4 id="it-guy-1973_commented_at_2020-04-29_1421"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-621243091">2020-04-29 14:21</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-29_1421" title="Permanent link">&para;</a></h4>
<p>@hpannenb Thank you for your valuable input. It all worked perfectly! I
did restore multiple times to get a feel of the process.</p>
<p>Thank you again,<br />
Regards,<br />
Niranjan</p>
<h4 id="jsmeix_commented_at_2020-04-29_1425"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-621245915">2020-04-29 14:25</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-29_1425" title="Permanent link">&para;</a></h4>
<p>@IT-Guy-1973<br />
can I conclude from your<br />
<a href="https://github.com/rear/rear/issues/2367#issuecomment-621243091">https://github.com/rear/rear/issues/2367#issuecomment-621243091</a><br />
that this issue which is primarily about NETWORKER backup usage<br />
is now sufficiently solved for you?</p>
<h4 id="it-guy-1973_commented_at_2020-04-30_0201"><img src="https://avatars.githubusercontent.com/u/63385995?v=4" width="50"><a href="https://github.com/IT-Guy-1973">IT-Guy-1973</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-621567487">2020-04-30 02:01</a>:<a class="headerlink" href="#it-guy-1973_commented_at_2020-04-30_0201" title="Permanent link">&para;</a></h4>
<p>@jsmeix Yes sir, you can. I also like to thank you for providing me with
answers to the questions that I have raised with this request as well as
other requests in the past.</p>
<p>Regards,<br />
Niranjan</p>
<h4 id="jsmeix_commented_at_2020-04-30_0852"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2367#issuecomment-621703431">2020-04-30 08:52</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-04-30_0852" title="Permanent link">&para;</a></h4>
<p>@IT-Guy-1973<br />
thank you for your positive feedback!</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2020-04-15.2367.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
