<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2545 Issue closed: grub menu does not contain rear -option although site.conf contains GRUB_RESCUE=y - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2545 Issue closed: grub menu does not contain rear -option although site.conf contains GRUB_RESCUE=y";
        var mkdocs_page_input_path = "issues/2020-12-16.2545.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2545 Issue closed: grub menu does not contain rear -option although site.conf contains GRUB_RESCUE=y</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2545_issue_closed_grub_menu_does_not_contain_rear_-option_although_siteconf_contains_grub_rescuey"><a href="https://github.com/rear/rear/issues/2545">#2545 Issue</a> <code>closed</code>: grub menu does not contain rear -option although site.conf contains GRUB_RESCUE=y<a class="headerlink" href="#2545_issue_closed_grub_menu_does_not_contain_rear_-option_although_siteconf_contains_grub_rescuey" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>support / question</code>, <code>needs sponsorship</code>,
<code>no-issue-activity</code></p>
<h4 id="jk-10_opened_issue_at_2020-12-16_1957"><img src="https://avatars.githubusercontent.com/u/61633779?v=4" width="50"><a href="https://github.com/jk-10">jk-10</a> opened issue at <a href="https://github.com/rear/rear/issues/2545">2020-12-16 19:57</a>:<a class="headerlink" href="#jk-10_opened_issue_at_2020-12-16_1957" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>ReaR version ("/usr/sbin/rear -V"):</li>
</ul>
<!-- -->

<pre><code>Relax-and-Recover 2.6-git.4230.80821448.master / 2020-12-10
</code></pre>
<ul>
<li>OS version ("cat /etc/os-release" or "lsb_release -a" or "cat
    /etc/rear/os.conf"):</li>
</ul>
<!-- -->

<pre><code>No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 20.04.1 LTS
Release:    20.04
Codename:   focal
</code></pre>
<ul>
<li>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):</li>
</ul>
<!-- -->

<pre><code>cat /etc/rear/local.conf 
# This file etc/rear/local.conf is intended for the user's
# manual configuration of Relax-and-Recover (ReaR).
# For configuration through packages and other automated means
# we recommend a separated file named site.conf next to this file
# and leave local.conf as is (ReaR upstream will never ship a site.conf).
# The default OUTPUT=ISO creates the ReaR rescue medium as ISO image.
# You need to specify your particular backup and restore method for your data
# as the default BACKUP=REQUESTRESTORE does not really do that (see "man rear").
# Configuration variables are documented in /usr/share/rear/conf/default.conf
# and the examples in /usr/share/rear/conf/examples/ can be used as templates.
# ReaR reads the configuration files via the bash builtin command 'source'
# so bash syntax like VARIABLE="value" (no spaces at '=') is mandatory.
# Because 'source' executes the content as bash scripts you can run commands
# within your configuration files, in particular commands to set different
# configuration values depending on certain conditions as you need like
# CONDITION_COMMAND &amp;&amp; VARIABLE="special_value" || VARIABLE="usual_value"
# but that means CONDITION_COMMAND gets always executed when 'rear' is run
# so ensure nothing can go wrong if you run commands in configuration files.

cat /etc/rear/site.conf
#
# This is ReaR site specific conf file.
#

# Defaults in use: page 4
#
# OUTPUT=ISO
#
# BACKUP=REQUESTRESTORE

# Required progs, page 15
REQUIRED_PROGS+=('tree' 'mc' 'lynx')

# Copy as is, ~/bin2/borg is standalone version, page 16
COPY_AS_IS+=("/etc/dskcnf" "/home/jk/bin" "/home/jk/Documents/system" "/home/jk/bin2/borg")

# Trusted file owners, page 17
TRUSTED_FILE_OWNERS+=( 'jk' )

# Clone users, groups, page 18
CLONE_USERS+=( 'jk' )
CLONE_GROUPS+=( 'jk' )

# Keep build dir for checking build contents, page 19
KEEP_BUILD_DIR="yes"

# Time synchronisation, could be NTP, CHRONY, NTPDATE, RDATE or empty: page 20
TIMESYNC=NTP

# Only include VG, page 32
ONLY_INCLUDE_VG=( "vg0" )

# Autoexclude filesystems
AUTOEXCLUDE_PATH=( /media /mnt /home/jk )

# GRUB rescue, page 34
GRUB_RESCUE=y
</code></pre>
<ul>
<li>Hardware (PC or PowerNV BareMetal or ARM) or virtual machine (KVM
    guest or PoverVM LPAR):</li>
</ul>
<!-- -->

<pre><code>inxi -Fxz
System:    Kernel: 5.4.0-58-generic x86_64 bits: 64 compiler: gcc v: 9.3.0 Desktop: MATE 1.24.0 
           Distro: Ubuntu 20.04.1 LTS (Focal Fossa) 
Machine:   Type: Mini-pc System: Intel Client Systems product: NUC7PJYH v: J67992-403 serial: &lt;filter&gt; 
           Mobo: Intel model: NUC7JYB v: J67969-403 serial: &lt;filter&gt; UEFI: Intel v: JYGLKCPX.86A.0050.2019.0418.1441 
           date: 04/18/2019 
CPU:       Topology: Quad Core model: Intel Pentium Silver J5005 bits: 64 type: MCP arch: Goldmont Plus rev: 1 
           L2 cache: 4096 KiB 
           flags: lm nx pae sse sse2 sse3 sse4_1 sse4_2 ssse3 vmx bogomips: 11980 
           Speed: 1472 MHz min/max: 800/2800 MHz Core speeds (MHz): 1: 1208 2: 1227 3: 1219 4: 1199 
Graphics:  Device-1: Intel UHD Graphics 605 driver: i915 v: kernel bus ID: 00:02.0 
           Display: server: X.Org 1.20.8 driver: modesetting unloaded: fbdev,vesa resolution: 1600x1200~60Hz 
           OpenGL: renderer: Mesa Intel UHD Graphics 605 (GLK 3) v: 4.6 Mesa 20.0.8 direct render: Yes 
Audio:     Device-1: Intel driver: snd_hda_intel v: kernel bus ID: 00:0e.0 
           Sound Server: ALSA v: k5.4.0-58-generic 
Network:   Device-1: Intel driver: iwlwifi v: kernel port: f000 bus ID: 00:0c.0 
           IF: wlo2 state: down mac: &lt;filter&gt; 
           Device-2: Realtek RTL8111/8168/8411 PCI Express Gigabit Ethernet vendor: Intel driver: r8169 v: kernel port: e000 
           bus ID: 02:00.0 
           IF: eno1 state: up speed: 1000 Mbps duplex: full mac: &lt;filter&gt; 
           IF-ID-1: docker0 state: down mac: &lt;filter&gt; 
Drives:    Local Storage: total: 10.92 TiB used: 252.42 GiB (2.3%) 
           ID-1: /dev/sda type: USB model: 1WDC WD3001FFSX-68JNUN0 DB987654321138D size: 2.73 TiB 
           ID-2: /dev/sdb vendor: Western Digital model: WDS100T2G0A-00JH30 size: 931.52 GiB temp: 38 C 
           ID-3: /dev/sdc type: USB vendor: Western Digital model: WD My Book 25EE size: 7.28 TiB 
Partition: ID-1: / size: 894.72 GiB used: 251.83 GiB (28.1%) fs: ext4 dev: /dev/dm-0 
           ID-2: /boot size: 968.3 MiB used: 586.7 MiB (60.6%) fs: ext4 dev: /dev/sdb2 
Sensors:   System Temperatures: cpu: 43.0 C mobo: N/A 
           Fan Speeds (RPM): N/A 
Info:      Processes: 280 Uptime: 32m Memory: 15.23 GiB used: 6.92 GiB (45.4%) Init: systemd runlevel: 5 Compilers: gcc: 9.3.0 
           Shell: bash v: 5.0.17 inxi: 3.0.38
</code></pre>
<ul>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device): x86_64</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot): UEFI, GRUB</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe): /boot and / stored on local SSD</p>
</li>
<li>
<p>Storage layout ("lsblk -ipo
    NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT" or "lsblk" as
    makeshift):</p>
</li>
</ul>
<!-- -->

<pre><code>lsblk -ipo NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT
NAME                    KNAME      PKNAME    TRAN   TYPE FSTYPE        SIZE MOUNTPOINT
/dev/loop0              /dev/loop0                  loop squashfs     97,8M /snap/core/10185
/dev/loop1              /dev/loop1                  loop squashfs     97,9M /snap/core/10444
/dev/loop2              /dev/loop2                  loop squashfs     55,4M /snap/core18/1944
/dev/loop3              /dev/loop3                  loop squashfs     55,4M /snap/core18/1932
/dev/loop4              /dev/loop4                  loop squashfs     31,1M /snap/snapd/10238
/dev/loop5              /dev/loop5                  loop squashfs    125,9M /snap/docker/471
/dev/loop6              /dev/loop6                  loop squashfs     31,1M /snap/snapd/10492
/dev/loop7              /dev/loop7                  loop squashfs     70,6M /snap/lxd/16922
/dev/loop8              /dev/loop8                  loop squashfs     67,8M /snap/lxd/18150
/dev/sda                /dev/sda             usb    disk crypto_LUKS   2,7T 
/dev/sdb                /dev/sdb             sata   disk             931,5G 
|-/dev/sdb1             /dev/sdb1  /dev/sdb         part vfat          512M /boot/efi
|-/dev/sdb2             /dev/sdb2  /dev/sdb         part ext4         1000M /boot
`-/dev/sdb3             /dev/sdb3  /dev/sdb         part LVM2_member   930G 
  `-/dev/mapper/vg0-lv0 /dev/dm-0  /dev/sdb3        lvm  ext4          910G /
/dev/sdc                /dev/sdc             usb    disk               7,3T 
`-/dev/sdc1             /dev/sdc1  /dev/sdc         part crypto_LUKS   7,3T
</code></pre>
<ul>
<li>Description of the issue (ideally so that others can reproduce it):</li>
</ul>
<!-- -->

<pre><code>1) install rear, create /etc/rear/site.conf with GRUB_RESCUE=y setting.
2) run sudo -v mkrescue (output and log in attachments)
3) boot and try to select rear from grub menu
</code></pre>
<p>Grub menu does not contain rear -option. When I compare this machine's
/etc/grub.d contents to another<br />
Ubuntu 20 machine's installation where rear is also installed with
GRUB_RESCUE=y setting,<br />
I noticed that in this machine there is no /etc/grub.d/45_rear -file or
any other rear files in /etc/grub.d.</p>
<ul>
<li>
<p>Workaround, if any: Unfortunately none found so far.</p>
</li>
<li>
<p>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files):<br />
<a href="https://github.com/rear/rear/files/5705172/rear-mkrescue-stdout.txt">rear-mkrescue-stdout.txt</a><br />
<a href="https://github.com/rear/rear/files/5705179/rear-mkrescue.log">rear-mkrescue.log</a></p>
</li>
</ul>
<h4 id="gdha_commented_at_2021-01-08_1102"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2545#issuecomment-756694967">2021-01-08 11:02</a>:<a class="headerlink" href="#gdha_commented_at_2021-01-08_1102" title="Permanent link">&para;</a></h4>
<p>@jk-10 The grub2 entry should be created via script:</p>
<pre><code>2020-12-16 20:16:58.150029606 Including output/default/940_grub2_rescue.sh
2020-12-16 20:16:58.155222676 Setting up GRUB_RESCUE: Adding Relax-and-Recover rescue system to the local GRUB 2 configuration.
2020-12-16 20:16:58.859947262 GRUB2 modules to load: ext2 fat part_gpt
2020-12-16 20:17:20.555943143 Finished GRUB_RESCUE setup: Added 'Relax-and-Recover' GRUB 2 menu entry.
</code></pre>
<p>To really know what happens over there re-run rear in debug mode - see
the man-page for more help.</p>
<h4 id="captainredhat_commented_at_2021-03-02_1848"><img src="https://avatars.githubusercontent.com/u/16484341?v=4" width="50"><a href="https://github.com/CaptainRedHat">CaptainRedHat</a> commented at <a href="https://github.com/rear/rear/issues/2545#issuecomment-789130751">2021-03-02 18:48</a>:<a class="headerlink" href="#captainredhat_commented_at_2021-03-02_1848" title="Permanent link">&para;</a></h4>
<p>I'm also having this same issue on Ubuntu 20.04.2 LTS. I'm on rear
version 2.5 / Git installed from the ubuntu software repositories.</p>
<p>Here's the debug log and my site.conf:
<a href="https://gist.github.com/CaptainRedHat/5a2bc4ba54c09601345634203bf8778a">https://gist.github.com/CaptainRedHat/5a2bc4ba54c09601345634203bf8778a</a></p>
<h4 id="jsmeix_commented_at_2021-03-04_1501"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2545#issuecomment-790680834">2021-03-04 15:01</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-03-04_1501" title="Permanent link">&para;</a></h4>
<p>@CaptainRedHat<br />
your<br />
<a href="https://gist.githubusercontent.com/CaptainRedHat/5a2bc4ba54c09601345634203bf8778a/raw/55051d7525a9f923dfe3e4641e91c2038b0869e6/rear-debug-log-03-02-2021-1239.log">https://gist.githubusercontent.com/CaptainRedHat/5a2bc4ba54c09601345634203bf8778a/raw/55051d7525a9f923dfe3e4641e91c2038b0869e6/rear-debug-log-03-02-2021-1239.log</a><br />
contains only</p>
<pre><code>2021-03-02 18:41:36.417777569 Including output/default/940_grub2_rescue.sh
2021-03-02 18:41:36.424064713 Setting up GRUB_RESCUE: Adding Relax-and-Recover rescue system to the local GRUB 2 configuration.
'/tmp/rear.5RyhPHQV567cZPu/tmp/initrd.cgz' -&gt; '/boot/rear-initrd.cgz'
2021-03-02 18:41:36.905450908 Finished GRUB_RESCUE setup: Added 'Relax-and-Recover' GRUB 2 menu entry.
</code></pre>
<p>which does not tell the needed details what goes on while this script
runs.</p>
<p>What we would need to debug issues is what is asked for in<br />
<a href="https://github.com/rear/rear/blob/master/.github/ISSUE_TEMPLATE.md">https://github.com/rear/rear/blob/master/.github/ISSUE_TEMPLATE.md</a><br />
that reads (excerpt)</p>
<pre><code>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover" debug log files):
</code></pre>
<p>i.e. the full debugscript mode via <code>-D</code> not only the normal debug mode
via <code>-d</code>.</p>
<p>See also the section<br />
"Debugging issues with Relax-and-Recover" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<h4 id="captainredhat_commented_at_2021-03-04_1624"><img src="https://avatars.githubusercontent.com/u/16484341?v=4" width="50"><a href="https://github.com/CaptainRedHat">CaptainRedHat</a> commented at <a href="https://github.com/rear/rear/issues/2545#issuecomment-790742632">2021-03-04 16:24</a>:<a class="headerlink" href="#captainredhat_commented_at_2021-03-04_1624" title="Permanent link">&para;</a></h4>
<p>Oh sorry, I wasn't sure what all you needed since I didn't open the
issue. Here you go:</p>
<p>ReaR version ("/usr/sbin/rear -V"): Relax-and-Recover 2.6 / 2020-06-17</p>
<p>OS version ("cat /etc/os-release" or "lsb_release -a" or "cat
/etc/rear/os.conf"):</p>
<pre><code>No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 20.04.2 LTS
Release:    20.04
Codename:   focal
</code></pre>
<p>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
/etc/rear/local.conf"):</p>
<pre><code>OUTPUT=ISO
BACKUP=NETFS
BACKUP_URL="nfs://192.168.100.105/data/backups"
GRUB_RESCUE=1
BACKUP_TYPE=incremental
FULLBACKUPDAY="Sun"
</code></pre>
<p>Hardware (PC or PowerNV BareMetal or ARM) or virtual machine (KVM guest
or PoverVM LPAR): Hardware: Intel PC</p>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact ARM
device): x86_64</p>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or ELILO
or Petitboot): UEFI / GRUB2, version 2.04-1ubuntu26.9</p>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
multipath (DM or NVMe): NVMe SSD</p>
<p>Storage layout ("lsblk -ipo
NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT" or "lsblk" as
makeshift):</p>
<pre><code>NAME                        KNAME         PKNAME        TRAN   TYPE FSTYPE   SIZE MOUNTPOINT
/dev/sda                    /dev/sda                    sata   disk          1.8T 
`-/dev/sda1                 /dev/sda1     /dev/sda             part LVM2_m   1.8T 
  `-/dev/mapper/vgdata-lvol1
                            /dev/dm-1     /dev/sda1            lvm  xfs      1.8T /opt/docker
/dev/nvme0n1                /dev/nvme0n1                nvme   disk        238.5G 
|-/dev/nvme0n1p1            /dev/nvme0n1p1
|                                         /dev/nvme0n1  nvme   part vfat     512M /boot/efi
|-/dev/nvme0n1p2            /dev/nvme0n1p2
|                                         /dev/nvme0n1  nvme   part ext4       1G /boot
`-/dev/nvme0n1p3            /dev/nvme0n1p3
                                          /dev/nvme0n1  nvme   part LVM2_m   237G 
  `-/dev/mapper/vgsys00-lvol1
                            /dev/dm-0     /dev/nvme0n1p3
                                                               lvm  ext4     237G /
</code></pre>
<p>Description of the issue (ideally so that others can reproduce it): Grub
menu doesn't contain rear entry although site.conf contains
GRUB_RESCUE=1</p>
<p>Workaround, if any: N/A</p>
<p>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover" debug
log files):
<a href="https://github.com/rear/rear/files/6085127/rear-umadbro.log">rear-umadbro.log</a></p>
<h4 id="github-actions_commented_at_2021-05-04_0225"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2545#issuecomment-831648527">2021-05-04 02:25</a>:<a class="headerlink" href="#github-actions_commented_at_2021-05-04_0225" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="gdha_commented_at_2021-05-04_0744"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2545#issuecomment-831746535">2021-05-04 07:44</a>:<a class="headerlink" href="#gdha_commented_at_2021-05-04_0744" title="Permanent link">&para;</a></h4>
<p>@jk-10 The entry has been created and can be found as follow (on
VirtualBox emulation of an Ubuntu20):<br />
<img alt="image" src="https://user-images.githubusercontent.com/888633/116973464-e02ff300-acbc-11eb-9b39-ff774daa3de9.png" /></p>
<p><img alt="image" src="https://user-images.githubusercontent.com/888633/116973536-fe95ee80-acbc-11eb-9bd8-83d183439656.png" /></p>
<p><img alt="image" src="https://user-images.githubusercontent.com/888633/116973613-18cfcc80-acbd-11eb-9682-095460b8cea5.png" /></p>
<h4 id="jsmeix_commented_at_2021-05-04_1025"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2545#issuecomment-831838825">2021-05-04 10:25</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-05-04_1025" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
thank you for your explanatory<br />
<a href="https://github.com/rear/rear/issues/2545#issuecomment-831746535">https://github.com/rear/rear/issues/2545#issuecomment-831746535</a></p>
<p>I think I understand now the root cause of this issue:<br />
I think the root cause are misleading user messages<br />
in case of GRUB_RESCUE setup with UEFI.</p>
<p>In case of GRUB_RESCUE setup with UEFI the LogPrint messages<br />
in output/default/940_grub2_rescue.sh are basically</p>
<pre><code>Setting up GRUB_RESCUE: Adding Relax-and-Recover rescue system to the local GRUB 2 configuration.
...
Finished GRUB_RESCUE setup: Added 'Relax-and-Recover' GRUB 2 menu entry.
</code></pre>
<p>so the user expects a 'Relax-and-Recover' GRUB 2 menu entry<br />
but the <code>UEFI "Relax-and-Recover" boot entry motivation</code> explanation
comment<br />
in output/default/940_grub2_rescue.sh tells</p>
<pre><code>If UEFI boot is in use, we will not modify grub.cfg,
but setup "Relax-and-Recover" entry in UEFI boot menu instead.
</code></pre>
<p><a href="https://github.com/rear/rear/blob/master/usr/share/rear/output/default/940_grub2_rescue.sh">https://github.com/rear/rear/blob/master/usr/share/rear/output/default/940_grub2_rescue.sh</a><br />
so what the user actually gets is no 'Relax-and-Recover' GRUB 2 menu
entry<br />
but a 'Relax-and-Recover' UEFI boot menu entry, see also<br />
<a href="https://github.com/rear/rear/pull/954">https://github.com/rear/rear/pull/954</a></p>
<p>My
<a href="https://github.com/rear/rear/pull/2609">https://github.com/rear/rear/pull/2609</a>
intends to fix that.<br />
@gdha @gozora<br />
I would much appreciate it if you could have a closer look<br />
and ideally review (perhaps even test) my pull request changes.</p>
<h4 id="captainredhat_commented_at_2021-05-08_0616"><img src="https://avatars.githubusercontent.com/u/16484341?v=4" width="50"><a href="https://github.com/CaptainRedHat">CaptainRedHat</a> commented at <a href="https://github.com/rear/rear/issues/2545#issuecomment-835134908">2021-05-08 06:16</a>:<a class="headerlink" href="#captainredhat_commented_at_2021-05-08_0616" title="Permanent link">&para;</a></h4>
<p>Hi,</p>
<p>As a user, I don't understand why you'd add an entry to the UEFI boot
menu and not the grub menu when GRUB_RESCUE=1 is set. GRUB_RESCUE=1
should add an entry to the Grub menu and nothing else. If a user wanted
to add an entry to the UEFI boot menu, then there should be a separate
setting called UEFI_RESCUE=1 or something like that. Additionally, I'd
like to provide a user experience perspective. I have multiple systems,
some running UEFI, while others are old BIOS systems. Trying to keep
track of which are which is hard enough, but when you also add trying to
remember what the boot menu key is on each of those UEFI systems, it
feels like a pretty rough user experience, especially when you're trying
to recover a production system under pressure. From my perspective, it's
a lot easier to just set a grub timeout and be able to select ReaR from
the grub menu, regardless of what hardware the system is running on.
Just my .02.</p>
<h4 id="gdha_commented_at_2021-05-08_0934"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2545#issuecomment-835245235">2021-05-08 09:34</a>:<a class="headerlink" href="#gdha_commented_at_2021-05-08_0934" title="Permanent link">&para;</a></h4>
<p>@CaptainRedHat I tend to agree with your comments, therefore, I've added
the "needs sponsorship" flag. Who has time to pick this one up?</p>
<h4 id="jsmeix_commented_at_2021-05-11_1018"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2545#issuecomment-838218794">2021-05-11 10:18</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-05-11_1018" title="Permanent link">&para;</a></h4>
<p>With
<a href="https://github.com/rear/rear/pull/2609">https://github.com/rear/rear/pull/2609</a>
merged<br />
there is now at least a better description in default.conf<br />
how GRUB_RESCUE with UEFI and GRUB2 currently works<br />
and in output/default/940_grub2_rescue.sh there is better error
checking<br />
plus some alignment with how create_grub2_cfg() creates a GRUB2 config
file.</p>
<h4 id="jsmeix_commented_at_2021-05-11_1034"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2545#issuecomment-838240195">2021-05-11 10:34</a>:<a class="headerlink" href="#jsmeix_commented_at_2021-05-11_1034" title="Permanent link">&para;</a></h4>
<p>@CaptainRedHat<br />
in general regarding what you don't understand read the description<br />
<code>UEFI 'Relax-and-Recover' boot entry motivation</code><br />
in usr/share/rear/output/default/940_grub2_rescue.sh<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/output/default/940_grub2_rescue.sh">https://github.com/rear/rear/blob/master/usr/share/rear/output/default/940_grub2_rescue.sh</a><br />
that explains why</p>
<pre><code>If UEFI boot is in use, we will not modify grub.cfg,
but setup 'Relax-and-Recover' entry in UEFI boot menu instead
</code></pre>
<p>from the point of view who implemented the current code.<br />
We are very grateful for his many various actual contributions to ReaR<br />
(otherwise there would be in particular no GRUB_RESCUE with UEFI).</p>
<p>Now we look forward to your pull request that provides what you ask
for,<br />
cf.
<a href="https://en.wikipedia.org/wiki/Linus%27s_law">https://en.wikipedia.org/wiki/Linus%27s_law</a></p>
<pre><code>Given a large enough beta-tester and co-developer base,
almost every problem will be characterized quickly
and the fix obvious to someone.
</code></pre>
<h4 id="github-actions_commented_at_2021-07-11_0211"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2545#issuecomment-877729845">2021-07-11 02:11</a>:<a class="headerlink" href="#github-actions_commented_at_2021-07-11_0211" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2020-12-16.2545.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
