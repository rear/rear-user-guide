<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1982 Issue closed: alter network config at boot time - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1982 Issue closed: alter network config at boot time";
        var mkdocs_page_input_path = "issues/2018-11-26.1982.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1982 Issue closed: alter network config at boot time</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1982_issue_closed_alter_network_config_at_boot_time"><a href="https://github.com/rear/rear/issues/1982">#1982 Issue</a> <code>closed</code>: alter network config at boot time<a class="headerlink" href="#1982_issue_closed_alter_network_config_at_boot_time" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>documentation</code>, <code>fixed / solved / done</code></p>
<h4 id="dm6079_opened_issue_at_2018-11-26_1651"><img src="https://avatars.githubusercontent.com/u/25588035?v=4" width="50"><a href="https://github.com/dm6079">dm6079</a> opened issue at <a href="https://github.com/rear/rear/issues/1982">2018-11-26 16:51</a>:<a class="headerlink" href="#dm6079_opened_issue_at_2018-11-26_1651" title="Permanent link">&para;</a></h4>
<p>rear version - Relax-and-Recover 2.4 / Git<br />
OS version - Red Hat Enterprise Linux 7.4<br />
source - x86 physical<br />
restore target - VMware virtual machine</p>
<p>Source system has 2x 10Gbe NICs, bonded together via 'teamd', multiple
vlans trunked over the team.<br />
Testing restore to a VM. The initial boot of the rescue .iso asks to
substitute one of the original NIC names (eno1) with a nic name of the
vm (ens192). After the boot, it brings up most the vlan interfaces and
one as a sub-interface of the new nic name.</p>
<p>Normally I use several 'cheats' to configure this networking under rhel7
- either 'nmtui', 'nmcli', or edit the config scripts under
/etc/sysconfig/network-scripts and restart networking via 'systemctl
restart network'. I don't see that any of these options are available
under rescue.</p>
<p>If I do manage to get a usable interface up with ip or ifconfig,
somewhere in the restore process it appears that the original vlan
interfaces are getting reconfigured to match production and restarted.
Makes testing very dicey ....</p>
<p>Is there some way to tell the rescue boot to disregard original network
configs ??<br />
Is there some way to tell the restore process to NOT bring up the
original nic settings ??</p>
<p>thanks,<br />
don m.</p>
<h4 id="schlomo_commented_at_2018-11-26_2202"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/1982#issuecomment-441815832">2018-11-26 22:02</a>:<a class="headerlink" href="#schlomo_commented_at_2018-11-26_2202" title="Permanent link">&para;</a></h4>
<p>You can force the rescue system to use DHCP via <code>USE_DHCLIENT=y</code>
(regardless of your actual DHCP client software, this is the parameter).
To set a completely custom network configuration in the rescue system
use the <code>NETWORKING_PREPARATION_COMMANDS</code> variables which is described
in <code>/usr/share/rear/conf/default.conf</code> like this:</p>
<pre><code># Commands to prepare network devices setup in the rescue/recovery system
# provided the kernel command line does not contain the 'noip' parameter.
# Each command is a quoted fixed string to get the commands separated from each other
# as in NETWORKING_PREPARATION_COMMANDS=( 'first command' 'second command' ).
# The commands in NETWORKING_PREPARATION_COMMANDS get copied at the beginning
# of /etc/scripts/system-setup.d/60-network-devices.sh that is the main script
# which runs while booting the rescue/recovery system to set up network devices.
# The primary intent is to be able to specify special commands for special cases
# as preparation so that the subsequent autogenerated network devices setup code
# in the 60-network-devices.sh script can successfully set up network devices
# (for details see usr/share/rear/rescue/GNU/Linux/310_network_devices.sh).
# But NETWORKING_PREPARATION_COMMANDS is not limited to its primary intent.
# For example it can also be used to set up networking completely manually in the rescue/recovery system via something like
# NETWORKING_PREPARATION_COMMANDS=( 'ip addr add 192.168.100.2/24 dev eth0' 'ip link set dev eth0 up' 'ip route add default via 192.168.100.1' 'return' )
# where the last command lets the 60-network-devices.sh script directly return
# so that the subsequent autogenerated network devices setup code will not be run.
# The by default empty NETWORKING_PREPARATION_COMMANDS means the 60-network-devices.sh script
# is autogenerated according to the network devices setup in the currently running system
# i.e. the default is an automated network devices setup in the rescue/recovery system
# that should match the network devices setup in the currently running system:
NETWORKING_PREPARATION_COMMANDS=()
</code></pre>
<p>See the <code>default.conf</code> for more things to tweak. For example
<code>POST_RECOVERY_SCRIPT</code> could point to some script that is called after
the recovery and that modifies the recovered system (found in
<code>/mnt/local</code>) to come up with a different network configuration. For
example by deleting the static network configuration files and switching
the system to DHCP. You have to create this script and can do there
whatever you want.</p>
<p>About the network configuration tools you mention - we don't support
those at all. You'll have to use Linux standard commands to configure
the network. The reason is that we don't copy the OS's network
configuration framework but ship our own which is much simpler and works
everywhere the same (based on the plain Linux networking commands).</p>
<p>Is that what you meant?</p>
<h4 id="gdha_commented_at_2018-11-27_0748"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1982#issuecomment-441959890">2018-11-27 07:48</a>:<a class="headerlink" href="#gdha_commented_at_2018-11-27_0748" title="Permanent link">&para;</a></h4>
<p>@dm6079 please check also
<a href="http://relax-and-recover.org/documentation/faq">http://relax-and-recover.org/documentation/faq</a></p>
<h4 id="dm6079_commented_at_2018-11-27_1722"><img src="https://avatars.githubusercontent.com/u/25588035?v=4" width="50"><a href="https://github.com/dm6079">dm6079</a> commented at <a href="https://github.com/rear/rear/issues/1982#issuecomment-442143834">2018-11-27 17:22</a>:<a class="headerlink" href="#dm6079_commented_at_2018-11-27_1722" title="Permanent link">&para;</a></h4>
<p>Thank you, gentlemen. Your suggestions got our test working. Did spend
a<br />
good bit of time adjusting partition &amp; volume sizings to restore to a<br />
smaller disk.</p>
<p>thanks,<br />
don m.</p>
<p>On Tue, Nov 27, 2018 at 2:48 AM gdha <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a> wrote:</p>
<blockquote>
<p>@dm6079 <a href="https://github.com/dm6079">https://github.com/dm6079</a> please
check also<br />
<a href="http://relax-and-recover.org/documentation/faq">http://relax-and-recover.org/documentation/faq</a></p>
<p>—<br />
You are receiving this because you were mentioned.<br />
Reply to this email directly, view it on GitHub<br />
<a href="https://github.com/rear/rear/issues/1982#issuecomment-441959890">https://github.com/rear/rear/issues/1982#issuecomment-441959890</a>,
or mute<br />
the thread<br />
<a href="https://github.com/notifications/unsubscribe-auth/AYZxQ96onA3evPrXojeNi_GFWPZ8a5CGks5uzO5fgaJpZM4YzbL_">https://github.com/notifications/unsubscribe-auth/AYZxQ96onA3evPrXojeNi_GFWPZ8a5CGks5uzO5fgaJpZM4YzbL_</a><br />
.</p>
</blockquote>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2018-11-26.1982.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
