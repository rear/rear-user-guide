<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1818 Issue closed: we have faced a network connectivity issue when the REAR ISO has been booted - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1818 Issue closed: we have faced a network connectivity issue when the REAR ISO has been booted";
        var mkdocs_page_input_path = "issues/2018-05-23.1818.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1818 Issue closed: we have faced a network connectivity issue when the REAR ISO has been booted</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1818_issue_closed_we_have_faced_a_network_connectivity_issue_when_the_rear_iso_has_been_booted"><a href="https://github.com/rear/rear/issues/1818">#1818 Issue</a> <code>closed</code>: we have faced a network connectivity issue when the REAR ISO has been booted<a class="headerlink" href="#1818_issue_closed_we_have_faced_a_network_connectivity_issue_when_the_rear_iso_has_been_booted" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="nirmal21s_opened_issue_at_2018-05-23_0938"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> opened issue at <a href="https://github.com/rear/rear/issues/1818">2018-05-23 09:38</a>:<a class="headerlink" href="#nirmal21s_opened_issue_at_2018-05-23_0938" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>ReaR version ("/usr/sbin/rear -V"): 2.3</li>
<li>OS version ("cat /etc/rear/os.conf" or "lsb_release -a" or "cat
    /etc/os-release"): RHEL 7.5</li>
<li>ReaR configuration files ("cat /etc/rear/site.conf" or "cat
    /etc/rear/local.conf"):</li>
</ul>
<pre>
NRSERVER=xxxxxxxxxxxx
NSR_CLIENT_MODE=y
OUTPUT=ISO
ISO_PREFIX="rear-nsr-$HOSTNAME"
BACKUP=NSR
OUTPUT_URL=file:///tmp
# Static IP (no DHCP!)
USE_DHCLIENT=
USE_STATIC_NETWORKING="y"
# NTP
TIMESYNC=NTP
</pre>

<ul>
<li>System architecture (x86 compatible or POWER and/or what kind of
    virtual machine):x86</li>
<li>Are you using BIOS or UEFI or another way to boot? Legacy BIOS</li>
<li>Brief description of the issue:we have faced a network connectivity
    issue when the REAR ISO has been booted:<br />
    The problem is in the mapping of the server physical interfces to
    the ethXX logaical interface names. As you can see in the
    screenshot (1) the eth names are assigned to the physical interfaces
    almost in random which is incorrect configuration. When I removed
    network card kernel modules (rmmod tg3;rmmod igb) and probed than
    back again (modprobe tg3, modprobe igb) the mapping between the
    physical interfaces and logical interface names is correct as you
    can see on screenshot (2). The mapping is configured in the udev
    conf file located in /lib/udev/rules.d/70-persistent-net.rules This
    file is present on the REAR iso as well, seems not used by the REAR
    initramdisk during bootup though.<br />
<img alt="image001" src="https://user-images.githubusercontent.com/31272475/40416496-0cef8a36-5e9b-11e8-8887-10970b0e5a36.png" /><br />
<img alt="image002" src="https://user-images.githubusercontent.com/31272475/40416499-0e727ab2-5e9b-11e8-9860-a9776b13faae.png" /><br />
<a href="https://github.com/rear/rear/files/2030424/70-persistent-net_rules.txt">70-persistent-net_rules.txt</a></li>
</ul>
<h4 id="nirmal21s_commented_at_2018-05-24_0453"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-391587602">2018-05-24 04:53</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-05-24_0453" title="Permanent link">&para;</a></h4>
<p>Hello @jsmeix @hpannenb</p>
<p>Any suggestion for the above issue.<br />
Kindly suggest me a fix....<br />
Thanks in Advance</p>
<h4 id="jsmeix_commented_at_2018-05-24_1002"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-391659776">2018-05-24 10:02</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-05-24_1002" title="Permanent link">&para;</a></h4>
<p>@nirmal21s<br />
I am afraid, my networking and/or udev knowledge is insufficient<br />
to actually help with such issues in the recovery system.</p>
<p>As a possible workaround in this particular case when manual<br />
<code>rmmod tg3 ; mmod igb ; modprobe tg3 ; modprobe igb</code><br />
helps before running "rear recover" you can automate that<br />
via the PRE_RECOVERY_SCRIPT config variable,<br />
see usr/share/rear/conf/default.conf</p>
<p>Such a PRE_RECOVERY_SCRIPT is run during "rear recover" via<br />
usr/share/rear/setup/default/010_pre_recovery_script.sh<br />
at a very early stage, cf.</p>
<pre>
# rear -s recover
Simulation mode activated ...
Source conf/Linux-i386.conf
Source conf/GNU/Linux.conf
Source conf/SUSE_LINUX.conf
Source init/default/005_verify_os_conf.sh
Source init/default/010_set_drlm_env.sh
Source init/default/030_update_recovery_system.sh
Source init/default/050_check_rear_recover_mode.sh
Source setup/default/005_ssh_agent_start.sh
Source setup/default/010_pre_recovery_script.sh
...
</pre>

<h4 id="jsmeix_commented_at_2018-05-24_1016"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-391663511">2018-05-24 10:16</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-05-24_1016" title="Permanent link">&para;</a></h4>
<p>@nirmal21s<br />
another blind guess what might perhaps help is to use MODULES_LOAD<br />
to enforce to load the specified kernel modules in the given order<br />
in the rescue/recovery system so that e.g. something like</p>
<pre>
MODULES_LOAD=( tg3 igb )
</pre>

<p>might help in your case.</p>
<p>In general to debug what happens during recovery system startup:</p>
<p>In general regarding debugging issues with the start up scripts<br />
that are run initially in the ReaR recovery system<br />
the basic idea behind is to not let those start up scripts<br />
run automatically and mostly silently but manually<br />
one after the other with 'set -x' bash debugging mode.</p>
<p>Add 'debug' to the ReaR kernel command line<br />
when booting the ReaR recovery/rescue system.</p>
<p>In the ReaR recovery/rescue system boot menue select<br />
the topmost enty of the form "Recover HOSTNAME"<br />
and press the [Tab] key to edit the boot command line<br />
and append the word ' debug' at its end and boot that.</p>
<p>You may found yourself stopped at a blank screen.<br />
In this case press [Enter] which runs the very first of the<br />
start up scripts (/etc/scripts/system-setup.d/00functions.sh).<br />
There is some bug that the initial message is not always<br />
printed so you may need to type the very first [Enter] blindly.</p>
<p>The further start up scripts are run one by one<br />
each one after pressing [Enter].</p>
<p>In 'debug' mode the start up scripts are run with 'set -x'<br />
so that this way you can better see what actually goes on<br />
in each of the start up scripts.</p>
<p>Cf.<br />
<a href="https://github.com/rear/rear/issues/1703#issuecomment-360398508">https://github.com/rear/rear/issues/1703#issuecomment-360398508</a></p>
<h4 id="nirmal21s_commented_at_2018-05-25_0624"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-391954445">2018-05-25 06:24</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-05-25_0624" title="Permanent link">&para;</a></h4>
<p>@jsmeix<br />
I will add the below parameters in local.conf and test it :</p>
<p>PRE_RECOVERY_SCRIPT=(rmmod tg3 ; mmod igb ; modprobe tg3 ; modprobe
igb)<br />
MODULES_LOAD=( tg3 igb )</p>
<p>I hope the parameter is correct.</p>
<h4 id="jsmeix_commented_at_2018-05-25_0917"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-391993719">2018-05-25 09:17</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-05-25_0917" title="Permanent link">&para;</a></h4>
<p>PRE_RECOVERY_SCRIPT and POST_RECOVERY_SCRIPT<br />
have same syntax and in conf/examples/SLE12-SP2-btrfs-example.conf<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/conf/examples/SLE12-SP2-btrfs-example.conf">https://github.com/rear/rear/blob/master/usr/share/rear/conf/examples/SLE12-SP2-btrfs-example.conf</a><br />
there is an example of a POST_RECOVERY_SCRIPT</p>
<h4 id="nirmal21s_commented_at_2018-05-25_1328"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-392057792">2018-05-25 13:28</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-05-25_1328" title="Permanent link">&para;</a></h4>
<p>@jsmeix<br />
Just want to know if the reason behind the issue might be due to this
parameter "USE_STATIC_NETWORKING="y"<br />
Since the Eth interface is :<br />
DEVICE=eth0<br />
BOOTPROTO=none<br />
ONBOOT=yes<br />
TYPE=Ethernet<br />
NM_CONTROLLED=NO</p>
<p>So do i need to remove "USE_STATIC_NETWORKING="y"" and use
USE_DHCLIENT=y ..</p>
<h4 id="hpannenb_commented_at_2018-05-25_1753"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-392133586">2018-05-25 17:53</a>:<a class="headerlink" href="#hpannenb_commented_at_2018-05-25_1753" title="Permanent link">&para;</a></h4>
<p>@nirmal21s<br />
I do not know where this "70-persistent-net.rules" file is coming from.
As far as I read it in RHEL 7.x this is not used any more; at least I
cannot find it under RHEL7.4 or Centos 7.5.</p>
<p>About USE_DHCLIENT: If You have an DHCP server available use it. But I
assume not using DHCP is not the issue here.</p>
<p>BTW, can You provide the information which kind of server is in use?</p>
<p>Thanks.</p>
<h4 id="nirmal21s_commented_at_2018-05-28_0737"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-392445634">2018-05-28 07:37</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-05-28_0737" title="Permanent link">&para;</a></h4>
<p>@hpannenb<br />
I am not getting your question .. you mean whether is a DHCP server or
?<br />
The OS version is RHEL 7.5..<br />
Thanks.</p>
<h4 id="gdha_commented_at_2018-05-28_1542"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-392557953">2018-05-28 15:42</a>:<a class="headerlink" href="#gdha_commented_at_2018-05-28_1542" title="Permanent link">&para;</a></h4>
<p>@nirmal21s I believe the question was "do you have internally a DHCP
server you can use to gain an IP address (during a recovery)?"<br />
If the answer is yes, then use "USE_DHCLIENT=yes" in the local.conf
file. It would fix your problem in an easy way.</p>
<h4 id="nirmal21s_commented_at_2018-05-28_1656"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-392570220">2018-05-28 16:56</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-05-28_1656" title="Permanent link">&para;</a></h4>
<p>@gdha @hpannenb<br />
server has static ip only :<br />
DEVICE=bond2<br />
NAME=bond2<br />
TYPE=bond<br />
BOOTPROTO=static<br />
ONBOOT=yes<br />
IPADDR=10.209.x.xxx<br />
PREFIX=22<br />
#NETMASK=255.255.255.0<br />
#USERCTL=no<br />
NM_CONTROLLED=no<br />
#PEERDNS=no<br />
BONDING_MASTER=yes<br />
BONDING_OPTS="mode=1 miimon=100"</p>
<h4 id="nirmal21s_commented_at_2018-05-28_1701"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-392570850">2018-05-28 17:01</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-05-28_1701" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
I am not able to prepare the syntax for PRE_RECOVERY_SCRIPT=(rmmod tg3
; mmod igb ; modprobe tg3 ; modprobe igb)..</p>
<p>The below mentioned is correct :</p>
<pre><code>for interface_count in `seq 0 9`

do

if [ -f "/sys/class/net/eth$interface_count" ]; then

            status="success"

else

            status="failed"

fi

done

if [ "$status" = "success" ]; then

            exit

else

            echo -e "Incorrect Interfaece sequence"


rmmod tg3 ; mmod igb ; modprobe tg3 ; modprobe igb

fi
</code></pre>
<h4 id="gdha_commented_at_2018-05-29_0745"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-392683541">2018-05-29 07:45</a>:<a class="headerlink" href="#gdha_commented_at_2018-05-29_0745" title="Permanent link">&para;</a></h4>
<p>@nirmal21s You could try the following. Add above commands into a script
and saved it as
<code>/usr/share/rear/skel/default/etc/scripts/system-setup.d/77-my-network-setup.sh</code>
and re-run <code>rear -v mkbackup</code>. When booting from the resulting ISO image
this script should be kicked in.</p>
<h4 id="nirmal21s_commented_at_2018-05-29_0812"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-392690869">2018-05-29 08:12</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-05-29_0812" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
Thanks for the above recommendation.<br />
Here the issue was after rear recover the network interface mixed up .<br />
I was going through the issue 770
(<a href="https://github.com/rear/rear/issues/770">https://github.com/rear/rear/issues/770</a>)
.<br />
Just wondering if this would fix the issue<br />
BACKUP_RESTORE_MOVE_AWAY_FILES=(
/lib/udev/rules.d/70-persistent-net.rules )</p>
<h4 id="gdha_commented_at_2018-05-29_0844"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-392700130">2018-05-29 08:44</a>:<a class="headerlink" href="#gdha_commented_at_2018-05-29_0844" title="Permanent link">&para;</a></h4>
<p>@nirmal21s good thinking as on RHEL 7.5 the
<code>/lib/udev/rules.d/70-persistent-net.rules</code> is not required it is indeed
best to remove it.</p>
<h4 id="nirmal21s_commented_at_2018-05-29_1100"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-392736840">2018-05-29 11:00</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-05-29_1100" title="Permanent link">&para;</a></h4>
<p>@gdha I will test it and confirm ..<br />
created a ISO image by running mkrescue . for BACKUP=NSR.<br />
For restoring the files we use Networker tool.<br />
Hope everything goes well..</p>
<h4 id="nirmal21s_commented_at_2018-05-31_1525"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-393568162">2018-05-31 15:25</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-05-31_1525" title="Permanent link">&para;</a></h4>
<p>After removing the below parameters :</p>
<p>BACKUP_RESTORE_MOVE_AWAY_FILES=(
/lib/udev/rules.d/70-persistent-net.rules )<br />
USE_DHCLIENT=</p>
<p>We tried to crated a new ISO image and tried to boot.<br />
Everything went well , after rear recover ,we got the MAC address.</p>
<p>But we were able to ping only this servers gateway and not able to ping
the backup server IP.<br />
issue was with routing i guess<br />
After running the /etc/scripts/system-setup.d/60-netowrk-devices.sh &amp;
62-routing.sh manually it worked and this server was rechable from
backup server.<br />
Any clue why REAR behaved like this.</p>
<h4 id="razorfish-sl_commented_at_2018-06-03_0434"><img src="https://avatars.githubusercontent.com/u/4497476?v=4" width="50"><a href="https://github.com/razorfish-sl">razorfish-sl</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-394134438">2018-06-03 04:34</a>:<a class="headerlink" href="#razorfish-sl_commented_at_2018-06-03_0434" title="Permanent link">&para;</a></h4>
<p>There were changes made to how linux boots &amp; identifies the Ethernet
interfaces.<br />
potentially there were race conditions in how linux enumerated
interfaces with some physical adaptions of the motheboards<br />
<strong>Also sometimes the initial config of the setup may make it IMPOSSIBLE
for REAR to discover the correct network....<br />
It is NOT just a matter of sticking an IP address onto an interface in
some cases.</strong></p>
<p>In my case I ALWAYS have to boot my HP servers with "REAR" in "manual
mode", since it is impossible for rear to guess my network config.
(unless i make manual scripts)<br />
A simple</p>
<p>"ip addr" gets me<br />
2: enp3s0f0:</p>
<p>I then</p>
<p>MUST<br />
ip addr add 172.18.10.xx/24 dev enp3s0f0<br />
ip link set enp3s0f0 up</p>
<p>So how can REAR fail to find the ipaddress on a functioning network,
seems foolish ?<br />
here is an example<br />
we already know enp3s0f0 is the external interface<br />
but during the BACKUP... REAR sees this:</p>
<p>cat ifcfg-enp3s0f0<br />
NM_CONTROLLED="no"<br />
IPV4_FAILURE_FATAL="no"<br />
NAME="enp3s0f0"<br />
UUID="7452703b-4fdc-4e9f-accb-8c30f7803b3d"<br />
DEVICE="enp3s0f0"<br />
ONBOOT="yes"<br />
TYPE=OVSPort<br />
DEVICETYPE=ovs<br />
OVS_BRIDGE=br-ex</p>
<p>cat ifcfg-br-ex<br />
NM_CONTROLLED="no"<br />
DEVICE=br-ex<br />
DEVICETYPE=ovs<br />
TYPE=OVSBridge<br />
PROXY_METHOD="none"<br />
BROWSER_ONLY="no"<br />
BOOTPROTO="static"<br />
IPADDR=172.18.10.70<br />
NETMASK=255.255.255.0<br />
GATEWAY=172.18.10.1<br />
DEFROUTE="yes"<br />
IPV4_FAILURE_FATAL="no"<br />
IPV6INIT="no"<br />
IPV6_AUTOCONF="no"<br />
IPV6_DEFROUTE="no"<br />
IPV6_FAILURE_FATAL="no"<br />
IPV6_ADDR_GEN_MODE="stable-privacy"<br />
ONBOOT="yes"</p>
<p>Ha Har......<br />
during recovery ,how can we expect REAR to deal with getting a suitable
ip config from the above?<br />
it is a backup program... not an AI to discover how data is routed out
of the box.</p>
<h4 id="jsmeix_commented_at_2018-06-04_1216"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-394334096">2018-06-04 12:16</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-06-04_1216" title="Permanent link">&para;</a></h4>
<p>FYI<br />
in general regarding<br />
how to prepare network devices setup in the rescue/recovery system<br />
see NETWORKING_PREPARATION_COMMANDS<br />
in usr/share/rear/conf/default.conf</p>
<p>Perhaps that could help in this case?</p>
<h4 id="nirmal21s_commented_at_2018-06-12_1402"><img src="https://avatars.githubusercontent.com/u/31272475?v=4" width="50"><a href="https://github.com/nirmal21s">nirmal21s</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-396600643">2018-06-12 14:02</a>:<a class="headerlink" href="#nirmal21s_commented_at_2018-06-12_1402" title="Permanent link">&para;</a></h4>
<p>Yes.. I have added the
PRE_RECOVERY_SCRIPT=/usr/share/rear/skel/default/etc/scripts/system-setup.d/77-my-network-setup.sh..
It worked fine..</p>
<p>Thanks a lot for your support.</p>
<h4 id="jsmeix_commented_at_2018-06-12_1417"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1818#issuecomment-396605784">2018-06-12 14:17</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-06-12_1417" title="Permanent link">&para;</a></h4>
<p>@nirmal21s<br />
thanks for your feedback!</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2018-05-23.1818.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
