<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2722 Issue closed: Failed to create parition table with LVM and LUKS - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2722 Issue closed: Failed to create parition table with LVM and LUKS";
        var mkdocs_page_input_path = "issues/2021-12-03.2722.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2722 Issue closed: Failed to create parition table with LVM and LUKS</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2722_issue_closed_failed_to_create_parition_table_with_lvm_and_luks"><a href="https://github.com/rear/rear/issues/2722">#2722 Issue</a> <code>closed</code>: Failed to create parition table with LVM and LUKS<a class="headerlink" href="#2722_issue_closed_failed_to_create_parition_table_with_lvm_and_luks" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="quixus_opened_issue_at_2021-12-03_1624"><img src="https://avatars.githubusercontent.com/u/29638423?v=4" width="50"><a href="https://github.com/Quixus">Quixus</a> opened issue at <a href="https://github.com/rear/rear/issues/2722">2021-12-03 16:24</a>:<a class="headerlink" href="#quixus_opened_issue_at_2021-12-03_1624" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"):<br />
    Relax-and-Recover 2.5 / Git</p>
</li>
<li>
<p>OS version ("cat /etc/os-release" or "lsb_release -a" or "cat
    /etc/rear/os.conf"):<br />
    Ubuntu 20.04.3 LTS</p>
</li>
<li>
<p>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):<br />
    Default configuration</p>
</li>
<li>
<p>Hardware vendor/product (PC or PowerNV BareMetal or ARM) or VM (KVM
    guest or PowerVM LPAR):<br />
    Source for mkrescue: x64 PC<br />
    Target of rear recover: VM in HyperV</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device):<br />
    x86 compatible</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot):<br />
    EFI and GRUB</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe):<br />
    Source: Local Disk with LVM and LUKS</p>
</li>
<li>
<p>Storage layout ("lsblk -ipo
    NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT"):</p>
</li>
</ul>
<!-- -->

<pre><code>NAME                                    KNAME      PKNAME    TRAN   TYPE  FSTYPE        SIZE MOUNTPOINT
/dev/loop0                              /dev/loop0                  loop  squashfs     55.5M /snap/core18/2246
/dev/loop1                              /dev/loop1                  loop  squashfs     55.5M /snap/core18/2253
/dev/loop2                              /dev/loop2                  loop  squashfs     61.9M /snap/core20/1169
/dev/loop3                              /dev/loop3                  loop  squashfs     70.3M /snap/lxd/21029
/dev/loop4                              /dev/loop4                  loop  squashfs     42.2M /snap/snapd/14066
/dev/loop5                              /dev/loop5                  loop  squashfs     32.5M /snap/snapd/13640
/dev/loop6                              /dev/loop6                  loop  squashfs     61.9M /snap/core20/1242
/dev/loop7                              /dev/loop7                  loop  squashfs     67.2M /snap/lxd/21835
/dev/sda                                /dev/sda             sata   disk              931.5G
|-/dev/sda1                             /dev/sda1  /dev/sda         part  vfat          512M /boot/efi
|-/dev/sda2                             /dev/sda2  /dev/sda         part  ext4            1G /boot
`-/dev/sda3                             /dev/sda3  /dev/sda         part  crypto_LUKS   930G
  `-/dev/mapper/dm_crypt-0              /dev/dm-0  /dev/sda3        crypt LVM2_member   930G
    `-/dev/mapper/ubuntu--vg-ubuntu--lv /dev/dm-1  /dev/dm-0        lvm   ext4          200G /
/dev/sr0                                /dev/sr0             sata   rom                1024M
</code></pre>
<ul>
<li>Description of the issue (ideally so that others can reproduce
    it):<br />
    After creating the ISO and mounting it as boot device on the VM, the
    writing of the partitions fails at the step where the LUKS password
    should be entered.</li>
</ul>
<!-- -->

<pre><code>Please enter the password for LUKS device dm_crypt-0 (/dev/sda3):
UserInput -I LAYOUT_CODE_RUN needed in /usr/share/rear/layout/recreate/default/200_run_layout_code.sh in line 127
The disk layout recreation script failed
</code></pre>
<ul>
<li>
<p>Workaround, if any:<br />
    I haven't found one</p>
</li>
<li>
<p>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files):<br />
    Unfortunately I cannot get the log out of the VM.</p>
</li>
</ul>
<h4 id="pcahyna_commented_at_2021-12-07_1032"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2722#issuecomment-987787955">2021-12-07 10:32</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-12-07_1032" title="Permanent link">&para;</a></h4>
<p>Hello, is it LUKS 2 ? I am no LUKS expert, but this sounds similar to
bug #2204. If so, LUKS 2 support was added by a colleague of mine
(@vcrhonek) in PR #2504, but it is not yet present in any released
version. Can you please try the current development version?</p>
<h4 id="quixus_commented_at_2021-12-07_1048"><img src="https://avatars.githubusercontent.com/u/29638423?v=4" width="50"><a href="https://github.com/Quixus">Quixus</a> commented at <a href="https://github.com/rear/rear/issues/2722#issuecomment-987801341">2021-12-07 10:48</a>:<a class="headerlink" href="#quixus_commented_at_2021-12-07_1048" title="Permanent link">&para;</a></h4>
<p>Yup, it is indeed LUKS2. I will see if I can use the dev version. Is
there an ETA for LUKS2 support in the release?<br />
[Edit]I installed rear with apt. how do I get the dev branch and which
branch is the LUKS2 support in [/Edit]</p>
<h4 id="pcahyna_commented_at_2021-12-07_1357"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2722#issuecomment-987949620">2021-12-07 13:57</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-12-07_1357" title="Permanent link">&para;</a></h4>
<blockquote>
<p>how do I get the dev branch and which branch is the LUKS2 support in</p>
</blockquote>
<p>See the first part of
<a href="https://github.com/rear/rear#quick-start-guide">https://github.com/rear/rear#quick-start-guide</a>
"how to run Relax-and-Recover from the git checkout". Note that the
configuration file for running from git checkout is indeed
<code>etc/rear/local.conf</code>, not <code>/etc/rear/local.conf</code> (the path is relative
to the root of the checked-out tree). The dev branch is the default
<code>master</code> one, the LUKS2 support branch has been already merged into
it.<br />
EDIT you can of course skip the part about preparing your USB media and
configuring USB output, you can configure the Git version just as you do
with your current version, only the config file path is different.</p>
<h4 id="quixus_commented_at_2021-12-08_1338"><img src="https://avatars.githubusercontent.com/u/29638423?v=4" width="50"><a href="https://github.com/Quixus">Quixus</a> commented at <a href="https://github.com/rear/rear/issues/2722#issuecomment-988822047">2021-12-08 13:38</a>:<a class="headerlink" href="#quixus_commented_at_2021-12-08_1338" title="Permanent link">&para;</a></h4>
<p>The partition table was created. Unfortunately I did not include the
necessary information about the restic backup that has the rest of the
disk content and I cannot get to it from the rescue image, but that is
not part of the issue</p>
<p>I consider this issue closed.</p>
<p>Thanks everyone</p>
<h4 id="pcahyna_commented_at_2021-12-08_1730"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2722#issuecomment-989022041">2021-12-08 17:30</a>:<a class="headerlink" href="#pcahyna_commented_at_2021-12-08_1730" title="Permanent link">&para;</a></h4>
<p>@Quixus thank you for verifying the fix in the development version.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2023 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2021-12-03.2722.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
