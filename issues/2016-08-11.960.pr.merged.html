<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#960 PR merged: Some fixes and addons for recovery system networking setup - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#960 PR merged: Some fixes and addons for recovery system networking setup";
        var mkdocs_page_input_path = "issues/2016-08-11.960.pr.merged.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rsync.html">External Backup using BACKUP=RSYNC method</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/duplicity.html">External Backup using duplicity</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#960 PR merged: Some fixes and addons for recovery system networking setup</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="960_pr_merged_some_fixes_and_addons_for_recovery_system_networking_setup"><a href="https://github.com/rear/rear/pull/960">#960 PR</a> <code>merged</code>: Some fixes and addons for recovery system networking setup<a class="headerlink" href="#960_pr_merged_some_fixes_and_addons_for_recovery_system_networking_setup" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>cleanup</code>, <code>waiting for info</code>,
<code>fixed / solved / done</code></p>
<h4 id="jsmeix_opened_issue_at_2016-08-11_1553"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> opened issue at <a href="https://github.com/rear/rear/pull/960">2016-08-11 15:53</a>:<a class="headerlink" href="#jsmeix_opened_issue_at_2016-08-11_1553" title="Permanent link">&para;</a></h4>
<p>Changed how rescue/GNU/Linux/31_network_devices.sh<br />
behaves when DHCP should be used for recovery system<br />
networking setup: Now in this case it does no longer generate
/etc/scripts/system-setup.d/60-network-devices.sh<br />
(before it generated one which does only 'return').</p>
<p>Added support for manual recovery system networking setup<br />
via NETWORKING_SETUP_COMMANDS, see default.conf.<br />
This functionality is intended to be helpful as some kind of<br />
"last resort" when the default automated network devices setup<br />
does not at all work in some special cases.<br />
I tested it on my SLES12-SP2-beta5 test system with</p>
<pre>
NETWORKING_SETUP_COMMANDS=( 'ip addr add 10.160.64.54/16 dev eth0' 'ip link set dev eth0 up' 'ip route add default via 10.160.255.254' )
</pre>

<p>and for me it works.</p>
<p>see
<a href="https://github.com/rear/rear/issues/951">https://github.com/rear/rear/issues/951</a></p>
<h4 id="jsmeix_commented_at_2016-08-11_1737"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/960#issuecomment-239233988">2016-08-11 17:37</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-11_1737" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
please have a look in particular at this change in<br />
usr/share/rear/rescue/GNU/Linux/31_network_devices.sh<br />
Before it was:</p>
<pre>
# Skip netscript if noip is configured on the command line:
cat &lt;&lt;EOT &gt;&gt; $netscript
if [[ -e /proc/cmdline ]] ; then
    if grep -q 'noip' /proc/cmdline ; then
        return
    fi
fi
EOT
# Add a line at the top of netscript to skip if dhclient will be used:
cat - &lt;&lt;EOT &gt; $netscript
# if USE_DHCLIENT=y then use DHCP instead and skip 60-network-devices.sh
[[ ! -z "\$USE_DHCLIENT" && -z "\$USE_STATIC_NETWORKING" ]] && return
...
EOT
</pre>

<p>Therin the &gt; $netscript was plain wrong because<br />
it made the above &gt;&gt; $netscript useless.<br />
I fixed that but that is not my actual question here.</p>
<p>Now it is</p>
<pre>
# When DHCP is used via 58-start-dhclient.sh do not mess up the existing networking setup
# here by possibly conflicting network devices setup via 60-network-devices.sh:
if test $USE_DHCLIENT -a -z $USE_STATIC_NETWORKING ; then
    Log "No network devices setup via 60-network-devices.sh because that happens via DHCP in 58-start-dhclient.sh."
    # To be on the safe side remove network_devices_setup_script if it somehow already exists:
    rm $v -f $network_devices_setup_script >&2
    return
fi
</pre>

<p>This changes the behaviour becaus now it evaluates<br />
the USE_DHCLIENT and USE_STATIC_NETWORKING<br />
variables during "rear mkbackup" and not during booting<br />
in the recovery system.</p>
<p>But I think now it is still correct and much simpler<br />
because I cannot imagine how the values of the<br />
USE_DHCLIENT and USE_STATIC_NETWORKING<br />
variables could be changed between "rear mkbackup"<br />
and booting in the recovery system.</p>
<p>I know that after the recovery system has booted<br />
(i.e. after one has logged in ther as root) one<br />
can change /etc/rear/local.conf but then<br />
/etc/scripts/system-setup.d/60-network-devices.sh<br />
was already run so that changes of the<br />
USE_DHCLIENT and USE_STATIC_NETWORKING<br />
variables in the recovery system have no effect on<br />
/etc/scripts/system-setup.d/60-network-devices.sh</p>
<h4 id="gdha_commented_at_2016-08-11_1752"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/pull/960#issuecomment-239238026">2016-08-11 17:52</a>:<a class="headerlink" href="#gdha_commented_at_2016-08-11_1752" title="Permanent link">&para;</a></h4>
<p>@jsmeix issue #819 is also linked to this I think. Will check it
tomorrow.</p>
<h4 id="jsmeix_commented_at_2016-08-11_1757"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/960#issuecomment-239239792">2016-08-11 17:57</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-11_1757" title="Permanent link">&para;</a></h4>
<p>Ah!<br />
your<br />
<a href="https://github.com/rear/rear/issues/819#issuecomment-224315823">https://github.com/rear/rear/issues/819#issuecomment-224315823</a><br />
shows a real behavioural difference / regression<br />
because with my change there is no longer a<br />
/etc/scripts/system-setup.d/60-network-devices.sh<br />
in case of DHCP.</p>
<p>Therefore I will change my change so that even in case of DHCP<br />
the /etc/scripts/system-setup.d/60-network-devices.sh is<br />
generated as usual so that it is available in the recovery system.</p>
<p>@gdha<br />
many thanks for pointing out that regression to me!</p>
<h4 id="gozora_commented_at_2016-08-11_2119"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/pull/960#issuecomment-239295958">2016-08-11 21:19</a>:<a class="headerlink" href="#gozora_commented_at_2016-08-11_2119" title="Permanent link">&para;</a></h4>
<p>UEFI starts to be pretty boring, so here I am messing a bit with
networking :-) (hope nobody minds).<br />
My first stop was <em>58-start-dhclient.sh</em> and I was a bit surprised here.</p>
<p>I have three basic questions (most probably for @gdha):</p>
<ol>
<li>Did I understood it well, that once original system have DHCP
    enabled on <strong>at least</strong> one interface, rear recover will start
    $DHCLIENT_BIN and stop processing with remaining network
    configuration?</li>
<li>Is it desired behavior to try to start $DHCLIENT_BIN on first
    interface only?<br />
    e.g. since I had eth0 connected to DHCP (network 10.0.2.0) and eth1
    to static setup (network 192.168.0.0) all was "fine", (eth0 was
    started with DHCP and eth1 left down)<br />
    but as soon as I "switch cables" and connected eth0 to network
    192.168.0.0 and eth1 to (10.0.2.0 - DHCP network) none of the
    interfaces went up :-( (network addresses are here only for
    illustration)</li>
<li>do you have some documents/issues/comments/anything describing how
    you intended to setup network in rear recover phase?</li>
</ol>
<p>I personally don't mind setting up network manually (I've used recovery
solution where I needed to load firmware to NIC prior driver loading not
talking about pure happiness when I was able to successfully finish PXE
boot without kernel panic or hang, so for me ReaR is real RELAX and
RECOVER :-)), but I've understood that your policy is to bring rear
recover to point where everything is ready.</p>
<h4 id="jsmeix_commented_at_2016-08-12_0941"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/960#issuecomment-239404644">2016-08-12 09:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-12_0941" title="Permanent link">&para;</a></h4>
<p>@gozora<br />
I guess you mean since you fixed basically all UEFI issues<br />
in Relax-and-Recover UEFI starts to be pretty boring<br />
but you like to avoid to get over-relaxed so that now<br />
you intend to fix basically all networking issues ;-)<br />
I have great plans for you:<br />
After you had fixed basically all networking issues<br />
you could fix all systemd issues which nowadays<br />
include all udev issues ;-)</p>
<p>Seriously:<br />
I have to do some major changes here<br />
see
<a href="https://github.com/rear/rear/pull/960#issuecomment-239239792">https://github.com/rear/rear/pull/960#issuecomment-239239792</a><br />
that I (hopefully) commit today...</p>
<h4 id="gozora_commented_at_2016-08-12_1032"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/pull/960#issuecomment-239414330">2016-08-12 10:32</a>:<a class="headerlink" href="#gozora_commented_at_2016-08-12_1032" title="Permanent link">&para;</a></h4>
<p>@jsmeix actually working on ReaR gave a the reason to study UEFI and
boot loaders in more detail (there is nothing like a good motivation).
And yes, couple days ago I've started to dig into systemd, so I hope
this knowledge will become useful one day.</p>
<p>When talking about network automatic configuration, I'd like to know
what is ReaR policy:</p>
<ul>
<li>would you like to have network configured exactly same way as on
    original system when in recovery mode (including all potentional
    networks / bonds / taps / tuns ...)</li>
<li>or having minimal network configuration that is sufficient for
    restore</li>
</ul>
<p>?</p>
<p>Thanks for that link!</p>
<h4 id="jsmeix_commented_at_2016-08-12_1136"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/960#issuecomment-239424607">2016-08-12 11:36</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-12_1136" title="Permanent link">&para;</a></h4>
<p>I replaced support for NETWORKING_SETUP_COMMANDS<br />
with support for NETWORKING_PREPARATION_COMMANDS<br />
see default.conf for description.</p>
<h4 id="jsmeix_commented_at_2016-08-12_1137"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/960#issuecomment-239424684">2016-08-12 11:36</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-12_1137" title="Permanent link">&para;</a></h4>
<p>I still need to test it...</p>
<h4 id="jsmeix_commented_at_2016-08-12_1237"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/960#issuecomment-239434911">2016-08-12 12:37</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-12_1237" title="Permanent link">&para;</a></h4>
<p>Regarding<br />
<a href="https://github.com/rear/rear/pull/960#issuecomment-239414330">https://github.com/rear/rear/pull/960#issuecomment-239414330</a><br />
what network config should be set up in the recovery system:</p>
<p>Personally I would prefer to do only a simple<br />
minimal network setup that is sufficient for restore.</p>
<p>But I fear enterprise users love to have complicated<br />
network setups where there is no such thing as a<br />
simple network setup that is sufficient for restore.</p>
<p>Cf.
<a href="https://github.com/rear/rear/issues/951#issuecomment-238651910">https://github.com/rear/rear/issues/951#issuecomment-238651910</a></p>
<pre>
Unfortunately in our env we do not have DHCP assigned
IP addresses and we MUST use VLAN tagging.
</pre>

<p>and I also remember a SUSE customer where there<br />
was no simple network setup that is sufficient for restore<br />
because he can only access his server where his backup is<br />
after a complicated networking setup.</p>
<p>Because I think it is hopeless to try to make the<br />
network setup automatism in Relax-and-Recover<br />
"just work" for any kind of complicated networking setup,<br />
I implemented here the new support for the<br />
NETWORKING_PREPARATION_COMMANDS<br />
so that users can - if needed - specify whatever they need<br />
in their particular case to set up networking in the recovery system.</p>
<h4 id="gozora_commented_at_2016-08-12_1250"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/pull/960#issuecomment-239437547">2016-08-12 12:50</a>:<a class="headerlink" href="#gozora_commented_at_2016-08-12_1250" title="Permanent link">&para;</a></h4>
<p>Well, VLAN is definitely a must have. I was rather talking about luxury
things like bonding that could be dropped in theory (during recovery
phase).<br />
Ok, so if we would have network in state where we car run <strong>rear
recover</strong> and it would work, everybody is happy. Hope I get it right ...</p>
<h4 id="jsmeix_commented_at_2016-08-12_1340"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/960#issuecomment-239448861">2016-08-12 13:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-12_1340" title="Permanent link">&para;</a></h4>
<p>My current fixes and the new support for the<br />
NETWORKING_PREPARATION_COMMANDS<br />
work perfectly well for me according to my test.</p>
<p>When I have only</p>
<pre>
USE_DHCLIENT="yes"
</pre>

<p>nothing changed for me - i.e. I get only networking setup<br />
via DHCP via 58-start-dhclient.sh and 60-network-devices.sh<br />
skips with 'return'.</p>
<p>When I have only</p>
<pre>
NETWORKING_PREPARATION_COMMANDS=( 'ip addr add 10.160.4.255/16 dev eth0' 'ip link set dev eth0 up' 'ip route add default via 10.160.255.254' 'return' )
</pre>

<p>I get networking setup only with that commands.</p>
<p>When I have (same as before but without the 'return'):</p>
<pre>
NETWORKING_PREPARATION_COMMANDS=( 'ip addr add 10.160.4.255/16 dev eth0' 'ip link set dev eth0 up' 'ip route add default via 10.160.255.254' )
</pre>

<p>I get networking setup via the<br />
NETWORKING_PREPARATION_COMMANDS<br />
plus the other commands in in 60-network-devices.sh - i.e. I<br />
get two IP addresses for 'eth0'.</p>
<p>When I have</p>
<pre>
USE_DHCLIENT="yes"
NETWORKING_PREPARATION_COMMANDS=( 'ip addr add 10.160.4.255/16 dev eth0' 'ip link set dev eth0 up' 'ip route add default via 10.160.255.254' 'return' )
</pre>

<p>I get first networking setup via DHCP via 58-start-dhclient.sh and<br />
additionally via the NETWORKING_PREPARATION_COMMANDS<br />
in 60-network-devices.sh - i.e. I get two IP addresses for 'eth0'.</p>
<p>When I have</p>
<pre>
USE_DHCLIENT="yes"
NETWORKING_PREPARATION_COMMANDS=( 'ip addr add 10.160.4.255/16 dev eth0' 'ip link set dev eth0 up' 'ip route add default via 10.160.255.254' 'USE_STATIC_NETWORKING="yes"' )
</pre>

<p>I get first networking setup via DHCP via 58-start-dhclient.sh and<br />
then via the NETWORKING_PREPARATION_COMMANDS<br />
plus the other commands in in 60-network-devices.sh - i.e. I get<br />
three IP addresses for 'eth0'.</p>
<p>Not that it makes much sense to have many IP addresses<br />
but I only liked to test if it works as intended.</p>
<p>I think I will merge it soon if there is no furious objection...</p>
<h4 id="jsmeix_commented_at_2016-08-12_1407"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/960#issuecomment-239455518">2016-08-12 14:07</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-12_1407" title="Permanent link">&para;</a></h4>
<p>I merged it because I like it so much now ;-)</p>
<p>I would very much apprerciate feedback if the new<br />
NETWORKING_PREPARATION_COMMANDS<br />
is really helpful to get problems with recovery system<br />
networking setup more easily fixed - or at least to get<br />
more easily a quick and dirty workaround in case of<br />
issues with recovery system networking setup.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2026 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-08-11.960.pr.merged.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
