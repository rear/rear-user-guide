<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1285 Issue closed: ReaR backups too old files for incremental backups - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1285 Issue closed: ReaR backups too old files for incremental backups";
        var mkdocs_page_input_path = "issues/2017-04-12.1285.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rsync.html">External Backup using BACKUP=RSYNC method</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/duplicity.html">External Backup using duplicity</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1285 Issue closed: ReaR backups too old files for incremental backups</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1285_issue_closed_rear_backups_too_old_files_for_incremental_backups"><a href="https://github.com/rear/rear/issues/1285">#1285 Issue</a> <code>closed</code>: ReaR backups too old files for incremental backups<a class="headerlink" href="#1285_issue_closed_rear_backups_too_old_files_for_incremental_backups" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>documentation</code>, <code>needs sponsorship</code>,
<code>won't fix / can't fix / obsolete</code></p>
<h4 id="dcz01_opened_issue_at_2017-04-12_1017"><img src="https://avatars.githubusercontent.com/u/20817288?v=4" width="50"><a href="https://github.com/dcz01">dcz01</a> opened issue at <a href="https://github.com/rear/rear/issues/1285">2017-04-12 10:17</a>:<a class="headerlink" href="#dcz01_opened_issue_at_2017-04-12_1017" title="Permanent link">&para;</a></h4>
<h4 id="rear_backups_too_much">ReaR backups too much<a class="headerlink" href="#rear_backups_too_much" title="Permanent link">&para;</a></h4>
<ul>
<li>rear version (/usr/sbin/rear -V): Relax-and-Recover 2.00 / Git</li>
<li>OS version (cat /etc/rear/os.conf or lsb_release -a): RHEL6</li>
<li>rear configuration files (cat /etc/rear/site.conf or cat
    /etc/rear/local.conf):</li>
</ul>
<!-- -->

<pre><code>OUTPUT=ISO
OUTPUT_URL=file:///tmp/rear
BACKUP=NETFS
BACKUP_PROG=tar
BACKUP_PROG_CRYPT_ENABLED=1
BACKUP_PROG_CRYPT_KEY=brpbackup123
BACKUP_PROG_CRYPT_OPTIONS="/usr/bin/openssl aes256 -salt -k"
BACKUP_PROG_DECRYPT_OPTIONS="/usr/bin/openssl aes256 -d -k"
#BACKUP_URL=nfs://
BACKUP_URL=cifs://S0100EDE/BRP-Backup
BACKUP_OPTIONS="cred=/etc/rear/cifs,sec=ntlmsspi"
BACKUP_TYPE=incremental
FULLBACKUPDAY="Sat"
BACKUP_PROG_EXCLUDE=( '/tmp/*' '/dev/shm/*' $VAR_DIR/output/\* '/opt/tivoli/tsm/rear/*' '/mnt/*' '/media/*' '/var/lib/pgsql/*/data/base/*' '/var/lib/pgsql/*/data/global/*' '/var/lib/pgsql/*/data/pg*/*' )
SSH_ROOT_PASSWORD='$1$HGjk3XUV$lid3Nd3k01Kht1mpMscLw1'
</code></pre>
<ul>
<li>Are you using legacy BIOS or UEFI boot? BIOS</li>
<li>Brief description of the issue: ReaR backup with tar does always an
    incremental backup six days long with one full backup on saturday.
    But in the incremental backups are always the database dumps from
    the same day and the day before. The dump from the day before should
    not be there or?</li>
<li>Work-around, if any: None</li>
</ul>
<p>I did an search over the archive for investigating why the filesize of
the archive is not about 13 or 14 GB where it should be. The real size
now is 26 or 27 GB for one incremental backup.<br />
With the following command i listed the files in the archive:<br />
dd if=/mnt/BRP-Backup/FBD01PSS/2017-04-04-0500-I.tar.gz |
/usr/bin/openssl aes256 -d -k brpbackup123 | tar -tzvf - &gt;&gt;
/tmp/restore3.txt</p>
<p>In the pictures are first the text file of the listing command and then
the cron schedules for the backups.</p>
<p><img alt="1" src="https://cloud.githubusercontent.com/assets/20817288/24952972/e33b9dd0-1f79-11e7-974d-85e8fe00dea1.jpg" /><br />
<img alt="2" src="https://cloud.githubusercontent.com/assets/20817288/24952973/e33be074-1f79-11e7-9039-7f864557c30f.jpg" /><br />
<img alt="3" src="https://cloud.githubusercontent.com/assets/20817288/24952971/e33b44d4-1f79-11e7-869a-3ef273203a51.jpg" /></p>
<h4 id="jsmeix_commented_at_2017-04-12_1105"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293544630">2017-04-12 11:05</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-12_1105" title="Permanent link">&para;</a></h4>
<p>The relevant code is in<br />
prep/NETFS/default/070_set_backup_archive.sh<br />
in particular this part (excerpts)</p>
<pre>
    case "$create_backup_type" in
...
        (incremental)
...
            if test "$latest_incremental_backup" ; then
                # A latest incremental backup that is based on the latest full backup is found:
                local latest_incremental_backup_file_name=$( basename $latest_incremental_backup )
                LogPrint "Latest incremental backup found ($latest_incremental_backup_file_name) that is newer than the latest full backup"
                local latest_incremental_backup_date=$( echo $latest_incremental_backup_file_name | grep -o "$date_glob_regex" )
                BACKUP_PROG_CREATE_NEWER_OPTIONS="--newer=$latest_incremental_backup_date -V $latest_incremental_backup_file_name"
                LogPrint "Performing incremental backup for files newer than $latest_incremental_backup_date using backup archive '$new_incremental_backup_file_name'"
</pre>

<p>so that when you run "rear mkbackup/mkbackuponly"<br />
in verbose mode (which you don't as far as I see)<br />
you would get a nice info message (LogPrint)<br />
that shows you what date will be used for the</p>
<pre>
tar ... --newer=DATE
</pre>

<p>call.<br />
Either the DATE value is somehow wrong determined<br />
in prep/NETFS/default/070_set_backup_archive.sh<br />
then it is an issue in ReaR or the DATE value looks right<br />
but 'tar ... --newer=DATE' seems to backup more files<br />
then it is probably an issue in 'tar'.</p>
<p>To debug issues that are related to ReaR you need to<br />
run /usr/sbin/rear with debugging enabled, i.e.<br />
"rear -d -D mkbackup/mkbackuponly",<br />
cf. "Debugging issues with Relax-and-Recover" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>To see the actual 'tar' command that is called by rear<br />
inspect the backup.log file.</p>
<h4 id="jsmeix_commented_at_2017-04-12_1114"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293546415">2017-04-12 11:14</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-12_1114" title="Permanent link">&para;</a></h4>
<p>For documentation how 'tar ... --newer=DATE'<br />
should behave, see<br />
<a href="https://www.gnu.org/software/tar/manual/tar.html#SEC117">https://www.gnu.org/software/tar/manual/tar.html#SEC117</a></p>
<p>I.e. run 'stat' on your database dump files and check<br />
if the 'Modify' and 'Change' dates in the 'stat' output<br />
match what 'tar ... --newer=DATE' does in your case.</p>
<h4 id="dcz01_commented_at_2017-04-12_1257"><img src="https://avatars.githubusercontent.com/u/20817288?v=4" width="50"><a href="https://github.com/dcz01">dcz01</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293567349">2017-04-12 12:57</a>:<a class="headerlink" href="#dcz01_commented_at_2017-04-12_1257" title="Permanent link">&para;</a></h4>
<p>@jsmeix Now i ran "rear -d -D mkbackuponly" with the same result, that
ReaR backs the same file up which the previous archive had.<br />
The full log file is attached.<br />
Here is also the output from the "stat" command:<br />
<img alt="4" src="https://cloud.githubusercontent.com/assets/20817288/24958630/42208dd6-1f90-11e7-8481-dbab8975dd07.jpg" /></p>
<p><a href="https://github.com/rear/rear/files/916540/rear-FBD01PSS.txt">rear-FBD01PSS.txt</a></p>
<h4 id="jsmeix_commented_at_2017-04-12_1313"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293571107">2017-04-12 13:13</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-12_1313" title="Permanent link">&para;</a></h4>
<p>Your rear-FBD01PSS.txt contains</p>
<pre>
++ BACKUP_PROG_CREATE_NEWER_OPTIONS='--newer=2017-04-12 -V 2017-04-12-0500-I.tar.gz'
</pre>

<p>which means 'tar' should be called as</p>
<pre>
tar ... --newer=2017-04-12
</pre>

<p>which should backup all files where mtime or ctime (or both)<br />
are newer than 2017-04-12.</p>
<p>I assume "newer than 2017-04-12" means all where<br />
mtime or ctime is later than 2017-04-12 at 00:00 time.</p>
<p>You need to verify in your backup.log file<br />
that 'tar' is acually called as</p>
<pre>
tar ... --newer=2017-04-12
</pre>

<p>and that there are no warning or error messages from 'tar'<br />
about that date setting.</p>
<p>Your 'stat' shows that both mtime and ctime of your<br />
pg_dump_YYYY-MM-DD files are all older<br />
than 2017-04-12 except pg_dump_2017-04-12<br />
so that - when 'tar' works as documented,<br />
only your pg_dump_2017-04-12 should be in the backup.</p>
<p>From my current point of view<br />
(I assume 'tar' is actually called with '--newer=2017-04-12')<br />
it seems this issue is in 'tar' and not in ReaR.</p>
<h4 id="jsmeix_commented_at_2017-04-12_1327"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293575309">2017-04-12 13:27</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-12_1327" title="Permanent link">&para;</a></h4>
<p>For me 'tar --newer' works well on command line.<br />
Example (in my ReaR GitHub checkout):</p>
<pre>
# cp usr/share/rear/conf/default.conf usr/share/rear/conf/dummy.conf

# stat usr/share/rear/conf/d*.conf | egrep 'File:|Modify:|Change:'
  File: 'usr/share/rear/conf/default.conf'
Modify: 2017-04-11 16:10:38.817390944 +0200
Change: 2017-04-11 16:10:38.817390944 +0200
  File: 'usr/share/rear/conf/dummy.conf'
Modify: 2017-04-12 15:24:19.310609526 +0200
Change: 2017-04-12 15:24:19.310609526 +0200

# tar --newer=2017-04-11 -cvf /tmp/testy.tar usr/share/rear/conf/d*.conf
tar: Option --after-date: Treating date '2017-04-11' as 2017-04-11 00:00:00
usr/share/rear/conf/default.conf
usr/share/rear/conf/dummy.conf

# tar -tvf /tmp/testy.tar
-rw-r--r-- root/root     84587 2017-04-11 16:10 usr/share/rear/conf/default.conf
-rw-r--r-- root/root     84587 2017-04-12 15:24 usr/share/rear/conf/dummy.conf

# tar --newer=2017-04-12 -cvf /tmp/testy.tar usr/share/rear/conf/d*.conf
tar: Option --after-date: Treating date '2017-04-12' as 2017-04-12 00:00:00
tar: usr/share/rear/conf/default.conf: file is unchanged; not dumped
usr/share/rear/conf/dummy.conf

# tar -tvf /tmp/testy.tar
-rw-r--r-- root/root     84587 2017-04-12 15:24 usr/share/rear/conf/dummy.conf
</pre>

<h4 id="dcz01_commented_at_2017-04-12_1359"><img src="https://avatars.githubusercontent.com/u/20817288?v=4" width="50"><a href="https://github.com/dcz01">dcz01</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293585973">2017-04-12 13:59</a>:<a class="headerlink" href="#dcz01_commented_at_2017-04-12_1359" title="Permanent link">&para;</a></h4>
<p>Well right now it is working correct and works fine.<br />
But i will wait until tomorrow and see if the backup of tonight at 05:00
(AM) works too.<br />
Then we'll see if the nightly backup holds only one or two copies of and
database dump.<br />
I'll write tomorrow if it worked.</p>
<h4 id="dcz01_commented_at_2017-04-13_0651"><img src="https://avatars.githubusercontent.com/u/20817288?v=4" width="50"><a href="https://github.com/dcz01">dcz01</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293806225">2017-04-13 06:51</a>:<a class="headerlink" href="#dcz01_commented_at_2017-04-13_0651" title="Permanent link">&para;</a></h4>
<p>@jsmeix The backup tonight has done the same. It backed two versions of
database dumps up.<br />
And in the backup.log is the right parameter for the "tar" command
set:<br />
--newer=2017-04-12 -V 2017-04-12-1353-I.tar.gz</p>
<p>Now i think the problem is an logical one... The database dumps are done
at 03:00 (AM) and ReaR starts at 05:00 (AM), so when the
--newer=2017-04-12 starts deciding the files at 00:00 at 12.04.2017 then
really two dumps are choosen to be backed up.<br />
The two are 12.04.2017 at 03:00 (AM) and 13.04.2017 at 03:00 (AM).</p>
<p>Is there not the opportunity to change ReaR, so that the exactly backs
up only the new or changed files from the last incremental backup (maybe
timestamp of the archive)?</p>
<h4 id="jsmeix_commented_at_2017-04-13_0655"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293807959">2017-04-13 06:55</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_0655" title="Permanent link">&para;</a></h4>
<p>Sleeping over an issue always helps,<br />
I think I know now what happens:</p>
<p>Example:<br />
On 2017-04-11 at 04:00 you do a database dump.<br />
On 2017-04-11 at 05:00 you do a backup.<br />
On 2017-04-12 at 04:00 you do another database dump.<br />
On 2017-04-12 at 05:00 you do another backup.<br />
The second backup is run with 'tar --newer=2017-04-11'<br />
cf.
<a href="https://github.com/rear/rear/issues/1285#issuecomment-293571107">https://github.com/rear/rear/issues/1285#issuecomment-293571107</a><br />
but '--newer=2017-04-11' means "newer than 2017-04-11 at 00:00"<br />
cf.
<a href="https://github.com/rear/rear/issues/1285#issuecomment-293575309">https://github.com/rear/rear/issues/1285#issuecomment-293575309</a><br />
so that both database dumps are newer than 2017-04-11 at 00:00<br />
and then both database dumps are in the second backup.</p>
<h4 id="dcz01_commented_at_2017-04-13_0722"><img src="https://avatars.githubusercontent.com/u/20817288?v=4" width="50"><a href="https://github.com/dcz01">dcz01</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293813104">2017-04-13 07:22</a>:<a class="headerlink" href="#dcz01_commented_at_2017-04-13_0722" title="Permanent link">&para;</a></h4>
<p>But should it not be in our example the "tar --newer=2017-04-12" option
in the command?<br />
Then it would be correct or should only the backup window of the
database dump be changed?</p>
<h4 id="jsmeix_commented_at_2017-04-13_0745"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293817443">2017-04-13 07:45</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_0745" title="Permanent link">&para;</a></h4>
<p>Ha - @dcz01 you found out the same as me!<br />
We did both comments simultaneously<br />
but you won because your submitted<br />
your comment 5 minutes eariler<br />
while I was still writing my comment.</p>
<p>The DATE in 'tar --newer=DATE' is (and must be)<br />
the DATE when the last backup was made.</p>
<p>Example:<br />
On 2017-04-10 at 04:00 you do a database dump.<br />
On 2017-04-10 at 05:00 you do a backup.<br />
On 2017-04-11 you change the database.<br />
On 2017-04-12 at 04:00 you do another database dump.<br />
On 2017-04-12 at 05:00 you do another backup.<br />
The second backup is run with 'tar --newer=2017-04-10'<br />
to include all since the day when the last backup was made.</p>
<p>The root cause is that the DATE in 'tar --newer=DATE'<br />
is only a day but no time at that day.</p>
<p>Example:<br />
On 2017-04-11 at 01:00 you do a database dump.<br />
On 2017-04-11 you add a 4GiB ISO image file.<br />
On 2017-04-11 at 23:00 you do a backup.<br />
On 2017-04-12 at 01:00 you do another database dump.<br />
On 2017-04-11 you add another 4GiB ISO image file.<br />
On 2017-04-12 at 23:00 you do another backup.<br />
The second backup is run with 'tar --newer=2017-04-11'<br />
so that it includes all since 2017-04-11 00:00<br />
i.e. both database dumps plus both ISO image files.</p>
<p>I think an enhancement is needed to use a more specific<br />
DATE for 'tar --newer=DATE' basically I think<br />
that DATE should be at least DAY plus HOUR<br />
perhaps even DAY plus HOUR plus MINUTE.</p>
<p>The only crucial point is that ReaR must work on the safe side<br />
so that it must never happen that in a sequence of<br />
incremental backups any tiny bit could be missing,<br />
i.e. in a sequence of incremental backups<br />
the backups should overlap a bit to be on the safe side.</p>
<h4 id="jsmeix_commented_at_2017-04-13_0751"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293818721">2017-04-13 07:51</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_0751" title="Permanent link">&para;</a></h4>
<p>Regarding<br />
<a href="https://github.com/rear/rear/issues/1285#issuecomment-293806225">https://github.com/rear/rear/issues/1285#issuecomment-293806225</a><br />
"exactly backs up only the new or changed files from the last<br />
incremental backup (maybe timestamp of the archive)?"</p>
<p>Careful!</p>
<p>Assume the backup starts on 2017-04-10 at 05:00<br />
and takes two hours to complete i.e. up to 2017-04-10 07:00.</p>
<p>If the backup archive timestamp is 2017-04-10 05:00<br />
things should be o.k but if the backup archive timestamp<br />
is 2017-04-10 07:00 a subsequent incremental backup<br />
that runs with tar --newer='2017-04-10 07:00'<br />
may miss all files that changed between<br />
2017-04-10 05:00 and 2017-04-10 07:00.</p>
<h4 id="jsmeix_commented_at_2017-04-13_0755"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293819555">2017-04-13 07:55</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_0755" title="Permanent link">&para;</a></h4>
<p>What should be o.k. is the timestamp<br />
in the backup archive filename because that is created<br />
in prep/NETFS/default/070_set_backup_archive.sh<br />
as described in the explanatory comments therein.</p>
<p>What might badly fail is to use the system modify or change<br />
timestamps (as shown by 'stat') of the backup archive file<br />
(note the difference "filename" above versus "file" here).</p>
<h4 id="gdha_commented_at_2017-04-13_0756"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293819636">2017-04-13 07:56</a>:<a class="headerlink" href="#gdha_commented_at_2017-04-13_0756" title="Permanent link">&para;</a></h4>
<p>@dcz01 @jsmeix Keep in mind that ReaR is not a backup solution, but
focuses on DR. Did you try to integrate a (open source) backup solution
with ReaR yet? Backup tools are better equipped to deal with such time
sensitive backup tasks then ReaR. Just my 2cents...</p>
<h4 id="jsmeix_commented_at_2017-04-13_0809"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293822278">2017-04-13 08:09</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_0809" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
I know, I know - and I wished ReaR never got added<br />
that code for advanced backup functionality<br />
(cf. my various other comments regarding all those<br />
issues with incremental/differential backup in ReaR)<br />
but as that code is already there in ReaR<br />
my opinion is that then the code must work<br />
reasonable well.</p>
<p>Cf. the similar issue<br />
<a href="https://github.com/rear/rear/issues/1283">https://github.com/rear/rear/issues/1283</a><br />
where ReaR got code added that actually<br />
does not belong to ReaR's native task.</p>
<p>See also the various issues with BACKUP_URL=usb<br />
that exist only because support for BACKUP_URL=usb<br />
was added as some kind of "ad hoc addon hack"<br />
instead of a properly designed integration in compliance<br />
with the existing ReaR framework.</p>
<p>Frankly:<br />
I do not like to work on that kind of code in ReaR<br />
but I do it to avoid bug reports from SUSE users<br />
who use existing functionality in ReaR and<br />
rightfully expect that existing functionality in ReaR<br />
works reasonably well.</p>
<p>Regarding how to get rid of existing functionality in ReaR<br />
that we actually do no longer want to have in ReaR<br />
because we cannot maintain it with reasonable effort<br />
or because it is "plain wrong" implemented, see<br />
<a href="https://github.com/rear/rear/issues/1173">https://github.com/rear/rear/issues/1173</a></p>
<h4 id="dcz01_commented_at_2017-04-13_0818"><img src="https://avatars.githubusercontent.com/u/20817288?v=4" width="50"><a href="https://github.com/dcz01">dcz01</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293824252">2017-04-13 08:18</a>:<a class="headerlink" href="#dcz01_commented_at_2017-04-13_0818" title="Permanent link">&para;</a></h4>
<p>@gdha @jsmeix I know that you don't like to support or maintain the code
for "tar" or "rsync" backups with ReaR. I can understand that and i
accept that ReaR is actual an DR solution an no backup program...<br />
But we searched for our clients (banks) a solution to backup their linux
servers from us (RHEL) which didn't need an separate server like TSM
(what many other clients use in combination with ReaR from us).<br />
So ReaR works great since today with the "tar" backups and we like that
functions very much.</p>
<h4 id="jsmeix_commented_at_2017-04-13_0827"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293825945">2017-04-13 08:27</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_0827" title="Permanent link">&para;</a></h4>
<p>And the good news for ReaR upstream is:</p>
<p>Because SUSE pays me I can work on such code in ReaR<br />
and make it work reasonably well.<br />
And why can SUSE pay me for that?<br />
Because existing functionality in ReaR works reasonably well<br />
for SUSE customers who use ReaR so that they buy SUSE<br />
products (actually they pay for maintenance and support).</p>
<p>But I would never ever work on such code<br />
on a voluntary base - Ugh!</p>
<p>@dcz01<br />
don't worry, I work on ReaR upstream code<br />
so that even Red Hat users get it ;-)</p>
<p>And why do I pay attention to Red Hat user issues?</p>
<p>Because basically always a Red Hat user issue<br />
is also valid for SUSE users and the more<br />
Red Hat users use current ReaR upstream code<br />
the more issues get known in advance and<br />
the less new issues happen to SUSE users.</p>
<p>In the end everybody wins.</p>
<p>I like free software!</p>
<h4 id="dcz01_commented_at_2017-04-13_0836"><img src="https://avatars.githubusercontent.com/u/20817288?v=4" width="50"><a href="https://github.com/dcz01">dcz01</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293827973">2017-04-13 08:36</a>:<a class="headerlink" href="#dcz01_commented_at_2017-04-13_0836" title="Permanent link">&para;</a></h4>
<p>@jsmeix Well i must say that we actually don't use the real RHEL... Only
CentOS is our basic system for us and clients. But its excatly the same
so it works well too.<br />
Thats a good thing if you get paid for updates in ReaR :-)</p>
<h4 id="jsmeix_commented_at_2017-04-13_0844"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293829755">2017-04-13 08:44</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_0844" title="Permanent link">&para;</a></h4>
<p>@dcz01<br />
only an offanded idea I think (but I did not test it)<br />
a possible workaround with current ReaR code is to<br />
do the database dump on 23:00<br />
and the ReaR backup on 01:00<br />
provided your timing during the night allows this.</p>
<p>Then this should happen:<br />
On 2017-04-10 at 23:00 you do a database dump.<br />
On 2017-04-11 at 01:00 you do a backup.<br />
During 2017-04-11 daytime the database is in use.<br />
On 2017-04-11 at 23:00 you do another database dump.<br />
On 2017-04-12 at 01:00 you do another backup.<br />
The second backup is run with 'tar --newer=2017-04-11'<br />
so that it only includes the second database dump.</p>
<h4 id="jsmeix_commented_at_2017-04-13_0950"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293844507">2017-04-13 09:50</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_0950" title="Permanent link">&para;</a></h4>
<p>Only FYI:<br />
The behaviour that the DATE in 'tar --newer=DATE'<br />
is only a DAY without HOUR or MINUTE exists<br />
since the beginning according to<br />
git log -p --follow
usr/share/rear/prep/NETFS/default/070_set_backup_archive.sh<br />
that shows</p>
<pre>
commit 354486da3191dbfe5c6a4b896e34977be10697d5
...
BACKUP_PROG_X_OPTIONS="$BACKUP_PROG_X_OPTIONS --newer=$(cat ${BUILD_DIR}/outputfs/${NETFS_PREFIX}/timestamp.txt)"
...
date '+%Y-%m-%d' > "${BUILD_DIR}/outputfs/${NETFS_PREFIX}/timestamp.txt"
</pre>

<h4 id="jsmeix_commented_at_2017-04-13_1224"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293880670">2017-04-13 12:24</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_1224" title="Permanent link">&para;</a></h4>
<p>It seems the DATE in 'tar --newer=DATE' is a can of worms,<br />
more specifically time zone setting is a can of worms.</p>
<p>On my SLES11 system</p>
<pre>
# export LC_ALL=POSIX
# export LANG=POSIX

# date +%Z
CEST

# echo Hello >hello

# date
Thu Apr 13 14:17:35 CEST 2017

# stat hello | egrep 'File:|Modify:|Change:'
  File: `hello'
Modify: 2017-04-13 14:17:33.708371000 +0200
Change: 2017-04-13 14:17:33.708371000 +0200

# tar --newer=2017-04-13T14:16 -cvf /dev/null hello
tar: Option --after-date: Treating date `2017-04-13T14:16' as 2017-04-13 09:16:00
hello

# tar --newer=2017-04-13T14:18 -cvf /dev/null hello
tar: Option --after-date: Treating date `2017-04-13T14:18' as 2017-04-13 09:18:00
hello

# tar --newer=2017-04-13T19:16 -cvf /dev/null hello
tar: Option --after-date: Treating date `2017-04-13T19:16' as 2017-04-13 14:16:00
hello

# tar --newer=2017-04-13T19:18 -cvf /dev/null hello
tar: Option --after-date: Treating date `2017-04-13T19:18' as 2017-04-13 14:18:00
tar: hello: file is unchanged; not dumped
</pre>

<p>note how 'tar' in SLES11 somehow misinterprets the specified<br />
date as another (wrong) date (an offset of -5 hours) that<br />
does not match the date that is shown by 'date' and 'stat'<br />
so that it seems 'tar' in SLES11 has a bug.</p>
<p>In particular it seems 'tar' in SLES11 has a bug<br />
because on SLES12 it works - i.e. the date in 'tar'<br />
matches the date that is shown by 'date' and 'stat':</p>
<pre>
# export LC_ALL=POSIX
# export LANG=POSIX

# date +%Z
CEST

# echo Hello >hello

# date
Thu Apr 13 14:22:33 CEST 2017

# stat hello | egrep 'File:|Modify:|Change:'
  File: 'hello'
Modify: 2017-04-13 14:22:27.955299761 +0200
Change: 2017-04-13 14:22:27.955299761 +0200

# tar --newer=2017-04-13T14:21 -cvf /dev/null hello
tar: Option --after-date: Treating date '2017-04-13T14:21' as 2017-04-13 14:21:00
hello

# tar --newer=2017-04-13T14:23 -cvf /dev/null hello
tar: Option --after-date: Treating date '2017-04-13T14:23' as 2017-04-13 14:23:00
tar: hello: file is unchanged; not dumped
</pre>

<h4 id="jsmeix_commented_at_2017-04-13_1329"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293895352">2017-04-13 13:29</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_1329" title="Permanent link">&para;</a></h4>
<p>The GNU tar documentation doesn't look promising<br />
<a href="https://www.gnu.org/software/tar/manual/tar.html#SEC117">https://www.gnu.org/software/tar/manual/tar.html#SEC117</a><br />
reads (excerpts)</p>
<pre>
to specify a particular date against
which tar can compare when deciding
whether or not to archive the files.
`--after-date=date'
`--newer=date'
`-N date'
Only store files newer than date.
...
 `--newer-mtime=date'
Acts like `--after-date', but only looks
at data modification times. 

[...]

Please Note: `--after-date' and `--newer-mtime'
should not be used for incremental backups.
See section
https://www.gnu.org/software/tar/manual/tar.html#SEC97
for proper way of creating incremental backups.
</pre>

<p>But as far as I understand<br />
<a href="https://www.gnu.org/software/tar/manual/tar.html#SEC97">https://www.gnu.org/software/tar/manual/tar.html#SEC97</a><br />
this conflicts with how a 'tar' backup is done in ReaR.<br />
Their "proper way of creating incremental backups" with 'tar'<br />
would result and need an additional metadata file<br />
which would even more complicate the incremental<br />
backup implementation in ReaR which I will not do.<br />
The current incremental backup implementation<br />
is already way beyond ReaR's native task, cf. my<br />
<a href="https://github.com/rear/rear/issues/1285#issuecomment-293822278">https://github.com/rear/rear/issues/1285#issuecomment-293822278</a></p>
<h4 id="dcz01_commented_at_2017-04-13_1349"><img src="https://avatars.githubusercontent.com/u/20817288?v=4" width="50"><a href="https://github.com/dcz01">dcz01</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293900724">2017-04-13 13:49</a>:<a class="headerlink" href="#dcz01_commented_at_2017-04-13_1349" title="Permanent link">&para;</a></h4>
<p>@jsmeix Yes, that implementation with the extra file for tracking the
changes and newer files between the old archive is complex.<br />
But i found something in the 1.23 manual of tar:<br />
<strong>-N, --newer=DATE-OR-FILE, --after-date=DATE-OR-FILE<br />
only store files newer than DATE-OR-FILE</strong></p>
<p>So you can give the --newer parameter an date or file to choose from for
the changes.<br />
We would need the file then or?</p>
<h4 id="jsmeix_commented_at_2017-04-13_1351"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293901345">2017-04-13 13:51</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_1351" title="Permanent link">&para;</a></h4>
<p>First and foremost:<br />
There is no bug in ReaR.<br />
The current 'tar --newer=yyyy-mm-dd' implementation works<br />
correctly as implemented and as documented in 'tar'.</p>
<p>The current 'tar --newer=yyyy-mm-dd' form even works<br />
with 'tar' in SLES11 that has a bug with the more<br />
sophisticated 'tar --newer=yyyy-mm-ddThh:mm' form, cf.<br />
<a href="https://github.com/rear/rear/issues/1285#issuecomment-293880670">https://github.com/rear/rear/issues/1285#issuecomment-293880670</a><br />
while in contrast 'tar --newer=yyyy-mm-dd' works in SLE11:</p>
<pre>
#  stat hello | egrep 'File:|Modify:|Change:'
  File: `hello'
Modify: 2017-04-13 14:17:33.708371000 +0200
Change: 2017-04-13 14:17:33.708371000 +0200

# tar --newer=2017-04-13 -cvf /dev/null hello
tar: Option --after-date: Treating date `2017-04-13' as 2017-04-13 00:00:00
hello

# tar --newer=2017-04-14 -cvf /dev/null hello
tar: Option --after-date: Treating date `2017-04-14' as 2017-04-14 00:00:00
tar: hello: file is unchanged; not dumped
</pre>

<p>Enhancing prep/NETFS/default/070_set_backup_archive.sh<br />
to support 'tar --newer=yyyy-mm-ddThh:mm' results<br />
regressions in SLES11 and it requires major adaptions<br />
and rework and will only be done as time permits<br />
for an unspecified future ReaR version when ReaR<br />
does no longer support SLES11.</p>
<p>Preferably a contributor to ReaR may provide<br />
a GitHub pull request that implements<br />
'tar --newer=yyyy-mm-ddThh:mm' support properly<br />
(perhaps even with a workaround for buggy tar versions)?</p>
<h4 id="jsmeix_commented_at_2017-04-13_1353"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293901885">2017-04-13 13:53</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_1353" title="Permanent link">&para;</a></h4>
<p>@dcz01<br />
bad luck for you because I will not implement changes<br />
that cause regressions for SLES11 :-(</p>
<h4 id="dcz01_commented_at_2017-04-13_1358"><img src="https://avatars.githubusercontent.com/u/20817288?v=4" width="50"><a href="https://github.com/dcz01">dcz01</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293903095">2017-04-13 13:58</a>:<a class="headerlink" href="#dcz01_commented_at_2017-04-13_1358" title="Permanent link">&para;</a></h4>
<p>@jsmeix Now i found a perfect solution for you:<br />
<a href="http://www.linuxquestions.org/questions/linux-general-1/tar-newer-files-since-date-and-time-447002/">http://www.linuxquestions.org/questions/linux-general-1/tar-newer-files-since-date-and-time-447002/</a><br />
<a href="http://extreme.pcgameshardware.de/linux-und-sonstige-betriebssysteme/146687-problem-mit-tar-und-der-option-newer-date.html">http://extreme.pcgameshardware.de/linux-und-sonstige-betriebssysteme/146687-problem-mit-tar-und-der-option-newer-date.html</a></p>
<p>You can give tar not only the date... In an string you can give it the
date and time.</p>
<h4 id="jsmeix_commented_at_2017-04-13_1410"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-293906383">2017-04-13 14:10</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-13_1410" title="Permanent link">&para;</a></h4>
<p>@dcz01<br />
I know how to provide date and time<br />
as 'tar --newer=yyyy-mm-ddThh:mm'<br />
but that does not work for me on SLES11.</p>
<p>Regarding your<br />
<a href="https://github.com/rear/rear/issues/1285#issuecomment-293900724">https://github.com/rear/rear/issues/1285#issuecomment-293900724</a><br />
to use a file instead of a specific date and time, see<br />
<a href="https://github.com/rear/rear/issues/1285#issuecomment-293819555">https://github.com/rear/rear/issues/1285#issuecomment-293819555</a></p>
<p>I would appreciate it of you play around with it on your systems<br />
and provide feedback here what fails and what works for you<br />
in your particular case.</p>
<p>Perhaps you find a sufficiently simple and fail-safe method.</p>
<p>That I gave up here (at least for now) does not at all mean<br />
I will not have a look when there is interesting new information.<br />
It only means that from my current point of view I don't see<br />
how I could implemement it in a sufficiently simple<br />
and fail-safe way.</p>
<h4 id="jsmeix_commented_at_2017-05-04_1053"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-299153040">2017-05-04 10:53</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-05-04_1053" title="Permanent link">&para;</a></h4>
<p>Because of the bad experience with<br />
'tar --newer=yyyy-mm-ddThh:mm'<br />
on my SLES11 system in my above<br />
<a href="https://github.com/rear/rear/issues/1285#issuecomment-293880670">https://github.com/rear/rear/issues/1285#issuecomment-293880670</a><br />
I had the idea if it works when I also specify the seconds as in<br />
'tar --newer=yyyy-mm-ddThh:mm:ss'<br />
to avoid that 'tar' does no longer do its broken re-calculation<br />
of the specified date/time value when it gets a precisely<br />
specified date/time value.</p>
<p>But that also does not work:</p>
<pre>
# export LC_ALL=POSIX
# export LANG=POSIX

# date +%Z
CEST

# echo Hello >hello

# date
Thu May  4 12:42:36 CEST 2017

# stat hello | egrep 'File:|Modify:|Change:'
  File: `hello'
Modify: 2017-05-04 12:42:32.000000000 +0200
Change: 2017-05-04 12:42:32.000000000 +0200

# tar --newer=2017-05-04T12:42:32 -cvf /dev/null hello
tar: Option --after-date: Treating date `2017-05-04T12:42:32' as 2017-05-04 07:42:32
hello

# tar --newer=2017-05-04T17:42:32 -cvf /dev/null hello
tar: Option --after-date: Treating date `2017-05-04T17:42:32' as 2017-05-04 12:42:32
hello

# tar --newer=2017-05-04T17:42:33 -cvf /dev/null hello
tar: Option --after-date: Treating date `2017-05-04T17:42:33' as 2017-05-04 12:42:33
tar: hello: file is unchanged; not dumped
</pre>

<p>There is still the 5 hours offset when tar is "Treating date".</p>
<h4 id="jsmeix_commented_at_2017-05-08_1243"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1285#issuecomment-299856209">2017-05-08 12:43</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-05-08_1243" title="Permanent link">&para;</a></h4>
<p>With
<a href="https://github.com/rear/rear/pull/1350">https://github.com/rear/rear/pull/1350</a>
merged<br />
the incremental/differential backup timing granularity<br />
(one day and the differentiating time is at 00:00)<br />
plus its consequence is now at least documented<br />
in default.conf.</p>
<p>I also documented in default.conf another shortcoming of<br />
BACKUP_TYPE=incremental or BACKUP_TYPE=differential:</p>
<pre>
Because of '--newer=YYYY-MM-DD' files that have been
deleted since the last backup are not recognized this way
so that such files will get falsely restored during "rear recover".
</pre>

<p>Finally I added in default.conf some general info<br />
about ReaR's internal backup methods:</p>
<pre>
In general regarding advanced backup functionality
(like incremental and differential backup):
ReaR is primarily a disaster recovery tool to recreate
the basic system after a disaster happened.
ReaR is is neither a backup software nor a backup
management software and it is not meant to be one
(cf. "Relax-and-Recover versus backup and restore"
in https://en.opensuse.org/SDB:Disaster_Recovery).
In particular do not expect too much from ReaR's
internal backup methods like 'tar'.
For simple tasks ReaR's internal backup
methods should be o.k. but
ReaR's internal backup methods are not meant
as professional backup solutions.
In general the backup and restore of the files
is "external functionality" for ReaR.
ReaR only calls an external tool and that tool
does the backup and restore of the files.
Use a professional backup solution in particular
when you need advanced backup functionality.
</pre>

<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2026 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2017-04-12.1285.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
