<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1267 PR merged: Added required libs and files for curl with HTTPs by default - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1267 PR merged: Added required libs and files for curl with HTTPs by default";
        var mkdocs_page_input_path = "issues/2017-03-28.1267.pr.merged.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rsync.html">Internal Backup using BACKUP=RSYNC method</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1267 PR merged: Added required libs and files for curl with HTTPs by default</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1267_pr_merged_added_required_libs_and_files_for_curl_with_https_by_default"><a href="https://github.com/rear/rear/pull/1267">#1267 PR</a> <code>merged</code>: Added required libs and files for curl with HTTPs by default<a class="headerlink" href="#1267_pr_merged_added_required_libs_and_files_for_curl_with_https_by_default" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>cleanup</code>, <code>fixed / solved / done</code></p>
<h4 id="didacog_opened_issue_at_2017-03-28_0953"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> opened issue at <a href="https://github.com/rear/rear/pull/1267">2017-03-28 09:53</a>:<a class="headerlink" href="#didacog_opened_issue_at_2017-03-28_0953" title="Permanent link">&para;</a></h4>
<p>This PR will add support for curl (HTTPS)<br />
brief description of changes:</p>
<p>Added required LIBS and files to <strong>/usr/share/rear/conf/GNU/Linux.conf</strong>
and remove them from
<strong>/usr/share/rear/init/default/010_set_drlm_env.sh</strong></p>
<p>This code has been tested on RHEL/CentOS, SLES/OpenSUSE and
Debian/Ubuntu.</p>
<h4 id="didacog_commented_at_2017-03-28_1205"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/pull/1267#issuecomment-289748588">2017-03-28 12:05</a>:<a class="headerlink" href="#didacog_commented_at_2017-03-28_1205" title="Permanent link">&para;</a></h4>
<p>Hi @jsmeix,</p>
<p>Any suggestion will be appreciated, I just added the libs and files
because now curl is added by default and just in order to work over HTTP
and HTTPs without issues.</p>
<p>Regards,</p>
<h4 id="jsmeix_commented_at_2017-03-28_1217"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/1267#issuecomment-289751288">2017-03-28 12:17</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-03-28_1217" title="Permanent link">&para;</a></h4>
<p>I think it would be rather unexpected nowadays<br />
when curl works via HTTP but not via HTTPS<br />
so that I think this pull request should be merged "as is".</p>
<p>Later - preferably only when a user can show some evidence<br />
that nowadays the recovery system is too big - we could add<br />
support for things like LIBS_EXCLUDE / PROGS_EXCLUDE</p>
<p>FYI:<br />
Since I impemented FIRMWARE_FILES support<br />
the user can make his recovery system really noticeable<br />
smaller compared to what it was before,<br />
cf.
<a href="https://github.com/rear/rear/issues/1216">https://github.com/rear/rear/issues/1216</a></p>
<h4 id="didacog_commented_at_2017-03-28_1221"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/pull/1267#issuecomment-289752093">2017-03-28 12:21</a>:<a class="headerlink" href="#didacog_commented_at_2017-03-28_1221" title="Permanent link">&para;</a></h4>
<p>Yes, I've seen that issue ;-)</p>
<p>Thx!</p>
<h4 id="jsmeix_commented_at_2017-03-28_1253"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/1267#issuecomment-289759920">2017-03-28 12:53</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-03-28_1253" title="Permanent link">&para;</a></h4>
<p>This is a follow up for
<a href="https://github.com/rear/rear/pull/1248">https://github.com/rear/rear/pull/1248</a></p>
<h4 id="jsmeix_commented_at_2017-04-05_1147"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/1267#issuecomment-291836695">2017-04-05 11:47</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-05_1147" title="Permanent link">&para;</a></h4>
<p>@didacog<br />
in<br />
<a href="https://github.com/rear/rear/pull/1278#issuecomment-291835588">https://github.com/rear/rear/pull/1278#issuecomment-291835588</a><br />
I am thinking about whether or not the<br />
current default setting in conf/GNU/Linux.conf</p>
<pre>
COPY_AS_IS=( ... /etc/ssl/certs/* /etc/pki/* )
</pre>

<p>could lead to security issues.</p>
<p>Reason:<br />
As far as I understand it - in /etc/ssl/certs or /etc/pki<br />
also self-generated private stuff could be stored<br />
which would then by default get copied into the<br />
ReaR recovery system.</p>
<p>But by default the ReaR recovery system should not contain<br />
confidential or private stuff (as far as I remember what<br />
@schlomo wrote a longer time ago) unless the user<br />
had explicitly configured something.</p>
<h4 id="didacog_commented_at_2017-04-05_1200"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/pull/1267#issuecomment-291839630">2017-04-05 12:00</a>:<a class="headerlink" href="#didacog_commented_at_2017-04-05_1200" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<p>This is required by curl with https, there are stored de distribution
provided certificates installed from packages, nothing confidential.
Usually the public verified certs, and not private keys as far as I
know.<br />
For example the private keys are stored in <strong>/etc/ssl/private</strong> (not
copied)<br />
In /etc/pki maybe <strong>/etc/pki/tls/private</strong> should be excluded.</p>
<h4 id="gdha_commented_at_2017-04-05_1201"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/pull/1267#issuecomment-291839888">2017-04-05 12:01</a>:<a class="headerlink" href="#gdha_commented_at_2017-04-05_1201" title="Permanent link">&para;</a></h4>
<p>@didacog Good catch - try to <strong>exclude</strong> all private keys.</p>
<h4 id="didacog_commented_at_2017-04-05_1204"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/pull/1267#issuecomment-291840492">2017-04-05 12:04</a>:<a class="headerlink" href="#didacog_commented_at_2017-04-05_1204" title="Permanent link">&para;</a></h4>
<p>@gdha @jsmeix I will try to adjust it and send a new pull request
excluding private keys location from /etc/pki.</p>
<h4 id="didacog_commented_at_2017-04-05_1217"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/pull/1267#issuecomment-291843342">2017-04-05 12:17</a>:<a class="headerlink" href="#didacog_commented_at_2017-04-05_1217" title="Permanent link">&para;</a></h4>
<p>I guess this should work:<br />
In <strong>usr/share/rear/conf/GNU/Linux.conf</strong>:</p>
<p><code>COPY_AS_IS_EXCLUDE=( ${COPY_AS_IS_EXCLUDE[@]:-} dev/shm/\* /etc/pki/private/* )</code></p>
<p>Let me test and check if more stuff should be excluded before PR.</p>
<h4 id="jsmeix_commented_at_2017-04-05_1231"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/1267#issuecomment-291846797">2017-04-05 12:31</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-05_1231" title="Permanent link">&para;</a></h4>
<p>@didacog<br />
when you work on it could you add some explanatory<br />
comments directly in the code that tell about why<br />
stuff is included and other stuff is excluded so that<br />
others can even a longer time later still understand<br />
the reasons behind, cf.<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a></p>
<p>To get comments at the right place inside longer bash arrays<br />
I would suggest to do it somehow like this:</p>
<pre>
COPY_AS_IS=( ${COPY_AS_IS[@]:-} /dev /etc/inputr[c] /etc/protocols /etc/services /etc/rpc /etc/termcap /etc/terminfo /lib*/terminfo /usr/share/terminfo /etc/netconfig /etc/mke2
fs.conf /etc/*-release /etc/localtime /etc/magic /usr/share/misc/magic /etc/dracut.conf /etc/dracut.conf.d /usr/lib/dracut /sbin/modprobe.ksplice-orig /etc/sysctl.conf /etc/sys
ctl.d /etc/e2fsck.conf )
# Required by curl with https:
# There are stored the distribution provided certificates
# installed from packages, nothing confidential.
# Usually the public verified certs, and not private keys.
# The private keys are stored in /etc/ssl/private (not copied)
# In /etc/pki maybe /etc/pki/tls/private is excluded (see below).
COPY_AS_IS=( "${COPY_AS_IS[@]}" '/etc/ssl/certs/*' '/etc/pki/*' )
# exclude /dev/shm/*, due to the way we use tar the leading / should be omitted
COPY_AS_IS_EXCLUDE=( ${COPY_AS_IS_EXCLUDE[@]:-} dev/shm/\* )
# Exclude /etc/pki/tls/private (cf. above):
COPY_AS_IS_EXCLUDE=( "${COPY_AS_IS_EXCLUDE[@]}" '/etc/pki/private/*' )
</pre>

<p>Note that using ${VAR[@]} without double-quotes is problematic<br />
so that one should use "${VAR[@]}" see 'Arrays' in "man bash"<br />
and see
<a href="https://github.com/rear/rear/issues/1068">https://github.com/rear/rear/issues/1068</a></p>
<p>Furthermore I wonder if bash globbing must be<br />
avoided for values like /path/to/something/*<br />
by using single quotes '/path/to/something/*'<br />
or if bash globbing is intended by not using single quotes?</p>
<h4 id="didacog_commented_at_2017-04-05_1425"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/pull/1267#issuecomment-291878134">2017-04-05 14:25</a>:<a class="headerlink" href="#didacog_commented_at_2017-04-05_1425" title="Permanent link">&para;</a></h4>
<p>@jsmeix @gdha</p>
<p>I've sent a PR #1279 with the changes tested.</p>
<p>Finally, to exclude all priivate keys:</p>
<pre><code>/etc/pki/tls/private 
/etc/pki/CA/private
/etc/pki/nssdb/key*.db
</code></pre>
<p>Regards,</p>
<h4 id="jsmeix_commented_at_2017-04-05_1452"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/1267#issuecomment-291886868">2017-04-05 14:52</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-04-05_1452" title="Permanent link">&para;</a></h4>
<p>I "just merged"
<a href="https://github.com/rear/rear/pull/1279">https://github.com/rear/rear/pull/1279</a><br />
to get that possible security issue solved as fast as possible.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2017-03-28.1267.pr.merged.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
