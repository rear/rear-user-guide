<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1040 Issue closed: Use ShellCheck for ReaR scripts static analysis - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1040 Issue closed: Use ShellCheck for ReaR scripts static analysis";
        var mkdocs_page_input_path = "issues/2016-10-19.1040.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1040 Issue closed: Use ShellCheck for ReaR scripts static analysis</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1040_issue_closed_use_shellcheck_for_rear_scripts_static_analysis"><a href="https://github.com/rear/rear/issues/1040">#1040 Issue</a> <code>closed</code>: Use ShellCheck for ReaR scripts static analysis<a class="headerlink" href="#1040_issue_closed_use_shellcheck_for_rear_scripts_static_analysis" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>cleanup</code>, <code>fixed / solved / done</code>,
<code>ReaR Project</code></p>
<h4 id="jsmeix_opened_issue_at_2016-10-19_1238"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> opened issue at <a href="https://github.com/rear/rear/issues/1040">2016-10-19 12:38</a>:<a class="headerlink" href="#jsmeix_opened_issue_at_2016-10-19_1238" title="Permanent link">&para;</a></h4>
<p>Currently rear scripts are only checked with "bash -n".</p>
<p>This is rather insufficient because "bash -n" detects only<br />
hard syntax errors but not at all any of the zillions of bad things<br />
that make bash scripts fail during runtime.</p>
<p>Hereby I will try to find out if ShellCheck could be used<br />
for rear scripts static analysis so that we can find more<br />
bugs before our users get hit by them during runtime.</p>
<p>For ShellCheck<br />
<a href="https://github.com/koalaman/shellcheck">https://github.com/koalaman/shellcheck</a></p>
<p>For some related issues see<br />
<a href="https://github.com/rear/rear/issues/549">https://github.com/rear/rear/issues/549</a><br />
and<br />
<a href="https://github.com/rear/rear/pull/1037#issuecomment-254770656">https://github.com/rear/rear/pull/1037#issuecomment-254770656</a><br />
<a href="https://github.com/rear/rear/pull/1037#issuecomment-254798217">https://github.com/rear/rear/pull/1037#issuecomment-254798217</a></p>
<h4 id="thomasmerz_commented_at_2022-02-04_1629"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1030147133">2022-02-04 16:29</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-02-04_1629" title="Permanent link">&para;</a></h4>
<p>Hi @jsmeix , please have a look at my PR
<a href="https://github.com/rear/rear/pull/2754">https://github.com/rear/rear/pull/2754</a>
and review and merge if everything is fine for you. Kind regards from a
valued SLES customer who's also fine with openSUSE 😉</p>
<h4 id="pcahyna_commented_at_2022-02-04_1652"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1030165555">2022-02-04 16:52</a>:<a class="headerlink" href="#pcahyna_commented_at_2022-02-04_1652" title="Permanent link">&para;</a></h4>
<p>There are people working on this now (@antonvoznia. @thomasmerz). I
propose to define some acceptance criteria here first.</p>
<h4 id="thomasmerz_commented_at_2022-02-04_1828"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1030243584">2022-02-04 18:28</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-02-04_1828" title="Permanent link">&para;</a></h4>
<p>I usually fix scripts top-down, straight forward and let some experts
check/test the <code>shellcheck</code>ed version. Acceptance criteria should be
that <code>rear</code> and the test-scripts are still doing what they expected to
do 😉</p>
<p>I thought that those test-scripts might exist for exactly this: to
ensure that any change don't break anything. But I don't know how to use
them / how you use them to test/check any changes. It might also be
reasonable to have a GitHub Action for tests… My PR #2754 can be used
as a template for another testing-action for every change in any script…</p>
<p>Do you agree or do you need more details on some acceptance criteria?</p>
<h4 id="thomasmerz_commented_at_2022-02-04_2054"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1030341624">2022-02-04 20:54</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-02-04_2054" title="Permanent link">&para;</a></h4>
<p>@pcahyna , please review my PR
<a href="https://github.com/rear/rear/pull/2756">https://github.com/rear/rear/pull/2756</a><br />
Do you like one commit per changed script in the final PR or should I
rebase and force-push into one single commit?</p>
<h4 id="pcahyna_commented_at_2022-02-09_2249"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034278415">2022-02-09 22:49</a>:<a class="headerlink" href="#pcahyna_commented_at_2022-02-09_2249" title="Permanent link">&para;</a></h4>
<blockquote>
<p>Acceptance criteria should be that rear and the test-scripts are still
doing what they expected to do</p>
</blockquote>
<p>@thomasmerz Sorry for the late reply - I meant acceptance criteria for
the automation (CI) that will run the shellcheck tests, not for the
changes that will fix the problems.</p>
<p>My acceptance criteria for this automation are:</p>
<ul>
<li>show only newly introduced problems, not all problems for a given
    PR. The number of ShellCheck-detected problems in current code is
    very high. One can not expect to have all of them fixed soon. At the
    same time, PR submitters and reviewers certainly do not want to be
    bothered by hundreds of errors in old code, they need to focus on
    what changed.</li>
<li>do not produce too many false positives (subjective, but if there is
    some warning that occurs all the time withous singifying a real
    problem, it is preferable to turn it off).</li>
<li>nice to have UI feature, not strictly necessary, but highly
    desirable: show the problems in the web UI in the diff view at the
    lines where the problems are detected.</li>
</ul>
<p>From my POV especially the first item is a must have and I don't think
your proposed solution achieves this.<br />
Now the problem is how to coordinate: @antonvoznia needs to know whether
to work on this subject in his diploma thesis or on something else. If
he works on this, we plan to have it ready in about half a year (not
because it is so difficult, but because other topics have higher
priority). Of course, I understand that you or someone else might come
with a solution sooner.</p>
<p>@antonvoznia can you please link an example PR to show the solution(s)
you have been researching, so that others can see how the UX looks like?</p>
<h4 id="jsmeix_commented_at_2022-02-10_0725"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034576705">2022-02-10 07:25</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-02-10_0725" title="Permanent link">&para;</a></h4>
<p>I would like to emphasise the "no false positives" acceptance criteria:</p>
<p>In the past I gave up on bash checking tools because the few I tested
shortly<br />
produced tons of false positives so all had been useless for me "out of
the box".</p>
<p>In particular - as far as I remember - they produced many coding style
warnings<br />
which are no errors but mostly a matter of taste how one writes code,
cf.<br />
<a href="https://schlomo.schapiro.org/2015/04/warning-is-waste-of-my-time.html">https://schlomo.schapiro.org/2015/04/warning-is-waste-of-my-time.html</a></p>
<p>Then they often detect things which they show as a problem but
actually<br />
the code is intentionally as is because the tool cannot understand the<br />
meaning of code but only apply dumb static checking rules.</p>
<p>As far as I remember one can manually configure at least some of them<br />
to exclude certain tests (e.g. by special comments in the code to skip<br />
certain checks at specific code places) but I didn't had interest in
that<br />
when the default results tons of false positives so I would have to sort
out<br />
tons of issues before I could get something that might be useful in
practice for me.<br />
Simply put:<br />
When taming such tools costs me more time<br />
than making and testing my code<br />
then it is not worth the effort.</p>
<p>My primary use case is detecting accidentally misspelled identifiers<br />
like variables or functions or programs and things like that<br />
i.e. typo detection, cf.
<a href="https://github.com/rear/rear/issues/549">https://github.com/rear/rear/issues/549</a><br />
because I can only test one or a few main paths of the code<br />
but not all the special cases and error handling paths.</p>
<p>Bottom line:<br />
A code checking tool must provide me real net value<br />
that actually helps me to avoid errors in my code.<br />
I don't want some patronizing wisenheimer bot.</p>
<h4 id="thomasmerz_commented_at_2022-02-10_1023"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034743874">2022-02-10 10:23</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-02-10_1023" title="Permanent link">&para;</a></h4>
<p>@pcahyna and @antonvoznia</p>
<blockquote>
<ul>
<li>show only newly introduced problems, not all problems for a given
    PR. The number of ShellCheck-detected problems in current code is
    very high. One can not expect to have all of them fixed soon.</li>
</ul>
</blockquote>
<p>"One" (man or machine) can - please review my PR #2756 😜</p>
<h4 id="thomasmerz_commented_at_2022-02-10_1027"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034748577">2022-02-10 10:27</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-02-10_1027" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<blockquote>
<p>In the past I gave up on bash checking tools because the few I tested
shortly produced tons of false positives so all had been useless for
me "out of the box".</p>
<p>In particular - as far as I remember - they produced many coding style
warnings which are no errors but mostly a matter of taste how one
writes code, cf.</p>
</blockquote>
<p>I agree. But this can easily solved because <code>shellcheck</code> could only warn
above a specific "Minimum severity of errors to consider (error,
warning, info, style)" so that only important warnings and errors are
shown. I also dislike info and even style because I sometimes use my
"own style" 🤣</p>
<p>In my PR #2754 I already kept this in mind before you even spoke it out
loudly:</p>
<pre><code>--severity=warning --exclude=SC1091,SC1090
</code></pre>
<p>Details for excludes:<br />
<a href="https://github.com/koalaman/shellcheck/wiki/SC1090">https://github.com/koalaman/shellcheck/wiki/SC1090</a><br />
<a href="https://github.com/koalaman/shellcheck/wiki/SC1091">https://github.com/koalaman/shellcheck/wiki/SC1091</a></p>
<p>Plus: <code>shellcheck</code> can be disabled for each single occurrence where
"one" knows it better (or wants to ignore the warning or because a
solution is to hard to find…) which is already done:<br />
<a href="https://github.com/rear/rear/search?q=shellcheck&amp;type=code">https://github.com/rear/rear/search?q=shellcheck&amp;type=code</a></p>
<h4 id="pcahyna_commented_at_2022-02-10_1135"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034816032">2022-02-10 11:35</a>:<a class="headerlink" href="#pcahyna_commented_at_2022-02-10_1135" title="Permanent link">&para;</a></h4>
<blockquote>
<p>@pcahyna and @antonvoznia</p>
<blockquote>
<ul>
<li>show only newly introduced problems, not all problems for a
    given PR. The number of ShellCheck-detected problems in current
    code is very high. One can not expect to have all of them fixed
    soon.</li>
</ul>
</blockquote>
<p>"One" (man or machine) can - please review my PR #2756
stuck_out_tongue_winking_eye</p>
</blockquote>
<p>I have seen shellcheck output on ReaR previously and I am afraid that
you have seriously underestimated the amount of errors / warnings that
it will produce. I am quite sure that the 14 changes proposed in the PR
will be far from enough. In particular, I suspect ShellCheck has not run
for virtually any script under <code>usr/share/rear/</code> where most of the
program logic resides (don't know why
<code>usr/share/rear/lib/write-protect-functions.sh</code> is an exception).</p>
<h4 id="jsmeix_commented_at_2022-02-10_1154"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034833692">2022-02-10 11:54</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-02-10_1154" title="Permanent link">&para;</a></h4>
<p>Only FYI:</p>
<pre><code># find usr/sbin/rear usr/share/rear/ -type f | xargs grep -i 'shellcheck'

usr/share/rear/output/USB/Linux-i386/100_create_efiboot.sh:# and https://github.com/koalaman/shellcheck/wiki/SC2155
usr/share/rear/restore/BORG/default/400_restore_backup.sh:# shellcheck disable=SC2168
usr/share/rear/restore/BORG/default/300_load_archives.sh:# shellcheck disable=SC2168
usr/share/rear/restore/BORG/default/300_load_archives.sh:# shellcheck disable=SC2168
usr/share/rear/restore/BORG/default/300_load_archives.sh:        # shellcheck disable=SC2034
usr/share/rear/verify/BORG/default/400_check_archive_access.sh:# shellcheck disable=SC2154
usr/share/rear/verify/BORG/default/400_check_archive_access.sh:            # shellcheck disable=SC2154
usr/share/rear/verify/BORG/default/400_check_archive_access.sh:            # shellcheck disable=SC2015
usr/share/rear/lib/borg-functions.sh:        # shellcheck disable=SC2034
usr/share/rear/lib/borg-functions.sh:    # shellcheck disable=SC2154
usr/share/rear/lib/borg-functions.sh:    # shellcheck disable=SC2086,SC2154
usr/share/rear/lib/borg-functions.sh:    # shellcheck disable=SC2086
usr/share/rear/lib/borg-functions.sh:    # shellcheck disable=SC2086
usr/share/rear/backup/BORG/default/900_umount_usb.sh:    # shellcheck disable=SC2154
usr/share/rear/backup/BORG/default/800_prune_old_backups.sh:# shellcheck disable=SC2168
usr/share/rear/backup/BORG/default/500_make_backup.sh:# shellcheck disable=SC2168
usr/share/rear/backup/BORG/default/500_make_backup.sh:# shellcheck disable=SC2168
usr/share/rear/prep/BORG/default/300_init_archive.sh:# shellcheck disable=SC2168
usr/share/rear/prep/BORG/default/300_init_archive.sh:            # shellcheck disable=SC2086,2154
usr/share/rear/prep/BORG/default/100_set_vars.sh:    # shellcheck disable=SC203
</code></pre>
<p>I don't want zillions of such comments needed in the code.</p>
<p>On first glance all or most of the above seem to come<br />
from one single pull request<br />
<a href="https://github.com/rear/rear/pull/2382">https://github.com/rear/rear/pull/2382</a><br />
cf.<br />
<a href="https://github.com/rear/rear/pull/2382/files">https://github.com/rear/rear/pull/2382/files</a></p>
<h4 id="pcahyna_commented_at_2022-02-10_1159"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034837857">2022-02-10 11:59</a>:<a class="headerlink" href="#pcahyna_commented_at_2022-02-10_1159" title="Permanent link">&para;</a></h4>
<p>The person writing the BORG integration obviously made use of
shellcheck, but virtually no other contributor did.</p>
<h4 id="pcahyna_commented_at_2022-02-10_1200"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034839307">2022-02-10 12:00</a>:<a class="headerlink" href="#pcahyna_commented_at_2022-02-10_1200" title="Permanent link">&para;</a></h4>
<p>and yes, such comments are annoying. If a particular idiom is used in
ReaR without being a problem, it should be disabled in shellcheck
config.</p>
<h4 id="jsmeix_commented_at_2022-02-10_1213"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034850987">2022-02-10 12:13</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-02-10_1213" title="Permanent link">&para;</a></h4>
<p>That's what I meant:<br />
A single pull request caused already noticeable effort for ShellCheck<br />
which basically proves my above<br />
<a href="https://github.com/rear/rear/issues/1040#issuecomment-1034576705">https://github.com/rear/rear/issues/1040#issuecomment-1034576705</a></p>
<p>Probably major work is neded to have a general ShellCheck<br />
in a sufficiently well preconfigured state that it is of actual help.</p>
<p>As time permits I might retry how ShellCheck behaves<br />
for all our scripts in usr/share/rear</p>
<h4 id="jsmeix_commented_at_2022-02-10_1234"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034870262">2022-02-10 12:34</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-02-10_1234" title="Permanent link">&para;</a></h4>
<p>Was easier than expected because<br />
there is a RPM package ShellCheck for openSUSE Leap 15.3</p>
<pre><code># for s in usr/sbin/rear $( find usr/share/rear/ -type f -name '*.sh' ) ; do shellcheck $s ; done | grep -o 'SC....:' | wc -l
7187

# for s in usr/sbin/rear $( find usr/share/rear/ -type f -name '*.sh' ) ; do shellcheck $s ; done | grep -o 'SC....:' | sort | uniq -c | wc -l
88

# for s in usr/sbin/rear $( find usr/share/rear/ -type f -name '*.sh' ) ; do shellcheck $s ; done | grep -o 'SC....:' | sort | uniq -c | sort -n
      1 SC1066:
      1 SC2000:
      1 SC2018:
      1 SC2019:
      1 SC2030:
      1 SC2031:
      1 SC2050:
      1 SC2066:
      1 SC2076:
      1 SC2091:
      1 SC2103:
      1 SC2119:
      1 SC2120:
      1 SC2178:
      1 SC2179:
      1 SC2221:
      1 SC2222:
      1 SC2235:
      2 SC1001:
      2 SC1075:
      2 SC1087:
      2 SC2003:
      2 SC2038:
      2 SC2063:
      2 SC2126:
      2 SC2143:
      2 SC2218:
      2 SC2229:
      2 SC2234:
      3 SC1007:
      3 SC1097:
      3 SC2059:
      3 SC2064:
      3 SC2140:
      3 SC2223:
      4 SC2010:
      4 SC2016:
      4 SC2053:
      4 SC2115:
      4 SC2125:
      4 SC2199:
      5 SC2029:
      5 SC2089:
      5 SC2090:
      6 SC1091:
      6 SC2021:
      6 SC2045:
      6 SC2094:
      6 SC2129:
      7 SC2009:
      7 SC2027:
      7 SC2043:
      7 SC2044:
      7 SC2124:
      8 SC2005:
      9 SC2012:
      9 SC2013:
      9 SC2188:
     16 SC2116:
     16 SC2153:
     20 SC2174:
     21 SC2236:
     26 SC2002:
     27 SC2001:
     30 SC1090:
     32 SC2006:
     33 SC2004:
     34 SC2166:
     34 SC2196:
     35 SC2181:
     35 SC2231:
     40 SC2068:
     59 SC2128:
     60 SC2145:
     63 SC2219:
     65 SC2254:
     69 SC2015:
     75 SC2164:
    122 SC2206:
    131 SC2207:
    138 SC2046:
    192 SC2154:
    206 SC2162:
    233 SC2155:
    316 SC2034:
    571 SC2168:
    574 SC2148:
   3717 SC2086:
</code></pre>
<p>so by default shellcheck found 7187 issues<br />
that belong to 88 different cases</p>
<h4 id="jsmeix_commented_at_2022-02-10_1240"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034876024">2022-02-10 12:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-02-10_1240" title="Permanent link">&para;</a></h4>
<p>I expected it!<br />
<a href="https://github.com/koalaman/shellcheck/wiki/SC2086">https://github.com/koalaman/shellcheck/wiki/SC2086</a><br />
is "Double quote to prevent globbing and word splitting"</p>
<p>I assume in very most cases we know that quoting is not needed like</p>
<pre><code>foo="something"
grep $foo file
</code></pre>
<p>and in some cases we even intentionally do not quote like</p>
<pre><code># Ensure $foo is a single non empty and non blank word
# (no quoting because test " " returns zero exit code):
test $foo ...
</code></pre>
<p>Have fun with checking 3717 code places<br />
whether or not quoting is right at each of them ;-)</p>
<h4 id="jsmeix_commented_at_2022-02-10_1257"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034890880">2022-02-10 12:57</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-02-10_1257" title="Permanent link">&para;</a></h4>
<p>But the SCnnnn that appear rarely may more likely indicate real errors<br />
like the one SC1066</p>
<pre><code>In usr/share/rear/prep/Linux-s390/305_include_s390_tools.sh line 7:
test -d "$bootdir" || $bootdir='/boot/'
                       ^-- SC1066: Don't use $ on the left side of assignments.
</code></pre>
<p>where the code is</p>
<pre><code>local bootdir="$( echo -n /boot/ )"
test -d "$bootdir" || $bootdir='/boot/'
</code></pre>
<p>I do not understand what the intent behind that code is,<br />
cf.
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a>
:-(</p>
<p>By chance I see now (Feb 23 2022) where that code comes from:<br />
See the code in prep/GNU/Linux/300_include_grub_tools.sh<br />
that sets grubdir via</p>
<pre><code>local grubdir="$( echo -n /boot/grub* )"
</code></pre>
<p>where 'shopt -s nullglob' results nothing when nothing matches<br />
but that is not needed here to set a fixed <code>bootdir="/boot"</code><br />
so I simplified it and fixed that ShellCheck issue SC1066<br />
"Don't use $ on the left side of assignments" via<br />
<a href="https://github.com/rear/rear/commit/ea0a74bd50493c7472600e2a523b06ae62ee508c">https://github.com/rear/rear/commit/ea0a74bd50493c7472600e2a523b06ae62ee508c</a></p>
<h4 id="pcahyna_commented_at_2022-02-10_1320"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034914789">2022-02-10 13:20</a>:<a class="headerlink" href="#pcahyna_commented_at_2022-02-10_1320" title="Permanent link">&para;</a></h4>
<blockquote>
<p>But the SCnnnn that appear rarely may more likely indicate real errors
like</p>
</blockquote>
<p>That's my experience as well, ShellCheck has sometimes found real
issues. So, I would prefer to relax the "no false positives" to a more
pragmatic "benefits shall outweight costs". Of course, the judgment will
be subjective.</p>
<blockquote>
<p>Have fun with checking 3717 code places<br />
whether or not quoting is right at each of them ;-)</p>
</blockquote>
<p>The beauty of my first acceptance criterion "show only newly introduced
problems, not all problems for a given PR. " (cf. what I wrote "The
number of ShellCheck-detected problems in current code is very high. One
can not expect to have all of them fixed soon") is that you don't have
to check the 3717 places. If done properly, the check will be done only
on newly added code, and you won't see warning for the old code at all.
This way, the quality of the code will monotonically improve (or at
least, not decrease) without too much additional effort.<br />
Of course, it is not perfect, because even in newly added code they may
be valid uses of the construct that ShellCheck is complaining about.
That said, you will need to review them only once and you will not need
to add any <code># shellcheck disable</code> clutter, because the next run will
ignore them. But if a particular false positive occurs too often, one
may disable it globally.</p>
<h4 id="jsmeix_commented_at_2022-02-10_1421"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1034978519">2022-02-10 14:21</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-02-10_1421" title="Permanent link">&para;</a></h4>
<p>I wrote "no false positives" only to emphasise that<br />
the absolute number of false positives is the real problem<br />
because human time is the precious thing.</p>
<p>Of course in practice the pragmatic "benefits shall outweight costs"
matters.</p>
<p>Or even more to the point: Efficiency is what actually matters.<br />
When a human spends N hours on ReaR what matters in the end is<br />
that his time results maximum benefit for ReaR.<br />
For example it could be better to spend ones time<br />
to improve the code to care more about possible errors<br />
(not ShellCheck errors but e.g. missing error handling code)<br />
cf. "Try hard to care about possible errors" in<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a><br />
than fixing ShellCheck issues.</p>
<h4 id="thomasmerz_commented_at_2022-02-10_1459"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1035021701">2022-02-10 14:59</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-02-10_1459" title="Permanent link">&para;</a></h4>
<p>Hi all,</p>
<p>I want to make the following suggestion and go step-by-step before we're
stuck in the "hell of bureaucracy":</p>
<ul>
<li>
<p>implement a user-friendly github-action for shellcheck<br />
    which only shecks warnings and errors<br />
    with my already shellcheck'ed scripts (I indeed didn't check all
    "files" due to the fact, that my PR is only shellcheck'ing files
    that match <code>file --brief --mime-type "$sh"</code>, which means: file must
    be a shell-script)<br />
    This should be a very good and solid base for upcoming PRs and more
    shellcheck'ed files. Your ( @jsmeix ) list includes even info and
    style from shellcheck, which could/should be ignored (as I also
    understand from you?). If you let shellcheck run on all files you
    will get even much more absolutely nonsense warnings due to checking
    Makefiles, "example"-files, text-files, doc(umentation),
    config-files for network-setup, Buildfiles, scripts without a valid
    shebang (SC2148), … and so on…</p>
</li>
<li>
<p>after my two connected PRs feel free to let @antonvoznia deepdive
    and cleanup some more excluded SC-codes with severity warning and
    above.</p>
</li>
<li>
<p>if you do not set repo-settings to benefit of the shellcheck action
    like this - nothing changes for any PR. It will only be transparent
    that shellcheck is complaining (but my first setup won't annoy
    anyone if both PRs are merged):<br />
<img alt="image" src="https://user-images.githubusercontent.com/18568381/153432327-9b9034a1-651f-47ad-bb23-15eeaa7538d0.png" /></p>
</li>
</ul>
<p>So, are you still interested in getting a github-action for shellcheck
"for free" with a first-round-shellcheck'ed set of many (but not all)
scripts? 🤔</p>
<h4 id="thomasmerz_commented_at_2022-02-10_1502"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1035024572">2022-02-10 15:02</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-02-10_1502" title="Permanent link">&para;</a></h4>
<p>We really would be faster achieve an improvement by going small(er)
steps and not a single huge one with 1000s of changes. My PRs are
fitting together and are solving the problem that no automatic
shellcheck is available for PRs and pushes to any files in the defined
"paths".</p>
<h4 id="thomasmerz_commented_at_2022-02-10_1505"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1035028210">2022-02-10 15:05</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-02-10_1505" title="Permanent link">&para;</a></h4>
<p>BTW: I'm also on openSUSE Leap 15.3 since 12.x, but I prefer the
docker-container to the SUSE repos because it's using always latest
version. Leap-Repos are "sometimes" a little bit behind the latest
versions.</p>
<h4 id="thomasmerz_commented_at_2022-02-10_1530"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1035056591">2022-02-10 15:30</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-02-10_1530" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<blockquote>
<p>I expected it!
<a href="https://github.com/koalaman/shellcheck/wiki/SC2086">https://github.com/koalaman/shellcheck/wiki/SC2086</a>
is "Double quote to prevent globbing and word splitting"</p>
<p>I assume in very most cases we know that quoting is not needed like<br />
…<br />
and in some cases we even intentionally do not quote like<br />
…<br />
Have fun with checking 3717 code places whether or not quoting is
right at each of them ;-)</p>
</blockquote>
<p>You could let shellcheck ignore (informational-only?) SC2086 by a single
line in <code>.shellcheckrc</code> or directly on the commandline for all 3717
occurrences. Let's concentrate on real warnings and errors.</p>
<p>If it would be helpful we could also discuss this issue via phone - I or
you could ask some SUSE-collegues we know if they might help both of us
(Sascha Weber or Ralph Roth I know "well") to find together.</p>
<h4 id="pcahyna_commented_at_2022-02-10_1556"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1035088745">2022-02-10 15:56</a>:<a class="headerlink" href="#pcahyna_commented_at_2022-02-10_1556" title="Permanent link">&para;</a></h4>
<blockquote>
<p>If you let shellcheck run on all files you will get even much more
absolutely nonsense warnings due to checking (...) scripts without a
valid shebang</p>
</blockquote>
<p>Unfortunately, scripts without a valid shebang comprise most of ReaR's
codebase. While the warning about missing shebang is indeed nonsense for
them, by excluding the scripts completely one gets rid of most of the
useful warnings together with the nonsense ones.</p>
<h4 id="thomasmerz_commented_at_2022-02-10_1651"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1035156425">2022-02-10 16:51</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-02-10_1651" title="Permanent link">&para;</a></h4>
<p>@pcahyna I understand. But what about my suggestion and start "small"?
Let us be growing with the tasks :-)</p>
<h4 id="jsmeix_commented_at_2022-02-11_0905"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1036000754">2022-02-11 09:05</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-02-11_0905" title="Permanent link">&para;</a></h4>
<p>Yes,<br />
step by step,<br />
first things first,<br />
no rush.</p>
<p>What I will do - as time permits - is looking throught the issues in<br />
<a href="https://github.com/rear/rear/issues/1040#issuecomment-1034870262">https://github.com/rear/rear/issues/1040#issuecomment-1034870262</a><br />
to get some basic understanding how ShellCheck behaves in practice<br />
for the ReaR code and how to control it to make it possibly useful.</p>
<p>I.e. first I will maually use ShellCheck and when I understand things<br />
then I can start thinking about if and how that could be automated.</p>
<p>Finally we can decide if we could have an automated ShellCheck<br />
i.e. when the automated ShellCheck benefits outweigh the costs.</p>
<h4 id="jsmeix_commented_at_2022-02-11_0911"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1036005201">2022-02-11 09:11</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-02-11_0911" title="Permanent link">&para;</a></h4>
<p>By the way:<br />
I am in homeoffice.<br />
I have no company phone.<br />
I give my private phone number only to private contacts.<br />
In general phone calls exclude others (in contrast to e.g. public GitHub
issues).<br />
In general phone calls and things like that are against<br />
<a href="https://xahteiwi.eu/resources/presentations/no-we-wont-have-a-video-call-for-that/">https://xahteiwi.eu/resources/presentations/no-we-wont-have-a-video-call-for-that/</a><br />
or for those who prefer video over text<br />
<a href="https://www.youtube.com/watch?v=NVnci3tyDa4">https://www.youtube.com/watch?v=NVnci3tyDa4</a></p>
<h4 id="thomasmerz_commented_at_2022-02-11_0934"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1036021612">2022-02-11 09:34</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-02-11_0934" title="Permanent link">&para;</a></h4>
<blockquote>
<p>By the way:</p>
</blockquote>
<p>Ok, I respect this, everything is fine for me. This was just an offer to
clarify some possible misunderstandings on both sides by a talk (which
is sometimes easier than writing).</p>
<h4 id="jsmeix_commented_at_2022-02-16_0932"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1041290436">2022-02-16 09:32</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-02-16_0932" title="Permanent link">&para;</a></h4>
<p>I won't find noticeable time for this issue until ReaR 2.7 was released,
cf.<br />
<a href="https://github.com/rear/rear/issues/2751">https://github.com/rear/rear/issues/2751</a><br />
so I set this issue's milestone to ReaR v2.8 i.e. after ReaR 2.7 was
released.</p>
<h4 id="antonvoznia_commented_at_2022-03-06_1435"><img src="https://avatars.githubusercontent.com/u/16565605?u=e1a7ac48dde521e3e67c55abd866c247275e9a86&v=4" width="50"><a href="https://github.com/antonvoznia">antonvoznia</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1059974045">2022-03-06 14:35</a>:<a class="headerlink" href="#antonvoznia_commented_at_2022-03-06_1435" title="Permanent link">&para;</a></h4>
<p>Hello all,</p>
<p>I apologize for the late reply.</p>
<p>Firstly I want to mention that I can solve the static analysis (whether
via ShellCheck nor) for ReaR as part of my diploma's subject.<br />
But I will start in 2-3 months because I currently have another task as
a priority.</p>
<p>@thomasmerz Please let me know if you'll wait or you are going to solve
it right now that I won't waste time.</p>
<p>However, I've already tried something with CheckShell and existed GitHub
actions from there:<br />
<a href="https://github.com/marketplace?type=actions&amp;query=shellcheck+">https://github.com/marketplace?type=actions&amp;query=shellcheck+</a></p>
<p>One good possible solution (of course subjectively) is reviewdog:<br />
<a href="https://github.com/marketplace/actions/run-shellcheck-with-reviewdog">https://github.com/marketplace/actions/run-shellcheck-with-reviewdog</a></p>
<p>There you can take a look at the test PR:<br />
<a href="https://github.com/antonvoznia/rear/pull/33">https://github.com/antonvoznia/rear/pull/33</a><br />
or<br />
<a href="https://github.com/antonvoznia/rear/pull/10">https://github.com/antonvoznia/rear/pull/10</a></p>
<p>As mentioned @pcahyna needed criteria above the reviewdog partionatly
fits them:</p>
<ol>
<li>
<p>"show only newly introduced problems, not all problems for a given
    PR."<br />
    You can see that reviewdog adds notes only for new or changed code
    lines .<br />
    Reviewdog doesn't write a lot of errors and warnings just because a
    developer had changed a file (it should be better investigated,
    please see below conclusion, sometimes the statement is incorrect).</p>
</li>
<li>
<p>"nice to have UI feature".<br />
    The reviewdog adds for wrong code description of a warning or an
    error and the link to the wiki page of ShellCheck documentation.<br />
    It is a good feature and gets more quickly to review the code.</p>
</li>
</ol>
<p>With reviewdog still exist some problems:</p>
<ul>
<li>"do not produce too many false positives" - sometimes reviewdog
    checks the code with respect to the ShellCheck standard (not ReaR
    code style standard).<br />
    It would be a problem and make some stuff for ReaR contributors.</li>
<li>sometimes it acts unexpectedly:<br />
<a href="https://github.com/antonvoznia/rear/pull/11/files">https://github.com/antonvoznia/rear/pull/11/files</a><br />
    Here reviewdog marked lines as bad, but actually, the lines weren't
    changed by me.</li>
</ul>
<p>As I wrote, I can further investigate ShellCheck and reviewdog (or
something another) in 2-3 months.</p>
<p>Feel free to ask me for something.</p>
<p>Thanks,<br />
Anton</p>
<h4 id="jsmeix_commented_at_2022-03-07_1345"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1060704029">2022-03-07 13:45</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-03-07_1345" title="Permanent link">&para;</a></h4>
<p>As expected:<br />
Starting with the SCnnnn that appear rarely reveals more likely real
errors<br />
that can be fixed with reasonable efficiency because of less false
positives.<br />
But it is still some major pain to deal with arbitrary code places<br />
where it is often unknown (i.e. undocumented) what that code is meant to
do<br />
so reverse engineering with much imagination is needed.<br />
For examples see my recent commits that are mentioned here just above<br />
and below.</p>
<h4 id="thomasmerz_commented_at_2022-03-07_1647"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1060898748">2022-03-07 16:47</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-03-07_1647" title="Permanent link">&para;</a></h4>
<p>@antonvoznia</p>
<blockquote>
<p>@thomasmerz Please let me know if you'll wait or you are going to
solve it right now that I won't waste time.</p>
</blockquote>
<p>I'm just a contributor and not related to the ReaR project other than
using ReaR intensively at work and at home. So @schlomo and @jsmeix and
others have to decide what and how to continue with <code>shellcheck</code>.</p>
<p>My <a href="https://github.com/rear/rear/pulls/thomasmerz">latest updates</a>
include:</p>
<ul>
<li>a <a href="https://github.com/rear/rear/pull/2754"><code>shellcheck</code> solution</a>
    that doesn't annotate directly in GitHub GUI, but that can also be
    highly optimized what files to check. If someone prefers this GitHub
    annotation thing than one of the linked solutions from you should
    really fit much better. So I'm also fine with this "more modern"
    solution, but personally I like it <a href="https://github.com/thomasmerz/rear/runs/5072376196?check_suite_focus=true">this way,
    too</a>.</li>
<li><a href="https://github.com/rear/rear/pull/2756">some shellcheck'ed scripts</a>
    that fit to the PR mentioned before. Because of the way what files
    are chosen for shellcheck'ing it's not completely checking all
    scripts/files of ReaR. This would be a really good base to start
    with, as it is also highly discussed and many suggestions from
    @schlomo for example I've been taking care of.</li>
</ul>
<p>I really don't want to "steal" or "crash" your thesis. But it would be a
pity to throw my pre-work away without paying some respect 🤷🏻‍♂️</p>
<h4 id="jsmeix_commented_at_2022-03-09_0907"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1062703092">2022-03-09 09:07</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-03-09_0907" title="Permanent link">&para;</a></h4>
<p>In my above<br />
<a href="https://github.com/rear/rear/issues/1040#issuecomment-1034870262">https://github.com/rear/rear/issues/1040#issuecomment-1034870262</a><br />
the items</p>
<pre><code>      1 SC2119:
      1 SC2120:
</code></pre>
<p>are</p>
<pre><code>In usr/share/rear/skel/default/etc/scripts/system-setup.d/00-functions.sh line 9:
        my_udevsettle
        ^-----------^ SC2119: Use my_udevsettle "$@" if function's $1 should mean script's $1.

In usr/share/rear/skel/default/etc/scripts/system-setup.d/00-functions.sh line 15:
my_udevsettle() {
^-- SC2120: my_udevsettle references arguments, but none are ever passed.
</code></pre>
<p>where both point to<br />
<a href="https://github.com/koalaman/shellcheck/wiki/SC2120">https://github.com/koalaman/shellcheck/wiki/SC2120</a><br />
that reads</p>
<pre><code>If the parameters are optional and you currently just don't want to use them,
you can ignore this message.
</code></pre>
<p>and I think this is the case here so I will add</p>
<pre><code># shellcheck disable=SC2119
# shellcheck disable=SC2120
</code></pre>
<p>comments at that code places.</p>
<h4 id="jsmeix_commented_at_2022-03-09_1341"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1062932894">2022-03-09 13:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-03-09_1341" title="Permanent link">&para;</a></h4>
<p>During my recent commits that show up here since<br />
<a href="https://github.com/rear/rear/issues/1040#issuecomment-1041290436">https://github.com/rear/rear/issues/1040#issuecomment-1041290436</a><br />
I got some initial understanding how far ShellCheck could be useful for
ReaR:</p>
<p>First and foremost my general finding from my current (limited) point of
view:<br />
ShellCheck is much more useful for ReaR than I had expected.<br />
Much more often than expected things that ShellCheck reports<br />
point to real issues (a.k.a. "bugs") in our code that really need to be
fixed.</p>
<p>BUT:<br />
Fixing things that ShellCheck reports means much more work than I had
expected<br />
because what ShellCheck reports is (of course) in most cases only some
syntactical<br />
"strange looking code" that can somehow indirectly points to a real
issue<br />
but what ShellCheck reports is in most cases not the real issue itself<br />
so only "fixing" what ShellCheck directly reports would often make
things worse<br />
because then the real issue would get concealed behind "well looking
code".</p>
<p>SO:<br />
Fixing things that ShellCheck reports means one has to investigate<br />
what the reported "strange looking code" is actually meant to do<br />
which often requires reverse engineering and that in most cases<br />
even with things which one does not have on one's own computer<br />
so one can neither reproduce the real issue nor verify one's fix,<br />
cf.
<a href="https://github.com/rear/rear/issues/1040#issuecomment-1060704029">https://github.com/rear/rear/issues/1040#issuecomment-1060704029</a></p>
<p>RESULT:<br />
From my current (limited) point of view first and foremost ShellCheck
reports<br />
that are limited to only the currently changed/added code would help
ReaR<br />
because this way the one who makes some new "strange looking code"<br />
should be able to see the real issue behind and fix that properly<br />
because he knows what his current code is actually meant to do<br />
(or at least the area of that code is in his current focus of mind).</p>
<h4 id="jsmeix_commented_at_2022-03-09_1355"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1062945160">2022-03-09 13:55</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-03-09_1355" title="Permanent link">&para;</a></h4>
<p>Regarding how to use ShellCheck generally in ReaR<br />
i.e. how to use ShellCheck also for old code in ReaR:</p>
<p>With current GitHub master code I did:</p>
<pre><code># for e in error warning info style ; \
do for s in usr/sbin/rear $( find usr/share/rear/ -type f -name '*.sh' ) ; \
   do shellcheck -s bash -S $e $s ; \
   done &gt;shellcheck.$e.out ; \
done

# for e in error warning info style ; \
do echo shellcheck.$e.out ; \
   grep -o 'SC....:' shellcheck.$e.out | wc -l ; \
done

shellcheck.error.out
685
shellcheck.warning.out
2192
shellcheck.info.out
6313
shellcheck.style.out
6588

# for e in error warning info style ; \
do read -p shellcheck.$e.out ; \
   grep -o 'SC....:' shellcheck.$e.out | sort | uniq -c | sort -n ; \
   echo ; \
done

shellcheck.error.out
      1 SC2066:
      2 SC1087:
      2 SC2218:
      3 SC1097:
      3 SC2199:
      4 SC2045:
     40 SC2068:
     59 SC2145:
    571 SC2168:

shellcheck.warning.out
      1 SC2066:
      1 SC2091:
      2 SC1087:
      2 SC2038:
      2 SC2063:
      2 SC2218:
      2 SC2229:
      3 SC1007:
      3 SC1097:
      3 SC2064:
      3 SC2140:
      3 SC2199:
      4 SC2010:
      4 SC2053:
      4 SC2115:
      4 SC2125:
      5 SC2089:
      5 SC2090:
      6 SC2045:
      7 SC2027:
      7 SC2043:
      7 SC2044:
      7 SC2124:
      9 SC2188:
     16 SC2153:
     20 SC2174:
     30 SC1090:
     34 SC2166:
     40 SC2068:
     57 SC2128:
     59 SC2145:
     65 SC2254:
     75 SC2164:
    121 SC2206:
    130 SC2207:
    138 SC2046:
    192 SC2154:
    232 SC2155:
    316 SC2034:
    571 SC2168:

shellcheck.info.out
      1 SC2066:
      1 SC2091:
      2 SC1001:
      2 SC1087:
      2 SC2038:
      2 SC2063:
      2 SC2218:
      2 SC2229:
      3 SC1007:
      3 SC1097:
      3 SC2059:
      3 SC2064:
      3 SC2140:
      3 SC2199:
      3 SC2223:
      4 SC2010:
      4 SC2016:
      4 SC2053:
      4 SC2115:
      4 SC2125:
      5 SC2029:
      5 SC2089:
      5 SC2090:
      6 SC1091:
      6 SC2021:
      6 SC2045:
      6 SC2094:
      7 SC2009:
      7 SC2027:
      7 SC2043:
      7 SC2044:
      7 SC2124:
      9 SC2012:
      9 SC2013:
      9 SC2188:
     16 SC2153:
     20 SC2174:
     30 SC1090:
     34 SC2166:
     34 SC2196:
     35 SC2231:
     40 SC2068:
     57 SC2128:
     59 SC2145:
     65 SC2254:
     69 SC2015:
     75 SC2164:
    121 SC2206:
    130 SC2207:
    138 SC2046:
    192 SC2154:
    206 SC2162:
    232 SC2155:
    316 SC2034:
    571 SC2168:
   3717 SC2086:

shellcheck.style.out
      1 SC2066:
      1 SC2091:
      2 SC1001:
      2 SC1087:
      2 SC2003:
      2 SC2038:
      2 SC2063:
      2 SC2126:
      2 SC2143:
      2 SC2218:
      2 SC2229:
      2 SC2234:
      3 SC1007:
      3 SC1097:
      3 SC2059:
      3 SC2064:
      3 SC2140:
      3 SC2199:
      3 SC2223:
      4 SC2010:
      4 SC2016:
      4 SC2053:
      4 SC2115:
      4 SC2125:
      5 SC2029:
      5 SC2089:
      5 SC2090:
      6 SC1091:
      6 SC2021:
      6 SC2045:
      6 SC2094:
      6 SC2129:
      7 SC2009:
      7 SC2027:
      7 SC2043:
      7 SC2044:
      7 SC2124:
      8 SC2005:
      9 SC2012:
      9 SC2013:
      9 SC2188:
     16 SC2116:
     16 SC2153:
     20 SC2174:
     21 SC2236:
     26 SC2002:
     27 SC2001:
     30 SC1090:
     32 SC2006:
     33 SC2004:
     34 SC2166:
     34 SC2196:
     35 SC2181:
     35 SC2231:
     40 SC2068:
     57 SC2128:
     59 SC2145:
     63 SC2219:
     65 SC2254:
     69 SC2015:
     75 SC2164:
    121 SC2206:
    130 SC2207:
    138 SC2046:
    192 SC2154:
    206 SC2162:
    232 SC2155:
    316 SC2034:
    571 SC2168:
   3717 SC2086:
</code></pre>
<p>I will start with what ShellCheck considers to be an "error"<br />
and afterwards step by step as time permits we can proceed<br />
with "warning" then "info" and finally perhaps even "style" issues.</p>
<h4 id="jsmeix_commented_at_2022-04-26_1314"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1109782792">2022-04-26 13:14</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-04-26_1314" title="Permanent link">&para;</a></h4>
<p>Now the only ShellCheck error that is left is<br />
SC2145: "Argument mixes string and array. Use * or separate argument."</p>
<pre><code># for e in error warning info style ; \
  do for s in usr/sbin/rear $( find usr/share/rear/ -type f -name '*.sh' ) ; \
     do shellcheck -s bash -S $e -e SC2168 $s ; \
     done &gt;shellcheck.$e.out ; \
  done

# for e in error warning info style ; \
  do echo shellcheck.$e.out ; grep -o 'SC....:' shellcheck.$e.out | wc -l ; \
  done

shellcheck.error.out
47
shellcheck.warning.out
1547
shellcheck.info.out
5669
shellcheck.style.out
5944

# grep -o 'SC....:' shellcheck.error.out | sort | uniq -c
     47 SC2145:
</code></pre>
<h4 id="github-actions_commented_at_2022-06-26_0324"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1166408587">2022-06-26 03:24</a>:<a class="headerlink" href="#github-actions_commented_at_2022-06-26_0324" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="github-actions_commented_at_2022-08-27_0350"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1229115031">2022-08-27 03:50</a>:<a class="headerlink" href="#github-actions_commented_at_2022-08-27_0350" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="github-actions_commented_at_2022-10-27_0326"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1292923043">2022-10-27 03:26</a>:<a class="headerlink" href="#github-actions_commented_at_2022-10-27_0326" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="github-actions_commented_at_2022-12-27_0224"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1365559101">2022-12-27 02:24</a>:<a class="headerlink" href="#github-actions_commented_at_2022-12-27_0224" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="thomasmerz_commented_at_2022-12-27_1020"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1365787399">2022-12-27 10:20</a>:<a class="headerlink" href="#thomasmerz_commented_at_2022-12-27_1020" title="Permanent link">&para;</a></h4>
<p>ping @gdha</p>
<h4 id="github-actions_commented_at_2023-02-27_0239"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1445596117">2023-02-27 02:39</a>:<a class="headerlink" href="#github-actions_commented_at_2023-02-27_0239" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="jsmeix_commented_at_2023-02-27_0855"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1445934759">2023-02-27 08:55</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-27_0855" title="Permanent link">&para;</a></h4>
<p>See<br />
<a href="https://github.com/rear/rear/pull/2847#issuecomment-1431497212">https://github.com/rear/rear/pull/2847#issuecomment-1431497212</a></p>
<h4 id="github-actions_commented_at_2023-04-29_0219"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1528498718">2023-04-29 02:19</a>:<a class="headerlink" href="#github-actions_commented_at_2023-04-29_0219" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="thomasmerz_commented_at_2023-04-29_1341"><img src="https://avatars.githubusercontent.com/u/18568381?u=520aed8f7e665d9d1caee6358db291489a99ef03&v=4" width="50"><a href="https://github.com/thomasmerz">thomasmerz</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1528791890">2023-04-29 13:41</a>:<a class="headerlink" href="#thomasmerz_commented_at_2023-04-29_1341" title="Permanent link">&para;</a></h4>
<p>@jsmeix , this issue should already be fixed by
<a href="https://github.com/rear/rear/pull/2847">https://github.com/rear/rear/pull/2847</a>
, isn't it?</p>
<h4 id="jsmeix_commented_at_2023-05-12_1325"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1040#issuecomment-1545743281">2023-05-12 13:25</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-05-12_1325" title="Permanent link">&para;</a></h4>
<p>Since also<br />
<a href="https://github.com/rear/rear/pull/2976">https://github.com/rear/rear/pull/2976</a><br />
is merged<br />
I consider this issue to be sufficiently done.<br />
If issues appear they will be handled via separated GitHub issues.</p>
<p>Many thanks to<br />
@antonvoznia @thomasmerz @pcahyna @jamacku @lzaoral<br />
and all the other @rear/contributors<br />
who helped and contributed here!</p>
<p>I wish you all a relaxed and recovering weekend!</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-10-19.1040.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
