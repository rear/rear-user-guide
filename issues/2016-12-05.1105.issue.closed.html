<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1105 Issue closed: rear with a very big usb device - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1105 Issue closed: rear with a very big usb device";
        var mkdocs_page_input_path = "issues/2016-12-05.1105.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1105 Issue closed: rear with a very big usb device</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1105_issue_closed_rear_with_a_very_big_usb_device"><a href="https://github.com/rear/rear/issues/1105">#1105 Issue</a> <code>closed</code>: rear with a very big usb device<a class="headerlink" href="#1105_issue_closed_rear_with_a_very_big_usb_device" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="dwerner1_opened_issue_at_2016-12-05_1457"><img src="https://avatars.githubusercontent.com/u/6715683?v=4" width="50"><a href="https://github.com/dwerner1">dwerner1</a> opened issue at <a href="https://github.com/rear/rear/issues/1105">2016-12-05 14:57</a>:<a class="headerlink" href="#dwerner1_opened_issue_at_2016-12-05_1457" title="Permanent link">&para;</a></h4>
<p>I'm trying to get rear working with the following setup:</p>
<ul>
<li>rear version (/usr/sbin/rear -V): 1.19-1</li>
<li>OS version (cat /etc/rear/os.conf or lsb_release -a): Debian
    testing 8.1.0</li>
<li>rear configuration files (cat /etc/rear/site.conf):</li>
</ul>
<p>BACKUP=NETFS<br />
OUTPUT=ISO<br />
BACKUP_URL=usb:///dev/disk/by-label/REAR-000<br />
ISO_PREFIX=”rear-$HOSTNAME”<br />
BACKUP_PROG_EXCLUDE=( ‘/tmp/<em>’ ‘/dev/shm/</em>’ ‘/mnt/<em>’ ‘/media/</em>’
$VAR_DIR/output/* )<br />
BACKUP_SELINUX_DISABLE=1<br />
BACKUP_TYPE=incremental<br />
FULLBACKUPDAY=Mon</p>
<ul>
<li>Brief description of the issue</li>
</ul>
<p>I have an external USB device set up as RAID1, 16TB of size. I have
chosen btfrs and also ext4 as filesystem, but both render being not
bootable. The backup process and every rear function work fine. I never
saw that problem with smaller disks and ext3, what am I doing wrong?</p>
<p>Dirk</p>
<h4 id="gozora_commented_at_2016-12-05_1601"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-264893075">2016-12-05 16:01</a>:<a class="headerlink" href="#gozora_commented_at_2016-12-05_1601" title="Permanent link">&para;</a></h4>
<p>Hi @dwerner1,</p>
<p>I somehow can't figure out what is not working for you.<br />
Are you using legacy or EFI boot?<br />
Are you trying to backup your OS to some external (16TB USB) disk, and
then recover from it (like do USB boot and <code>rear recover</code>)?<br />
If so, how did you chose "btrfs and also ext4" as filesystem for
<em>/dev/disk/by-label/REAR-000</em>?<br />
Because normally you should do something like
<code>rear --format &lt;device_name&gt;</code> which will format your disk with
<code>mkfs.ext3</code> ...</p>
<p>There might be even limit with MBR not supporting more than 2TB
partitions.</p>
<h4 id="dwerner1_commented_at_2016-12-05_1616"><img src="https://avatars.githubusercontent.com/u/6715683?v=4" width="50"><a href="https://github.com/dwerner1">dwerner1</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-264897710">2016-12-05 16:16</a>:<a class="headerlink" href="#dwerner1_commented_at_2016-12-05_1616" title="Permanent link">&para;</a></h4>
<p>Hi gozora,<br />
thanks for sharing this issue!<br />
Yes, I'm planning to backup a complete linux machine with OS and data
and I wanna be able to recover that from a USB DAS device that contains
4 x 8TB disks, running as RAID1. I chose btfrs and ext4 because with
ext3 I couldn't handle this partition size &gt; 2TB. My main question is
actually - can I leave out the rear setup step<br />
<code>sudo rear -v format /dev/sdX</code><br />
and do the formatting manually and then proceed with<br />
<code>sudo rear -v mkrescue</code> ?</p>
<h4 id="gozora_commented_at_2016-12-05_1645"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-264906477">2016-12-05 16:45</a>:<a class="headerlink" href="#gozora_commented_at_2016-12-05_1645" title="Permanent link">&para;</a></h4>
<p>Ufff, that is hard question. In theory it should work, but
<a href="https://github.com/rear/rear/blob/master/doc/user-guide/04-scenarios.adoc#preparing-your-usb-storage-device">reading</a>,
I'd say you should follow guidelines.</p>
<p>If I could give you an advice,</p>
<ol>
<li>try to split your backup tasks between OS and data backup. (with
    support for multiple backups commit by @jsmeix it should be quite
    easy, it is not fully documented though, but you can check some
    examples <a href="https://github.com/rear/rear/issues/1088">here</a></li>
<li>do not try to boot from DAS directly, but use it just for data
    storage. Create small bootable USB stick instead, where you can be
    sure that you will not hit some kind of limit. Something like:</li>
</ol>
<!-- -->

<pre><code>OUTPUT=USB
USB_DEVICE=/dev/disk/by-label/REAR-000
BACKUP=NETFS
BACKUP_URL=file:///directory/path/
</code></pre>
<p>I've never tried something like this, but there is a good chance that it
will work.</p>
<p>V.</p>
<h4 id="dwerner1_commented_at_2016-12-05_1652"><img src="https://avatars.githubusercontent.com/u/6715683?v=4" width="50"><a href="https://github.com/dwerner1">dwerner1</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-264908487">2016-12-05 16:52</a>:<a class="headerlink" href="#dwerner1_commented_at_2016-12-05_1652" title="Permanent link">&para;</a></h4>
<p>Wow, that's a really cool idea to split tasks and to put the boot
related stuff on a separate small usb device. I will test that tomorrow.
Again, many thanks for your input!!</p>
<h4 id="dwerner1_commented_at_2016-12-06_1851"><img src="https://avatars.githubusercontent.com/u/6715683?v=4" width="50"><a href="https://github.com/dwerner1">dwerner1</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265237216">2016-12-06 18:51</a>:<a class="headerlink" href="#dwerner1_commented_at_2016-12-06_1851" title="Permanent link">&para;</a></h4>
<p>I have tried another scenario today cause I was curious if that might
work out:</p>
<p>I formatted an external 320GB USB hdd by doing</p>
<p><code>sudo rear -v format /dev/sdc1</code></p>
<p>That created an 320GB ext3 partition. Then I shrinked this partition to
100GB and created a btrfs partition in the freed space, labeled
<code>REAR-DATA</code> . I adjusted the file <code>/etc/rear/site.conf</code> accordingly to</p>
<p><code>OUTPUT=USB USB_DEVICE=/dev/disk/by-label/REAR-000 BACKUP=NETFS BACKUP_URL=usb:///dev/disk/by-label/REAR-DATA ISO_PREFIX=”rear-$HOSTNAME” BACKUP_PROG_EXCLUDE=( ‘/tmp/*’ ‘/dev/shm/*’ ‘/mnt/*’ ‘/media/*’ $VAR_DIR/output/\* ) BACKUP_SELINUX_DISABLE=1 BACKUP_TYPE=incremental FULLBACKUPDAY=Tue</code></p>
<p><strong>That boots and offers the recovery menu!</strong> If I create the ext3 and
btrfs partition manually, it does not work and says
<code>Missing operating system</code> when trying to boot.</p>
<p>The idea came up cause I'd prefer to have everything disaster recovery
specific on one device. Unfortunately my initial problem is not solved
by that - I could never do that with the 16TB device, cause rear will
understandably refuse to format that completely with an ext3 fs</p>
<h4 id="dwerner1_commented_at_2016-12-06_1853"><img src="https://avatars.githubusercontent.com/u/6715683?v=4" width="50"><a href="https://github.com/dwerner1">dwerner1</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265237900">2016-12-06 18:53</a>:<a class="headerlink" href="#dwerner1_commented_at_2016-12-06_1853" title="Permanent link">&para;</a></h4>
<p>Here's the file <code>/etc/rear/site.conf</code> again, hopefully in a better
formatting</p>
<p><code>OUTPUT=USB</code><br />
<code>USB_DEVICE=/dev/disk/by-label/REAR-000</code><br />
<code>BACKUP=NETFS</code><br />
<code>BACKUP_URL=usb:///dev/disk/by-label/REAR-DATA</code><br />
<code>ISO_PREFIX=”rear-$HOSTNAME”</code><br />
<code>BACKUP_PROG_EXCLUDE=( ‘/tmp/*’ ‘/dev/shm/*’ ‘/mnt/*’ ‘/media/*’ $VAR_DIR/output/\* )</code><br />
<code>BACKUP_SELINUX_DISABLE=1</code><br />
<code>BACKUP_TYPE=incremental</code><br />
<code>FULLBACKUPDAY=Tue</code></p>
<h4 id="jsmeix_commented_at_2016-12-07_0920"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265396635">2016-12-07 09:20</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-07_0920" title="Permanent link">&para;</a></h4>
<p>I have no experience with such huge disks.</p>
<p>@dwerner1</p>
<p>Out of curiosity:<br />
Why do you use btrfs at all?<br />
I.e. what specific btrfs feature do you need?<br />
In
<a href="https://en.wikipedia.org/wiki/Ext4">https://en.wikipedia.org/wiki/Ext4</a>
I read</p>
<pre>
Red Hat recommends using XFS instead of ext4
for volumes larger than 100 TB.
</pre>

<p>and in general for "data" we (i.e. SUSE) also recommend XFS<br />
(by default in SLE12 we use btrfs only for the basic system stuff)<br />
so that I wonder why you don't use ext4 (should be o.k. up to 16TB)<br />
or in general XFS for any "data" partitions?</p>
<p>FYI:<br />
The ReaR script<br />
usr/share/rear/format/USB/default/300_format_usb_disk.sh<br />
does the formatting of the USB device<br />
which you can adapt and enhance as you need it<br />
for your particular case, cf. the<br />
"Disaster recovery with Relax-and-Recover (ReaR)"<br />
section and its sub-sections in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<h4 id="gozora_commented_at_2016-12-07_0953"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265403818">2016-12-07 09:53</a>:<a class="headerlink" href="#gozora_commented_at_2016-12-07_0953" title="Permanent link">&para;</a></h4>
<p>I've managed to make following configuration work:</p>
<pre><code>BACKUP=NETFS
OUTPUT=USB
USB_DEVICE=/dev/disk/by-label/REAR-000
BACKUP_URL=file:///backup/data/

EXCLUDE_MD=( $(grep -o -E '^md[0-9]+' /proc/mdstat) ) # exclude all md devices
COPY_AS_IS=( ${COPY_AS_IS[@]} /sbin/sysctl /etc/sysctl.conf /sbin/vconfig /sbin/if* /etc/sysconfig/network )
GRUB_RESCUE=n
ONLY_INCLUDE_VG=( "centos" )
EXCLUDE_BACKUP=( ${EXCLUDE_BACKUP[@]} fs:/crash fs:/usr/sap fs:/oracle )
BACKUP_PROG_EXCLUDE=( ${BACKUP_PROG_EXCLUDE[@]} '/mnt/*' )
</code></pre>
<p>This however requires modification of
<em>usr/share/rear/format/USB/default/300_format_usb_disk.sh</em> as
mentioned by @jsmeix.<br />
e.g.</p>
<pre><code>- echo "Yes" | parted -s $RAW_USB_DEVICE mkpart primary 0 100% &gt;&amp;2
+ echo "Yes" | parted -s $RAW_USB_DEVICE mkpart primary 0 25% &gt;&amp;2
</code></pre>
<ul>
<li><code>rear format /dev/sdb</code></li>
<li>load whatever filesystem on free 75% of USB drive.</li>
<li>mount it to <em>/backup/data/</em></li>
<li><code>rear mkbackup</code></li>
</ul>
<p>This should create bootable USB disk on partition 1 and store data on
partition 2</p>
<p>I was not able to test restore, as I don't have any easy way how to boot
from USB. Maybe you will need to manually mount <em>/dev/sdb2</em> to
<em>/backup/data</em> once ReaR rescue/recovery system is loaded.</p>
<p>V.</p>
<h4 id="gozora_commented_at_2016-12-07_1014"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265408567">2016-12-07 10:14</a>:<a class="headerlink" href="#gozora_commented_at_2016-12-07_1014" title="Permanent link">&para;</a></h4>
<p>Ok, I've found a way (again couple of minutes after my last comment,
this is my curse) how to test this, setup.<br />
And I can confirm that it works just fine for me ...</p>
<h4 id="jsmeix_commented_at_2016-12-07_1102"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265418995">2016-12-07 11:02</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-07_1102" title="Permanent link">&para;</a></h4>
<p>I think I could add some variables so that the user can specify<br />
to some basic extent how to partition and format a USB disk.</p>
<h4 id="gozora_commented_at_2016-12-07_1135"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265425216">2016-12-07 11:35</a>:<a class="headerlink" href="#gozora_commented_at_2016-12-07_1135" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<blockquote>
<p>I think I could add some variables so that the user can specify<br />
to some basic extent how to partition and format a USB disk.</p>
</blockquote>
<p>When I did implementation for USB / EFI, I maybe wrote something that
might be useful.<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/format/USB/default/300_format_usb_disk.sh#L15">see</a></p>
<h4 id="dwerner1_commented_at_2016-12-07_1155"><img src="https://avatars.githubusercontent.com/u/6715683?v=4" width="50"><a href="https://github.com/dwerner1">dwerner1</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265428871">2016-12-07 11:55</a>:<a class="headerlink" href="#dwerner1_commented_at_2016-12-07_1155" title="Permanent link">&para;</a></h4>
<p>@gozora<br />
I can confirm that the above setup works like a charm! Great!<br />
There was no specific plan behind using btfrs, I tried various file
systems including xfs, ext4 and btfrs . I'll choose XFS for the data
partition</p>
<h4 id="jsmeix_commented_at_2016-12-07_1631"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265496413">2016-12-07 16:31</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-07_1631" title="Permanent link">&para;</a></h4>
<p>Have a look at my tentative attempt in<br />
<a href="https://github.com/rear/rear/pull/1112">https://github.com/rear/rear/pull/1112</a><br />
to support partitioning and formatting a huge medium<br />
via the new variables USB_DEVICE_FILESYSTEM<br />
and USB_DEVICE_FILESYSTEM_PERCENTAGE<br />
for details see conf/default.conf</p>
<h4 id="dwerner1_commented_at_2016-12-07_1732"><img src="https://avatars.githubusercontent.com/u/6715683?v=4" width="50"><a href="https://github.com/dwerner1">dwerner1</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265514570">2016-12-07 17:32</a>:<a class="headerlink" href="#dwerner1_commented_at_2016-12-07_1732" title="Permanent link">&para;</a></h4>
<p>The script /usr/share/rear/format/USB/default/300_format_usb_disk.sh
creates an msdos partition table by default, I have changed line 7</p>
<p>`- echo "Yes" | parted -s $RAW_USB_DEVICE mklabel msdos &gt;&amp;2</p>
<ul>
<li>echo "Yes" | parted -s $RAW_USB_DEVICE mklabel gpt &gt;&amp;2`</li>
</ul>
<p>to be able to create an xfs partition of 14TB afterwards</p>
<h4 id="dwerner1_commented_at_2016-12-07_1733"><img src="https://avatars.githubusercontent.com/u/6715683?v=4" width="50"><a href="https://github.com/dwerner1">dwerner1</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265514883">2016-12-07 17:33</a>:<a class="headerlink" href="#dwerner1_commented_at_2016-12-07_1733" title="Permanent link">&para;</a></h4>
<p><code>- echo "Yes" | parted -s $RAW_USB_DEVICE mklabel msdos &gt;&amp;2</code><br />
<code>+ echo "Yes" | parted -s $RAW_USB_DEVICE mklabel gpt &gt;&amp;2</code></p>
<h4 id="jsmeix_commented_at_2016-12-08_0939"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265696437">2016-12-08 09:39</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-08_0939" title="Permanent link">&para;</a></h4>
<p>@dwerner1<br />
many thanks for your valuable feedback.</p>
<p>I have seen that too but it didn't trigger the right things in my
mind.<br />
Only in case of U(EFI) it creates a GPT.</p>
<p>I had never worked before with the 'format' workflow scripts<br />
but from my first glance they look somewhat "weird" to me.<br />
I think a general overhaul of the 'format' workflow could be<br />
a good idea but currently I do not understand it sufficiently<br />
to do that so that for now I work around with new variables<br />
so that experienced users can manually specify what to get.</p>
<p>In
<a href="https://en.wikipedia.org/wiki/Master_boot_record">https://en.wikipedia.org/wiki/Master_boot_record</a><br />
I read right now that</p>
<pre>
The organization of the partition table in the MBR
limits the maximum addressable storage space
of a disk to 2 TiB 
</pre>

<p>Therefore I need one more new variable<br />
USB_DEVICE_PARTED_LABEL<br />
that is by default 'msdos' but can be set to 'gpt'<br />
by the user when the medium is bigger than 2TB.</p>
<h4 id="jsmeix_commented_at_2016-12-08_1041"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265709444">2016-12-08 10:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-08_1041" title="Permanent link">&para;</a></h4>
<p>@gozora @dwerner1 @gdha<br />
does anybody have an idea what the reason behind is why in<br />
usr/share/rear/format/USB/default/300_format_usb_disk.sh<br />
there is</p>
<pre>
echo "Yes" | parted -s ...
</pre>

<p>regardless that "man parted" reads:</p>
<pre>
       -s, --script
              never prompts for user intervention
</pre>

<h4 id="jsmeix_commented_at_2016-12-08_1449"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1105#issuecomment-265757767">2016-12-08 14:49</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-08_1449" title="Permanent link">&para;</a></h4>
<p>With<br />
<a href="https://github.com/rear/rear/pull/1112">https://github.com/rear/rear/pull/1112</a><br />
merged there should be now support for partitioning<br />
and formatting even huge devices via the 'format' workflow.<br />
Accordingly I think this issue is fixed.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-12-05.1105.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
