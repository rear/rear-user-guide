<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2936 Issue closed: "rear mkrescue -C ..." option setting is not automatically used by "rear recover" - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2936 Issue closed: \"rear mkrescue -C ...\" option setting is not automatically used by \"rear recover\"";
        var mkdocs_page_input_path = "issues/2023-02-16.2936.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2936 Issue closed: "rear mkrescue -C ..." option setting is not automatically used by "rear recover"</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2936_issue_closed_rear_mkrescue_-c_option_setting_is_not_automatically_used_by_rear_recover"><a href="https://github.com/rear/rear/issues/2936">#2936 Issue</a> <code>closed</code>: "rear mkrescue -C ..." option setting is not automatically used by "rear recover"<a class="headerlink" href="#2936_issue_closed_rear_mkrescue_-c_option_setting_is_not_automatically_used_by_rear_recover" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>discuss / RFC</code>, <code>support / question</code>,
<code>no-issue-activity</code></p>
<h4 id="idanbenezra_opened_issue_at_2023-02-16_2108"><img src="https://avatars.githubusercontent.com/u/19408535?v=4" width="50"><a href="https://github.com/idanbenezra">idanbenezra</a> opened issue at <a href="https://github.com/rear/rear/issues/2936">2023-02-16 21:08</a>:<a class="headerlink" href="#idanbenezra_opened_issue_at_2023-02-16_2108" title="Permanent link">&para;</a></h4>
<p>ReaR 2.7</p>
<p>When using the <code>rear mkrescue -C /path/to/conf/coutomname.conf</code> the
<code>rear recover</code> will use the <code>default.conf</code> file and not the custom
config file.</p>
<p>Please note that i can't use the <code>/etc/rear/local.conf</code> as I'm using it
in a dynamic system that can execute multiple <code>rear mkrescue</code> at the
same time with different configs.</p>
<p>In my custom config I've set the <code>BACKUP=MYINTEGRATION</code>, and when
recover is executed it uses <code>BACKUP=REQUESTRESTORE</code> as this is the
default in <code>default.conf</code> file.</p>
<p>Is this a normal behavior?</p>
<h4 id="jsmeix_commented_at_2023-02-17_0747"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1434253882">2023-02-17 07:47</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-17_0747" title="Permanent link">&para;</a></h4>
<p>usr/share/rear/conf/default.conf<br />
gets sourced by sbin/rear in any case<br />
because ReaR won't work correctly without its default settings<br />
and there is no need to change usr/share/rear/conf/default.conf<br />
because the defaults can be changed as needed by user config files.</p>
<p>What config files get sourced by sbin/rear is same<br />
for all workflows (in particular same for "rear mkbackup"<br />
and "rear recover") because the same code in sbin/rear<br />
is run for all workflows.<br />
The only difference is that during "rear recover" an<br />
additional config file "rescue.conf" is there which<br />
was created by "rear mkrescue/mkbackup".</p>
<p>See "man rear"<br />
<a href="https://github.com/rear/rear/blob/rear-2.7/doc/rear.8.adoc">https://github.com/rear/rear/blob/rear-2.7/doc/rear.8.adoc</a><br />
how to use a different directory for user config files<br />
and how to specify additional user config files<br />
(excerpt):</p>
<pre><code>-c DIR
alternative config directory; instead of /etc/rear

-C CONFIG
additional config file; absolute path or relative to config directory
</code></pre>
<p>For me it seems to work<br />
(but I did not test "rear recover" with that):</p>
<pre><code># cat /tmp/foodir/foo.conf

MYVAR=MYVALUE

# usr/sbin/rear -D -C /tmp/foodir/foo.conf mkrescue

Relax-and-Recover 2.7 / Git
...
Using build area: /var/tmp/rear.gHTk4xo2616VVcy
Sourcing additional configuration file '/tmp/foodir/foo.conf'
...

# chroot /var/tmp/rear.gHTk4xo2616VVcy/rootfs/

bash-4.4# cat /tmp/foodir/foo.conf

MYVAR=MYVALUE

bash-4.4# rear -D -C /tmp/foodir/foo.conf help

Sourcing additional configuration file '/tmp/foodir/foo.conf'
...
</code></pre>
<p>My blind guess is that perhaps your implementation<br />
of your BACKUP=MYINTEGRATION is not yet right?</p>
<p>Or is the issue perhaps actually that<br />
when you call</p>
<pre><code># rear -C /path/to/conf/myconfig.conf mkrescue
</code></pre>
<p>then calling only plain</p>
<pre><code># rear recover
</code></pre>
<p>will (of course) not use /path/to/conf/myconfig.conf<br />
because you would have to call</p>
<pre><code># rear -C /path/to/conf/myconfig.conf recover
</code></pre>
<p>to tell the program <code>rear</code> to use the additional config file<br />
also for the 'recover' workflow.</p>
<h4 id="schlomo_commented_at_2023-02-17_0825"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1434288297">2023-02-17 08:25</a>:<a class="headerlink" href="#schlomo_commented_at_2023-02-17_0825" title="Permanent link">&para;</a></h4>
<p>Maybe we should add a line like <code>source /path/to/conf/myconfig.conf</code> to
<code>$ROOTFS_DIR/etc/rear/rescue.conf</code> so that the rescue system will
automatically use the same extra configuration files that had been used
to create it?</p>
<p>I think that this would help a lot to make the rescue → recovery
workflow be more consistent with itself.</p>
<p>I wonder what the DRLM perspective on this is, @didacog and @proura what
do you think?</p>
<h4 id="jsmeix_commented_at_2023-02-17_0841"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1434304552">2023-02-17 08:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-17_0841" title="Permanent link">&para;</a></h4>
<p>@schlomo<br />
in general I am very much against all those<br />
"well intended automatisms" all over the place.</p>
<p>What when a user wants to do</p>
<pre><code>rear -C /path/to/mkrescue1.conf mkrescue

rear -C /path/to/mkrescue2.conf mkrescue

rear -C /path/to/mkbackup1.conf mkbackup

rear -C /path/to/mkbackup2.conf mkbackup

rear -C /path/to/mkbackuponly1.conf mkbackuponly

rear -C /path/to/mkbackuponly2.conf mkbackuponly

rear -C /path/to/recover1.conf recover

rear -C /path/to/recover2.conf recover
</code></pre>
<p>Most automatisms work against "final power to the user"<br />
unless automatisms would have been implemented<br />
very carefully and very thoroughly<br />
but most are not.</p>
<h4 id="idanbenezra_commented_at_2023-02-17_0928"><img src="https://avatars.githubusercontent.com/u/19408535?v=4" width="50"><a href="https://github.com/idanbenezra">idanbenezra</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1434370975">2023-02-17 09:28</a>:<a class="headerlink" href="#idanbenezra_commented_at_2023-02-17_0928" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<p>I do understand you point, However If i created the ISO with
<code>BACKUP=MYINTEGRATION</code>, shouldn't it restored automatically with
<code>BACKUP=MYINTEGRATION</code>?</p>
<h4 id="schlomo_commented_at_2023-02-17_0933"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1434376825">2023-02-17 09:33</a>:<a class="headerlink" href="#schlomo_commented_at_2023-02-17_0933" title="Permanent link">&para;</a></h4>
<p>I agree with @jsmeix and with @idanbenezra as you talk IMHO about
different scenarios:</p>
<ol>
<li>on the original system a user might have multiple configurations →
    need to manually specify it for every command</li>
<li>on the rescue system the main intention for ReaR is that everything
    is predefined and even an inexperienced user should be able to
    perform a recovery → the "right" configuration files should be used
    without specifying them</li>
</ol>
<p>For the "final power to the user" perspective we need to provide a way
how to achieve what @idanbenezra needs.</p>
<p>Personally I'd make this the default behaviour but maybe the following
is a suitable compromise:</p>
<p>In
<a href="https://github.com/rear/rear/blob/46d4dd3fe03595cc7b969db66d6ab1a881fcb6eb/usr/sbin/rear#L614-L624">https://github.com/rear/rear/blob/46d4dd3fe03595cc7b969db66d6ab1a881fcb6eb/usr/sbin/rear#L614-L624</a>
we start sourcing the additional configuration files <strong>after</strong> reading
the <code>local.conf</code>, <code>site.conf</code> and <strong><code>rescue.conf</code></strong> files. That means
that instead of providing <code>-C file</code> on the command line you can
configure that behaviour into your configuration via the
<code>CONFIG_APPEND_FILES</code> variable.</p>
<p>So we could introduce a new configuration directive like
"CONFIG_AUTOLOAD_EXTRA_FILES" or such that simply adds sets
<code>CONFIG_APPEND_FILES</code> in <code>/etc/rear/rescue.conf</code> from
<code>CONFIG_APPEND_FILES_PATHS</code> which is a new variable that I introduced
with #2932 to record the extra configs that we read successfully during
ReaR initialisation. Setting that configuration directive would induce
the automatic behaviour that @idanbenezra wants.</p>
<h4 id="didacog_commented_at_2023-02-17_0942"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1434386618">2023-02-17 09:42</a>:<a class="headerlink" href="#didacog_commented_at_2023-02-17_0942" title="Permanent link">&para;</a></h4>
<blockquote>
<p>Maybe we should add a line like <code>source /path/to/conf/myconfig.conf</code>
to <code>$ROOTFS_DIR/etc/rear/rescue.conf</code> so that the rescue system will
automatically use the same extra configuration files that had been
used to create it?</p>
<p>I think that this would help a lot to make the rescue → recovery
workflow be more consistent with itself.</p>
<p>I wonder what the DRLM perspective on this is, @didacog and @proura
what do you think?</p>
</blockquote>
<p>Hello @schlomo,</p>
<p>As far as you simply add <code>source &lt;path_to_configs&gt;</code> before
<code>/usr/share/rear/init/default/010_set_drlm_env.sh</code> will not cause any
problem to DRLM provided configurations. The only concern is that if the
config to source is not present, then rear must continue, not exiting.
but if is controlled by <code>CONFIG_AUTOLOAD_EXTRA_FILES=yes|no</code> should be
under control.</p>
<p>thanks for taking us into account!<br />
Kind regards,<br />
Didac</p>
<h4 id="jsmeix_commented_at_2023-02-20_0955"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1436659601">2023-02-20 09:55</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-20_0955" title="Permanent link">&para;</a></h4>
<p>I agree with what @schlomo wrote in his<br />
<a href="https://github.com/rear/rear/issues/2936#issuecomment-1434376825">https://github.com/rear/rear/issues/2936#issuecomment-1434376825</a></p>
<pre><code>2. ... an inexperienced user should be able to perform a recovery ...
</code></pre>
<p>In sbin/rear the additional config files are<br />
intentionally sourced after the ususal config files<br />
so that the user can overwrite settings in his<br />
ususal config files by different ones in his<br />
additional config files so he can have settings<br />
in his ususal config files as his specific defaults.</p>
<p>I think what @idanbenezra wants can be done without<br />
any changes in ReaR code because sourcing config files<br />
means to run them as bash scripts so the user can run<br />
any commands as he needs for his specific use case, see<br />
<a href="https://github.com/rear/rear/blob/master/etc/rear/local.conf">https://github.com/rear/rear/blob/master/etc/rear/local.conf</a></p>
<p>For example to automatically source an additional config file<br />
when no '-C /tmp/foodir/foo.conf' was specified<br />
in etc/rear/local.conf like</p>
<pre><code>if ! [[ "$CONFIG_APPEND_FILES" == */tmp/foodir/foo.conf* ]] ; then
    LogPrint "Sourcing /tmp/foodir/foo.conf"
    test -s /tmp/foodir/foo.conf || Error "/tmp/foodir/foo.conf does not exists or is empty"
    Source /tmp/foodir/foo.conf || Error "Failed to Source /tmp/foodir/foo.conf"
fi
</code></pre>
<p>which seems to work for me<br />
(but I didn't test with "rear recover"):</p>
<pre><code># usr/sbin/rear -D help
Sourcing /tmp/foodir/foo.conf
...
</code></pre>
<p>Currently one cannot set CONFIG_APPEND_FILES in etc/rear/local.conf<br />
because CONFIG_APPEND_FILES is set readonly in sbin/rear before<br />
etc/rear/local.conf is sourced.<br />
Perhaps that readonly is superfluous and can be removed?</p>
<p>@idanbenezra<br />
be careful with sourcing config files:<br />
Sourcing the same config file more than once<br />
can lead to trouble when settings are not idempotent,<br />
e.g. when things are appended to variables.</p>
<h4 id="jsmeix_commented_at_2023-02-20_1013"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1436685872">2023-02-20 10:13</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-20_1013" title="Permanent link">&para;</a></h4>
<p>Currently ReaR behaves as usual traditional commands do<br />
which means that a subsequent call of a command does not inherit<br />
command line option settings from a former command call.<br />
E.g. nobody expects that after one 'cat -n ...' subsequent<br />
calls of plain 'cat' automatically number output lines.</p>
<p>In contrast to usual traditional commands modern GUI stuff<br />
often behaves with "automated inheritance" of former calls.<br />
E.g. after a GUI tool to play some music was run once<br />
a subsequent run starts with the volume setting of the<br />
former run (which is often rather unexpected volume).</p>
<p>I do not want such "automated inheritance" in ReaR.</p>
<p>On the other hand I understand that<br />
"an inexperienced user should be able to perform a recovery".<br />
In particular because this should help the user to avoid<br />
accidental errors during a real disaster recovery<br />
in case of emergency and time pressure.</p>
<p>As far as I see both conflict so I think<br />
careful and thorough investigation is needed<br />
to find out step by step what a right solution is<br />
(or to show that no right solution exists in this case).</p>
<h4 id="schlomo_commented_at_2023-02-20_1205"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1436879543">2023-02-20 12:05</a>:<a class="headerlink" href="#schlomo_commented_at_2023-02-20_1205" title="Permanent link">&para;</a></h4>
<p>Good point about GUI apps, @jsmeix</p>
<p>I think ReaR is somewhat a special case, it is neither just a CLI tool
nor a GUI app.</p>
<p>On top of that I take the <strong>ReaR Rescue System</strong> to be a very special
tool, which is custom built for a single job and purpose: Recover the
original system as easy as we can make it.</p>
<p>For that purpose the <code>rear mkrescue</code> phase takes a large amount of
decisions and pre-configures the rescue system in a way that ensures
that <code>rear recover</code> works well. And we don't support changing course
mid-way, e.g. starting a rescue system and then changing the backup
method to something completely different via command line option. At
least we don't provide that kind of functionality by default.</p>
<p>With regard to extra configs that thinking makes me lean towards adding
a configuration option that automatically includes the extra configs for
recovery, to follow the existing approach that a <code>rear mkrescue</code> run
pre-configures the rescue system for the intended job.</p>
<p>The result would be that calling <code>rear mkrescue</code> with different
<code>-C conf</code> options would yield different rescue systems that also behave
different. After all, in that extra config everything can be changed to
the extend that calling <code>rear recover</code> <em>without</em> that extra config won't
actually work.</p>
<p>As the recovery is intended to be used even by less technically skilled
people I would choose "reliably run recovery as configured" over "the
admin must choose the recovery extra options if he did so during
mkrescue"</p>
<p>Makes any sense?</p>
<h4 id="jsmeix_commented_at_2023-02-20_1223"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1436921236">2023-02-20 12:23</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-20_1223" title="Permanent link">&para;</a></h4>
<p>All what you describe in<br />
<a href="https://github.com/rear/rear/issues/2936#issuecomment-1436879543">https://github.com/rear/rear/issues/2936#issuecomment-1436879543</a><br />
"just works" with current ReaR with<br />
BACKUP=MYINTEGRATION in etc/rear/local.conf<br />
It works because you talk about "the system" (singular).</p>
<p>The issue here is that for obscure reasons @idanbenezra<br />
cannot have BACKUP=MYINTEGRATION in etc/rear/local.conf</p>
<p>I do not at all understand what is meant with</p>
<pre><code>a dynamic system that can execute multiple rear mkrescue
at the same time with different configs
</code></pre>
<p>Multiple rear mkrescue at the same time<br />
are normally explicitly forbidden via</p>
<pre><code>SIMULTANEOUS_RUNNABLE_WORKFLOWS=( 'mkbackuponly' 'restoreonly' )
</code></pre>
<p>in default.conf.</p>
<p>FYI:<br />
The primarily intended use case behind '-C' is described in<br />
<a href="https://github.com/rear/rear/blob/master/doc/user-guide/11-multiple-backups.adoc">https://github.com/rear/rear/blob/master/doc/user-guide/11-multiple-backups.adoc</a></p>
<h4 id="schlomo_commented_at_2023-02-21_1232"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1438403419">2023-02-21 12:32</a>:<a class="headerlink" href="#schlomo_commented_at_2023-02-21_1232" title="Permanent link">&para;</a></h4>
<p>@idanbenezra can you please shed some light on our discussion from your
perspective? What - <strong>and why</strong> - would be your expectation with regard
to how <code>rear recover</code> should behave in context of additional
configuration files?</p>
<h4 id="idanbenezra_commented_at_2023-02-21_1305"><img src="https://avatars.githubusercontent.com/u/19408535?v=4" width="50"><a href="https://github.com/idanbenezra">idanbenezra</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1438454289">2023-02-21 13:05</a>:<a class="headerlink" href="#idanbenezra_commented_at_2023-02-21_1305" title="Permanent link">&para;</a></h4>
<p>@schlomo</p>
<p>I'm integration ReaR into our own product (JetBackup
<a href="https://www.jetbackup.com/">https://www.jetbackup.com/</a>).<br />
Our product can execute multiple backup jobs simultaneously, However
after @jsmeix last replay that <code>rear mkrescue</code> can't be executed
simultaneously I've disabled it on our end also.</p>
<p>Our software creates custom config for ReaR during the backup process
and then provides it to the <code>mkrescue -C</code>.</p>
<p>The end user that will use it won't know that he need to use
<code>recover -C</code> on the rescue system, also the "Automatic Recover" will
never work.</p>
<h4 id="jsmeix_commented_at_2023-02-21_1309"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1438462224">2023-02-21 13:09</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-21_1309" title="Permanent link">&para;</a></h4>
<p>By the way<br />
(sleeping on an issue always helps - if not sleep more ;-)</p>
<p>I found a real issue with our current '-c' and '-C':</p>
<p>The 'automatic/auto_recover' and 'unattended' modes<br />
currently call only</p>
<pre><code>rear $rear_debug_options recover
</code></pre>
<p>see<br />
<a href="https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/skel/default/etc/scripts/system-setup#L155">https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/skel/default/etc/scripts/system-setup#L155</a><br />
and<br />
<a href="https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/skel/default/etc/scripts/system-setup#L192">https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/skel/default/etc/scripts/system-setup#L192</a></p>
<p>So '-c' and '-C' are ignored / not possible<br />
with our current 'automatic/auto_recover' and 'unattended' modes<br />
which is a bug that needs to be fixed.</p>
<h4 id="jsmeix_commented_at_2023-02-21_1313"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1438470020">2023-02-21 13:13</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-21_1313" title="Permanent link">&para;</a></h4>
<p>@idanbenezra<br />
yes,<br />
I also found out that the 'automatic/auto_recover'<br />
and 'unattended' modes currently don't work<br />
with '-c' and/or '-C'<br />
(which tells a lot how often '-c' and/or '-C'<br />
plus 'automatic/auto_recover' or 'unattended'<br />
are actually used by users "out there").</p>
<h4 id="jsmeix_commented_at_2023-02-21_1316"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1438475287">2023-02-21 13:16</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-21_1316" title="Permanent link">&para;</a></h4>
<p>My current offhanded idea how to fix that generically<br />
is to store the whole 'rear [options] workflow' command line<br />
of each last called workflow in the ReaR recovery system.</p>
<p>Because only "rear mkrescue" and "rear mkbackup" create<br />
a ReaR recovery system only those workflows can store<br />
their command line in the ReaR recovery system.</p>
<p>So some "rear special_option mkbackuponly" cannot<br />
store its command line in the ReaR recovery system.</p>
<h4 id="jsmeix_commented_at_2023-02-21_1320"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1438481365">2023-02-21 13:20</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-21_1320" title="Permanent link">&para;</a></h4>
<p>I did<br />
<a href="https://github.com/rear/rear/issues/2942">https://github.com/rear/rear/issues/2942</a><br />
to have that specific issue separated from this one here.</p>
<h4 id="jsmeix_commented_at_2023-02-21_1326"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1438488850">2023-02-21 13:26</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-21_1326" title="Permanent link">&para;</a></h4>
<p>@idanbenezra<br />
I do not understand what you actually mean with</p>
<pre><code>Our product can execute multiple backup jobs simultaneously
</code></pre>
<p>How could it make sense to execute multiple backup jobs<br />
simultaneously on one same system?</p>
<p>What exactly is a "backup job"?</p>
<p>I can imagine to run multiple file backups like 'tar'<br />
simultaneously on one same system when each one<br />
backups a different part of the files, cf. my<br />
<a href="https://github.com/rear/rear/blob/master/doc/user-guide/11-multiple-backups.adoc">https://github.com/rear/rear/blob/master/doc/user-guide/11-multiple-backups.adoc</a></p>
<p>But I cannot imagine what the use case could be to<br />
create multiple times simultaneously on one same system<br />
a rescue/recovery system (e.g. a ReaR recovery system)?</p>
<h4 id="idanbenezra_commented_at_2023-02-21_1332"><img src="https://avatars.githubusercontent.com/u/19408535?v=4" width="50"><a href="https://github.com/idanbenezra">idanbenezra</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1438498206">2023-02-21 13:32</a>:<a class="headerlink" href="#idanbenezra_commented_at_2023-02-21_1332" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<p>A "backup job" define a set of configurations that can be executed at a
user configurable schedule.</p>
<p>For example, a user can set 2 different accounts backup jobs (will
backup the entire account - homedir, databases, Email accounts and etc)
that runs at the same time and backs up the data to 2 different offsite
destinations.</p>
<h4 id="jsmeix_commented_at_2023-02-21_1341"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1438512457">2023-02-21 13:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-21_1341" title="Permanent link">&para;</a></h4>
<p>@idanbenezra<br />
so with "backup" you mean making a backup of some files<br />
but not creating a rescue/recovery system.</p>
<p>We use the same meaning of "backup" in ReaR.<br />
But often users confuse the meaning of "backup" in ReaR<br />
with ReaR's native task: "creating a rescue/recovery system"<br />
cf. the section<br />
"Relax-and-Recover versus backup and restore" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<h4 id="github-actions_commented_at_2023-04-24_0222"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2936#issuecomment-1519291895">2023-04-24 02:22</a>:<a class="headerlink" href="#github-actions_commented_at_2023-04-24_0222" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2023-02-16.2936.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
