<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>2015 04 24.581.issue.closed - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "2015 04 24.581.issue.closed";
        var mkdocs_page_input_path = "issues/2015-04-24.581.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', '366986045', 'auto');
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>2015 04 24.581.issue.closed</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="581_issue_closed_cannot_create_iso_image_4gb_on_rhel6"><a href="https://github.com/rear/rear/issues/581">#581 Issue</a> <code>closed</code>: Cannot create ISO image &gt;4GB on RHEL6<a class="headerlink" href="#581_issue_closed_cannot_create_iso_image_4gb_on_rhel6" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>documentation</code>, <code>support / question</code></p>
<h4 id="wwoo1_opened_issue_at_2015-04-24_2121"><img src="https://avatars.githubusercontent.com/u/12104456?v=4" width="50"><a href="https://github.com/wwoo1">wwoo1</a> opened issue at <a href="https://github.com/rear/rear/issues/581">2015-04-24 21:21</a>:<a class="headerlink" href="#wwoo1_opened_issue_at_2015-04-24_2121" title="Permanent link">&para;</a></h4>
<p>Hello... I could not backup to ISO images &gt;4GB. I set
ISO_MAX_SIZE=10000 and that did not help either. Thanks.</p>
<pre><code>[root@teak rear]# rear -v mkbackup
Relax-and-Recover 1.17.0 / Git
Using log file: /var/log/rear/rear-teak.log
Creating disk layout
Creating root filesystem layout
TIP: To login as root via ssh you need to set up /root/.ssh/authorized_keys or SSH_ROOT_PASSWORD in your configuration file
Copying files and directories
Copying binaries and libraries
Copying kernel modules
Creating initramfs
Encrypting disabled
Creating tar archive '/backups/rear/rear.RPwWr8Nk1dERlAI/tmp/isofs/backup/backup.tar.gz'
Archived 5533 MiB [avg 6112 KiB/sec]OK
Archived 5533 MiB in 928 seconds [avg 6106 KiB/sec]
Preparing 2 ISO images ...
Making additionnal ISO image : rear-teak_01.iso
Wrote ISO image: /backups/rear/rear-teak_01.iso (1.2G)
Making ISO image
ERROR: Could not create ISO image (with /usr/bin/mkisofs)
Aborting due to an error, check /var/log/rear/rear-teak.log for details
Terminated
[root@teak rear]#
</code></pre>
<p>From /var/log/rear/rear-teak.log</p>
<pre><code>2015-04-24 12:34:54 Wrote ISO image: /backups/rear/rear-teak_01.iso (1.2G)
2015-04-24 12:34:54 Including output/ISO/Linux-i386/82_create_iso_image.sh
2015-04-24 12:34:54 Starting '/usr/bin/mkisofs'
2015-04-24 12:34:54 Making ISO image
genisoimage 1.1.9 (Linux)
Scanning .
Scanning ./backup
File ./backup/backup.tar.gz.00 is larger than 4GiB-1.
-allow-limited-size was not specified. There is no way do represent this file size. Aborting.
2015-04-24 12:34:54 ERROR: Could not create ISO image (with /usr/bin/mkisofs)
=== Stack trace ===
Trace 0: /usr/sbin/rear:251 main
Trace 1: /usr/share/rear/lib/mkbackup-workflow.sh:22 WORKFLOW_mkbackup
Trace 2: /usr/share/rear/lib/framework-functions.sh:70 SourceStage
Trace 3: /usr/share/rear/lib/framework-functions.sh:31 Source
Trace 4: /usr/share/rear/output/ISO/Linux-i386/82_create_iso_image.sh:17 source
Trace 5: /usr/share/rear/lib/_input-output-functions.sh:132 StopIfError
Message: Could not create ISO image (with /usr/bin/mkisofs)
===================
2015-04-24 12:34:54 Running exit tasks.
rmdir: removing directory, `/backups/rear/rear.RPwWr8Nk1dERlAI/outputfs'
2015-04-24 12:34:54 Finished in 965 seconds
2015-04-24 12:34:54 Removing build area /backups/rear/rear.RPwWr8Nk1dERlAI
rmdir: removing directory, `/backups/rear/rear.RPwWr8Nk1dERlAI/outputfs'
rmdir: failed to remove `/backups/rear/rear.RPwWr8Nk1dERlAI/outputfs': No such file or directory
rmdir: removing directory, `/backups/rear/rear.RPwWr8Nk1dERlAI'
2015-04-24 12:34:55 End of program reached
</code></pre>
<h4 id="gdha_commented_at_2015-04-26_1633"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/581#issuecomment-96405311">2015-04-26 16:33</a>:<a class="headerlink" href="#gdha_commented_at_2015-04-26_1633" title="Permanent link">&para;</a></h4>
<p>See
<a href="http://stackoverflow.com/questions/20209263/genisoimage-script-cannot-burn-bigger-than-4gb-but-less-than-4-5gb-file">http://stackoverflow.com/questions/20209263/genisoimage-script-cannot-burn-bigger-than-4gb-but-less-than-4-5gb-file</a><br />
It was never the purpose of rear to create <em>big</em> ISO images, but with
the above link you could tweak rear to make your problem go away. Keep
in touch on your progress...</p>
<h4 id="wwoo1_commented_at_2015-04-27_1941"><img src="https://avatars.githubusercontent.com/u/12104456?v=4" width="50"><a href="https://github.com/wwoo1">wwoo1</a> commented at <a href="https://github.com/rear/rear/issues/581#issuecomment-96792807">2015-04-27 19:41</a>:<a class="headerlink" href="#wwoo1_commented_at_2015-04-27_1941" title="Permanent link">&para;</a></h4>
<p>I added <code>-allow-limited-size</code> to <code>$ISO_MKISOFS_BIN</code> in
<code>/usr/share/rear/output/ISO/Linux-i386/81_prepare_multiple_iso.sh</code> and
the image size was able to go past 4GB, but it looks like 8.6GB is the
limit. I worked around it by tar'ing the large directories and manually
restoring them after recovery. Thanks for your help.</p>
<h4 id="multipathmaster_commented_at_2015-09-01_1348"><img src="https://avatars.githubusercontent.com/u/11719398?u=e1b5820af3b009d3b55aad6297b9a0342d37662c&v=4" width="50"><a href="https://github.com/multipathmaster">multipathmaster</a> commented at <a href="https://github.com/rear/rear/issues/581#issuecomment-136728650">2015-09-01 13:48</a>:<a class="headerlink" href="#multipathmaster_commented_at_2015-09-01_1348" title="Permanent link">&para;</a></h4>
<p>So yes, having <code>-allow-limited-size</code> to $ISO_MKISOFS_BIN will enable
the ISO image to become larger than 4.7 GIGs. However the real issue is
that in RHEL6/CENTOS6 mkisofs is actually a soft link back to
/etc/alternatives that points to genisoimage. The issue is that
genisomage is not infact mkisofs, with the REAL version of mkisofs being
a subset of a tools package called CDRTOOLS. Which is open source,
however because of certain limitations of working for a large
corporation, we do not have the ability to install (./configure make
make install) for the real binary version of mkisofs, so instead, you
can always add a new variable within the
<code>/usr/share/rear/backup/NETFS/default/50*</code> called SPLIT_COMMAND2 which
references the actual split differently than the normal $SPLIT_COMMAND
that is called under the tar function sequence of that script.</p>
<p>so inside <code>50_make_backup.sh</code> you can put this at the top, or inside the
set_tar_features</p>
<pre><code>SPLIT_COMMAND2="split --bytes=${BKUP_MAX_SIZE} - ${backuparchive}."
</code></pre>
<p>Or name it whatever you wish...</p>
<p><code>${BKUP_MAX_SIZE}</code> is a variable that you set in <code>/etc/rear/*.conf</code>
(whichever conf file you wish to use, os.conf/site.conf/default.conf,
whatever you currently are running with rear).</p>
<pre><code>cat /etc/rear/site.conf | grep BKUP_MAX_SIZE
BKUP_MAX_SIZE=3500MB
</code></pre>
<p>Now under the tar section of ${BACKUP_PROG} section of
50_make_backup.sh</p>
<pre><code># tar compatible programs here
        (tar)
                set_tar_features
                Log $BACKUP_PROG $TAR_OPTIONS --sparse --block-number --totals --verbose \
                        --no-wildcards-match-slash --one-file-system \
                        --ignore-failed-read $BACKUP_PROG_OPTIONS \
                        $BACKUP_PROG_X_OPTIONS \
                        ${BACKUP_PROG_BLOCKS:+-b $BACKUP_PROG_BLOCKS} $BACKUP_PROG_COMPRESS_OPTIONS \
                        -X $TMP_DIR/backup-exclude.txt -C / -c -f - \
                        $(cat $TMP_DIR/backup-include.txt) $LOGFILE \| $BACKUP_PROG_CRYPT_OPTIONS BACKUP_PROG_CRYPT_KEY \| $SPLIT_COMMAND2
                $BACKUP_PROG $TAR_OPTIONS --sparse --block-number --totals --verbose \
                        --no-wildcards-match-slash --one-file-system \
                        --ignore-failed-read $BACKUP_PROG_OPTIONS \
                        $BACKUP_PROG_X_OPTIONS \
                        ${BACKUP_PROG_BLOCKS:+-b $BACKUP_PROG_BLOCKS} $BACKUP_PROG_COMPRESS_OPTIONS \
                        -X $TMP_DIR/backup-exclude.txt -C / -c -f - \
                        $(cat $TMP_DIR/backup-include.txt) $LOGFILE | $BACKUP_PROG_CRYPT_OPTIONS $BACKUP_PROG_CRYPT_KEY | $SPLIT_COMMAND2
</code></pre>
<p>see how now I am calling on $SPLIT_COMMAND2 at the tail end of these 2
lines?</p>
<p>What does this do for RHEL6?</p>
<p>Your backup.tar.gz will go into your tmp directory (you can define this
as well, or leave it default if you think you have enough room), and it
will only allow the backup.tar.gz do grow to 3.5 GIGS, and then it
splits it off and creates a new one, and you wind up with a naming
convention such as this --&gt; backup.tar.gz.aa<br />
backup.tar.gz.ab<br />
backup.tar.gz.ac<br />
backup.tar.gz.ad</p>
<p>so on and so forth. This will keep the backup.tar.gz from exceeding the
4GiB hard limit that is set by the false mkisofs that is really a
pointer back to genisoimage. Then once the ISO is created, it can grow
to as big as it needs, while copying the backup.tar.gz files within the
ISO.</p>
<p>Once it is time for recovery, the recovery section utilizes a for i in
<code>ls ${BUILDDIR}/path/to/backups/*.tar.gz</code> which finds the path to those
backup.tar.gz and because of globbing within a native shell it should
extract them in the same order as it had created them. Although some
testing needs to be done.</p>
<p>This simple step will allow much larger than 4 gig ISO images, but keeps
the actual NETFS tar.gz files smaller than 4GIB so that you avoid that
pesky error about the file size being too large.</p>
<h4 id="gdha_commented_at_2016-02-19_0933"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/581#issuecomment-186135543">2016-02-19 09:33</a>:<a class="headerlink" href="#gdha_commented_at_2016-02-19_0933" title="Permanent link">&para;</a></h4>
<p>Added a note to the FAQ of rear (on the web pages)</p>
<h4 id="br0adax3_commented_at_2016-10-05_2300"><img src="https://avatars.githubusercontent.com/u/20324101?v=4" width="50"><a href="https://github.com/Br0adax3">Br0adax3</a> commented at <a href="https://github.com/rear/rear/issues/581#issuecomment-251823986">2016-10-05 23:00</a>:<a class="headerlink" href="#br0adax3_commented_at_2016-10-05_2300" title="Permanent link">&para;</a></h4>
<p>Uhm. I have run into this problem with an installation on RHEL7.2, using
the version that comes with the OS (1.17.2). I have modified the scripts
as suggested here, and still got the error. The problem file in my case
is ./isolinux/initrd.cgz, which has grown to some 5.8G. Any suggestions?</p>
<p>Thanks.</p>
<h4 id="jsmeix_commented_at_2016-10-06_0915"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/581#issuecomment-251909003">2016-10-06 09:15</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-10-06_0915" title="Permanent link">&para;</a></h4>
<p>I have a general question:</p>
<p>Currently I cannot imagine a good reason why<br />
one would like to have the backup.tar.gz within the ISO?</p>
<p>"BACKUP_URL=iso://" is mentioned in the documentation<br />
but without a reason when this could be useful or to what<br />
extent this is meant to be used.</p>
<p>What is the advantage to mix up the backup.tar.gz<br />
with the rear recovery system ISO image?</p>
<p>Why not keep separated things separated?</p>
<p>Furthermore in general regarding huge backup.tar.gz see<br />
<a href="https://github.com/rear/rear/issues/1006#issuecomment-248862040">https://github.com/rear/rear/issues/1006#issuecomment-248862040</a></p>
<p>Finally in general regarding issues with the backup:</p>
<p>Relax-and-Recover (rear) is neither a backup software nor a<br />
backup management software and it is not meant to be one, cf.<br />
"Relax-and-Recover (rear) versus backup and restore" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>In particular in this case here rear only calls an external tool<br />
that makes an ISO image in the usual way as it is normally<br />
intended for rear i.e. an ISO image that contains only<br />
the rear recovery system (up to about 500 MB)<br />
or at most an ISO image that contains the rear recovery<br />
system plus a backup of the files of the basic operating<br />
system (up to very few GB - usually less than 4 GB)<br />
but not to also a backup of huge application files<br />
like databases and things like that.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2022 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2015-04-24.581.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
