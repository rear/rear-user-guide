<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1264 Issue closed: Get "grub&gt;" prompt and not booting, after "rear recover" done and reboot with UEFI - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1264 Issue closed: Get \"grub\u0026gt;\" prompt and not booting, after \"rear recover\" done and reboot with UEFI";
        var mkdocs_page_input_path = "issues/2017-03-27.1264.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li class="breadcrumb-item active">#1264 Issue closed: Get "grub&gt;" prompt and not booting, after "rear recover" done and reboot with UEFI</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1264_issue_closed_get_grub_prompt_and_not_booting_after_rear_recover_done_and_reboot_with_uefi"><a href="https://github.com/rear/rear/issues/1264">#1264 Issue</a> <code>closed</code>: Get "grub&gt;" prompt and not booting, after "rear recover" done and reboot with UEFI<a class="headerlink" href="#1264_issue_closed_get_grub_prompt_and_not_booting_after_rear_recover_done_and_reboot_with_uefi" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="dongin0916_opened_issue_at_2017-03-27_0434"><img src="https://avatars.githubusercontent.com/u/26700585?v=4" width="50"><a href="https://github.com/DongIn0916">DongIn0916</a> opened issue at <a href="https://github.com/rear/rear/issues/1264">2017-03-27 04:34</a>:<a class="headerlink" href="#dongin0916_opened_issue_at_2017-03-27_0434" title="Permanent link">&para;</a></h4>
<h3 id="relax-and-recover_rear_issue_template">#### Relax-and-Recover (rear) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h3>
<p>Please fill in the following items before submitting a new issue (quick
response is not guaranteed with free support):</p>
<ul>
<li>rear version (/usr/sbin/rear -V): 1.19-2 and 2.00-2</li>
<li>OS version (cat /etc/rear/os.conf or lsb_release -a): RHEL 6.7</li>
<li>rear configuration files (cat /etc/rear/site.conf or cat
    /etc/rear/local.conf):</li>
</ul>
<pre>
OUTPUT=ISO
BACKUP=NETFS
USING_UEFI_BOOTLOADER=1
AUTOEXCLUDE_MULTIPATH=n  
BOOT_OVER_SAN=y         
NETFS_URL=nfs://16.151.73.77/home/shindig
NETFS_KEEP_OLD_BACKUP_COPY=no
BACKUP_PROG_EXCLUDE=("${BACKUP_PROG_EXCLUDE[@]}" '/dev/shm' '/var/tmp/*' '/tmp/*' '/var/crash/*')
KERNEL_CMDLINE="biosdevname=1"
</pre>

<ul>
<li>Are you using legacy BIOS or UEFI boot? UEFI Boot</li>
<li>Brief description of the issue:<br />
    Hello, last week, I have tested rear tool as the following
    environment:<br />
    Rear : 1.19-2 and 2.00-2<br />
    OS : RHEL V6.7<br />
    HW : HPE Superdome X + 3PAR Storage<br />
    Boot Mode : UEFI<br />
    Boot : SAN Boot Storage(3PAR).</li>
</ul>
<p>I had succfully done rear backup and recover by the above configuration,
but I have got to grub prompt "grub&gt;" after booting.<br />
I need your help about the reason and the solution of booting failure at
grub.<br />
I recreated bootloader by efibootmgr command, but this issue has
occurred again by the follwing command:</p>
<pre>
# efibootmgr –c –d /dev/mapper/device-name –L “Redhat xxxxx” –l \EFI\redhat\grub.efi
</pre>

<ul>
<li>Work-around, if any: None</li>
</ul>
<h4 id="jsmeix_commented_at_2017-03-27_0832"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289387853">2017-03-27 08:32</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-03-27_0832" title="Permanent link">&para;</a></h4>
<p>@gozora<br />
I dare to assign this issue to you because it is about UEFI.</p>
<p>I noticed that in this case there is "BOOT_OVER_SAN=y"<br />
together with "USING_UEFI_BOOTLOADER=1" and<br />
I wonder if that is supported at all by ReaR?</p>
<h4 id="jsmeix_commented_at_2017-03-27_0834"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289388410">2017-03-27 08:34</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-03-27_0834" title="Permanent link">&para;</a></h4>
<p>@DongIn0916<br />
what exactly do you mean with</p>
<pre>
... this issue has occurred again by the follwing command:
# efibootmgr ...
</pre>

<h4 id="jsmeix_commented_at_2017-03-27_0840"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289389764">2017-03-27 08:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-03-27_0840" title="Permanent link">&para;</a></h4>
<p>@DongIn0916<br />
in general when after "rear recover" and reboot<br />
the recreated system cannot successfully boot,<br />
you should first redo "rear recover" but then do not<br />
reboot from the running ReaR recovery system<br />
but instead keep the ReaR recovery system running<br />
(where you are still logged in as 'root') and try to manually<br />
install the bootloader as you need it in your particular case.<br />
Within the running ReaR recovery system after "rear recover"<br />
the recreated system is mounted below "/mnt/local/" so that<br />
with appropriate "chroot /mnt/local/" commands you can<br />
manually install your bootloader in your recreated system.</p>
<h4 id="gozora_commented_at_2017-03-27_0845"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289390822">2017-03-27 08:45</a>:<a class="headerlink" href="#gozora_commented_at_2017-03-27_0845" title="Permanent link">&para;</a></h4>
<p>@jsmeix thanks for trusting in UEFI skills so much :-).</p>
<p>@DongIn0916 my guess is that you've somehow lost grub.cfg. You can try
to locate it using GRUB shell.<br />
On my system following worked for me<br />
<code>grub&gt; configfile (hd1,gpt3)/boot/grub2/grub.cfg</code></p>
<p>or you can load kernel and initrd
<a href="https://www.linux.com/learn/how-rescue-non-booting-grub-2-linux">manually</a></p>
<p>V.</p>
<h4 id="gozora_commented_at_2017-03-27_0902"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289394840">2017-03-27 09:02</a>:<a class="headerlink" href="#gozora_commented_at_2017-03-27_0902" title="Permanent link">&para;</a></h4>
<p>Hello @jsmeix</p>
<blockquote>
<p>I noticed that in this case there is "BOOT_OVER_SAN=y"<br />
together with "USING_UEFI_BOOTLOADER=1" and<br />
I wonder if that is supported at all by ReaR?</p>
</blockquote>
<p>Checking BOOT_OVER_SAN doesen't do really much:</p>
<pre><code># 240_include_multipath_tools.sh
# Boot Over SAN executables and other goodies

[[ $BOOT_OVER_SAN != ^[yY1] ]] &amp;&amp; return

PROGS=( "${PROGS[@]}" multipath dmsetup kpartx multipathd scsi_id  )
COPY_AS_IS=( "${COPY_AS_IS[@]}" /etc/multipath/bindings /etc/multipath/wwids /etc/multipath.conf )
</code></pre>
<p>So I guess it is compatible with USING_UEFI_BOOTLOADER ...</p>
<p>V.</p>
<h4 id="dongin0916_commented_at_2017-03-27_0906"><img src="https://avatars.githubusercontent.com/u/26700585?v=4" width="50"><a href="https://github.com/DongIn0916">DongIn0916</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289395803">2017-03-27 09:06</a>:<a class="headerlink" href="#dongin0916_commented_at_2017-03-27_0906" title="Permanent link">&para;</a></h4>
<p>Tank you very much for your update.<br />
I run efibootmgr command after rear recover done and chroot
/mnt/local.<br />
and then I run reboot command. but this issue occurred again.</p>
<h4 id="jsmeix_commented_at_2017-03-27_1121"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289425078">2017-03-27 11:21</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-03-27_1121" title="Permanent link">&para;</a></h4>
<p>As UEFI and general booting noob I mainly listen here<br />
so that I may (hopefully) learn a bit.</p>
<p>As far as I meanwhile understand it<br />
"BOOT_OVER_SAN=y" together with<br />
"USING_UEFI_BOOTLOADER=1" means that<br />
the disk wherefrom the system is booted is connected via SAN<br />
and on that boot disk UEFI is used.</p>
<h4 id="gozora_commented_at_2017-03-27_1504"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289482070">2017-03-27 15:04</a>:<a class="headerlink" href="#gozora_commented_at_2017-03-27_1504" title="Permanent link">&para;</a></h4>
<p>efibootmgr will not help you much out of this!<br />
Did you try to load kernel and initrd from grub prompt?</p>
<p>V.</p>
<h4 id="dongin0916_commented_at_2017-03-27_2340"><img src="https://avatars.githubusercontent.com/u/26700585?v=4" width="50"><a href="https://github.com/DongIn0916">DongIn0916</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289618296">2017-03-27 23:40</a>:<a class="headerlink" href="#dongin0916_commented_at_2017-03-27_2340" title="Permanent link">&para;</a></h4>
<p>No, I did not try to load them from grub.</p>
<h4 id="dongin0916_commented_at_2017-03-27_2344"><img src="https://avatars.githubusercontent.com/u/26700585?v=4" width="50"><a href="https://github.com/DongIn0916">DongIn0916</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289618929">2017-03-27 23:44</a>:<a class="headerlink" href="#dongin0916_commented_at_2017-03-27_2344" title="Permanent link">&para;</a></h4>
<p>I would like to know the root cause of this issue that does not
recognize grub bootloader with san boot environment.</p>
<h4 id="gozora_commented_at_2017-03-28_0735"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289688153">2017-03-28 07:35</a>:<a class="headerlink" href="#gozora_commented_at_2017-03-28_0735" title="Permanent link">&para;</a></h4>
<p>@DongIn0916 you've told that your boot end up in grub shell. That means
that your boot loader is recognized ...</p>
<h4 id="dongin0916_commented_at_2017-03-28_0750"><img src="https://avatars.githubusercontent.com/u/26700585?v=4" width="50"><a href="https://github.com/DongIn0916">DongIn0916</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289691299">2017-03-28 07:50</a>:<a class="headerlink" href="#dongin0916_commented_at_2017-03-28_0750" title="Permanent link">&para;</a></h4>
<p>I agree with your information, but I do not know the root reason. I'll
try to anlyze about rear and efi san boot.</p>
<h4 id="gdha_commented_at_2017-03-28_0816"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-289697082">2017-03-28 08:16</a>:<a class="headerlink" href="#gdha_commented_at_2017-03-28_0816" title="Permanent link">&para;</a></h4>
<p>@jsmeix @gozora BOOT_OVER_SAN piece was added for a customer that
needed it to clone from internal boot disks to SAN boot disks.
Therefore, the code is rather small, and perhaps today it could be
removed and added by default?</p>
<h4 id="dongin0916_commented_at_2017-03-31_0528"><img src="https://avatars.githubusercontent.com/u/26700585?v=4" width="50"><a href="https://github.com/DongIn0916">DongIn0916</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-290619637">2017-03-31 05:28</a>:<a class="headerlink" href="#dongin0916_commented_at_2017-03-31_0528" title="Permanent link">&para;</a></h4>
<p>now, the system is grub menu with grub&gt; normal and then the system is
normal booting.<br />
but I do not know the reason to drop grub commant prompt.</p>
<p>My detail steps are :</p>
<p>Step1 : I run grub-install and efibootmgr commands.<br />
Step2 : run "shutdown -r now" command<br />
Step3 : Drop to grub command prompt<br />
Step4 : run normal command<br />
grub&gt; normal <enter><br />
Step5 : display grub menu<br />
Step6 : done normal booting</p>
<h4 id="jsmeix_commented_at_2019-04-26_1253"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1264#issuecomment-487046031">2019-04-26 12:53</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-04-26_1253" title="Permanent link">&para;</a></h4>
<p>Because there was no further update since a long time here<br />
I assume this issue is meanwhile somehow sufficiently solved and<br />
<a href="https://github.com/rear/rear/issues/1264#issuecomment-290619637">https://github.com/rear/rear/issues/1264#issuecomment-290619637</a><br />
indicates there is at least some workaround how to get it booted.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2023 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2017-03-27.1264.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
