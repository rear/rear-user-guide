<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2340 Issue closed: SELinux failure upon restoration of system, when choosing the auto-recover option from the grub menu. - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2340 Issue closed: SELinux failure upon restoration of system, when choosing the auto-recover option from the grub menu.";
        var mkdocs_page_input_path = "issues/2020-03-11.2340.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2340 Issue closed: SELinux failure upon restoration of system, when choosing the auto-recover option from the grub menu.</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2340_issue_closed_selinux_failure_upon_restoration_of_system_when_choosing_the_auto-recover_option_from_the_grub_menu"><a href="https://github.com/rear/rear/issues/2340">#2340 Issue</a> <code>closed</code>: SELinux failure upon restoration of system, when choosing the auto-recover option from the grub menu.<a class="headerlink" href="#2340_issue_closed_selinux_failure_upon_restoration_of_system_when_choosing_the_auto-recover_option_from_the_grub_menu" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>no-issue-activity</code></p>
<h4 id="toure_opened_issue_at_2020-03-11_1101"><img src="https://avatars.githubusercontent.com/u/306878?u=60a9afd3ac48bd97fbba98f194f47641b56917e8&v=4" width="50"><a href="https://github.com/Toure">Toure</a> opened issue at <a href="https://github.com/rear/rear/issues/2340">2020-03-11 11:01</a>:<a class="headerlink" href="#toure_opened_issue_at_2020-03-11_1101" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"): rear-2.4-7</p>
</li>
<li>
<p>OS version ("cat /etc/rear/os.conf" or "lsb_release -a" or "cat
    /etc/os-release"): RHEL7.7 / Centos 7.7</p>
</li>
<li>
<p>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):</p>
</li>
<li>
<p>Hardware (PC or PowerNV BareMetal or ARM) or virtual machine (KVM
    guest or PoverVM LPAR):<br />
    KVM guest</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device):<br />
    x86_64</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot):<br />
    GRUB</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe):<br />
    local disk</p>
</li>
<li>
<p>Storage layout ("lsblk -ipo
    NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT" or "lsblk" as
    makeshift):</p>
</li>
<li>
<p>Description of the issue (ideally so that others can reproduce
    it):<br />
    Using ReaR to backup the system and creating a bootable recovery
    image, select "Automatic Recover <Node Name>" from the GRUB menu,
    complete the recovery process and reboot the server. Upon first
    boot, the system will throw an error from selinux stating that it
    can not find its policy file.</p>
</li>
<li>
<p>Workaround, if any:<br />
    Selecting manual recovery seem to complete the recovery correctly
    without any issues, possible race condition.</p>
</li>
<li>
<p>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files):<br />
    Working on getting logs.</p>
</li>
</ul>
<h4 id="jsmeix_commented_at_2020-03-12_1442"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2340#issuecomment-598226511">2020-03-12 14:42</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-03-12_1442" title="Permanent link">&para;</a></h4>
<p>@Toure<br />
does it behave reproducible?<br />
I.e. when you test it several times does then the issue<br />
always happen when you select <code>Automatic Recover</code><br />
in the ReaR recovery system bootloader menue<br />
but it never happens when you launch "rear recover" manually?</p>
<p>I ask because I cannot imagine what the reason could be.</p>
<p>As far as I see the only difference between <code>Automatic Recover</code><br />
and launching "rear recover" manually is coded in<br />
usr/share/rear/skel/default/etc/scripts/system-setup<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/skel/default/etc/scripts/system-setup">https://github.com/rear/rear/blob/master/usr/share/rear/skel/default/etc/scripts/system-setup</a><br />
which is run (as /etc/scripts/system-setup) during ReaR recovery system
startup<br />
and all what it does is to launch "rear recover" automatically, so there
should<br />
be no difference what "rear recover" does.</p>
<p>For a real analysis inspect your "rear -D recover" debug log files<br />
and compare in particular the SELinux related messages therein<br />
for both cases (i.e. when it fails versus when it works).</p>
<p>Those are the SELinux related files in ReaR:</p>
<pre><code>usr/share/rear/skel/default/selinux
usr/share/rear/restore/default/500_selinux_autorelabel.sh
usr/share/rear/restore/NETFS/default/500_selinux_autorelabel.sh
usr/share/rear/restore/NETFS/Linux-i386/510_selinux_fixfiles_exclude_dirs.sh
usr/share/rear/restore/YUM/default/600_restore_selinux_contexts.sh
usr/share/rear/restore/YUM/default/403_binds_for_selinux.sh
usr/share/rear/restore/FDRUPSTREAM/default/270_selinux_considerations.sh
usr/share/rear/prep/RSYNC/GNU/Linux/200_selinux_in_use.sh
usr/share/rear/backup/RSYNC/GNU/Linux/610_start_selinux.sh
usr/share/rear/backup/RSYNC/GNU/Linux/310_stop_selinux.sh
usr/share/rear/backup/NETFS/GNU/Linux/600_start_selinux.sh
usr/share/rear/backup/YUM/default/600_capture_selinux_contexts.sh
</code></pre>
<p>What is actually run in your case depends on your backup/restore method.</p>
<p>I cannot actually help with SELinux specific issues<br />
because I do not use SELinux but I know that every now and then<br />
there have been SELinux related issues with ReaR, cf.<br />
<a href="https://raw.githubusercontent.com/rear/rear/master/doc/rear-release-notes.txt">https://raw.githubusercontent.com/rear/rear/master/doc/rear-release-notes.txt</a><br />
and we have <code>BACKUP_SELINUX_DISABLE</code><br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L1064">https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L1064</a><br />
but I don't know if that could be at all related to this issue here.</p>
<h4 id="toure_commented_at_2020-03-12_1502"><img src="https://avatars.githubusercontent.com/u/306878?u=60a9afd3ac48bd97fbba98f194f47641b56917e8&v=4" width="50"><a href="https://github.com/Toure">Toure</a> commented at <a href="https://github.com/rear/rear/issues/2340#issuecomment-598237555">2020-03-12 15:02</a>:<a class="headerlink" href="#toure_commented_at_2020-03-12_1502" title="Permanent link">&para;</a></h4>
<p>@jsmeix Thanks for responding I may have found the issue, still testing.
It has to do with the option for NETFS:<br />
" # Disable SELinux policy during backup with NETFS or RSYNC (default
yes)<br />
BACKUP_SELINUX_DISABLE=1"</p>
<p>I am not sure why this does effect the manual recovery, but if the above
flag is disabled, that is if it is set to "0" then the recovery seems to
work. As I mentioned I am still trying to test and re-test to make sure,
but so far that has been to only fix so far.</p>
<h4 id="gdha_commented_at_2020-04-15_0856"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2340#issuecomment-613910793">2020-04-15 08:56</a>:<a class="headerlink" href="#gdha_commented_at_2020-04-15_0856" title="Permanent link">&para;</a></h4>
<p>@Toure Strange - the ReaR Automated Testing project is using the
automatic recovery for years already and I never had difficulties with
SELinux so far.<br />
Did you have the time for doing re-tests? And results to share with
us?<br />
Thanks.</p>
<h4 id="github-actions_commented_at_2020-06-26_0139"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2340#issuecomment-649900604">2020-06-26 01:39</a>:<a class="headerlink" href="#github-actions_commented_at_2020-06-26_0139" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<h4 id="toure_commented_at_2020-07-07_1533"><img src="https://avatars.githubusercontent.com/u/306878?u=60a9afd3ac48bd97fbba98f194f47641b56917e8&v=4" width="50"><a href="https://github.com/Toure">Toure</a> commented at <a href="https://github.com/rear/rear/issues/2340#issuecomment-654945556">2020-07-07 15:33</a>:<a class="headerlink" href="#toure_commented_at_2020-07-07_1533" title="Permanent link">&para;</a></h4>
<p>@gdha sorry for the delay we have not been able to reproduce the issue.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2020-03-11.2340.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
