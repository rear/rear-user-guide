<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2907 PR merged: Update 310_network_devices.sh - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2907 PR merged: Update 310_network_devices.sh";
        var mkdocs_page_input_path = "issues/2023-01-08.2907.pr.merged.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2907 PR merged: Update 310_network_devices.sh</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2907_pr_merged_update_310_network_devicessh"><a href="https://github.com/rear/rear/pull/2907">#2907 PR</a> <code>merged</code>: Update 310_network_devices.sh<a class="headerlink" href="#2907_pr_merged_update_310_network_devicessh" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>bug</code>, <code>fixed / solved / done</code></p>
<h4 id="hpannenb_opened_issue_at_2023-01-08_1850"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> opened issue at <a href="https://github.com/rear/rear/pull/2907">2023-01-08 18:50</a>:<a class="headerlink" href="#hpannenb_opened_issue_at_2023-01-08_1850" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_pull_request_template">Relax-and-Recover (ReaR) Pull Request Template<a class="headerlink" href="#relax-and-recover_rear_pull_request_template" title="Permanent link">&para;</a></h4>
<p>Please fill in the following items before submitting a new pull request:</p>
<h5 id="pull_request_details">Pull Request Details:<a class="headerlink" href="#pull_request_details" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p>Type: <strong>Bug Fix</strong></p>
</li>
<li>
<p>Impact: <strong>Normal</strong></p>
</li>
<li>
<p>Reference to related issue (URL):<br />
    #2902</p>
</li>
<li>
<p>How was this pull request tested?<br />
    Tested on a CentOS7 VM with two NICs; 2nd NIC IPv6 only;<br />
    tested on lab and production RHEL7 VMs with hybrid IPv4/6 and IPv6
    only NICs.</p>
</li>
<li>
<p>Brief description of the changes in this pull request:<br />
    With this PR all available intefaces (IPv4 &amp; IPv6) will be chosen
    for the rescue environment.<br />
    Previously just IPv4 interfaces with IP addresses and routing only
    were selected.</p>
</li>
</ul>
<h4 id="jsmeix_commented_at_2023-01-09_1252"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1375580924">2023-01-09 12:52</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-09_1252" title="Permanent link">&para;</a></h4>
<p>@hpannenb<br />
thank you for your pull request!</p>
<p>Could you please add a reference to your issue<br />
<a href="https://github.com/rear/rear/issues/2902">https://github.com/rear/rear/issues/2902</a><br />
by enhancing your existing comment like</p>
<pre><code># Use output of 'ls /sys/class/net/' to select all available interfaces
# in particular to make networking also work with IPv6 only NICs
# see https://github.com/rear/rear/issues/2902
</code></pre>
<p>so others can later easily understand the reason behind,<br />
cf.
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a></p>
<h4 id="jsmeix_commented_at_2023-01-09_1351"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1375653775">2023-01-09 13:51</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-09_1351" title="Permanent link">&para;</a></h4>
<p>@hpannenb<br />
thanks!</p>
<h4 id="jsmeix_commented_at_2023-01-10_1333"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1377288156">2023-01-10 13:33</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-10_1333" title="Permanent link">&para;</a></h4>
<p>@rear/contributors<br />
could someone please also review it if time permits?</p>
<h4 id="pcahyna_commented_at_2023-01-11_1312"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1378732050">2023-01-11 13:12</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-01-11_1312" title="Permanent link">&para;</a></h4>
<p>I am checking how it behaves on a machine with many NICs.</p>
<h4 id="pcahyna_commented_at_2023-01-11_1427"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1378834278">2023-01-11 14:27</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-01-11_1427" title="Permanent link">&para;</a></h4>
<p>On a machine with 6 NICs, 2 of which are configured:</p>
<pre><code>ip r | awk '$2 == "dev" &amp;&amp; $8 == "src" { print $3 }' | sort -u

enp2s0f0
enp2s0f2
</code></pre>
<hr />
<pre><code>ls /sys/class/net/

enp14s0  enp15s0  enp2s0f0  enp2s0f1  enp2s0f2  enp2s0f3  lo
</code></pre>
<h4 id="pcahyna_commented_at_2023-01-11_1901"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1379350378">2023-01-11 19:01</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-01-11_1901" title="Permanent link">&para;</a></h4>
<p>I have not yet found a case where the new code produces a different
output from the old code, but so far I have not invested much in it. I
still feel that it would be better to keep the old code. I believe there
is probably a good reason to keep only interfaces with routing
information and I am afraid of breaking it. Unfortunately, currently I
have very little time for investigating it.<br />
I don't entirely agree with the reasoning in
<a href="https://github.com/rear/rear/issues/2902#issuecomment-1369567575">https://github.com/rear/rear/issues/2902#issuecomment-1369567575</a>
"there are new user options available for NICs (i.e.
EXCLUDE_NETWORK_INTERFACES=()) giving the user enough power to
excluded unwanted NICs instead of implicitly filtering them elsewhere."
It would be unfortunate if we forced users for whom the previous
autodetection has worked well to use an explicit configuration (which
then would need to be maintained - interfaces can change their names, be
different on different machines even if the machies are otherwise
similar, etc.)<br />
@hpannenb could you please change you approach to use the output of
<code>ip -6 r</code>, as suggested by @jsmeix
<a href="https://github.com/rear/rear/issues/2902#issuecomment-1368967611">https://github.com/rear/rear/issues/2902#issuecomment-1368967611</a>
? (I know that it is not straightforward, because the IPv6 routes lack
the <code>src</code> keyword used in the filter for the IPv4 routes.)</p>
<h4 id="pcahyna_commented_at_2023-01-12_2352"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1381116451">2023-01-12 23:52</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-01-12_2352" title="Permanent link">&para;</a></h4>
<p>I have finally found one meaningful difference between the result of the
old code and of the proposed code.</p>
<pre><code>diff -U10 -r /var/tmp/rear.cjIYxe4t6h4ksM2/rootfs/etc/scripts/system-setup.d/60-network-devices.sh /var/tmp/rear.PgacJne54eJTRRI/rootfs/etc/scripts/system-setup.d/60-network-devices.sh

--- /var/tmp/rear.cjIYxe4t6h4ksM2/rootfs/etc/scripts/system-setup.d/60-network-devices.sh       2023-01-12 18:43:30.128396285 -0500
+++ /var/tmp/rear.PgacJne54eJTRRI/rootfs/etc/scripts/system-setup.d/60-network-devices.sh       2023-01-12 04:00:48.923395070 -0500
@@ -18,10 +18,12 @@
 # The following is autogenerated code to setup network interfaces
 # in the recovery system which have all these on the original system:
 # - they are UP
 # - they have an IP address
 # - they are somehow linked to a physical device
 # For details see the rescue/GNU/Linux/310_network_devices.sh script.
 ip link set dev eno1 up
 ip link set dev eno1 mtu 1500
 ip addr add 10.16.216.49/23 dev eno1
 ip addr add 2620:52:0:10d8:1658:d0ff:fed3:31ab/64 dev eno1
+ip link set dev eno2 up
+ip link set dev eno2 mtu 1500
</code></pre>
<p>This is on a machine with two interfaces, one of them (<code>eno2</code>) is
connected, but not configured.<br />
I am not sure if the difference matters or not - probably not.<br />
In any case, the comment</p>
<pre><code># - they have an IP address
</code></pre>
<p>is no longer correct with the proposed code.</p>
<h4 id="hpannenb_commented_at_2023-01-13_2034"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1382359586">2023-01-13 20:34</a>:<a class="headerlink" href="#hpannenb_commented_at_2023-01-13_2034" title="Permanent link">&para;</a></h4>
<p>@pcahyna Well done and valid point.</p>
<p>So the task in the code is to gather all interfaces that are configured
with an IP (either IPv4 and/or IPv6).</p>
<h4 id="hpannenb_commented_at_2023-01-15_0842"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1383090829">2023-01-15 08:42</a>:<a class="headerlink" href="#hpannenb_commented_at_2023-01-15_0842" title="Permanent link">&para;</a></h4>
<p>In the earlier times of the code all available network interfaces were
selected. My PR is reverting to this approach. See e.g.</p>
<p><a href="https://github.com/rear/rear/blob/38131ce55bede4a80fe75bbff416df32ca855945/usr/share/rear/rescue/GNU/Linux/310_network_devices.sh#L90">https://github.com/rear/rear/blob/38131ce55bede4a80fe75bbff416df32ca855945/usr/share/rear/rescue/GNU/Linux/310_network_devices.sh#L90</a></p>
<p>With the commit
<a href="https://github.com/rear/rear/commit/15567ede425401b008e5b1680db36a2c62752b8f">https://github.com/rear/rear/commit/15567ede425401b008e5b1680db36a2c62752b8f</a>
this changed.</p>
<p>Maybe @rmetrich can explain the intention behind introducing his
approach.</p>
<h4 id="rmetrich_commented_at_2023-01-16_0939"><img src="https://avatars.githubusercontent.com/u/1163635?u=36b5e32e1dd55f1ce77cad431a5683fce40a7934&v=4" width="50"><a href="https://github.com/rmetrich">rmetrich</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1383758409">2023-01-16 09:39</a>:<a class="headerlink" href="#rmetrich_commented_at_2023-01-16_0939" title="Permanent link">&para;</a></h4>
<blockquote>
<p>In the earlier times of the code all available network interfaces were
selected. My PR is reverting to this approach. See e.g.</p>
<p><a href="https://github.com/rear/rear/blob/38131ce55bede4a80fe75bbff416df32ca855945/usr/share/rear/rescue/GNU/Linux/310_network_devices.sh#L90">https://github.com/rear/rear/blob/38131ce55bede4a80fe75bbff416df32ca855945/usr/share/rear/rescue/GNU/Linux/310_network_devices.sh#L90</a></p>
<p>With the commit
<a href="https://github.com/rear/rear/commit/15567ede425401b008e5b1680db36a2c62752b8f">15567ed</a>
this changed.</p>
<p>Maybe @rmetrich can explain the intention behind introducing his
approach.</p>
</blockquote>
<p>Hello,<br />
the idea was to select only interfaces backed on physical device and
which would be useful when starting the recovery (i.e. to fetch the
backup).<br />
Everything not backed by a physical interface doesn't need to be
restored while in the rescue env.</p>
<h4 id="jsmeix_commented_at_2023-01-16_1043"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1383845823">2023-01-16 10:43</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-16_1043" title="Permanent link">&para;</a></h4>
<p>@rmetrich<br />
thank you for your explanation!</p>
<p>What @pcahyna reports in his above<br />
<a href="https://github.com/rear/rear/pull/2907#issuecomment-1381116451">https://github.com/rear/rear/pull/2907#issuecomment-1381116451</a><br />
is</p>
<pre><code>... two interfaces, one of them (eno2) is connected, but not configured.
</code></pre>
<p>I think this means the connected but not configured interface<br />
is "somehow linked to a physical device"<br />
but it has no IP when "rear mkrescue" is run.</p>
<p>I think any interface that is "somehow linked to a physical device"<br />
could be later useful to fetch the backup during "rear recover"<br />
(the admin would then have to assign an IP manually)<br />
regardless whether or not an interface was actually usable<br />
when making the backup during "rear mkbackup".</p>
<p>In particular for third party backup tools normally<br />
"rear mkbackup" is useless (because normally ReaR does<br />
not implement making a backup with third party backup tools)<br />
so only "rear mkrescue" is used for third party backup tools<br />
(also for BACKUP=REQUESTRESTORE)<br />
and then it is possible that an interface is not usable<br />
during "rear mkrescue" time but that interface could be used<br />
when the backup is made with a third party backup tool.<br />
Of course this example is rather theoretical (I don't assume<br />
admins disable special interfaces that are only used for<br />
special things like making a backup with some backup tool)<br />
but this is only an offhanded example for my actual point<br />
which is:</p>
<p>I wonder if ReaR should automatically exclude something<br />
when there is no hard reason to exclude it?</p>
<p>I think something should be automatically excluded only when<br />
including it would cause problems in the ReaR recovery system.<br />
E.g. when things fail in the recovery system if it was inculded<br />
or possible security/privacy issues if secrets were included.</p>
<p>I am not a sufficient networking expert to make a decision<br />
if it could cause problems in the ReaR recovery system<br />
when interfaces are included that are linked to a physical device<br />
but have no IP.</p>
<h4 id="jsmeix_commented_at_2023-01-16_1124"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1383900911">2023-01-16 11:24</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-16_1124" title="Permanent link">&para;</a></h4>
<p>Via<br />
<a href="https://github.com/rear/rear/commit/2cf67aed8a1ae7e6709d29e13a225d098b25c370">https://github.com/rear/rear/commit/2cf67aed8a1ae7e6709d29e13a225d098b25c370</a><br />
I added a comment that also appears in network_devices_setup_script<br />
that shows the idea behind which interfaces are currently selected<br />
according to<br />
<a href="https://github.com/rear/rear/pull/2907#issuecomment-1383758409">https://github.com/rear/rear/pull/2907#issuecomment-1383758409</a></p>
<p>This is only to show how the current code (without this change here)<br />
is meant to work.<br />
Of course that comment (and likely some other comments)<br />
change when we decide here to include more interfaces.</p>
<h4 id="hpannenb_commented_at_2023-01-16_1137"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1383917196">2023-01-16 11:37</a>:<a class="headerlink" href="#hpannenb_commented_at_2023-01-16_1137" title="Permanent link">&para;</a></h4>
<blockquote>
<p>Everything not backed by a physical interface doesn't need to be
restored while in the rescue env.</p>
</blockquote>
<p>@rmetrich Thanks for the insights. Indeed this is how this mechanism
works (well documented by You in the code). The interesting question to
me is what YOur intentions was to change the network interface selection
mechanism from previous approach to "select IPv4 with routing NICs
only". BTW, so far this seems to have worked flawlessly.</p>
<h4 id="rmetrich_commented_at_2023-01-16_1149"><img src="https://avatars.githubusercontent.com/u/1163635?u=36b5e32e1dd55f1ce77cad431a5683fce40a7934&v=4" width="50"><a href="https://github.com/rmetrich">rmetrich</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1383933845">2023-01-16 11:49</a>:<a class="headerlink" href="#rmetrich_commented_at_2023-01-16_1149" title="Permanent link">&para;</a></h4>
<blockquote>
<blockquote>
<p>Everything not backed by a physical interface doesn't need to be
restored while in the rescue env.</p>
</blockquote>
<p>@rmetrich Thanks for the insights. Indeed this is how this mechanism
works (well documented by You in the code). The interesting question
to me is what YOur intentions was to change the network interface
selection mechanism from previous approach to "select IPv4 with
routing NICs only". BTW, so far this seems to have worked flawlessly.</p>
</blockquote>
<p>Honestly I cannot remember. Probably I never got a pure IPv6 system and
never saw any Red Hat customer have such, so in the end restoring the
network for IPv4 only was sufficient.</p>
<h4 id="hpannenb_commented_at_2023-01-16_1204"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1383951665">2023-01-16 12:04</a>:<a class="headerlink" href="#hpannenb_commented_at_2023-01-16_1204" title="Permanent link">&para;</a></h4>
<blockquote>
<p>I am not a sufficient networking expert to make a decision<br />
if it could cause problems in the ReaR recovery system<br />
when interfaces are included that are linked to a physical device<br />
but have no IP.</p>
</blockquote>
<p>@jsmeix Likewise. But it seems this has never been (reported as) an
issue until now with either the old or the new approach of collecting
the network interfaces.</p>
<h4 id="hpannenb_commented_at_2023-01-16_1209"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1383959691">2023-01-16 12:09</a>:<a class="headerlink" href="#hpannenb_commented_at_2023-01-16_1209" title="Permanent link">&para;</a></h4>
<blockquote>
<p>Honestly I cannot remember.</p>
</blockquote>
<p>Sure. I just raised the questions because it could have been a special
decision by You to do so.</p>
<blockquote>
<p>Probably I never got a pure IPv6 system and never saw any Red Hat
customer have such, so in the end restoring the network for IPv4 only
was sufficient.</p>
</blockquote>
<p>The system I am dealing with is a hybrid: E.g. the management interface
is IPv4 only whereas the connection to the backup service is via IPv6
only.</p>
<h4 id="hpannenb_commented_at_2023-01-16_1240"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1384000015">2023-01-16 12:40</a>:<a class="headerlink" href="#hpannenb_commented_at_2023-01-16_1240" title="Permanent link">&para;</a></h4>
<blockquote>
<p>I wonder if ReaR should automatically exclude something when there is
no hard reason to exclude it?</p>
<p>I think something should be automatically excluded only when including
it would cause problems in the ReaR recovery system. E.g. when things
fail in the recovery system if it was inculded or possible
security/privacy issues if secrets were included.</p>
</blockquote>
<p>@jsmeix Under point 4 in my
<a href="https://github.com/rear/rear/issues/2902#issuecomment-1369567575">https://github.com/rear/rear/issues/2902#issuecomment-1369567575</a>
I mentioned it is possible to exclude NICs with
<code>EXCLUDE_NETWORK_INTERFACES =()</code> already in case they should be excluded
from the rescue environment. So user has the power to do something in
case it is harming on the NIC side.</p>
<p>BTW, from purely looking at the code this approach should have made the
test passed of @pcahyna putting the <code>eno2</code> onto this list. Obviously the
comment section of the algorithm needs a slight update then.</p>
<h4 id="hpannenb_commented_at_2023-01-28_0856"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1407344227">2023-01-28 08:56</a>:<a class="headerlink" href="#hpannenb_commented_at_2023-01-28_0856" title="Permanent link">&para;</a></h4>
<p>I adjusted the comments in my PR to align it with my code change.</p>
<p>Since this change is working as such (as already shown with earlier ReaR
versions) my opinion is my PR is a lightweight change to support IPv4
<em>and</em> IPv6 NICs in the rescue environment.</p>
<p>@jsmeix @rmetrich @rear/contributors : Please leave Your comments.</p>
<h4 id="hpannenb_commented_at_2023-02-19_0944"><img src="https://avatars.githubusercontent.com/u/13567759?u=b037e492e58a5f63f35277b3606d500cd622c8ed&v=4" width="50"><a href="https://github.com/hpannenb">hpannenb</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1435940689">2023-02-19 09:44</a>:<a class="headerlink" href="#hpannenb_commented_at_2023-02-19_0944" title="Permanent link">&para;</a></h4>
<p>It is a great piece of code @rmetrich provided since it covers almost
any situation in different NIC setups already. I just changed a single
line of code to include IPv6 only NICs again.</p>
<p>@schlomo @jsmeix Appreciate both Your approvals on this; waiting for
@pcahyna about his view/thoughts on my change.</p>
<h4 id="schlomo_commented_at_2023-03-01_0948"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1449724320">2023-03-01 09:48</a>:<a class="headerlink" href="#schlomo_commented_at_2023-03-01_0948" title="Permanent link">&para;</a></h4>
<p>@pcahyna any comments from you or can we merge this?</p>
<h4 id="jsmeix_commented_at_2023-03-23_1040"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2907#issuecomment-1480958283">2023-03-23 10:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-23_1040" title="Permanent link">&para;</a></h4>
<p>@rear/contributors<br />
I would like to be bold here<br />
and merge it next Monday (27. March) afternoon<br />
unless there are objections.</p>
<p>@pcahyna<br />
I think because we are in ReaR 2.8 development phase<br />
it is OK to "just merge" something like this one because<br />
it does not look as if instantly hell broke loose<br />
because of this changes (at least it "just works"<br />
for @hpannenb so it cannot be wrong in any case)<br />
and whether or not it is wrong in some cases<br />
we learn best how it actually goes wrong<br />
when various interested users who use our<br />
current GitHub master code try it out<br />
in their individual networking environments.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2023-01-08.2907.pr.merged.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
