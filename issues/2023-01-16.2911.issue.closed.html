<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>2023 01 16.2911.issue.closed - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "2023 01 16.2911.issue.closed";
        var mkdocs_page_input_path = "issues/2023-01-16.2911.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', '366986045', 'auto');
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>2023 01 16.2911.issue.closed</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2911_issue_closed_backup_prog_compress_options_makes_tar_-c_mntlocal_untar_in_pwd_ie_in_root"><a href="https://github.com/rear/rear/issues/2911">#2911 Issue</a> <code>closed</code>: BACKUP_PROG_COMPRESS_OPTIONS="" makes 'tar ... -C /mnt/local/' untar in $(pwd) i.e. in /root<a class="headerlink" href="#2911_issue_closed_backup_prog_compress_options_makes_tar_-c_mntlocal_untar_in_pwd_ie_in_root" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code>,
<code>not ReaR / invalid</code></p>
<h4 id="scprsync_opened_issue_at_2023-01-16_1905"><img src="https://avatars.githubusercontent.com/u/122825842?v=4" width="50"><a href="https://github.com/scprsync">scprsync</a> opened issue at <a href="https://github.com/rear/rear/issues/2911">2023-01-16 19:05</a>:<a class="headerlink" href="#scprsync_opened_issue_at_2023-01-16_1905" title="Permanent link">&para;</a></h4>
<p>setting<br />
BACKUP_PROG_COMPRESS_OPTIONS=""<br />
BACKUP_PROG_COMPRESS_SUFFIX=""</p>
<p>makes a nice tar file in the backup, but fails to restore the files. i
think its still trying to do a tar xzf which fails because it's not
gzipped.</p>
<p>what option can i set to make it untar on recovery ?<br />
thank you</p>
<p>~chris</p>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"):</p>
</li>
<li>
<p>OS version ("cat /etc/os-release" or "lsb_release -a" or "cat
    /etc/rear/os.conf"):</p>
</li>
<li>
<p>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):</p>
</li>
<li>
<p>Hardware vendor/product (PC or PowerNV BareMetal or ARM) or VM (KVM
    guest or PowerVM LPAR):</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device):</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot):</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe):</p>
</li>
<li>
<p>Storage layout ("lsblk -ipo
    NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,LABEL,SIZE,MOUNTPOINT"):</p>
</li>
<li>
<p>Description of the issue (ideally so that others can reproduce it):</p>
</li>
<li>
<p>Workaround, if any:</p>
</li>
<li>
<p>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files):</p>
</li>
</ul>
<p>To paste verbatim text like command output or file content,<br />
include it between a leading and a closing line of three backticks like</p>
<pre><code>```
verbatim content
```
</code></pre>
<h4 id="jsmeix_commented_at_2023-01-17_1236"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1385361020">2023-01-17 12:36</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-17_1236" title="Permanent link">&para;</a></h4>
<p>@scprsync<br />
how does it fail for you?</p>
<h4 id="scprsync_commented_at_2023-01-17_1354"><img src="https://avatars.githubusercontent.com/u/122825842?v=4" width="50"><a href="https://github.com/scprsync">scprsync</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1385459060">2023-01-17 13:54</a>:<a class="headerlink" href="#scprsync_commented_at_2023-01-17_1354" title="Permanent link">&para;</a></h4>
<p>Using NETFS and ISO mode, storing on a Truenas ZFS NFS server.</p>
<p>When restoring a machine, with gzip disabled,<br />
the file download and install doesn’t restore any files.</p>
<p>It tried to do an nfs mount and untar the backup.tar file<br />
but it doesn’t extract any files</p>
<p>/mnt/local has directories, but no files… so of course<br />
the rest of the restoration fails</p>
<p>When allowing gzip it all works, creation, restoration…</p>
<p>When removing the gzip, it makes backup.tar , but then<br />
when restoring it doesn’t untar the files. It actually<br />
shows them being downloaded, just doesn’t untar them</p>
<p>i was guessing that REaR was still trying to tar xzf<br />
which would fail/error out because its not gzipped.</p>
<p>~chris</p>
<p>a different solution i tried was using pigz on creation.<br />
worked well,<br />
much faster to create a backup like 10x-15x depending on processors.<br />
But restoration fails.<br />
I'm guessing because it saves pigz as the restoration command<br />
and its not in the initrd.<br />
If it just used gzip to decompress, it would have worked,<br />
they are compatible.</p>
<h4 id="jsmeix_commented_at_2023-01-17_1447"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1385540002">2023-01-17 14:47</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-17_1447" title="Permanent link">&para;</a></h4>
<p>For me it seems to "just work":</p>
<pre><code>RESCUE localhost:~ # rear -D recover
Relax-and-Recover 2.7 / Git
...
Disk layout created.
Running 'restore' stage ======================
Restoring from '/var/tmp/rear.H1FRjykwUNNKLmO/outputfs/localhost/backup.tar' (restore log in /var/lib/rear/restore/recover.backup.tar.725.restore.log) ...
Backup restore program 'tar' started in subshell (PID=4761)
Restored 519 MiB [avg. 106376 KiB/sec] 
Restored 1051 MiB [avg. 107675 KiB/sec] 
Restored 1512 MiB [avg. 103268 KiB/sec] 
...
</code></pre>
<h4 id="scprsync_commented_at_2023-01-17_1502"><img src="https://avatars.githubusercontent.com/u/122825842?v=4" width="50"><a href="https://github.com/scprsync">scprsync</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1385563456">2023-01-17 15:02</a>:<a class="headerlink" href="#scprsync_commented_at_2023-01-17_1502" title="Permanent link">&para;</a></h4>
<p>rear version 2.6, debian 11</p>
<p>its restoring in / instead of /mnt/local.<br />
watching recovery says</p>
<p>"creating filesystem of type ext4 with mount point / on
/dev/mapper/rootvg-rootlv" and then proceeds to untar in / instead of
/mnt/local and that of course breaks much of the rest of the script</p>
<p>i see that bind mount still works /mnt/local/sys /mnt/local/dev
/mnt/local/proc are there<br />
but /mnt/local/lib..var..home and the rest were untard in /</p>
<p>uploaded log, not sure why its untaring in /</p>
<p>we have a large number of machines, some of them with a good amount of
data. standardly with REaR, im getting 10-15MB/s creation rate, not
great. i found 2 ways to increase up to 100-150MB/s,</p>
<ol>
<li>not using gzip, breaks for me on restoration</li>
<li>using pigz, breaks for me on restoration</li>
</ol>
<h4 id="scprsync_commented_at_2023-01-17_1655"><img src="https://avatars.githubusercontent.com/u/122825842?v=4" width="50"><a href="https://github.com/scprsync">scprsync</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1385727678">2023-01-17 16:55</a>:<a class="headerlink" href="#scprsync_commented_at_2023-01-17_1655" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/rear/rear/files/10437505/rear-adcphltappserver46.log">rear-adcphltappserver46.log</a></p>
<h4 id="jsmeix_commented_at_2023-01-18_0738"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1386613819">2023-01-18 07:38</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-18_0738" title="Permanent link">&para;</a></h4>
<p>@scprsync<br />
I had a first look at your<br />
<a href="https://github.com/rear/rear/files/10437505/rear-adcphltappserver46.log">https://github.com/rear/rear/files/10437505/rear-adcphltappserver46.log</a><br />
and it shows (excerpts):</p>
<pre><code>+++ Print 'Creating filesystem of type ext4 with mount point / on /dev/mapper/rootvg-rootlv.'
+++ wipefs --all --force /dev/mapper/rootvg-rootlv
/dev/mapper/rootvg-rootlv: 2 bytes were erased at offset 0x00000438 (ext4): 53 ef
+++ mkfs -t ext4 -b 4096 -i 16255 -U 73e56cee-dc12-4209-ae25-c48aba05a423 -F /dev/mapper/rootvg-rootlv
...
+++ Print 'Mounting filesystem /'
+++ mkdir -p /mnt/local/
+++ mount -o rw,relatime,errors=remount-ro /dev/mapper/rootvg-rootlv /mnt/local/
+++ mount -o rw,relatime,errors=remount-ro,remount,user_xattr /dev/mapper/rootvg-rootlv /mnt/local/
</code></pre>
<p>so dev/mapper/rootvg-rootlv is mounted at /mnt/local/<br />
while "rear recover" is running.<br />
The 'Print' messages are meant from what it was on the original system<br />
(i.e. what was stored in disklayout.conf by "rear mkrescue/mkbackup")<br />
and what it will be finally on the recreated target system<br />
(i.e. after the reboot when "rear recover" had finished).</p>
<pre><code>2023-01-17 16:40:20.180005623 Restoring from '/tmp/rear.X9RyqxbJOSVg4Lo/outputfs/adcphltappserver46/backup.tar' (restore log in /var/lib/rear/restore/recover.backup.tar.815.restore.log) ...
2023-01-17 16:40:20.188737813 dd if=/tmp/rear.X9RyqxbJOSVg4Lo/outputfs/adcphltappserver46/backup.tar | tar --block-number --totals --verbose --anchored --xattrs --xattrs-include=security.capability --xattrs-include=security.selinux --acls  -C /mnt/local/ -x -f -
2023-01-17 16:40:20.189415958 Launched backup restore subshell (PID=1880)
2023-01-17 16:41:21.648781917 Backup restore 'tar' finished with zero exit code
2023-01-17 16:41:21.652773917 Restoring finished (verify backup restore log messages in /var/lib/rear/restore/recover.backup.tar.815.restore.log)
</code></pre>
<p>so <code>... | tar ... -C /mnt/local/ ...</code> should untar in /mnt/local/<br />
(at least this is what "man tar" tells what should happen<br />
as far as I understand what "man tar" tells).<br />
Did you "verify backup restore log messages in
/var/lib/rear/restore/recover.backup.tar.815.restore.log"?</p>
<h4 id="gdha_commented_at_2023-01-18_0814"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1386650388">2023-01-18 08:14</a>:<a class="headerlink" href="#gdha_commented_at_2023-01-18_0814" title="Permanent link">&para;</a></h4>
<p>@scprsync Could you paste the <code>/etc/rear/local.conf</code> please?</p>
<h4 id="jsmeix_commented_at_2023-01-18_1057"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1386862853">2023-01-18 10:57</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-18_1057" title="Permanent link">&para;</a></h4>
<p>@scprsync<br />
thank you for your description that "its untaring in /".</p>
<p>When I tried to reproduce it yesterday<br />
on a KVM/QEMU test VM with 2 GiB of RAM<br />
I had issues like this one which is from right now today:</p>
<pre><code>Restoring from '/var/tmp/rear.21UbIcsbfyqiwo3/outputfs/localhost/backup.tar' (restore log in /var/lib/rear/restore/recover.backup.tar.1497.restore.log) ...
Backup restore program 'tar' started in subshell (PID=5510)
Restored 241 MiB [avg. 49419 KiB/sec] 
Restored 519 MiB [avg. 53188 KiB/sec] 
Restored 754 MiB [avg. 51496 KiB/sec] 
Restored 975 MiB [avg. 49970 KiB/sec] 
Restored 1137 MiB [avg. 46598 KiB/sec] 
Restored 1404 MiB [avg. 47952 KiB/sec] 
Restored 1551 MiB [avg. 45406 KiB/sec] 
Killed
</code></pre>
<p>I noticed 'oom-killer' in the dmesg output like</p>
<pre><code>... tar invoked oom-killer ...
...
... Out of memory: Killed process ... (rear) ...
</code></pre>
<p>But I failed to see the reason why it runs out of memory.</p>
<p>Now I see it:<br />
It is because 'tar ... -C /mnt/local/' untars in $(pwd)<br />
i.e. in '/root' in the ReaR recovery system<br />
if 'tar' is called without '--gzip'<br />
like this:</p>
<pre><code>Welcome to Relax-and-Recover. Run "rear recover" to restore your system !

RESCUE localhost:~ # du -xhsc /
167M    /
167M    total

RESCUE localhost:~ # rear -D recover
...
Restoring from '/var/tmp/rear.21UbIcsbfyqiwo3/outputfs/localhost/backup.tar' (restore log in /var/lib/rear/restore/recover.backup.tar.1497.restore.log) ...
Backup restore program 'tar' started in subshell (PID=5510)
Restored 241 MiB [avg. 49419 KiB/sec] 
Restored 519 MiB [avg. 53188 KiB/sec] 
Restored 754 MiB [avg. 51496 KiB/sec] 
Restored 975 MiB [avg. 49970 KiB/sec] 
Restored 1137 MiB [avg. 46598 KiB/sec] 
Restored 1404 MiB [avg. 47952 KiB/sec] 
Restored 1551 MiB [avg. 45406 KiB/sec] 
Killed

RESCUE localhost:~ # ls -lhtr
total 0
drwxr-xr-x   3 root root 0 Jun 29  2021 srv
drwxr-xr-x   3 root root 0 Jun 29  2021 home
drwxr-xr-x   3 root root 0 Jun 29  2021 boot
drwxr-xr-x   3 root root 0 Aug  5  2021 opt
drwxr-xr-x   4 root root 0 Jan 17 12:21 rear.github.master
drwx------  14 root root 0 Jan 17 12:50 root
drwxrwxrwt   2 root root 0 Jan 17 12:50 tmp
drwx------  10 root root 0 Jan 18 11:35 var
drwx------ 101 root root 0 Jan 18 11:35 etc
drwxr-xr-x   4 root root 0 Jan 18 11:35 usr

RESCUE localhost:~ # du -xhsc /
1.8G    /
1.8G    total

RESCUE localhost:~ # du -xhsc /mnt/local
4.0K    /mnt/local
4.0K    total

RESCUE localhost:~ # pwd
/root
</code></pre>
<p>Because the ReaR recovery system runs in a ramdisk<br />
and my VM has only 2 GiB memory it runs out of memory.</p>
<h4 id="jsmeix_commented_at_2023-01-18_1106"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1386874687">2023-01-18 11:06</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-18_1106" title="Permanent link">&para;</a></h4>
<p>I have no idea why in the ReaR recovery system<br />
'tar ... -C /mnt/local/' untars in $(pwd) i.e. in '/root'<br />
when 'tar' is called without '--gzip'<br />
because on my homeoffice laptop it works:</p>
<pre><code>~&gt; mkdir /tmp/mydir1 /tmp/mydir2 /tmp/mydir3 /tmp/mydir4

~&gt; cd /tmp/mydir1

/tmp/mydir1&gt; echo Hello &gt;hello.txt

/tmp/mydir1&gt; tar -c -f hello.tar hello.txt

/tmp/mydir1&gt; tar -c --gzip -f hello.tar.gz hello.txt

/tmp/mydir1&gt; ls -l
total 20
-rw-r--r-- 1 johannes users 10240 Jan 18 12:02 hello.tar
-rw-r--r-- 1 johannes users   227 Jan 18 12:02 hello.tar.gz
-rw-r--r-- 1 johannes users     6 Jan 18 12:02 hello.txt

/tmp/mydir1&gt; cat hello.tar.gz | tar -v --gzip -C /tmp/mydir2 -x -f -
hello.txt

/tmp/mydir1&gt; ls -l /tmp/mydir2
total 4
-rw-r--r-- 1 johannes users 6 Jan 18 12:02 hello.txt

/tmp/mydir1&gt; cat hello.tar | tar -v -C /tmp/mydir3 -x -f -
hello.txt

/tmp/mydir1&gt; ls -l /tmp/mydir3
total 4
-rw-r--r-- 1 johannes users 6 Jan 18 12:02 hello.txt

/tmp/mydir1&gt; cat hello.tar | tar --block-number --totals --verbose --anchored --xattrs --xattrs-include=security.capability --xattrs-include=security.selinux --acls  -C /tmp/mydir4 -x -f -
block 3: hello.txt
block 4: ** Block of NULs **
Total bytes read: 10240 (10KiB, 20MiB/s)

/tmp/mydir1&gt; ls -l /tmp/mydir4
total 4
-rw-r--r-- 1 johannes users 6 Jan 18 12:02 hello.txt
</code></pre>
<h4 id="jsmeix_commented_at_2023-01-18_1115"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1386887279">2023-01-18 11:15</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-18_1115" title="Permanent link">&para;</a></h4>
<p>In my above ReaR recovery system the<br />
/var/lib/rear/restore/recover.backup.tar.1497.restore.log<br />
shows nothing that tells me (I am not a 'tar' expert) that<br />
'tar ... -C /mnt/local/' does not untar in /mnt/local/<br />
or even why it seems tar ignores '-C /mnt/local/':</p>
<pre><code>++ case "$BACKUP_PROG" in
++ '[' -s /var/tmp/rear.21UbIcsbfyqiwo3/tmp/restore-exclude-list.txt ']'
++ is_true false
++ case "$1" in
++ return 1
++ Log 'dd if=/var/tmp/rear.21UbIcsbfyqiwo3/outputfs/localhost/backup.tar bs=1M | tar --block-number --totals --verbose --anchored' --xattrs --xattrs-include=security.capability --xattrs-include=security.selinux '--acls  -C /mnt/local/ -x -f -'
++ test -w /var/log/rear/rear-localhost.log
++ echo '2023-01-18 11:34:58.792671397 dd if=/var/tmp/rear.21UbIcsbfyqiwo3/outputfs/localhost/backup.tar bs=1M | tar --block-number --totals --verbose --anchored --xattrs --xattrs-include=security.capability --xattrs-include=security.selinux --acls  -C /mnt/local/ -x -f -'
++ tar --block-number --totals --verbose --anchored --xattrs --xattrs-include=security.capability --xattrs-include=security.selinux --acls '' -C /mnt/local/ -x -f -
++ dd if=/var/tmp/rear.21UbIcsbfyqiwo3/outputfs/localhost/backup.tar bs=1M
block 3: boot/grub2/x86_64-efi/
block 6: boot/grub2/i386-pc/
tar: acl_set_file_at: Cannot set POSIX ACLs for file 'boot/grub2/x86_64-efi': Operation not supported
tar: acl_delete_def_file_at: Cannot drop default POSIX ACLs for file 'boot/grub2/x86_64-efi': Operation not supported
block 9: boot/grub2/i386-pc/load.cfg
...
block 3265634: usr/share/locale/vi/LC_TIME/coreutils.mo
block 3265637: usr/share/locale/wa/
block 3265640: usr/share/locale/wa/LC_MESSAGES/
block 3265643: usr/share/locale/wa/LC_MESSAGES/popt.mo
</code></pre>
<p>there it stops logging (because oom-killer killed it).</p>
<p>I had noticed those "POSIX ACLs" messages also yesterday<br />
but I did not see the reason (because it untars into a ramdisk).</p>
<p>I use tar (GNU tar) version 1.34 (on openSUSE Leap 15.4).</p>
<p>Of course the actual target filesystems are mounted<br />
below /mnt/local in my above ReaR recovery system:</p>
<pre><code>RESCUE localhost:~ # lsblk -ipo NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,LABEL,SIZE,MOUNTPOINT

NAME                        KNAME     PKNAME    TRAN TYPE FSTYPE      LABEL     SIZE MOUNTPOINT
/dev/sda                    /dev/sda            ata  disk                        20G 
|-/dev/sda1                 /dev/sda1 /dev/sda       part                         8M 
`-/dev/sda2                 /dev/sda2 /dev/sda       part LVM2_member            20G 
  |-/dev/mapper/system-swap /dev/dm-0 /dev/sda2      lvm  swap                    2G 
  |-/dev/mapper/system-home /dev/dm-1 /dev/sda2      lvm  xfs                   5.4G /mnt/local/home
  `-/dev/mapper/system-root /dev/dm-2 /dev/sda2      lvm  btrfs                12.6G /mnt/local
/dev/sr0                    /dev/sr0            ata  rom  iso9660     REAR-ISO 70.9M
</code></pre>
<p>And with '--gzip' it works as expected (of course):</p>
<pre><code>RESCUE localhost:~ # rear -D recover
...
Restoring from '/var/tmp/rear.xHEhrqXKQRUiUTZ/outputfs/localhost/backup.tar.gz' (restore log in /var/lib/rear/restore/recover.backup.tar.gz.710.restore.log) ...
Backup restore program 'tar' started in subshell (PID=4712)
Restored 241 MiB [avg. 49419 KiB/sec] 
Restored 335 MiB [avg. 34342 KiB/sec] 
...
Restored 3666 MiB [avg. 35418 KiB/sec] 
OK
Restored 3693 MiB in 111 seconds [avg. 34075 KiB/sec]
Restoring finished (verify backup restore log messages in /var/lib/rear/restore/recover.backup.tar.gz.710.restore.log)
</code></pre>
<p>and /var/lib/rear/restore/recover.backup.tar.gz.710.restore.log<br />
contains (excerpts):</p>
<pre><code>++ case "$BACKUP_PROG" in
++ '[' -s /var/tmp/rear.xHEhrqXKQRUiUTZ/tmp/restore-exclude-list.txt ']'
++ is_true false
++ case "$1" in
++ return 1
++ Log 'dd if=/var/tmp/rear.xHEhrqXKQRUiUTZ/outputfs/localhost/backup.tar.gz bs=1M | tar --block-number --totals --verbose --anchored' --xattrs --xattrs-include=security.capability --xattrs-include=security.selinux '--acls --gzip -C /mnt/local/ -x -f -'
++ test -w /var/log/rear/rear-localhost.log
++ echo '2023-01-18 12:31:07.722522270 dd if=/var/tmp/rear.xHEhrqXKQRUiUTZ/outputfs/localhost/backup.tar.gz bs=1M | tar --block-number --totals --verbose --anchored --xattrs --xattrs-include=security.capability --xattrs-include=security.selinux --acls --gzip -C /mnt/local/ -x -f -'
++ tar --block-number --totals --verbose --anchored --xattrs --xattrs-include=security.capability --xattrs-include=security.selinux --acls --gzip -C /mnt/local/ -x -f -
++ dd if=/var/tmp/rear.xHEhrqXKQRUiUTZ/outputfs/localhost/backup.tar.gz bs=1M
block 3: boot/grub2/x86_64-efi/
block 6: boot/grub2/i386-pc/
block 9: boot/grub2/i386-pc/load.cfg
...
block 7560869: sbin/dhclient
1790+1 records in
1790+1 records out
1877849577 bytes (1.9 GB, 1.7 GiB) copied, 107.868 s, 17.4 MB/s
block 7564757: sbin/dhclient-script
block 7564807: sbin/dhclient6
block 7564810: selinux/
block 7564813: root/rear.github.master/var/log/rear/rear-localhost.log
Total bytes read: 3873187840 (3.7GiB, 35MiB/s)
block 7564813: ** Block of NULs **
</code></pre>
<h4 id="jsmeix_commented_at_2023-01-18_1253"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1387019641">2023-01-18 12:53</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-18_1253" title="Permanent link">&para;</a></h4>
<p>For me 'tar ... -C /mnt/local/' without --gzip<br />
works manually in the ReaR recovery system.<br />
I used the enforced MIGRATION_MODE<br />
so that I can halt "rear recover"<br />
before the backup is restored<br />
at this user dialog</p>
<pre><code>UserInput -I LAYOUT_MIGRATED_CONFIRMATION needed in /usr/share/rear/layout/recreate/default/200_run_layout_code.sh line 168
Confirm the recreated disk layout or go back one step
1) Confirm recreated disk layout and continue 'rear recover'
2) Go back one step to redo disk layout recreation
3) Use Relax-and-Recover shell and return back to here
4) Abort 'rear recover'
(default '1' timeout 300 seconds)
3
UserInput: Valid choice number result 'Use Relax-and-Recover shell and return back to here'

Welcome to Relax-and-Recover.

rear&gt;
</code></pre>
<p>In the "Relax-and-Recover shell" I did the following test:</p>
<pre><code>rear&gt; pwd
/var/lib/rear

rear&gt; ls -l
total 0
drwxr-xr-x 6 root root 0 Jan 18 13:33 layout
drwxr-xr-x 2 root root 0 Jan 17 10:39 output
drwxr-xr-x 2 root root 0 Jan 17 10:38 recovery
drwxr-xr-x 2 root root 0 Jan 17 10:39 sysreqs

rear&gt; echo Hello &gt;hello.txt

rear&gt; tar -c -f hello.tar hello.txt

rear&gt; tar -c --gzip -f hello.tar.gz hello.txt

rear&gt; ls -l hello.*
-rw-r--r-- 1 root root 10240 Jan 18 13:43 hello.tar
-rw-r--r-- 1 root root   210 Jan 18 13:43 hello.tar.gz
-rw-r--r-- 1 root root     6 Jan 18 13:43 hello.txt

rear&gt; cat hello.tar.gz | tar -v --gzip -C /mnt/local -x -f -
hello.txt

rear&gt; ls -l /mnt/local/hello.*
-rw-r--r-- 1 root root 6 Jan 18 13:43 /mnt/local/hello.txt

rear&gt; rm /mnt/local/hello.txt

rear&gt; cat hello.tar | tar -v -C /mnt/local -x -f -
hello.txt

rear&gt; ls -l /mnt/local/hello.*
-rw-r--r-- 1 root root 6 Jan 18 13:43 /mnt/local/hello.txt

rear&gt; rm /mnt/local/hello.txt

rear&gt; cat hello.tar | tar --block-number --totals --verbose --anchored --xattrs --xattrs-include=security.capability --xattrs-include=security.sel
inux --acls  -C /mnt/local -x -f -
block 3: hello.txt
block 4: ** Block of NULs **
Total bytes read: 10240 (10KiB, 10MiB/s)

rear&gt; ls -l /mnt/local/hello.*
-rw-r--r-- 1 root root 6 Jan 18 13:43 /mnt/local/hello.txt

rear&gt; rm /mnt/local/hello.txt

rear&gt; exit
Are you sure you want to exit the Relax-and-Recover shell ? y
exit
</code></pre>
<p>Leaving the "Relax-and-Recover shell"<br />
makes "rear recover" continue with this:</p>
<pre><code>...
Restoring from '/var/tmp/rear.x5KbBEeRTtGGXGS/outputfs/localhost/backup.tar' (restore log in /var/lib/rear/restore/recover.backup.tar.715.restore.log) ...
Backup restore program 'tar' started in subshell (PID=5291)
Restored 591 MiB [avg. 121069 KiB/sec] 
Restored 890 MiB [avg. 91230 KiB/sec] 
Restored 1199 MiB [avg. 81891 KiB/sec] 
Killed
</code></pre>
<p>Currently I have no idea what is going on here...</p>
<h4 id="jsmeix_commented_at_2023-01-18_1306"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1387044923">2023-01-18 13:06</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-18_1306" title="Permanent link">&para;</a></h4>
<p>... I found something:</p>
<p>When I change in<br />
/usr/share/rear/restore/NETFS/default/400_restore_backup.sh<br />
the actual restore command line from</p>
<pre><code>    (   case "$BACKUP_PROG" in
            (tar)
...
                if is_true "$BACKUP_PROG_CRYPT_ENABLED" ; then 
...
                else
...
                    dd if=$restore_input bs=1M | $BACKUP_PROG --block-number --totals --verbose "${BACKUP_PROG_OPTIONS[@]}" "${BACKUP_PROG_COMPRESS_OPTIONS[@]}" -C $TARGET_FS_ROOT/ -x -f -
                fi
</code></pre>
<p>to</p>
<pre><code>                    dd if=$restore_input bs=1M | $BACKUP_PROG --block-number --totals --verbose "${BACKUP_PROG_OPTIONS[@]}" -C $TARGET_FS_ROOT/ -x -
f -
</code></pre>
<p>i.e. when I remove <code>"${BACKUP_PROG_COMPRESS_OPTIONS[@]}"</code><br />
then it works for me.</p>
<h4 id="jsmeix_commented_at_2023-01-18_1315"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1387056556">2023-01-18 13:15</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-18_1315" title="Permanent link">&para;</a></h4>
<p>Argh!</p>
<p>It "just works" (without code modifications) with</p>
<pre><code>BACKUP_PROG_COMPRESS_OPTIONS=()
BACKUP_PROG_COMPRESS_SUFFIX=""
</code></pre>
<p>cf. the BACKUP_PROG_COMPRESS_OPTIONS definition in default.conf<br />
<a href="https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L1282">https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L1282</a></p>
<pre><code># BACKUP_PROG_COMPRESS_OPTIONS is an array ...
...
BACKUP_PROG_COMPRESS_OPTIONS=( --gzip )
</code></pre>
<p>FYI:</p>
<p>How an array that is set to the empty string<br />
(actually when its only/first element is set to an empty string)<br />
evaluates versus how it evaluates when it is set to an empty array:</p>
<pre><code># arr=( --foo )

# arr=""

# ( set -x ; echo --this "${arr[@]}" --that )
+ echo --this '' --that
--this  --that

# arr=()

# ( set -x ; echo --this "${arr[@]}" --that )
+ echo --this --that
--this --that
</code></pre>
<p>Note the one more space character in the first echo output<br />
so on first glance it may look same but there is a difference,<br />
cf. "Beware of the emptiness" in<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a></p>
<p>How tar behaves with an additional empty argument:</p>
<pre><code>~&gt; ls -l /tmp/mydir*

/tmp/mydir1:
total 20
-rw-r--r-- 1 johannes users 10240 Jan 18 12:02 hello.tar
-rw-r--r-- 1 johannes users   227 Jan 18 12:02 hello.tar.gz
-rw-r--r-- 1 johannes users     6 Jan 18 12:02 hello.txt

/tmp/mydir2:
total 0

/tmp/mydir3:
total 0

~&gt; cd /tmp/mydir2

/tmp/mydir2&gt; cat /tmp/mydir1/hello.tar | tar -v '' -C /tmp/mydir3 -x -f -
hello.txt

/tmp/mydir2&gt; ls -l /tmp/mydir*

/tmp/mydir1:
total 20
-rw-r--r-- 1 johannes users 10240 Jan 18 12:02 hello.tar
-rw-r--r-- 1 johannes users   227 Jan 18 12:02 hello.tar.gz
-rw-r--r-- 1 johannes users     6 Jan 18 12:02 hello.txt

/tmp/mydir2:
total 4
-rw-r--r-- 1 johannes users 6 Jan 18 12:02 hello.txt

/tmp/mydir3:
total 0
</code></pre>
<p>That empty arguments make such a crucial difference<br />
for tar and that tar reports nothing that it does<br />
not do what is requested by a '-C ...' argument<br />
loks like a bug in tar.</p>
<p>But that possible issue in tar is not something<br />
we at ReaR upstream will try to work around<br />
(except there is a generic, simple, fail-safe solution).</p>
<p>From my point of view it is in any case a bug<br />
when a program silently(!) ignores what is<br />
requested by its user (in particular when<br />
the program is run in verbose mode).</p>
<h4 id="scprsync_commented_at_2023-01-18_1423"><img src="https://avatars.githubusercontent.com/u/122825842?v=4" width="50"><a href="https://github.com/scprsync">scprsync</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1387156844">2023-01-18 14:23</a>:<a class="headerlink" href="#scprsync_commented_at_2023-01-18_1423" title="Permanent link">&para;</a></h4>
<p>My version is slightly different (bs=1M isn’t in it),<br />
but I dropped the BACKUP_PROGRAM_OPTIONS and it now works</p>
<p>So</p>
<ol>
<li></li>
</ol>
<p>Thank you</p>
<ol>
<li></li>
</ol>
<p>Does this break anything for others?<br />
Can we get this change into the Debian 11 repository<br />
so that I don’t have to track it on 400 computers<br />
and can just install from repo?</p>
<p>And again, thank you.<br />
It’s a nice product.<br />
One that we used to do ourselves locally,<br />
but your is more robust and I like it.<br />
Honestly, more people should know about it.</p>
<p>~chris</p>
<h4 id="scprsync_commented_at_2023-01-18_1436"><img src="https://avatars.githubusercontent.com/u/122825842?v=4" width="50"><a href="https://github.com/scprsync">scprsync</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1387176105">2023-01-18 14:36</a>:<a class="headerlink" href="#scprsync_commented_at_2023-01-18_1436" title="Permanent link">&para;</a></h4>
<p>Correction,<br />
I dropped the BACKUP_PROG_COMPRESS_OPTIONS and it works</p>
<h4 id="jsmeix_commented_at_2023-01-19_0741"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1396557464">2023-01-19 07:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-19_0741" title="Permanent link">&para;</a></h4>
<p>@scprsync<br />
it seems you missed my last entry here<br />
<a href="https://github.com/rear/rear/issues/2911#issuecomment-1387056556">https://github.com/rear/rear/issues/2911#issuecomment-1387056556</a></p>
<p>It reads in particular</p>
<pre><code>It "just works" (without code modifications) with

BACKUP_PROG_COMPRESS_OPTIONS=()
BACKUP_PROG_COMPRESS_SUFFIX=""
</code></pre>
<p>So use</p>
<pre><code>BACKUP_PROG_COMPRESS_OPTIONS=()
</code></pre>
<p>to set it to an actually empty array<br />
instead of</p>
<pre><code>BACKUP_PROG_COMPRESS_OPTIONS=""
</code></pre>
<p>which sets the first array element to be an empty string</p>
<pre><code># arr=( one two )

# declare -p arr
declare -a arr=([0]="one" [1]="two")

# arr=""

# declare -p arr
declare -a arr=([0]="" [1]="two")

# arr=()

# declare -p arr
declare -a arr=()
</code></pre>
<p>and I assume then things will "just work" also for you<br />
(without code modifications).</p>
<p>For more information and some details behind how tar behaves<br />
in this particular case see my complete last entry<br />
<a href="https://github.com/rear/rear/issues/2911#issuecomment-1387056556">https://github.com/rear/rear/issues/2911#issuecomment-1387056556</a></p>
<h4 id="jsmeix_commented_at_2023-01-19_0754"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1396568822">2023-01-19 07:54</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-19_0754" title="Permanent link">&para;</a></h4>
<p>A side note regarding the current (since ReaR 2.7)</p>
<pre><code>dd if=$restore_input bs=1M | ...
</code></pre>
<p>versus the before (up to ReaR 2.6)</p>
<pre><code>dd if=$restore_input | ...
</code></pre>
<p>in usr/share/rear/restore/NETFS/default/400_restore_backup.sh<br />
see
<a href="https://github.com/rear/rear/issues/2369">https://github.com/rear/rear/issues/2369</a><br />
and
<a href="https://github.com/rear/rear/issues/2458">https://github.com/rear/rear/issues/2458</a><br />
where the former reads in particular (excerpts)</p>
<pre><code>... the speed was 500KiB/s ... on a 100MBit line ...
...
After adding bs=1M to the dd command
the speed was now really fast in comparison:
it used the full capacity of the line (about 100MBit/s).
</code></pre>
<h4 id="scprsync_commented_at_2023-01-19_1502"><img src="https://avatars.githubusercontent.com/u/122825842?v=4" width="50"><a href="https://github.com/scprsync">scprsync</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1397113105">2023-01-19 15:02</a>:<a class="headerlink" href="#scprsync_commented_at_2023-01-19_1502" title="Permanent link">&para;</a></h4>
<p>I understand.</p>
<p>I added the bs=1M option.<br />
Restoration went from ~85MB/s -&gt; 220MB/s, significant improvement.</p>
<p>How large does /tmp need to be with a NETFS option?</p>
<p>Anyway, great tool, thank you a ton for your effort.</p>
<p>~chris</p>
<h4 id="jsmeix_commented_at_2023-01-20_1301"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2911#issuecomment-1398346148">2023-01-20 13:01</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-01-20_1301" title="Permanent link">&para;</a></h4>
<p>FYI:</p>
<p>Simple reproducers for the inexplicable behaviour<br />
when 'tar' gets an additional empty argument<br />
(I use GNU tar 1.34 on openSUSE Leap 15.4):</p>
<pre><code>$ tar -v -x '' -C /targetdir -f archive.tar
</code></pre>
<p>and</p>
<pre><code>$ tar -v '' -x -C /targetdir -f archive.tar
</code></pre>
<p>untar into the current working directory<br />
while</p>
<pre><code>$ tar -v -x -C /targetdir '' -f archive.tar
</code></pre>
<p>and</p>
<pre><code>$ tar '' -v -x -C /targetdir -f archive.tar
</code></pre>
<p>untar into /targetdir</p>
<p>I guess this might be related to the "Old Option Style"<br />
that is described in<br />
<a href="https://www.gnu.org/software/tar/manual/tar.html#Old-Options">https://www.gnu.org/software/tar/manual/tar.html#Old-Options</a></p>
<p>But I fail to see how the additional empty argument<br />
interferes with the -C option and its value.</p>
<p>I asked a colleague and here his reply:</p>
<pre><code>Suppose you have a tar archive ar.tar
that contains two directories: A and B.
So it might have:
  A/foo
  A/bar
  A/baz
  B/this
  B/that
  B/the_other

If you run

 tar -x -f ar.tar -C /tmp A -C /var/tmp B

Then tar would chdir to /tmp, extract the "A" directory,
then chdir to /var/tmp and extract the B directory.

If you don't have the first "-C /tmp",
then "A" would be extracted into the current directory.

If you have the name "" rather than "A" or "B",
then tar would extract the entire archive
(everything starting with "").

With this understanding, your observations make perfect sense.
</code></pre>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2022 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2023-01-16.2911.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
