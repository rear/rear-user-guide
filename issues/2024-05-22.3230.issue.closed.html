<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#3230 Issue closed: ReaR confuses Device Mapper Multipathing (DM) devices with Non-volatile Memory Express™ (NVMe™) multipathing devices. - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#3230 Issue closed: ReaR confuses Device Mapper Multipathing (DM) devices with Non-volatile Memory Express\u2122 (NVMe\u2122) multipathing devices.";
        var mkdocs_page_input_path = "issues/2024-05-22.3230.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#3230 Issue closed: ReaR confuses Device Mapper Multipathing (DM) devices with Non-volatile Memory Express™ (NVMe™) multipathing devices.</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="3230_issue_closed_rear_confuses_device_mapper_multipathing_dm_devices_with_non-volatile_memory_expresstm_nvmetm_multipathing_devices"><a href="https://github.com/rear/rear/issues/3230">#3230 Issue</a> <code>closed</code>: ReaR confuses Device Mapper Multipathing (DM) devices with Non-volatile Memory Express™ (NVMe™) multipathing devices.<a class="headerlink" href="#3230_issue_closed_rear_confuses_device_mapper_multipathing_dm_devices_with_non-volatile_memory_expresstm_nvmetm_multipathing_devices" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="stefanfrommunich_opened_issue_at_2024-05-22_0822"><img src="https://avatars.githubusercontent.com/u/158028301?v=4" width="50"><a href="https://github.com/StefanFromMunich">StefanFromMunich</a> opened issue at <a href="https://github.com/rear/rear/issues/3230">2024-05-22 08:22</a>:<a class="headerlink" href="#stefanfrommunich_opened_issue_at_2024-05-22_0822" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"):<br />
    Relax-and-Recover 2.6 / 2020-06-17</p>
</li>
<li>
<p>OS version ("cat /etc/os-release" or "lsb_release -a" or "cat
    /etc/rear/os.conf"):</p>
</li>
</ul>
<!-- -->

<pre><code>NAME="Oracle Linux Server"
VERSION="8.5"
ID="ol"
ID_LIKE="fedora"
VARIANT="Server"
VARIANT_ID="server"
VERSION_ID="8.5"
PLATFORM_ID="platform:el8"
PRETTY_NAME="Oracle Linux Server 8.5"
ANSI_COLOR="0;31"
CPE_NAME="cpe:/o:oracle:linux:8:5:server"
HOME_URL="https://linux.oracle.com/"
BUG_REPORT_URL="https://bugzilla.oracle.com/"

ORACLE_BUGZILLA_PRODUCT="Oracle Linux 8"
ORACLE_BUGZILLA_PRODUCT_VERSION=8.5
ORACLE_SUPPORT_PRODUCT="Oracle Linux"
ORACLE_SUPPORT_PRODUCT_VERSION=8.5
</code></pre>
<ul>
<li>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):</li>
</ul>
<!-- -->

<pre><code>OUTPUT=ISO
OUTPUT_URL=nfs://193.14.236.134/volume1/Rear
BACKUP=NETFS
BACKUP_URL=nfs://193.14.236.134/volume1/Rear
BACKUP_PROG_EXCLUDE=("${BACKUP_PROG_EXCLUDE[@]}" '/media' '/var/tmp' '/var/crash' '/u02' '/dev/nvme0n1'  '/dev/nvme1n1'  '/dev/nvme2n1'  '/dev/nvme3n1'  '/dev/nvme4n1'  '/dev/nvme5n1' )
NETFS_KEEP_OLD_BACKUP_COPY=
UEFI_BOOTLOADER=/boot/efi/EFI/redhat/grubx64.efi
SECURE_BOOT_BOOTLOADER=/boot/efi/EFI/redhat/shimx64.efi
EXCLUDE_MOUNTPOINTS=( '/u03/flashdata/ZVK_MUC' '/u02/oradata/ZVK_MUC' )
AUTOEXCLUDE_MULTIPATH=n
BOOT_OVER_SAN=y
AUTORESIZE_PARTITIONS=true
AUTOSHRINK_DISK_SIZE_LIMIT_PERCENTAGE=100
</code></pre>
<ul>
<li>
<p>Hardware vendor/product (PC or PowerNV BareMetal or ARM) or VM (KVM
    guest or PowerVM LPAR):<br />
    PC</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device):<br />
    x86</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot):<br />
    UEFI and bootloader GRUB</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe):<br />
    SSD (DM <strong>and</strong> NVMe)</p>
</li>
<li>
<p>Storage layout ("lsblk -ipo
    NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,LABEL,SIZE,MOUNTPOINT"):</p>
</li>
</ul>
<!-- -->

<pre><code>NAME                                      KNAME          PKNAME         TRAN   TYPE  FSTYPE          LABEL   SIZE MOUNTPOINT
/dev/sda                                  /dev/sda                      sata   disk  isw_raid_member       447,1G
|-/dev/sda1                               /dev/sda1      /dev/sda              part  vfat                    600M
|-/dev/sda2                               /dev/sda2      /dev/sda              part  xfs                       1G
|-/dev/sda3                               /dev/sda3      /dev/sda              part  LVM2_member             154G
|-/dev/sda4                               /dev/sda4      /dev/sda              part  LVM2_member           269,2G
`-/dev/md126                              /dev/md126     /dev/sda              raid1                       424,8G
  |-/dev/md126p1                          /dev/md126p1   /dev/md126            md    vfat                    600M /boot/efi
  |-/dev/md126p2                          /dev/md126p2   /dev/md126            md    xfs                       1G /boot
  |-/dev/md126p3                          /dev/md126p3   /dev/md126            md    LVM2_member             154G
  | |-/dev/mapper/ol-root                 /dev/dm-0      /dev/md126p3          lvm   xfs                      30G /
  | |-/dev/mapper/ol-swap                 /dev/dm-1      /dev/md126p3          lvm   swap                     24G [SWAP]
  | `-/dev/mapper/ol-u01                  /dev/dm-11     /dev/md126p3          lvm   xfs                     100G /u01
  `-/dev/md126p4                          /dev/md126p4   /dev/md126            md    LVM2_member           269,2G
/dev/sdb                                  /dev/sdb                      sata   disk  isw_raid_member       447,1G
|-/dev/sdb1                               /dev/sdb1      /dev/sdb              part  vfat                    600M
|-/dev/sdb2                               /dev/sdb2      /dev/sdb              part  xfs                       1G
|-/dev/sdb3                               /dev/sdb3      /dev/sdb              part  LVM2_member             154G
|-/dev/sdb4                               /dev/sdb4      /dev/sdb              part  LVM2_member           269,2G
`-/dev/md126                              /dev/md126     /dev/sdb              raid1                       424,8G
  |-/dev/md126p1                          /dev/md126p1   /dev/md126            md    vfat                    600M /boot/efi
  |-/dev/md126p2                          /dev/md126p2   /dev/md126            md    xfs                       1G /boot
  |-/dev/md126p3                          /dev/md126p3   /dev/md126            md    LVM2_member             154G
  | |-/dev/mapper/ol-root                 /dev/dm-0      /dev/md126p3          lvm   xfs                      30G /
  | |-/dev/mapper/ol-swap                 /dev/dm-1      /dev/md126p3          lvm   swap                     24G [SWAP]
  | `-/dev/mapper/ol-u01                  /dev/dm-11     /dev/md126p3          lvm   xfs                     100G /u01
  `-/dev/md126p4                          /dev/md126p4   /dev/md126            md    LVM2_member           269,2G
/dev/nvme0n1                              /dev/nvme0n1                  nvme   disk                          5,8T
`-/dev/nvme0n1p1                          /dev/nvme0n1p1 /dev/nvme0n1   nvme   part  LVM2_member             5,8T
  |-/dev/mapper/vg_oracle-u02_zvk_muc     /dev/dm-2      /dev/nvme0n1p1        lvm   ext4                    2,5T /u02/oradata/ZVK_MUC
  |-/dev/mapper/vg_oracle-u02_zvk_da      /dev/dm-3      /dev/nvme0n1p1        lvm   ext4                   1000G /u02/oradata/ZVK_DA
  |-/dev/mapper/vg_oracle-u02_bsv         /dev/dm-4      /dev/nvme0n1p1        lvm   ext4                   1000G /u02/oradata/BSV
  |-/dev/mapper/vg_oracle-u02_kvv         /dev/dm-5      /dev/nvme0n1p1        lvm   ext4                    500G /u02/oradata/KVV
  `-/dev/mapper/vg_oracle-u02_daisy       /dev/dm-6      /dev/nvme0n1p1        lvm   ext4                    500G /u02/oradata/DAISY
/dev/nvme3n1                              /dev/nvme3n1                  nvme   disk                          2,9T
/dev/nvme1n1                              /dev/nvme1n1                  nvme   disk                          5,8T
`-/dev/nvme1n1p1                          /dev/nvme1n1p1 /dev/nvme1n1   nvme   part  LVM2_member             5,8T
  |-/dev/mapper/vg_oracle-u02_vip         /dev/dm-7      /dev/nvme1n1p1        lvm   ext4                    500G /u02/oradata/VIP
  |-/dev/mapper/vg_oracle-u02_vbo--portal /dev/dm-8      /dev/nvme1n1p1        lvm   ext4                    500G /u02/oradata/VBO-Portal
  |-/dev/mapper/vg_oracle-u02_bsv--portal /dev/dm-9      /dev/nvme1n1p1        lvm   ext4                    500G /u02/oradata/BSV-Portal
  `-/dev/mapper/vg_oracle-u02_vbo         /dev/dm-10     /dev/nvme1n1p1        lvm   ext4                    500G /u02/oradata/VBO
/dev/nvme4n1                              /dev/nvme4n1                  nvme   disk                          2,9T
/dev/nvme2n1                              /dev/nvme2n1                  nvme   disk                          2,9T
`-/dev/nvme2n1p1                          /dev/nvme2n1p1 /dev/nvme2n1   nvme   part  ext4                    2,9T /u03/flashdata/ZVK_MUC
/dev/nvme5n1                              /dev/nvme5n1                  nvme   disk                          2,9T
</code></pre>
<ul>
<li>Description of the issue (ideally so that others can reproduce it):</li>
</ul>
<p>My analysis of the attached files revealed the following facts:</p>
<p>ReaR confuses DM (Device Mapper Multipathing) multipathing devices with
NVMe™ (Non-volatile Memory Express™) multipathing devices.</p>
<p>In the original disklayout.conf file, ReaR correctly detects the
following DM multipath devices (Sata devices):</p>
<pre><code>/dev/sda (sata)
/dev/sdb (sata)
</code></pre>
<p>ReaR also correctly detects the following (NVMe™) multipathing devices:</p>
<pre><code>/dev/nvme0n1 (nvme)
/dev/nvme1n1 (nvme)
/dev/nvme2n1 (nvme)
/dev/nvme3n1 (nvme)
/dev/nvme4n1 (nvme)
/dev/nvme5n1 (nvme)
</code></pre>
<p>When testing disaster recovery, ReaR can no longer correctly reconstruct
the multipathing devices.</p>
<p>/dev/sdb correctly recognizes ReaR as a SATA device.<br />
/dev/sda does not correctly recognize ReaR as a SATA, but incorrectly as
an NVME device<br />
ReaR incorrectly links /dev/sda (sata) to /dev/nvme0n1 (nvme)</p>
<p>ReaR then fails with the error message during disaster recovery<br />
ERROR: No file system mounted on mnt/local</p>
<p>AUTOEXCLUDE_MULTIPATH=n does not solve the problem.</p>
<p>What measures are required for proper disaster recovery?</p>
<ul>
<li>
<p>Workaround, if any:<br />
    unidentified</p>
</li>
<li>
<p>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files):</p>
</li>
<li>
<p>original_disklayout.conf.txt:
    (<a href="https://github.com/rear/rear/files/15399959/original_disklayout.conf.txt">https://github.com/rear/rear/files/15399959/original_disklayout.conf.txt</a>)</p>
</li>
<li>
<p>recovered_disklayout conf:
    (<a href="https://github.com/rear/rear/assets/158028301/ebd75c54-34fc-423b-9d3d-bfacdf6a3670">https://github.com/rear/rear/assets/158028301/ebd75c54-34fc-423b-9d3d-bfacdf6a3670</a>)</p>
</li>
<li>
<p>var_log_rear_rear-ora:
    (<a href="https://github.com/rear/rear/assets/158028301/1438de1e-328c-42f7-aa82-42cdca1c14ff">https://github.com/rear/rear/assets/158028301/1438de1e-328c-42f7-aa82-42cdca1c14ff</a>)</p>
</li>
</ul>
<h4 id="jsmeix_commented_at_2024-05-22_1233"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/3230#issuecomment-2124681561">2024-05-22 12:33</a>:<a class="headerlink" href="#jsmeix_commented_at_2024-05-22_1233" title="Permanent link">&para;</a></h4>
<p>I am not at all a multipath expert and<br />
I know nothing at all about "NVMe multipathing"<br />
so only as an offhanded side note regarding</p>
<pre><code>ReaR confuses DM (Device Mapper Multipathing) multipathing devices
with NVMe™ (Non-volatile Memory Express™) multipathing devices.
</code></pre>
<p>cf. starting at<br />
<a href="https://github.com/rear/rear/issues/3085#issuecomment-1890616502">https://github.com/rear/rear/issues/3085#issuecomment-1890616502</a><br />
which - unfortunately - did not further proceed there.</p>
<p>So current ReaR may not work with "NVMe multipathing"<br />
because "NVMe multipathing" may require some special<br />
treatment in ReaR which is currently not implemented.</p>
<h4 id="stefanfrommunich_commented_at_2024-08-19_0954"><img src="https://avatars.githubusercontent.com/u/158028301?v=4" width="50"><a href="https://github.com/StefanFromMunich">StefanFromMunich</a> commented at <a href="https://github.com/rear/rear/issues/3230#issuecomment-2296156563">2024-08-19 09:54</a>:<a class="headerlink" href="#stefanfrommunich_commented_at_2024-08-19_0954" title="Permanent link">&para;</a></h4>
<p>We use NVMe™ drives only as flash storage.<br />
Therefore, we only store volatile data on NVMe™ drives.<br />
We do not store permanent data on NVMe™ drives.<br />
Therefore, we do not require ReaR disaster recovery<br />
for the NVMe™ drives.<br />
I therefore excluded the NVMe™ disks<br />
('/dev/nvme0n1' '/dev/nvme1n1' '/dev/nvme2n1' '/dev/nvme3n1'
'/dev/nvme4n1' '/dev/nvme5n1')<br />
from the backup with the following configuration:</p>
<pre><code>BACKUP_PROG_EXCLUDE=("${BACKUP_PROG_EXCLUDE[@]}"
                     '/media' '/var/tmp' '/var/crash' '/u02'
                     '/dev/nvme0n1' '/dev/nvme1n1' '/dev/nvme2n1' '/dev/nvme3n1' '/dev/nvme4n1' '/dev/nvme5n1' )
</code></pre>
<p>However, this did not help,<br />
because ReaR disaster recovery did not work.</p>
<p>Is it possible to exclude the NVMe™ disks from REaR backup<br />
so that ReaR disaster recovery works?</p>
<h4 id="jsmeix_commented_at_2024-08-19_1502"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/3230#issuecomment-2296797890">2024-08-19 15:02</a>:<a class="headerlink" href="#jsmeix_commented_at_2024-08-19_1502" title="Permanent link">&para;</a></h4>
<p>@StefanFromMunich</p>
<p>the various exclude-this-or-that functionalities in ReaR<br />
are rather complicated and may behave confusing so you<br />
may have to experiment with some trial and error tests<br />
until you may get what you need in your specific case.</p>
<p>You may have a look at my comments in<br />
<a href="https://github.com/rear/rear/issues/2772">https://github.com/rear/rear/issues/2772</a><br />
starting at<br />
<a href="https://github.com/rear/rear/issues/2772#issuecomment-1066754013">https://github.com/rear/rear/issues/2772#issuecomment-1066754013</a><br />
and as needed also follow links to other issues therein.</p>
<p>I think what you need first and foremost is to exclude<br />
what is called "component" in ReaR because disk devices<br />
are "components" in ReaR.</p>
<p>Because you use ReaR 2.6<br />
which is several years old (from June 2020):</p>
<p>In general I recommend to try out our latest GitHub master code<br />
because the GitHub master code is the only place where we fix things<br />
and if there are issues it helps when you use exactly the code<br />
where we could fix things.</p>
<p>See the section<br />
"Testing current ReaR upstream GitHub master code" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a><br />
how you can try out our current ReaR GitHub master code<br />
without conflicts with your already installed ReaR version.</p>
<p>In general we at ReaR upstream do not support older ReaR versions.<br />
We at ReaR upstream do not plain reject issues with older ReaR
versions<br />
(e.g. we may answer easy to solve questions also for older ReaR
versions)<br />
but we do not spend much time on issues with older ReaR versions
because<br />
we do not (and cannot) fix issues in released ReaR versions.<br />
Issues in released ReaR versions are not fixed by us (by ReaR
upstream).<br />
Issues in released ReaR versions that got fixed in current ReaR
upstream<br />
GitHub master code might be fixed (if the fix can be backported with<br />
reasonable effort) by the Linux distributor wherefrom you got ReaR.</p>
<h4 id="jsmeix_commented_at_2024-08-19_1543"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/3230#issuecomment-2296886092">2024-08-19 15:43</a>:<a class="headerlink" href="#jsmeix_commented_at_2024-08-19_1543" title="Permanent link">&para;</a></h4>
<p>@StefanFromMunich</p>
<p>a side note regarding your</p>
<pre><code>AUTORESIZE_PARTITIONS=true
AUTOSHRINK_DISK_SIZE_LIMIT_PERCENTAGE=100
</code></pre>
<p>I think those two settings contradict each other<br />
because usr/share/rear/conf/default.conf<br />
reads - even for the old ReaR 2.6 - (excerpts):</p>
<pre><code># When AUTORESIZE_PARTITIONS is true, all active partitions on all active disks
# get resized by the 430_autoresize_all_partitions.sh script
...
# When the first value in AUTORESIZE_PARTITIONS is neither true nor false
# only the last active partition on each active disk gets resized
# by the 420_autoresize_last_partitions.sh script.
#
# The following applies only when the last active partition on each active disk
# gets resized by the 420_autoresize_last_partitions.sh script
...
AUTOSHRINK_DISK_SIZE_LIMIT_PERCENTAGE...
</code></pre>
<p>see starting at<br />
<a href="https://github.com/rear/rear/blob/rear-2.6/usr/share/rear/conf/default.conf#L413">https://github.com/rear/rear/blob/rear-2.6/usr/share/rear/conf/default.conf#L413</a></p>
<p>Regarding the 430_autoresize_all_partitions.sh script see<br />
the current GitHub master code default.conf that reads</p>
<pre><code># Using AUTORESIZE_PARTITIONS='true' with 430_autoresize_all_partitions.sh
# may result badly aligned partitions in particular possibly harmful aligned
# according to what flash memory based disks (i.e. SSDs) actually need
# which is usually 4MiB or 8MiB alignment where a too small value
# will result lower speed and less lifetime of flash memory devices
</code></pre>
<p>see<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L567">https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L567</a><br />
and see our release notes where this was introduced<br />
in ReaR 2.4 which reads (excerpts):</p>
<pre><code>Version 2.4 (June 2018)
...
-   Major rework and changed default behaviour how ReaR behaves in migration
    mode when partitions can or must be resized to fit on replacement disks
    with different size. The new default behaviour is that only the partition
    end value of the last partition on a disk (and therefore its partition
    size) may get changed if really needed but no partition start value gets
    changed to avoid changes of the partition alignment. The new
    420_autoresize_last_partitions script implements the new behaviour and the
    old 400_autoresize_disks was renamed into 430_autoresize_all_partitions to
    still provide the old behaviour if that is explicitly requested by the
    user but the old behaviour may result unexpected changes of arbitrary
    partitions on a disk.
</code></pre>
<p><a href="https://github.com/rear/rear/blob/master/doc/rear-release-notes.txt#L2778">https://github.com/rear/rear/blob/master/doc/rear-release-notes.txt#L2778</a></p>
<p>For details see also<br />
<a href="https://github.com/rear/rear/issues/1750">https://github.com/rear/rear/issues/1750</a><br />
and the other issues mentioned therein<br />
in particular<br />
<a href="https://github.com/rear/rear/pull/1733">https://github.com/rear/rear/pull/1733</a></p>
<h4 id="stefanfrommunich_commented_at_2024-09-05_0530"><img src="https://avatars.githubusercontent.com/u/158028301?v=4" width="50"><a href="https://github.com/StefanFromMunich">StefanFromMunich</a> commented at <a href="https://github.com/rear/rear/issues/3230#issuecomment-2330635374">2024-09-05 05:30</a>:<a class="headerlink" href="#stefanfrommunich_commented_at_2024-09-05_0530" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<p>Thank you for your comments.<br />
I have taken all your comments into consideration.<br />
I used the GIt master code:</p>
<pre><code>Relax-and-Recover 2.7 / Git
</code></pre>
<p>I updated the operating system:</p>
<pre><code>NAME="Oracle Linux Server"
VERSION="8.10"
ID="ol"
ID_LIKE="fedora"
</code></pre>
<p>I have adjusted the ReaR configuration according to your instructions:</p>
<pre><code>OUTPUT=ISO
OUTPUT_URL=nfs://193.14.236.134/volume1/Rear
BACKUP=NETFS
BACKUP_URL=nfs://193.14.236.134/volume1/Rear
BACKUP_PROG_EXCLUDE=("${BACKUP_PROG_EXCLUDE[@]}" '/media' '/var/tmp' '/var/crash' '/u02' '/dev/nvme0n1'  '/dev/nvme1n1'  '/dev/nvme2n1'  '/dev/nvme3n1'  '/dev/nvme4n1'  '/dev/nvme5n1' )
EXCLUDE_COMPONENTS=( "${EXCLUDE_COMPONENTS[@]}" "/dev/nvme0n1"  "/dev/nvme1n1"  "/dev/nvme2n1"  "/dev/nvme3n1"  "/dev/nvme4n1"  "/dev/nvme5n1" )
NETFS_KEEP_OLD_BACKUP_COPY=
UEFI_BOOTLOADER=/boot/efi/EFI/redhat/grubx64.efi
SECURE_BOOT_BOOTLOADER=/boot/efi/EFI/redhat/shimx64.efi
EXCLUDE_MOUNTPOINTS=( '/u03/flashdata/ZVK_MUC' '/u02/oradata/ZVK_MUC' )
AUTOEXCLUDE_MULTIPATH=n
AUTORESIZE_PARTITIONS=false
</code></pre>
<p>There are no more problems with the multipath devices.</p>
<p>However, there seems to be something wrong with the ISO image.<br />
The virtual machine cannot be booted with it.<br />
Attached you will find three screenshots with the screen messages.<br />
The numbering corresponds to the order in which the screen messages
appear.<br />
After "Press any key to continue..." nothing happens.<br />
What else do I have to do to make the machine bootable?</p>
<p><img alt="Rear_boot_Screen1" src="https://github.com/user-attachments/assets/82b88a9e-c253-44e5-93ae-5689a4f5b2e9" /><br />
<img alt="Rear_boot_Screen2" src="https://github.com/user-attachments/assets/894cac8a-6d2c-4bce-b888-248874771d2f" /><br />
<img alt="Rear_boot_Screen3" src="https://github.com/user-attachments/assets/33fb74a1-209f-450e-8969-337b0e35f513" /></p>
<h4 id="stefanfrommunich_commented_at_2024-09-05_0644"><img src="https://avatars.githubusercontent.com/u/158028301?v=4" width="50"><a href="https://github.com/StefanFromMunich">StefanFromMunich</a> commented at <a href="https://github.com/rear/rear/issues/3230#issuecomment-2330727271">2024-09-05 06:44</a>:<a class="headerlink" href="#stefanfrommunich_commented_at_2024-09-05_0644" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<p>I also noticed that the two files xzio and fshelp,<br />
which were not found during the boot process,<br />
are entered in the backup log file:</p>
<pre><code>block 7609484: /usr/lib/grub/x86_64-efi/xzio.mod
block 7600337: /usr/lib/grub/x86_64-efi/fshelp.mod
</code></pre>
<p>Only kernel.exec is entered in the ISO log file:</p>
<pre><code>/usr/lib/grub/x86_64-efi/kernel.exec
</code></pre>
<p>The two files xzio and fshelp were not entered into the ISO log file.</p>
<p>The initrd.cgz file is included in the ISO log file:</p>
<pre><code>2024-09-04 11:35:00.755448505 Created initrd.cgz with gzip default compression (778 MiB) in 56 seconds
</code></pre>
<h4 id="stefanfrommunich_commented_at_2024-09-23_1039"><img src="https://avatars.githubusercontent.com/u/158028301?v=4" width="50"><a href="https://github.com/StefanFromMunich">StefanFromMunich</a> commented at <a href="https://github.com/rear/rear/issues/3230#issuecomment-2367837729">2024-09-23 10:39</a>:<a class="headerlink" href="#stefanfrommunich_commented_at_2024-09-23_1039" title="Permanent link">&para;</a></h4>
<p>@jsmeix<br />
Can you please remove the label "old version".<br />
I have completed the upgrade and am now working with the GIt master
code:<br />
Relax-and-Recover 2.7 / Git<br />
I also documented this in the last bug description.</p>
<h4 id="jsmeix_commented_at_2024-09-23_1352"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/3230#issuecomment-2368336036">2024-09-23 13:52</a>:<a class="headerlink" href="#jsmeix_commented_at_2024-09-23_1352" title="Permanent link">&para;</a></h4>
<p>@StefanFromMunich<br />
according to your<br />
<a href="https://github.com/rear/rear/issues/3230#issuecomment-2330635374">https://github.com/rear/rear/issues/3230#issuecomment-2330635374</a><br />
(excerpt)</p>
<pre><code>There are no more problems with the multipath devices.

However, there seems to be something wrong with the ISO image.
The virtual machine cannot be booted with it.
</code></pre>
<p>this issue has now changed its topic / subject<br />
from something about</p>
<pre><code>NVMe multipathing devices
</code></pre>
<p>to something about</p>
<pre><code>UEFI booting from ReaR's ISO image
</code></pre>
<p>which is somewhat problematic for us because<br />
we at ReaR upstream (and in particular I)<br />
prefer separated issues for separated topics<br />
so that the right people who know best about<br />
a certain area could focus on a particular issue.</p>
<p>So ideally I wished you could re-report your<br />
"UEFI booting from ReaR's ISO image" issue<br />
as a new separated issue here at GitHub.</p>
<p>I am not at all an expert in UEFI booting and<br />
I am also in general not an expert in booting stuff<br />
so personally I cannot help much with booting issues.</p>
<p>In particular am not a Red Hat / Fedora / Oracle Linux user<br />
so I cannot reproduce issues which are specific for<br />
those Linux distributions (and in particular booting issues<br />
are often specific for a particular Linux distribution).</p>
<p>For my personal experience with UEFI booting<br />
from ReaR's ISO image you may read through<br />
<a href="https://github.com/rear/rear/issues/3084">https://github.com/rear/rear/issues/3084</a><br />
in particular therein see<br />
<a href="https://github.com/rear/rear/issues/3084#issuecomment-1833496190">https://github.com/rear/rear/issues/3084#issuecomment-1833496190</a><br />
(and follow the links therein as needed)<br />
and see<br />
<a href="https://github.com/rear/rear/issues/3084#issuecomment-1835773844">https://github.com/rear/rear/issues/3084#issuecomment-1835773844</a><br />
and finally see<br />
<a href="https://github.com/rear/rear/issues/3084#issuecomment-2330953577">https://github.com/rear/rear/issues/3084#issuecomment-2330953577</a></p>
<p>By the way:<br />
I think both</p>
<pre><code>UEFI_BOOTLOADER=/boot/efi/EFI/redhat/grubx64.efi
SECURE_BOOT_BOOTLOADER=/boot/efi/EFI/redhat/shimx64.efi
</code></pre>
<p>are currently not supported in ReaR because<br />
setting SECURE_BOOT_BOOTLOADER overwrites UEFI_BOOTLOADER<br />
and when SECURE_BOOT_BOOTLOADER is set it specifies the<br />
first-stage bootloader (which is shim) and then shim<br />
runs as second-stage bootloader something that is<br />
basically hardcoded inside shim so that what ReaR does<br />
is to copy all possible second-stage bootloaders<br />
(basicaly all GRUB EFI binaries as far as I remember)<br />
into the ISO to make shim's second-stage bootloader<br />
available via the ISO, cf. the comments in<br />
usr/share/rear/output/USB/Linux-i386/100_create_efiboot.sh<br />
starting at</p>
<pre><code># Copy UEFI bootloader:
if test -f "$SECURE_BOOT_BOOTLOADER" ; then
</code></pre>
<p>currently online at<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/output/USB/Linux-i386/100_create_efiboot.sh#L65">https://github.com/rear/rear/blob/master/usr/share/rear/output/USB/Linux-i386/100_create_efiboot.sh#L65</a><br />
This is for OUTPUT=USB but since<br />
<a href="https://github.com/rear/rear/pull/3031">https://github.com/rear/rear/pull/3031</a><br />
it is similar as what is done for OUTPUT=ISO.<br />
For background information what I had done in the past<br />
you may have a look at<br />
<a href="https://github.com/rear/rear/pull/3031">https://github.com/rear/rear/pull/3031</a><br />
(and follow the links therein as needed).</p>
<h4 id="stefanfrommunich_commented_at_2024-10-04_0953"><img src="https://avatars.githubusercontent.com/u/158028301?v=4" width="50"><a href="https://github.com/StefanFromMunich">StefanFromMunich</a> commented at <a href="https://github.com/rear/rear/issues/3230#issuecomment-2393316490">2024-10-04 09:53</a>:<a class="headerlink" href="#stefanfrommunich_commented_at_2024-10-04_0953" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<p>Thank you for the detailed analysis.<br />
As per your suggestion, I am now closing this issue. As a replacement, I
have opened issue<br />
UEFI booting from ReaR ISO image does not work #3326</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2024-05-22.3230.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
