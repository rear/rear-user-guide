<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#227 Issue closed: recovery on smaller disks - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#227 Issue closed: recovery on smaller disks";
        var mkdocs_page_input_path = "issues/2013-04-12.227.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rsync.html">External Backup using BACKUP=RSYNC method</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/duplicity.html">External Backup using duplicity</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#227 Issue closed: recovery on smaller disks</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="227_issue_closed_recovery_on_smaller_disks"><a href="https://github.com/rear/rear/issues/227">#227 Issue</a> <code>closed</code>: recovery on smaller disks<a class="headerlink" href="#227_issue_closed_recovery_on_smaller_disks" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="wdpoorte_opened_issue_at_2013-04-12_1319"><img src="https://avatars.githubusercontent.com/u/1590248?v=4" width="50"><a href="https://github.com/wdpoorte">wdpoorte</a> opened issue at <a href="https://github.com/rear/rear/issues/227">2013-04-12 13:19</a>:<a class="headerlink" href="#wdpoorte_opened_issue_at_2013-04-12_1319" title="Permanent link">&para;</a></h4>
<p>When recovering a server on a VM with smaller disks, I get an error
during layout creation. The system has some not-used partitions labeled
as PVs (for possible future use by applications).</p>
<p>When I uncomment these partitions, together with the corresponding
lvmdev lines, the recovery goes smoothly.</p>
<p>We use the following in our config:<br />
ONLY_INCLUDE_VG=( "vg00" )</p>
<p>It would be a good idea according to me if you could modify the code so
that unused partitions and PVs are excluded from the disklayout.</p>
<p>disklayout:</p>
<pre><code>#disk /dev/sda 10737745920 msdos
disk /dev/sdb 146778685440 msdos
part /dev/sdb 536870912 1048576 primary boot /dev/sdb1
part /dev/sdb 68719476736 537919488 primary lvm /dev/sdb2
part /dev/sdb 24121442304 69257396224 primary none /dev/sdb3
part /dev/sdb 1024 93378838528 extended none /dev/sdb4
part /dev/sdb 44500516864 93379887104 logical lvm /dev/sdb5
part /dev/sdb 8897167360 137881452544 logical lvm /dev/sdb6
#disk /dev/sdc 10737745920 msdos
lvmdev /dev/vg00 /dev/sdb2 9PIZAC-p8uE-iUCg-4Nez-3cv7-q1Mn-Tt91te 134217728
#lvmdev /dev/vg_data /dev/mapper/mpathbp2 hDdsZq-xZ3z-Tlch-2yM6-eKH1-6qvY-crKZtW 20916630
lvmdev /dev/#orphans_lvm2 /dev/sdb5 Eg2A17-Top3-zugP-V9XR-s1lD-3GMc-NaGQK3 86915072
lvmdev /dev/#orphans_lvm2 /dev/sdb6 Y6NAmW-hnfj-Cl73-l9V7-nDA8-KpZO-jceoP6 17377280
lvmgrp /dev/vg00 32768 2047 67076096
#lvmgrp /dev/vg_data 4096 2553 10457088
lvmvol /dev/vg00 lv00 256 16777216
lvmvol /dev/vg00 lv01 256 16777216
lvmvol /dev/vg00 lv02 256 16777216
lvmvol /dev/vg00 lv03 256 16777216
lvmvol /dev/vg00 lv04 256 16777216
lvmvol /dev/vg00 lv05 256 16777216
lvmvol /dev/vg00 lv06 81 5308416
#lvmvol /dev/vg_data lv_data 2000 16384000
fs /dev/mapper/vg00-lv00 / ext3 uuid=74f9aa74-dd67-4ae5-9344-9381585f7d19 label= blocksize=4096 reserved_blocks=4% max_mounts=-1 check_interval=0d bytes_per_inode=16384 options=rw
fs /dev/sdb1 /boot ext3 uuid=d5b2ad22-1534-4f4c-8f00-6adac825f93e label= blocksize=4096 reserved_blocks=4% max_mounts=-1 check_interval=0d bytes_per_inode=16384 options=rw
fs /dev/mapper/vg00-lv05 /home ext3 uuid=141b6688-8192-438e-a83b-d4afe18c72a5 label= blocksize=4096 reserved_blocks=4% max_mounts=-1 check_interval=0d bytes_per_inode=16384 options=rw
fs /dev/mapper/vg00-lv01 /opt ext3 uuid=67e9e9ab-ffb4-4f4b-8a67-84349ae84c1c label= blocksize=4096 reserved_blocks=4% max_mounts=-1 check_interval=0d bytes_per_inode=16384 options=rw
fs /dev/mapper/vg00-lv02 /tmp ext3 uuid=c74bc757-d860-4106-a039-cf3cf800116e label= blocksize=4096 reserved_blocks=4% max_mounts=-1 check_interval=0d bytes_per_inode=16384 options=rw
fs /dev/mapper/vg00-lv03 /usr ext3 uuid=2852b22d-663f-45f9-b3e4-9d8db7ff6eeb label= blocksize=4096 reserved_blocks=4% max_mounts=-1 check_interval=0d bytes_per_inode=16384 options=rw
fs /dev/mapper/vg00-lv06 /usr/openv ext3 uuid=87f1b2e7-83e5-47c6-93db-d4edcb21e8be label= blocksize=4096 reserved_blocks=4% max_mounts=-1 check_interval=0d bytes_per_inode=16374 options=rw
fs /dev/mapper/vg00-lv04 /var ext3 uuid=6e88469c-2561-4ec9-bee5-8790e073469d label= blocksize=4096 reserved_blocks=4% max_mounts=-1 check_interval=0d bytes_per_inode=16384 options=rw
swap /dev/sdb3 uuid=8ca85cce-3053-440e-b4a7-302914bc38aa label=
logicaldrive /dev/sdb 0|A|1 raid=1 drives=1I:1:1,1I:1:2, spares= sectors=32 stripesize=256
smartarray 0
#multipath /dev/mapper/mpathb /dev/sda,/dev/sdc
#part /dev/mapper/mpathb 24643584 unknown primary boot /dev/mapper/mpathbp1
#part /dev/mapper/mpathb 10709314560 unknown primary none /dev/mapper/mpathbp2
</code></pre>
<h4 id="gdha_commented_at_2013-05-07_1229"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/227#issuecomment-17539030">2013-05-07 12:29</a>:<a class="headerlink" href="#gdha_commented_at_2013-05-07_1229" title="Permanent link">&para;</a></h4>
<p>could you give an example of before/after your changes? This will make
me see the diffs better. Thanks Werner.</p>
<h4 id="dagwieers_commented_at_2013-06-07_1658"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/227#issuecomment-19119427">2013-06-07 16:58</a>:<a class="headerlink" href="#dagwieers_commented_at_2013-06-07_1658" title="Permanent link">&para;</a></h4>
<p>I don't think excluding unused partitions or volumes during recovery is
what most people would expect. Sure, in your case it would be better to
get rid of them in order to have the recovery work, but recovering to
smaller disks is not something we advise to do, there are many other
issues that are hard to impossible to cover when doing a recovery to
smaller disks.</p>
<p>The fact that you were able to recover in this case by manually adapting
the configuration is exactly how it was designed for cases like yours.</p>
<p>If one does have ample diskspace, one would expect a system that is
exactly the same, including unused partitions and unused logical
volumes. If you expect such unused entries to not be around, I would
suggest not creating them in the first place, until the moment you need
them... ;-)</p>
<h4 id="dagwieers_commented_at_2013-06-07_1704"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/227#issuecomment-19119719">2013-06-07 17:04</a>:<a class="headerlink" href="#dagwieers_commented_at_2013-06-07_1704" title="Permanent link">&para;</a></h4>
<p>Hmm, there's one thing I do not understand from the report. You <em>only</em>
include vg00, still you mention that the creation <em>fails</em> unless you
uncomment the stuff you excluded explicitely. This seems more like a
bug.</p>
<p>Can you provide us with a debug log of the failed layout creation as
well as the necessary layout-file ? Without this it is impossible to
understand what is going on :-/</p>
<h4 id="gdha_commented_at_2013-11-04_1530"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/227#issuecomment-27693601">2013-11-04 15:30</a>:<a class="headerlink" href="#gdha_commented_at_2013-11-04_1530" title="Permanent link">&para;</a></h4>
<p>@wdpoorte is there a way to reproduce this?</p>
<h4 id="gdha_commented_at_2015-02-03_0936"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/227#issuecomment-72620297">2015-02-03 09:36</a>:<a class="headerlink" href="#gdha_commented_at_2015-02-03_0936" title="Permanent link">&para;</a></h4>
<p>@wdpoorte the disklayout you pasted above was that a modified one or
original before the changes??</p>
<h4 id="gdha_commented_at_2015-09-23_1157"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/227#issuecomment-142577909">2015-09-23 11:57</a>:<a class="headerlink" href="#gdha_commented_at_2015-09-23_1157" title="Permanent link">&para;</a></h4>
<p>The orphans VGs are filtered out since rear-1.16</p>
<pre><code>./layout/save/GNU/Linux/34_false_blacklisted.sh:get_child_components "$blockdev" | grep "^/dev" | grep -v "\#orphans" &gt;&gt;  "$TMP_DIR/blacklisted.devices"
</code></pre>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2026 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2013-04-12.227.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
