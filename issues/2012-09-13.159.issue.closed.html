<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#159 Issue closed: Using a non-existing backup method fails in recovery (e.g. REQUEST_RESTORE instead of REQUESTRESTORE) - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#159 Issue closed: Using a non-existing backup method fails in recovery (e.g. REQUEST_RESTORE instead of REQUESTRESTORE)";
        var mkdocs_page_input_path = "issues/2012-09-13.159.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#159 Issue closed: Using a non-existing backup method fails in recovery (e.g. REQUEST_RESTORE instead of REQUESTRESTORE)</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="159_issue_closed_using_a_non-existing_backup_method_fails_in_recovery_eg_request_restore_instead_of_requestrestore"><a href="https://github.com/rear/rear/issues/159">#159 Issue</a> <code>closed</code>: Using a non-existing backup method fails in recovery (e.g. REQUEST_RESTORE instead of REQUESTRESTORE)<a class="headerlink" href="#159_issue_closed_using_a_non-existing_backup_method_fails_in_recovery_eg_request_restore_instead_of_requestrestore" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>documentation</code></p>
<h4 id="tastle73_opened_issue_at_2012-09-13_1330"><img src="https://avatars.githubusercontent.com/u/2339489?u=3fa466e43b76a8a55d71df34fc5ab1ba7efc631f&v=4" width="50"><a href="https://github.com/tastle73">tastle73</a> opened issue at <a href="https://github.com/rear/rear/issues/159">2012-09-13 13:30</a>:<a class="headerlink" href="#tastle73_opened_issue_at_2012-09-13_1330" title="Permanent link">&para;</a></h4>
<p>I'm trying to restore a CentOS 5.8 system using this config:</p>
<pre><code>RESCUE birch:~ # less /etc/rear/local.conf
# sample local configuration

# Create Rear rescue media as ISO image
OUTPUT=ISO

# optionally define (non-default) backup software, e.g. TSM, NBU, DP, BACULA
BACKUP=REQUEST_RESTORE

# the following is required on older VMware VMs
MODULES_LOAD=( vmxnet )

# to see boot messages on the serial console (uncomment next line)
# KERNEL_CMDLINE="console=tty0 console=ttyS1"
</code></pre>
<p>The ISO boots fine and the partitions are set up. But at the very end
when it looks likes it's going to chroot /mnt/local to install the
initrd it crashes like this:</p>
<pre><code>2012-09-13 08:35:25 Including finalize/Fedora/i386/17_rebuild_initramfs.sh
2012-09-13 08:35:25 Original OLD_INITRD_MODULES='scsi_mod dm-message dm-log ata_piix dm-zero ehci-hcd dm-raid45 shpchp dm-mem-cache dm-region_hash sd_mod dm-mirror ext3 uhci-hcd dm-mod ohci-hcd libata megaraid_sas dm-snapshot jbd'
2012-09-13 08:35:25 New INITRD_MODULES='scsi_mod dm-message dm-log ata_piix dm-zero ehci-hcd dm-raid45 shpchp dm-mem-cache dm-region_hash sd_mod dm-mirror ext3 uhci-hcd dm-mod ohci-hcd libata megaraid_sas dm-snapshot jbd sg sr_mod'
chroot: cannot run command `/bin/bash': No such file or directory
2012-09-13 08:35:25 WARNING !!!
initramfs creation failed, please check '/var/log/rear/rear-birch.log' to see the error
messages in detail and decide yourself, wether the system will boot or not.

2012-09-13 08:35:25 Including finalize/Linux-i386/21_install_grub.sh
2012-09-13 08:35:25 Installing GRUB boot loader
2012-09-13 08:35:25 ERROR: Could not find directory /boot/grub
=== Stack trace ===
Trace 0: /bin/rear:245 main
Trace 1: /usr/share/rear/lib/recover-workflow.sh:34 WORKFLOW_recover
Trace 2: /usr/share/rear/lib/framework-functions.sh:79 SourceStage
Trace 3: /usr/share/rear/lib/framework-functions.sh:40 Source
Trace 4: /usr/share/rear/finalize/Linux-i386/21_install_grub.sh:30 source
Trace 5: /usr/share/rear/lib/_input-output-functions.sh:131 StopIfError
Message: Could not find directory /boot/grub
===================
2012-09-13 08:35:25 Running exit tasks.
2012-09-13 08:35:25 Finished in 77 seconds
2012-09-13 08:35:25 Removing build area /tmp/rear.HjthDkoNLxN1921
rmdir: removing directory, /tmp/rear.HjthDkoNLxN1921
</code></pre>
<p>If I do a complete backup using rsync to a NAS it's fine.</p>
<h4 id="dagwieers_commented_at_2012-09-13_1555"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/159#issuecomment-8533113">2012-09-13 15:55</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-09-13_1555" title="Permanent link">&para;</a></h4>
<p>What version of Relax-and-Recover are you using ?</p>
<h4 id="tastle73_commented_at_2012-09-13_1606"><img src="https://avatars.githubusercontent.com/u/2339489?u=3fa466e43b76a8a55d71df34fc5ab1ba7efc631f&v=4" width="50"><a href="https://github.com/tastle73">tastle73</a> commented at <a href="https://github.com/rear/rear/issues/159#issuecomment-8533464">2012-09-13 16:06</a>:<a class="headerlink" href="#tastle73_commented_at_2012-09-13_1606" title="Permanent link">&para;</a></h4>
<p>root@birch ~]# rpm -q rear<br />
rear-1.13.0-56.git201209050817.el5</p>
<h4 id="dagwieers_commented_at_2012-09-14_0030"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/159#issuecomment-8548426">2012-09-14 00:30</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-09-14_0030" title="Permanent link">&para;</a></h4>
<p>From the post on the mailing list it was clear that the cause of the
error is the lack of restore when Relax-and-Recover ask you to perform
the (manual) restore. That is what <code>REQUESTRESTORE</code> means.</p>
<p>Can I close this ticket ?</p>
<h4 id="cal-s_commented_at_2012-09-17_1104"><img src="https://avatars.githubusercontent.com/u/2027029?v=4" width="50"><a href="https://github.com/cal-s">cal-s</a> commented at <a href="https://github.com/rear/rear/issues/159#issuecomment-8610934">2012-09-17 11:04</a>:<a class="headerlink" href="#cal-s_commented_at_2012-09-17_1104" title="Permanent link">&para;</a></h4>
<p>in docs/03-configuration:</p>
<p>BACKUP=REQUESTRESTORE::<br />
No backup, just ask user to somehow restore the filesystems</p>
<p>The intent is not very clear at all :) in addition to REQUESTRESTORE
being misnamed in the doc. Is there somewhere else that this option is
described in more detail?</p>
<h4 id="dagwieers_commented_at_2012-09-17_1209"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/159#issuecomment-8612069">2012-09-17 12:09</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-09-17_1209" title="Permanent link">&para;</a></h4>
<p>I agree the documentation could be improved. Please send a pull-request
for documentation improvements.</p>
<p>The most detail is in the scripts itself:</p>
<pre><code>[dag@moria rear]$ find . -name REQUESTRESTORE
./usr/share/rear/restore/REQUESTRESTORE
[dag@moria rear]$ cat ./usr/share/rear/restore/REQUESTRESTORE/default/20_prompt_user_to_start_restore.sh 
#
# the user has to do the main part here :-)
#
#

LogPrint "$REQUESTRESTORE_TEXT"

if [[ "$REQUESTRESTORE_COMMAND" ]]; then
    LogPrint "Use the following command to restore the backup to your system in '/mnt/local':

    $REQUESTRESTORE_COMMAND
"

    LogPrint "Please restore your backup in the provided shell, use the shell history to
access the above command and, when finished, type exit in the shell to continue
recovery.
"
    rear_shell "Did you restore the backup to /mnt/local ? Are you ready to continue recovery ?" \
        "$REQUESTRESTORE_COMMAND"
else
    LogPrint "Please restore your backup in the provided shell and, when finished, type exit
in the shell to continue recovery."

    rear_shell "Did you restore the backup to /mnt/local ? Are you ready to continue recovery ?"
fi
</code></pre>
<p>So <code>REQUESTRESTORE</code> is correctly named in the documentation, and during
recovery the process clearly indicates what is expected from the user.
You can provide a separate message (via <code>REQUESTRESTORE_COMMAND</code> to the
user to hint what the restore command should be. This "backup" method is
in fact a placeholder and the default backup method (lacking any
information to the backup strategy since none was provided in the
configuration).</p>
<h4 id="dagwieers_commented_at_2012-09-17_1211"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/159#issuecomment-8612112">2012-09-17 12:11</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-09-17_1211" title="Permanent link">&para;</a></h4>
<p>I guess the failure here is that the OP used <code>REQUEST_RESTORE</code> instead
of <code>REQUESTRESTORE</code> and as a result there was <em>no</em> backup method used,
so Relax-and-Recover fails automatically during the chroot bash test...</p>
<p>The irony here is that if the OP would not have selected any backup
method, <code>BACKUP=REQUESTRESTORE</code> would have correctly been the used
configuration.</p>
<p>@cal-s Thanks for noticing !</p>
<h4 id="dagwieers_commented_at_2012-09-17_1217"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/159#issuecomment-8612211">2012-09-17 12:17</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-09-17_1217" title="Permanent link">&para;</a></h4>
<p>A solution to the above case could be to test whether any recovery
script would be selected for the <code>BACKUP</code> method specified and if there
is no script found an error could be shown to the user that this BACKUP
method has no recovery script. That's the only way we can be sure that
the user made an error.</p>
<h4 id="tastle73_commented_at_2012-09-17_1325"><img src="https://avatars.githubusercontent.com/u/2339489?u=3fa466e43b76a8a55d71df34fc5ab1ba7efc631f&v=4" width="50"><a href="https://github.com/tastle73">tastle73</a> commented at <a href="https://github.com/rear/rear/issues/159#issuecomment-8613805">2012-09-17 13:25</a>:<a class="headerlink" href="#tastle73_commented_at_2012-09-17_1325" title="Permanent link">&para;</a></h4>
<p>We can help you test this in any way you see fit. We're not using a live
system as we are evaluating the product for our use.</p>
<p>On Sep 17, 2012, at 8:17 AM, Dag Wieers <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a>
wrote:</p>
<blockquote>
<p>A solution to the above case could be to test whether any recovery
script would be selected for the BACKUP method specified and if there
is no script found an error could be shown to the user that this
BACKUP method has no recovery script. That's the only way we can be
sure that the user made an error.</p>
<p>—<br />
Reply to this email directly or view it on GitHub.</p>
</blockquote>
<p>Tom Astle<br />
RedHat Certified System Administrator<br />
Technical Solutions Tier II<br />
E-Mail: <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#116;&#111;&#109;&#64;&#112;&#99;&#99;&#46;&#99;&#111;&#109;">&#116;&#111;&#109;&#64;&#112;&#99;&#99;&#46;&#99;&#111;&#109;</a><br />
For Support: (800) 722-1082 x2</p>
<h4 id="cal-s_commented_at_2012-09-17_1416"><img src="https://avatars.githubusercontent.com/u/2027029?v=4" width="50"><a href="https://github.com/cal-s">cal-s</a> commented at <a href="https://github.com/rear/rear/issues/159#issuecomment-8615924">2012-09-17 14:16</a>:<a class="headerlink" href="#cal-s_commented_at_2012-09-17_1416" title="Permanent link">&para;</a></h4>
<p>Please explain the intent behind the BACKUP variable as set (maybe) in
local.conf? I have it set (see below), which allows direct restore from
a NETFS location:</p>
<p>BACKUP_URL=nfs://server/xfs/backup/rear/14092012<br />
BACKUP=NETFS</p>
<p>Is "BACKUP=whatever" not even used during mkbackup and only used on
restore (i would guess it's put somewhere for restore reference)? When
one sets (or not) BACKUP=REQUESTRESTORE, is it left for the user to
then: "Please restore your backup in the provided shell", assuming they
know where and what said backup was. How would one deal with this? untar
the mkbackup tarball/tape to /mnt/local and proceed?</p>
<h4 id="dagwieers_commented_at_2012-09-17_1433"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/159#issuecomment-8616671">2012-09-17 14:33</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-09-17_1433" title="Permanent link">&para;</a></h4>
<p>The <code>BACKUP</code> method is used during mkbackup. But obviously
<code>BACKUP=REQUESTRESTORE</code> means, we don't manage the backup with
Relax-and-Recover and ask the user to restore using whatever means
necessary. Again, the <code>REQUESTRESTORE_COMMAND</code> may give a hint to what
the restore procedure should be. On the other hand, it is not required.</p>
<p>It all depends on whether you want Relax-and-Recover to take care of the
backup, whether the rescue image should include specific tools and what
the process is to restore. If you know all of this in advance,
<code>REQUESTRESTORE</code> is not for you. If you have any specific needs,
Relax-and-Recover can guide you with those.</p>
<p>Obviously the default for <em>all</em> users is that we don't know anything
about your specific case, so that means: <code>REQUESTRESTORE</code>. We do not do
anything in advance, and you are on your own for restoring the data.</p>
<h4 id="schlomo_commented_at_2012-09-18_1920"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/159#issuecomment-8666812">2012-09-18 19:20</a>:<a class="headerlink" href="#schlomo_commented_at_2012-09-18_1920" title="Permanent link">&para;</a></h4>
<p>Honestly, I don't think we need to take care of typos in the
configuration,<br />
or only to a very limited extend.</p>
<p>If we really want to check for non-existant backup methos then each
method<br />
should set a flag in the pre stage so that we can bail out with a<br />
meaningful message later on, if the flag is not set.</p>
<p>IIRC we do something similar for the boot loader already.</p>
<h4 id="dagwieers_commented_at_2012-09-19_2019"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/159#issuecomment-8705113">2012-09-19 20:19</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-09-19_2019" title="Permanent link">&para;</a></h4>
<p>@schlomo Fair comment.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2012-09-13.159.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
