<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2922 Issue closed: Missing RPM dependencies for "usual programs" - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2922 Issue closed: Missing RPM dependencies for \"usual programs\"";
        var mkdocs_page_input_path = "issues/2023-02-12.2922.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2922 Issue closed: Missing RPM dependencies for "usual programs"</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2922_issue_closed_missing_rpm_dependencies_for_usual_programs"><a href="https://github.com/rear/rear/issues/2922">#2922 Issue</a> <code>closed</code>: Missing RPM dependencies for "usual programs"<a class="headerlink" href="#2922_issue_closed_missing_rpm_dependencies_for_usual_programs" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>no-issue-activity</code></p>
<h4 id="schlomo_opened_issue_at_2023-02-12_2110"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> opened issue at <a href="https://github.com/rear/rear/issues/2922">2023-02-12 21:10</a>:<a class="headerlink" href="#schlomo_opened_issue_at_2023-02-12_2110" title="Permanent link">&para;</a></h4>
<p>Installing rear RPM from<br />
<a href="http://download.opensuse.org/repositories/Archiving:/Backup:/Rear/openSUSE_Leap_15.3/x86_64/rear-2.7-1.x86_64.rpm">http://download.opensuse.org/repositories/Archiving:/Backup:/Rear/openSUSE_Leap_15.3/x86_64/rear-2.7-1.x86_64.rpm</a><br />
on openSUSE Leap 15.4 (don't we have a Leap 15.4 repo?)<br />
leads to a broken installation because <code>pidof</code> is missing:</p>
<pre><code>localhost:~ # cat /etc/os-release 
NAME="openSUSE Leap"
VERSION="15.4"
ID="opensuse-leap"
ID_LIKE="suse opensuse"
VERSION_ID="15.4"
PRETTY_NAME="openSUSE Leap 15.4"
ANSI_COLOR="0;32"
CPE_NAME="cpe:/o:opensuse:leap:15.4"
BUG_REPORT_URL="https://bugs.opensuse.org"
HOME_URL="https://www.opensuse.org/"
DOCUMENTATION_URL="https://en.opensuse.org/Portal:Leap"
LOGO="distributor-logo-Leap"

localhost:~ # rear --version
Relax-and-Recover 2.7 / 2022-07-13

localhost:~ # rear dump
ERROR: Cannot find required programs: pidof
Some messages from /var/tmp/rear.jJqPVr6xw65nt5h/tmp/rear.dump.stdout_stderr since the last called script 950_check_missing_programs.sh:
  /usr/share/rear/lib/_input-output-functions.sh: line 525: type: pidof: not found
  /usr/share/rear/lib/_input-output-functions.sh: line 525: type: pidof: not found
Use debug mode '-d' for some debug messages or debugscript mode '-D' for full debug messages with 'set -x' output
Aborting due to an error, check /var/log/rear/rear-localhost.log.lockless for details
Terminated
</code></pre>
<p>Installing the <code>sysvinit-tools</code> seems to fix this problem.</p>
<p>@jsmeix can we just add that dependency<br />
or will this create a problem on other distros?</p>
<h4 id="jsmeix_commented_at_2023-02-13_1320"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2922#issuecomment-1427933497">2023-02-13 13:20</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-13_1320" title="Permanent link">&para;</a></h4>
<p>It is not a 'bug' in a program when the program aborts<br />
with a meaningful error message when it cannot continue<br />
because then the issue is properly handled in the program<br />
(which does not mean the software cannot be 'enhanced' to<br />
deal better with the underlying root cause - if possible).</p>
<p>In this case it is handled in<br />
init/default/950_check_missing_programs.sh<br />
cf.<br />
<a href="https://github.com/rear/rear/issues/892">https://github.com/rear/rear/issues/892</a></p>
<p>Because noone else reported this issue up to now,<br />
it seems 'pidof' is normally installed on Linux distributions.</p>
<p>In general we do not have explicit RPM dependencies<br />
for every program that is usually called in ReaR.<br />
We have only few RPM dependencies in rear.spec<br />
<a href="https://github.com/rear/rear/blob/master/packaging/rpm/rear.spec">https://github.com/rear/rear/blob/master/packaging/rpm/rear.spec</a><br />
In general we assume that "standard programs" are there.</p>
<p>On my openSUSE Leap 15.4 homeoffice system (with Gnome desktop)<br />
'sysvinit-tools' is a required RPM package</p>
<pre><code># rpm -e --test sysvinit-tools
error: Failed dependencies:
        sysvinit-tools is needed by (installed) insserv-compat-0.1-4.6.1.noarch
        sysvinit-tools is needed by (installed) openvpn-2.5.6-150400.3.3.1.x86_64
        /sbin/pidof is needed by (installed) xdm-1.1.11-150400.23.6.x86_64
</code></pre>
<p>so it seems your openSUSE Leap 15.4 installation<br />
is a very minimal (perhaps even a too minimal) installation?</p>
<p>For my tests on VMs I use small systems without desktop<br />
and I never had the issue that 'pidof' was missing.</p>
<p>But what I always do is to let the "recommended" packages<br />
be installed - i.e. what is specified in a spec file as</p>
<pre><code>Recommends: RPM_capability
</code></pre>
<p>because that avoids to get a system where things are missing<br />
that are "usually just there", e.g. on my Leap 15.4 system</p>
<pre><code># rpm -e --test vim
[no output]
</code></pre>
<p>'vi' is not required but nevertheless it is "just there".</p>
<p>In general:<br />
All explicit RPM dependencies are always a problem because<br />
every explicit RPM dependency requires manual maintenance<br />
which is likely different for different Linux distributions.<br />
Explicit RPM requirements cause trouble in particular because<br />
when one cannot be fulfilled the package cannot be installed and<br />
when one is missing the software in the package doesn't work and<br />
when one is not a real hard requirement some users complain<br />
that they cannot use the software in a minimal system and so on...</p>
<p>Offhandedly I don't know to generically specify in RPM<br />
that a program called 'pidof' is required.<br />
I guess</p>
<pre><code>Requires: pidof
</code></pre>
<p>won't work because (on my Leap 15.4 system)</p>
<pre><code># rpm -q --whatprovides pidof
no package provides pidof

# rpm -q --whatprovides bin/pidof
no package provides bin/pidof

# rpm -q --whatprovides /bin/pidof
sysvinit-tools-2.99-1.1.x86_64
</code></pre>
<p>so it seems I have to specify the program with full path<br />
but what /path/pidof is generic for all RPM based distributions?</p>
<pre><code># type -a pidof
pidof is /sbin/pidof
pidof is /bin/pidof

# file /sbin/pidof /bin/pidof
/sbin/pidof: symbolic link to killall5
/bin/pidof:  symbolic link to /sbin/killall5
</code></pre>
<p>As time permits I will try to find out<br />
if it is possible to generically specify in RPM<br />
that a program called 'sometool' is required.<br />
When this is possible (also for older RPM based distributions)<br />
we can add all REQUIRED_PROGS as such generic RPM 'Requires'<br />
and all in PROGS as such generic RPM 'Recommends'.</p>
<h4 id="jsmeix_commented_at_2023-02-13_1332"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2922#issuecomment-1427950310">2023-02-13 13:32</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-13_1332" title="Permanent link">&para;</a></h4>
<p>Regarding "a Leap 15.4 repo" see<br />
<a href="https://github.com/rear/rear/issues/2890#issuecomment-1323462648">https://github.com/rear/rear/issues/2890#issuecomment-1323462648</a></p>
<pre><code># osc results -v Archiving:Backup:Rear rear-2.7 | grep '15\.'
openSUSE_Leap_15.3   x86_64     succeeded
openSUSE_Leap_15.3   ppc64le    succeeded
15.4                 x86_64     succeeded
15.4                 ppc64le    succeeded

#  osc results -v Archiving rear | grep '15\.'
openSUSE_Leap_15.4   x86_64     succeeded
openSUSE_Leap_15.4   ppc64le    succeeded
</code></pre>
<p>The repository naming in OBS looks inconsistent.<br />
Perhaps there is some technical reason behind<br />
but this is in areas that I don't understand.</p>
<h4 id="schlomo_commented_at_2023-02-13_1345"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/2922#issuecomment-1427966914">2023-02-13 13:45</a>:<a class="headerlink" href="#schlomo_commented_at_2023-02-13_1345" title="Permanent link">&para;</a></h4>
<p>About the distro RPM repos, maybe all we need to do is update the list
at
<a href="https://relax-and-recover.org/download/">https://relax-and-recover.org/download/</a></p>
<p>I was using a Leap 15.4 "Minimal Server" installation to reduce the size
of the ReaR backup during testing. I'd suggest to always use the distro
minimal software selection for validation as that will help us to ensure
that ReaR will work on all "normal" installs, meaning installations that
use the distro installer with its default settings.</p>
<p>The reason I wanted to talk about this package - and I think this issue
should really only be about <code>pidof</code> and not about everything, is that it
seems like different RPM distros use different package names:</p>
<p><a href="https://rpmfind.net/linux/rpm2html/search.php?query=sysvinit-tools">https://rpmfind.net/linux/rpm2html/search.php?query=sysvinit-tools</a>
is for SUSE and CentOS 7 only<br />
<a href="https://rpmfind.net/linux/rpm2html/search.php?query=procps-ng">https://rpmfind.net/linux/rpm2html/search.php?query=procps-ng</a>
is for CentOS 8+, Fedora and others</p>
<p>Given that, can we now add it to our <code>rear.spec</code> and the respective
distro specific spec files? Given the fact that ReaR won't work without
<code>pidof</code> I'd think that this could be reason enough to make it a hard RPM
dependency.</p>
<p>I fully agree with you that we shouldn't have RPM/DEB dependencies on
optional ReaR functionality.</p>
<h4 id="jsmeix_commented_at_2023-02-13_1419"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2922#issuecomment-1428019158">2023-02-13 14:19</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-13_1419" title="Permanent link">&para;</a></h4>
<p>Regarding<br />
<a href="https://relax-and-recover.org/download/">https://relax-and-recover.org/download/</a><br />
see<br />
<a href="https://github.com/rear/rear.github.com/pull/16">https://github.com/rear/rear.github.com/pull/16</a></p>
<p>Regarding RPM requirements:</p>
<p>Let me find out if it is possible to generically specify in RPM<br />
that a program called 'sometool' is required.</p>
<p>I don't want to manually maintain individual RPM requirements<br />
for RPM package names or specific RPM capabilities that<br />
are likely different for different Linux distributions<br />
simply because I don't get paid for that (no SUSE customer<br />
ever reported an issue about that to me - I guess they help<br />
themselves when they use minimal systems - or perhaps<br />
SUSE support helps them and I won't notice that).</p>
<p>In the future RPM and such will go away anyway and<br />
we all will be happy in total containerized isolation ;-)</p>
<h4 id="schlomo_commented_at_2023-02-17_0815"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/2922#issuecomment-1434279299">2023-02-17 08:15</a>:<a class="headerlink" href="#schlomo_commented_at_2023-02-17_0815" title="Permanent link">&para;</a></h4>
<p>I had a bit more thought about this:</p>
<p>In the end, I'd like us to get to the point where a "zypper install
URL-TO-REAR-RPM" would lead to a ReaR installation that works. That
means that whatever programs are required for ReaR to run with the
included <strong>default</strong> configuration must be covered by the RPM
dependencies.</p>
<p>Same for the YUM and DEB ecosystems, of course.</p>
<p>And for that minimum requirements I don't want to rely on package
manager recommendations as we talk about the minimum required programs
for ReaR to run without an error. The motivation for investing our
efforts into this would be to give users a successful out-of-the-box
experience, where they install ReaR and try it out and then it must work
and not fail on a missing program.</p>
<p>But indeed this is only about the bare minimum for the default config
and I agree with you that users need to add required programs themselves
to cover their configuration changes, e.g. adding Rsync if they want to
do a backup via Rsync.</p>
<h4 id="jsmeix_commented_at_2023-02-17_0857"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2922#issuecomment-1434332507">2023-02-17 08:57</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-02-17_0857" title="Permanent link">&para;</a></h4>
<p>ReaR never gave users a successful out-of-the-box experience.<br />
My first trial with ReaR was a complete abysmal disaster.<br />
I never had a worse first impression with a program.<br />
Meanwhile ReaR works somewhat "sufficiently OK"<br />
for experienced users (in particular system admins)<br />
who know what they do and what "disaster recovery" means.<br />
A successful out-of-the-box user experience is far away,<br />
cf.
<a href="https://github.com/rear/rear/wiki/Developers-Guide">https://github.com/rear/rear/wiki/Developers-Guide</a><br />
Feel free to implement that - I do fully appreciate it.<br />
But I won't help because I don't get paid for that.</p>
<h4 id="schlomo_commented_at_2023-02-17_0946"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/2922#issuecomment-1434391230">2023-02-17 09:46</a>:<a class="headerlink" href="#schlomo_commented_at_2023-02-17_0946" title="Permanent link">&para;</a></h4>
<p>OK, fair enough. Is <code>packaging/rpm/rear.spec</code> still used to generate the
SUSE RPMs? Or do we have a different spec file in OBS? I don't mind
adding that dependency.</p>
<h4 id="github-actions_commented_at_2023-04-19_0222"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2922#issuecomment-1514041263">2023-04-19 02:22</a>:<a class="headerlink" href="#github-actions_commented_at_2023-04-19_0222" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2023-02-12.2922.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
