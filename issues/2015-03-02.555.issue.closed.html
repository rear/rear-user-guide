<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#555 Issue closed: ReaR Recover Issue - Unrecognized mount option, wrong fs type, bad option - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#555 Issue closed: ReaR Recover Issue - Unrecognized mount option, wrong fs type, bad option";
        var mkdocs_page_input_path = "issues/2015-03-02.555.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rsync.html">Internal Backup using BACKUP=RSYNC method</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#555 Issue closed: ReaR Recover Issue - Unrecognized mount option, wrong fs type, bad option</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="555_issue_closed_rear_recover_issue_-_unrecognized_mount_option_wrong_fs_type_bad_option"><a href="https://github.com/rear/rear/issues/555">#555 Issue</a> <code>closed</code>: ReaR Recover Issue - Unrecognized mount option, wrong fs type, bad option<a class="headerlink" href="#555_issue_closed_rear_recover_issue_-_unrecognized_mount_option_wrong_fs_type_bad_option" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code></p>
<h4 id="bbeaver_opened_issue_at_2015-03-02_0017"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> opened issue at <a href="https://github.com/rear/rear/issues/555">2015-03-02 00:17</a>:<a class="headerlink" href="#bbeaver_opened_issue_at_2015-03-02_0017" title="Permanent link">&para;</a></h4>
<p>Hi All:</p>
<p>Running current rear-1.16.1-1.git201502200825, and had both a Centos6.6
and RHEL6.5 box experience recover problems that had to be manually
corrected. Both had very similar problems, but with different invalid
options built within a mount command. My Centos6.6 box attempted a
'mount -o rw,relatime,barrier=1,data /dev/mapper/vg_centos02-LogVol00
/mnt/local/" command, and my RHEL6.5 box attempted a "mount -o
rw,relatime,barrier=1,strip /dev/mapper/vg00-LogVol00 /mnt/local/"
command. Both failed and had to be manually tweaked using the "Edit
restore script" option. In the Centos case, had to remove the "data"
option that had been added, in the case of RHEL had to remove the
"strip" option that had been added. How are these invalid mount options
landing in the restore script? Thanks for your help.</p>
<h4 id="gdha_commented_at_2015-03-02_0842"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76675492">2015-03-02 08:42</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-02_0842" title="Permanent link">&para;</a></h4>
<p>@bbeaver Could you attach the <code>disklayout.conf</code> file? There were recent
some changes in the script
<code>/usr/share/rear/layout/save/GNU/Linux/23_filesystem_layout.sh</code> - could
be related?</p>
<h4 id="bbeaver_commented_at_2015-03-02_1347"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76713715">2015-03-02 13:47</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-02_1347" title="Permanent link">&para;</a></h4>
<p>Yes, thanks - please see disklayout.conf below. You can see it was
created with an invalid "data" option within the mount_options:</p>
<pre><code>disk /dev/cciss/c0d0 587127480320 msdos
part /dev/cciss/c0d0 524288000 1048576 primary boot /dev/cciss/c0d0p1
part /dev/cciss/c0d0 565628108800 525336576 primary lvm /dev/cciss/c0d0p2
part /dev/cciss/c0d0 10485760000 566153445376 primary none /dev/cciss/c0d0p3
part /dev/cciss/c0d0 1024 576639205376 extended lba /dev/cciss/c0d0p4
part /dev/cciss/c0d0 10485760000 576641302528 logical lvm /dev/cciss/c0d0p5
lvmdev /dev/VG00 /dev/cciss/c0d0p5 DqSgVf-IPJs-lW6z-VMVQ-3sbO-AoH0-iMSBgL 20480000
lvmdev /dev/vg_centos02 /dev/cciss/c0d0p2 a4Cutt-6Gnv-eeVp-5mQC-32oV-p8Fk-5Nqj71 1104742400
lvmgrp /dev/VG00 4096 2499 10235904
lvmgrp /dev/vg_centos02 4096 134856 552370176
lvmvol /dev/VG00 LVTEST01 1280 10485760
lvmvol /dev/vg_centos02 LogVol01 8000 65536000
lvmvol /dev/vg_centos02 LogVol00 12500 102400000
lvmvol /dev/vg_centos02 LogVol02 114356 936804352
# Filesystems (only ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs are supported).
# Format: fs &lt;device&gt; &lt;mountpoint&gt; &lt;fstype&gt; [uuid=&lt;uuid&gt;] [label=&lt;label&gt;] [&lt;attributes&gt;]
fs /dev/cciss/c0d0p1 /boot ext4 uuid=964edbd0-3eb2-4caa-9704-3fca7540ba71 label= blocksize=1024 fragmentsize=1024 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=4063 default_mount_options=user_xattr,acl options=rw,relatime,barrier=1,data
fs /dev/drbd0 /home/test01 ext4 uuid=5eac3567-ad8d-48d6-b519-1276f20b4ad2 label= blocksize=4096 fragmentsize=4096 reserved_blocks=4% max_mounts=21 check_interval=180d bytes_per_inode=16383 options=rw,relatime,barrier=1,data
fs /dev/mapper/vg_centos02-LogVol00 / ext4 uuid=7f82e34c-b22b-4d09-b30e-f1010a3f4b80 label= blocksize=4096 fragmentsize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16304 default_mount_options=user_xattr,acl options=rw,relatime,barrier=1,data
fs /dev/mapper/vg_centos02-LogVol02 /home ext4 uuid=d70d94e8-30b2-4651-8648-6984e8a4e787 label= blocksize=4096 fragmentsize=4096 reserved_blocks=2% max_mounts=-1 check_interval=0d bytes_per_inode=16318 default_mount_options=user_xattr,acl options=rw,relatime,barrier=1,data
swap /dev/mapper/vg_centos02-LogVol01 uuid=6d15bf48-4298-488d-99a3-c698b4392570 label=
drbd /dev/drbd0 test01data /dev/mapper/VG00-LVTEST01
</code></pre>
<h4 id="gdha_commented_at_2015-03-02_1352"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76714417">2015-03-02 13:52</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-02_1352" title="Permanent link">&para;</a></h4>
<p>@bbeaver ok thanks - and could you also post the <code>mount</code> output?</p>
<h4 id="bbeaver_commented_at_2015-03-02_1442"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76722724">2015-03-02 14:42</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-02_1442" title="Permanent link">&para;</a></h4>
<p>Sure - plesae see mount output below:</p>
<h1 id="mount">mount<a class="headerlink" href="#mount" title="Permanent link">&para;</a></h1>
<p>/dev/mapper/vg_centos02-LogVol00 on / type ext4 (rw)<br />
proc on /proc type proc (rw)<br />
sysfs on /sys type sysfs (rw)<br />
devpts on /dev/pts type devpts (rw,gid=5,mode=620)<br />
tmpfs on /dev/shm type tmpfs (rw)<br />
/dev/cciss/c0d0p1 on /boot type ext4 (rw)<br />
/dev/mapper/vg_centos02-LogVol02 on /home type ext4 (rw)<br />
none on /proc/sys/fs/binfmt_misc type binfmt_misc (rw)<br />
/dev/drbd0 on /home/test01 type ext4 (rw)</p>
<h4 id="gdha_commented_at_2015-03-02_1547"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76735544">2015-03-02 15:47</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-02_1547" title="Permanent link">&para;</a></h4>
<pre><code># diff disklayout.conf disklayout.conf.old
11,16c11,14
&lt; # Filesystems (only ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs are supported).
&lt; # Format: fs &lt;device&gt; &lt;mountpoint&gt; &lt;fstype&gt; [uuid=&lt;uuid&gt;] [label=&lt;label&gt;] [&lt;attributes&gt;]
&lt; fs /dev/mapper/vg_noc-lv_home /home ext4 uuid=42fc2968-51b8-4f0a-89a0-f4faeffe72c2 label= blocksize=4096 fragmentsize=4096 reserved_blocks=4% max_mounts=-1 check_interval=0d bytes_per_inode=16377 default_mount_options=user_xattr,acl options=rw,relatime,barrier=1,data=ordered
&lt; fs /dev/mapper/vg_noc-lv_root / ext4 uuid=9dcfc861-9895-4456-89cd-8aab887900f8 label= blocksize=4096 fragmentsize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16384 default_mount_options=user_xattr,acl options=rw,relatime,barrier=1,data=ordered
&lt; fs /dev/sda1 /boot ext4 uuid=8bfe951c-ad1c-464a-86a6-72f65f3833f4 label= blocksize=1024 fragmentsize=1024 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=4095 default_mount_options=user_xattr,acl options=rw,relatime,barrier=1,data=ordered
---
&gt; fs /dev/mapper/vg_noc-lv_root / ext4 uuid=9dcfc861-9895-4456-89cd-8aab887900f8 label= blocksize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16384 default_mount_options=user_xattr,acl options=rw
&gt; fs /dev/sda1 /boot ext4 uuid=8bfe951c-ad1c-464a-86a6-72f65f3833f4 label= blocksize=1024 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=4095 default_mount_options=user_xattr,acl options=rw
&gt; fs /dev/mapper/vg_noc-lv_home /home ext4 uuid=42fc2968-51b8-4f0a-89a0-f4faeffe72c2 label= blocksize=4096 reserved_blocks=4% max_mounts=-1 check_interval=0d bytes_per_inode=16377 default_mount_options=user_xattr,acl options=rw
</code></pre>
<p>The difference is coming from:</p>
<pre><code>/bin/findmnt -alnv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs
</code></pre>
<p>before applying the patch of @jsmeix we just used <code>mount</code></p>
<p>Alright, between <code>rw</code> and <code>rw,relatime,seclabel,barrier=1,data=ordered</code>
- what should be keep (rw), but what about the rest?</p>
<h4 id="bbeaver_commented_at_2015-03-02_1607"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76739907">2015-03-02 16:07</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-02_1607" title="Permanent link">&para;</a></h4>
<p>I manually edited the restore script in both my cases where rear recover
failed. On the CentOS box related to the info above, I changed the mount
command from:</p>
<p>"mount -o rw,relatime,barrier=1,data /dev/mapper/vg_centos02-LogVol00
/mnt/local/"</p>
<p>to:</p>
<p>"mount -o rw,relatime,barrier=1 /dev/mapper/vg_centos02-LogVol00
/mnt/local/"</p>
<p>On the RHEL system, I basically did the same thing, but removed a
"strip" option instead of the "data" option. After doing this, I chose
to continue the recovery, and it succeeded.</p>
<h4 id="jsmeix_commented_at_2015-03-03_1115"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76927453">2015-03-03 11:15</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-03_1115" title="Permanent link">&para;</a></h4>
<p>@bbeaver</p>
<p>What are the exact outputs for your CentOS6.6 and RHEL6.5 systems for
each of the commands</p>
<pre>
findmnt -alnv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs
</pre>

<p>versus</p>
<pre>
mount -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs
</pre>

<h4 id="jsmeix_commented_at_2015-03-03_1123"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76928417">2015-03-03 11:23</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-03_1123" title="Permanent link">&para;</a></h4>
<p>@gdha</p>
<p>at a first glange I currenly guess that the findmnt output that results
entries like</p>
<pre>
fs  ...  options=rw,relatime,barrier=1,data=ordered
</pre>

<p>is probably correct but I guess some other script might fail to
correctly process that kind of options value (in particular options of
the form keyword=value)?</p>
<p>I guess this because bbeaver reported</p>
<pre>
mount -o rw,relatime,barrier=1,data /dev/...
</pre>

<p>which shows that the mount options have been clipped at the last '='.</p>
<p>I assume with the whole mount options as reported by findmnt</p>
<pre>
mount -o rw,relatime,barrier=1,data=ordered /dev/...
</pre>

<p>mounting would have worked.</p>
<h4 id="jsmeix_commented_at_2015-03-03_1144"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76931165">2015-03-03 11:44</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-03_1144" title="Permanent link">&para;</a></h4>
<p>Phew!<br />
It seems this issue here is only about fstype "ext4" which means it
should not be caused by my new btrfs code :-)</p>
<h4 id="jsmeix_commented_at_2015-03-03_1152"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76932069">2015-03-03 11:52</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-03_1152" title="Permanent link">&para;</a></h4>
<p>I think in 13_include_mount_filesystem_code.sh the following is
wrong:</p>
<pre>
    # Extract mount options.
    local option mountopts
    for option in $options ; do
        name=${option%%=*}     # options can contain more '=' signs
        value=${option#*=}
</pre>

<p>because:</p>
<pre>
$ options=rw,relatime,barrier=1,data=ordered ; echo $options ; for option in $options ; do name=${option%%=*} ; value=${option#*=} ; echo name=$name value=$value ; done
</pre>

<p>outputs</p>
<pre>
rw,relatime,barrier=1,data=ordered
name=rw,relatime,barrier value=1,data=ordered
</pre>

<h4 id="bbeaver_commented_at_2015-03-03_1315"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76942938">2015-03-03 13:15</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-03_1315" title="Permanent link">&para;</a></h4>
<p>Gdha is exactly right, the "=" is getting clipped out. Here is the
output from findmnt and mount:</p>
<p>[root@centos02]]# findmnt -alnv -o SOURCE,TARGET,FSTYPE,OPTIONS -t
ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs<br />
/dev/mapper/vg_centos02-LogVol00 / ext4
rw,relatime,barrier=1,data=ordered<br />
/dev/cciss/c0d0p1 /boot ext4 rw,relatime,barrier=1,data=ordered<br />
/dev/mapper/vg_centos02-LogVol02 /home ext4
rw,relatime,barrier=1,data=ordered<br />
/dev/drbd0 /home/test01 ext4 rw,relatime,barrier=1,data=ordered</p>
<p>[root@centos02]# mount -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs<br />
/dev/mapper/vg_centos02-LogVol00 on / type ext4 (rw)<br />
/dev/cciss/c0d0p1 on /boot type ext4 (rw)<br />
/dev/mapper/vg_centos02-LogVol02 on /home type ext4 (rw)<br />
/dev/drbd0 on /home/test01 type ext4 (rw)</p>
<h4 id="jsmeix_commented_at_2015-03-03_1332"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76945334">2015-03-03 13:32</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-03_1332" title="Permanent link">&para;</a></h4>
<p>My previous comment is wrong because the options entry is not</p>
<pre>
rw,relatime,barrier=1,data=ordered
</pre>

<p>but instead it is</p>
<pre>
options=rw,relatime,barrier=1,data=ordered
</pre>

<p>and with the latter it works because</p>
<pre>
$ options="options=rw,relatime,barrier=1,data=ordered" ; echo $options ; for option in $options ; do name=${option%%=*} ; value=${option#*=} ; echo name=$name value=$value ; done
</pre>

<p>outputs</p>
<pre>
options=rw,relatime,barrier=1,data=ordered
name=options value=rw,relatime,barrier=1,data=ordered
</pre>

<p>Somewhere else it happens that the mount options are clipped at the last
'='.</p>
<h4 id="gdha_commented_at_2015-03-03_1444"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76957876">2015-03-03 14:44</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-03_1444" title="Permanent link">&para;</a></h4>
<p>@bbeaver @jsmeix I think problem is not the code but the length of the
output. In bbeaver example I counted 274 characters before it was cut
off. Could be wrong of course, but it looks we also need to investigate
this path</p>
<h4 id="gdha_commented_at_2015-03-03_1450"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76958886">2015-03-03 14:50</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-03_1450" title="Permanent link">&para;</a></h4>
<p>@bbeaver could you run <code>rear -vD savelayout</code> and check the code around
the line <code>fs /dev/mapper/vg_centos02-LogVol02 /home</code>?<br />
Please paste only that part as we should be able to see what happens
with the line (being truncated or what).</p>
<h4 id="bbeaver_commented_at_2015-03-03_1502"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76961272">2015-03-03 15:02</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-03_1502" title="Permanent link">&para;</a></h4>
<p>The "savelayout" shows proper mount options, but running "mkbackup" does
not, and cuts off the string.</p>
<p>Here's the output, First, run "rear -vD savelayout" and check
disklayout.conf:</p>
<pre><code>[root@centos02] # cat /var/lib/rear/layout/disklayout.conf
disk /dev/cciss/c0d0 587127480320 msdos
part /dev/cciss/c0d0 524288000 1048576 primary boot /dev/cciss/c0d0p1
part /dev/cciss/c0d0 565628108800 525336576 primary lvm /dev/cciss/c0d0p2
part /dev/cciss/c0d0 10485760000 566153445376 primary none /dev/cciss/c0d0p3
part /dev/cciss/c0d0 1024 576639205376 extended lba /dev/cciss/c0d0p4
part /dev/cciss/c0d0 10485760000 576641302528 logical lvm /dev/cciss/c0d0p5
lvmdev /dev/VG00 /dev/cciss/c0d0p5 DqSgVf-IPJs-lW6z-VMVQ-3sbO-AoH0-iMSBgL 20480000
lvmdev /dev/vg_centos02 /dev/cciss/c0d0p2 a4Cutt-6Gnv-eeVp-5mQC-32oV-p8Fk-5Nqj71 1104742400
lvmgrp /dev/VG00 4096 2499 10235904
lvmgrp /dev/vg_centos02 4096 134856 552370176
lvmvol /dev/VG00 LVTEST01 1280 10485760
lvmvol /dev/vg_centos02 LogVol01 8000 65536000
lvmvol /dev/vg_centos02 LogVol00 12500 102400000
lvmvol /dev/vg_centos02 LogVol02 114356 936804352
# Filesystems (only ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs are supported).
# Format: fs &lt;device&gt; &lt;mountpoint&gt; &lt;fstype&gt; [uuid=&lt;uuid&gt;] [label=&lt;label&gt;] [&lt;attributes&gt;]
fs /dev/cciss/c0d0p1 /boot ext4 uuid=964edbd0-3eb2-4caa-9704-3fca7540ba71 label= blocksize=1024 fragmentsize=1024 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=4047 default_mount_options=user_xattr,acl options=rw,relatime,barrier=1,data=ordered
fs /dev/drbd0 /home/test01 ext4 uuid=5eac3567-ad8d-48d6-b519-1276f20b4ad2 label= blocksize=4096 fragmentsize=4096 reserved_blocks=3% max_mounts=21 check_interval=180d bytes_per_inode=16351 options=rw,relatime,barrier=1,data=ordered
fs /dev/mapper/vg_centos02-LogVol00 / ext4 uuid=7f82e34c-b22b-4d09-b30e-f1010a3f4b80 label= blocksize=4096 fragmentsize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16272 default_mount_options=user_xattr,acl options=rw,relatime,barrier=1,data=ordered
fs /dev/mapper/vg_centos02-LogVol02 /home ext4 uuid=d70d94e8-30b2-4651-8648-6984e8a4e787 label= blocksize=4096 fragmentsize=4096 reserved_blocks=1% max_mounts=-1 check_interval=0d bytes_per_inode=16286 default_mount_options=user_xattr,acl options=rw,relatime,barrier=1,data=ordered
swap /dev/mapper/vg_centos02-LogVol01 uuid=6d15bf48-4298-488d-99a3-c698b4392570 label=
drbd /dev/drbd0 testdata01 /dev/mapper/VG00-LVTEST01
</code></pre>
<p>Then, run "rear -v mkbackup" and check disklayout.conf:</p>
<pre><code>[root@centos02] # cat disklayout.conf
disk /dev/cciss/c0d0 587127480320 msdos
part /dev/cciss/c0d0 524288000 1048576 primary boot /dev/cciss/c0d0p1
part /dev/cciss/c0d0 565628108800 525336576 primary lvm /dev/cciss/c0d0p2
part /dev/cciss/c0d0 10485760000 566153445376 primary none /dev/cciss/c0d0p3
part /dev/cciss/c0d0 1024 576639205376 extended lba /dev/cciss/c0d0p4
part /dev/cciss/c0d0 10485760000 576641302528 logical lvm /dev/cciss/c0d0p5
lvmdev /dev/VG00 /dev/cciss/c0d0p5 DqSgVf-IPJs-lW6z-VMVQ-3sbO-AoH0-iMSBgL 20480000
lvmdev /dev/vg_centos02 /dev/cciss/c0d0p2 a4Cutt-6Gnv-eeVp-5mQC-32oV-p8Fk-5Nqj71 1104742400
lvmgrp /dev/VG00 4096 2499 10235904
lvmgrp /dev/vg_centos02 4096 134856 552370176
lvmvol /dev/VG00 LVTEST01 1280 10485760
lvmvol /dev/vg_centos02 LogVol01 8000 65536000
lvmvol /dev/vg_centos02 LogVol00 12500 102400000
lvmvol /dev/vg_centos02 LogVol02 114356 936804352
# Filesystems (only ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs are supported).
# Format: fs &lt;device&gt; &lt;mountpoint&gt; &lt;fstype&gt; [uuid=&lt;uuid&gt;] [label=&lt;label&gt;] [&lt;attributes&gt;]
fs /dev/cciss/c0d0p1 /boot ext4 uuid=964edbd0-3eb2-4caa-9704-3fca7540ba71 label= blocksize=1024 fragmentsize=1024 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=4047 default_mount_options=user_xattr,acl options=rw,relatime,barrier=1,data
fs /dev/drbd0 /home/test01 ext4 uuid=5eac3567-ad8d-48d6-b519-1276f20b4ad2 label= blocksize=4096 fragmentsize=4096 reserved_blocks=3% max_mounts=21 check_interval=180d bytes_per_inode=16351 options=rw,relatime,barrier=1,data
fs /dev/mapper/vg_centos02-LogVol00 / ext4 uuid=7f82e34c-b22b-4d09-b30e-f1010a3f4b80 label= blocksize=4096 fragmentsize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16272 default_mount_options=user_xattr,acl options=rw,relatime,barrier=1,data
fs /dev/mapper/vg_centos02-LogVol02 /home ext4 uuid=d70d94e8-30b2-4651-8648-6984e8a4e787 label= blocksize=4096 fragmentsize=4096 reserved_blocks=1% max_mounts=-1 check_interval=0d bytes_per_inode=16286 default_mount_options=user_xattr,acl options=rw,relatime,barrier=1,data
swap /dev/mapper/vg_centos02-LogVol01 uuid=6d15bf48-4298-488d-99a3-c698b4392570 label=
drbd /dev/drbd0 testdata01 /dev/mapper/VG00-LVTEST01
</code></pre>
<h4 id="gdha_commented_at_2015-03-03_1524"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76965782">2015-03-03 15:24</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-03_1524" title="Permanent link">&para;</a></h4>
<p>@bbeaver that is interesting, but I don't get it as the disklayout.conf
file is written only once (during the savelayout workflow)<br />
Could you add the <em>rear.log</em> file when you run <code>rear -vD mkbackup</code> as a
gist?</p>
<h4 id="bbeaver_commented_at_2015-03-03_1535"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76968033">2015-03-03 15:35</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-03_1535" title="Permanent link">&para;</a></h4>
<p>The dksklayout.conf file definitely gets updated when running the "rear
mkbackup" command. Please see below. Anything specific you are wanting
to see from the rear.log? Thanks for your help</p>
<p>[root@centos02 tmp]# ls -ltr /var/lib/rear/layout<br />
total 20<br />
drwxr-xr-x 2 root root 4096 Jan 11 13:03 config<br />
-rw-r--r-- 1 root root 2188 Mar 3 09:53 disklayout.conf<br />
-rw-r--r-- 1 root root 598 Mar 3 09:53 disktodo.conf<br />
-rw-r--r-- 1 root root 824 Mar 3 09:53 diskdeps.conf<br />
drwxr-xr-x 2 root root 4096 Mar 3 09:53 lvm</p>
<p>[root@centos02 tmp]# date<br />
Tue Mar 3 10:29:21 EST 2015</p>
<p>root@centos02 tmp]# nohup rear -vD mkbackup &amp;</p>
<p>[root@centos02 tmp]# ls -ltr /var/lib/rear/layout<br />
total 20<br />
drwxr-xr-x 2 root root 4096 Jan 11 13:03 config<br />
-rw-r--r-- 1 root root 2188 Mar 3 10:29 disklayout.conf<br />
-rw-r--r-- 1 root root 598 Mar 3 10:29 disktodo.conf<br />
-rw-r--r-- 1 root root 824 Mar 3 10:29 diskdeps.conf<br />
drwxr-xr-x 2 root root 4096 Mar 3 10:29 lvm</p>
<h4 id="gdha_commented_at_2015-03-03_1555"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76972294">2015-03-03 15:55</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-03_1555" title="Permanent link">&para;</a></h4>
<p>@bbeaver that is normal as <code>sudo rear -s mkbackup</code> will tell you that
script <code>layout/save/GNU/Linux/23_filesystem_layout.sh</code> will get sourced.
To verify type: <code>sudo rear -s savelayout</code>.<br />
I still would like to get the full debugging output - thanks.</p>
<h4 id="bbeaver_commented_at_2015-03-03_1728"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76992210">2015-03-03 17:28</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-03_1728" title="Permanent link">&para;</a></h4>
<p>Sure - looking to see how I upload the file...</p>
<h4 id="bbeaver_commented_at_2015-03-03_1734"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-76993514">2015-03-03 17:34</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-03_1734" title="Permanent link">&para;</a></h4>
<p>Please see if this gets you there - full rear-centos02.log debug:</p>
<p><a href="https://gist.github.com/bbeaver/f736f9e80c3bd0b04017">https://gist.github.com/bbeaver/f736f9e80c3bd0b04017</a></p>
<h4 id="gdha_commented_at_2015-03-03_1924"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77015214">2015-03-03 19:24</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-03_1924" title="Permanent link">&para;</a></h4>
<p>@bbeaver thanks for the logging:</p>
<pre><code>+ . /usr/share/rear/layout/save/GNU/Linux/23_filesystem_layout.sh
++ Log 'Begin saving filesystem layout'
....
+++ tune2fs -l /dev/cciss/c0d0p1
+++ grep -i 'Default mount options:'
+++ cut -d : -f 2
+++ awk '{$1=$1};1'
+++ grep -v none
+++ tr ' ' ,
++ default_mount_options=user_xattr,acl
++ [[ -n user_xattr,acl ]]
++ echo -n ' default_mount_options=user_xattr,acl'
++ options=rw,relatime,barrier=1,data
++ options=rw,relatime,barrier=1,data
++ options=rw,relatime,barrier=1,data
++ echo -n ' options=rw,relatime,barrier=1,data'
</code></pre>
<p>I'll dig into the code tomorrow and see what it is causing it.</p>
<h4 id="jsmeix_commented_at_2015-03-04_0906"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77120276">2015-03-04 09:06</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-04_0906" title="Permanent link">&para;</a></h4>
<p>At
<a href="https://github.com/rear/rear/issues/545">https://github.com/rear/rear/issues/545</a>
I found</p>
<pre>
OS_VENDOR=RedHatEnterpriseServer
OS_VERSION=6.4
</pre>

<p>and</p>
<pre>
+++ mount -o rw,relatime,seclabel,barrier=1,dat /dev/mapper/vg_lsrs0vio-lv_root /mnt/local/
mount: wrong fs type, bad option, bad superblock on /dev/mapper/vg_lsrs0vio-lv_root,
</pre>

<p>It is the same issue there:<br />
There the mount options are cut at "...dat".</p>
<p>Because there it is cut in between the "data=ordered" (and not at the
'=' character) it now seems there is really some obscure length limit
somewhere.</p>
<p>But if it is a length limit it is not a fixed length limit.</p>
<p>Very strange.</p>
<h4 id="gdha_commented_at_2015-03-04_1418"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77164895">2015-03-04 14:18</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-04_1418" title="Permanent link">&para;</a></h4>
<p>@bbeaver @jsmeix I noticed it happens on centos 6.6 at random - let's
say 1/10 it is bad and 9/10 it is ok - makes it even worse to debug</p>
<h4 id="jsmeix_commented_at_2015-03-04_1425"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77166193">2015-03-04 14:25</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-04_1425" title="Permanent link">&para;</a></h4>
<p>@gdha</p>
<p>do the 1/10 bad happen also with "rear savelayout" or do the 1/10 bad
happen only with "rear mkbackup"?</p>
<h4 id="bbeaver_commented_at_2015-03-04_1428"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77166582">2015-03-04 14:28</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-04_1428" title="Permanent link">&para;</a></h4>
<p>I'm seeing RedHat/Fedora/CentOS servers behave the same with this issue.
Not too surprising, since these distros are all RedHat based.</p>
<h4 id="jsmeix_commented_at_2015-03-04_1438"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77168381">2015-03-04 14:38</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-04_1438" title="Permanent link">&para;</a></h4>
<p>Only a blind guess:</p>
<p>Perhaps it is not rear that sometimes cuts the mount options.</p>
<p>Perhaps it is the findmnt command itself that sometimes reports clipped
mount options?</p>
<p>On my SLES12 system "man findmnt" reads in particular:</p>
<pre>
-u, --notruncate
Do not truncate text in columns. The default is to not truncate
the TARGET, SOURCE, UUID, LABEL, PARTUUID, PARTLABEL
columns. This option disables text truncation also in all other columns.
</pre>

<p>and 23_filesystem_layout.sh contains</p>
<pre>
read_filesystems_command="$findmnt_command -alnv -o SOURCE,TARGET,FSTYPE,OPTIONS ...
</pre>

<p>wich means without '-u' the FSTYPE and OPTIONS could be truncated.</p>
<h4 id="bbeaver_commented_at_2015-03-04_1443"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77169321">2015-03-04 14:43</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-04_1443" title="Permanent link">&para;</a></h4>
<p>That might explain why I just started seeing this issue recently. A few
months ago I had not come accross this problem. I understand that ReaR
recently changed from using "mount" to using "findmnt". If there are
problems with "findmnt", then ReaR is just now seeing those issues.</p>
<h4 id="jsmeix_commented_at_2015-03-04_1446"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77169842">2015-03-04 14:46</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-04_1446" title="Permanent link">&para;</a></h4>
<p>@bbeaver</p>
<p>try if it helps to replace in
usr/share/rear/layout/save/GNU/Linux/23_filesystem_layout.sh</p>
<pre>
read_filesystems_command="$findmnt_command -alnv -o ...
</pre>

<p>with</p>
<pre>
read_filesystems_command="$findmnt_command -alnuv -o ...
</pre>

<h4 id="gdha_commented_at_2015-03-04_1454"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77171460">2015-03-04 14:54</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-04_1454" title="Permanent link">&para;</a></h4>
<p>@bbeaver @jsmeix savelayout is sourced by mkbackup so it is running all
the time (overwriting the existing <code>disklayout.conf</code> file)</p>
<h4 id="gdha_commented_at_2015-03-04_1516"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77175752">2015-03-04 15:16</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-04_1516" title="Permanent link">&para;</a></h4>
<p>I think that @jsmeix is right - it has to do with <code>findmnt</code> command
itself and in particular on older RHEL based OSes (5,6)</p>
<h4 id="schlomo_commented_at_2015-03-04_1617"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77188692">2015-03-04 16:17</a>:<a class="headerlink" href="#schlomo_commented_at_2015-03-04_1617" title="Permanent link">&para;</a></h4>
<p>findmnt supports -u (--notruncate) also on RHEL6, I don't have RHEL5
to<br />
check.</p>
<p>Without running my own tests I wold place my bets on the -u option :-)</p>
<p>On 4 March 2015 at 16:16, gdha <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a> wrote:</p>
<blockquote>
<p>I think that @jsmeix
<a href="https://github.com/jsmeix">https://github.com/jsmeix</a> is right - it
has to do<br />
with findmnt command itself and in particular on older RHEL based
OSes<br />
(5,6)</p>
<p>—<br />
Reply to this email directly or view it on GitHub<br />
<a href="https://github.com/rear/rear/issues/555#issuecomment-77175752">https://github.com/rear/rear/issues/555#issuecomment-77175752</a>.</p>
</blockquote>
<h4 id="bbeaver_commented_at_2015-03-04_1626"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77190576">2015-03-04 16:26</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-04_1626" title="Permanent link">&para;</a></h4>
<p>I just added the "-u" option, such that 23_filesystem_layout.sh now
looks like:</p>
<p>read_filesystems_command="$findmnt_command -alnuv -o ...</p>
<p>I've not tried tested a ReaR recovery, but, appears good now. The
/var/lib/rear/layout/disklayout.conf file now shows "data=ordered"
instead of "data" at the end of the fs options line.</p>
<h4 id="schlomo_commented_at_2015-03-04_1630"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77191547">2015-03-04 16:30</a>:<a class="headerlink" href="#schlomo_commented_at_2015-03-04_1630" title="Permanent link">&para;</a></h4>
<p>I guess somebody should try to find out if RHEL5 supports that as
well.<br />
Otherwise we would have to discontinue RHEL5 support now??</p>
<p>On 4 March 2015 at 17:26, bbeaver <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a> wrote:</p>
<blockquote>
<p>I just added the "-u" option, such that 23_filesystem_layout.sh now
looks<br />
like:</p>
<p>read_filesystems_command="$findmnt_command -alnuv -o ...</p>
<p>I've not tried tested a ReaR recovery, but, appears good now. The<br />
/var/lib/rear/layout/disklayout.conf file now shows "data=ordered"
instead<br />
of "data" at the end of the fs options line.</p>
<p>—<br />
Reply to this email directly or view it on GitHub<br />
<a href="https://github.com/rear/rear/issues/555#issuecomment-77190576">https://github.com/rear/rear/issues/555#issuecomment-77190576</a>.</p>
</blockquote>
<h4 id="bbeaver_commented_at_2015-03-04_1709"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77200022">2015-03-04 17:09</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-04_1709" title="Permanent link">&para;</a></h4>
<p>I'll hunt around and see if I can dig up a RHEL5 or Fedora equivalent
box, check the findmnt options, and report back.</p>
<h4 id="bbeaver_commented_at_2015-03-04_1725"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77203214">2015-03-04 17:25</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-04_1725" title="Permanent link">&para;</a></h4>
<p>I've made it back as far as Fedora 14, (which supports findmnt), but
don't have easy access to a box with an older rhel5'ish o/s. I will
continue looking though.</p>
<p>In the meantime, will this "-u" option to the findmnt command be added
to the latest rear code?</p>
<h4 id="bbeaver_commented_at_2015-03-04_1845"><img src="https://avatars.githubusercontent.com/u/7350825?u=2ec61633eda874b17db7b1eb383363444e6064d6&v=4" width="50"><a href="https://github.com/bbeaver">bbeaver</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77218989">2015-03-04 18:45</a>:<a class="headerlink" href="#bbeaver_commented_at_2015-03-04_1845" title="Permanent link">&para;</a></h4>
<p>Thank you much for your help and quick response</p>
<h4 id="jsmeix_commented_at_2015-03-05_1048"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77343473">2015-03-05 10:48</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1048" title="Permanent link">&para;</a></h4>
<p>On RHEL 5.1 there is no findmnt command (at least not by default):</p>
<pre>
# cat /etc/redhat-release
Red Hat Enterprise Linux Server release 5.1 (Tikanga)
# findmnt -alnv -o SOURCE,TARGET,FSTYPE,OPTIONS
-bash: findmnt: command not found
# type -a findmnt
-bash: type: findmnt: not found
</pre>

<p>In this case rear falls back using "mount" in 23_filesystem_layout.sh
as follows:</p>
<pre>
# mount -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs | tr -s '[:blank:]' ' ' | cut -d ' ' -f 1,3,5,6
/dev/mapper/VolGroup00-LogVol00 / ext3 (rw)
/dev/hda1 /boot ext3 (rw)
</pre>

<h4 id="schlomo_commented_at_2015-03-05_1054"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77344210">2015-03-05 10:54</a>:<a class="headerlink" href="#schlomo_commented_at_2015-03-05_1054" title="Permanent link">&para;</a></h4>
<p>The we should probably use this fallback code for all cases where<br />
"findmount -u" will not work.</p>
<p>Are there any downsides to using mount instead of findmount? If yes,
then<br />
we should warn the user about them, e..g</p>
<p>WARNING: On your system ReaR cannot determine XYZ because findmnt is
not<br />
available.</p>
<p>On 5 March 2015 at 11:48, Johannes Meixner <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a>
wrote:</p>
<blockquote>
<p>On RHEL 5.1 there is no findmnt command (at least not by default):</p>
<h1 id="cat_etcredhat-release">cat /etc/redhat-release<a class="headerlink" href="#cat_etcredhat-release" title="Permanent link">&para;</a></h1>
<p>Red Hat Enterprise Linux Server release 5.1 (Tikanga)</p>
<h1 id="findmnt_-alnv_-o_sourcetargetfstypeoptions">findmnt -alnv -o SOURCE,TARGET,FSTYPE,OPTIONS<a class="headerlink" href="#findmnt_-alnv_-o_sourcetargetfstypeoptions" title="Permanent link">&para;</a></h1>
<p>-bash: findmnt: command not found</p>
<h1 id="type_-a_findmnt">type -a findmnt<a class="headerlink" href="#type_-a_findmnt" title="Permanent link">&para;</a></h1>
<p>-bash: type: findmnt: not found</p>
<p>In this case rear falls back using "mount" in
23_filesystem_layout.sh as<br />
folows:</p>
<h1 id="mount_-t_ext2ext3ext4vfatxfsreiserfsbtrfs_tr_-s_blank_cut_-d_-f_1356">mount -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs | tr -s '[:blank:]' ' ' | cut -d ' ' -f 1,3,5,6<a class="headerlink" href="#mount_-t_ext2ext3ext4vfatxfsreiserfsbtrfs_tr_-s_blank_cut_-d_-f_1356" title="Permanent link">&para;</a></h1>
<p>/dev/mapper/VolGroup00-LogVol00 / ext3 (rw)<br />
/dev/hda1 /boot ext3 (rw)</p>
<p>—<br />
Reply to this email directly or view it on GitHub<br />
<a href="https://github.com/rear/rear/issues/555#issuecomment-77343473">https://github.com/rear/rear/issues/555#issuecomment-77343473</a>.</p>
</blockquote>
<h4 id="jsmeix_commented_at_2015-03-05_1108"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77346125">2015-03-05 11:08</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1108" title="Permanent link">&para;</a></h4>
<p>One downside to using mount instead of findmount is documented in
23_filesystem_layout.sh:</p>
<pre>
# If the findmnt command is available use it instead of the traditional mount command
# because (since SLE12) "man 8 mount" reads:
#   The listing mode is maintained for backward compatibility only.
#   For more robust and customizable output use findmnt(8), especially in your scripts.
</pre>

<p>Another downside seems to be shown here in this issue:<br />
findmnt reports more mount options compared to mount which means with
findmnt rear could recreate the system more exactly as it was
originally.</p>
<p>Finally findmnt is basically required for btrfs subvolumes to get the
mounted btrfs subvolume path (i.e. the subvolume name), see "Mounted
btrfs subvolumes" in 23_filesystem_layout.sh - if findmnt is not
available it falls back using awkward hacks to determine the mounted
btrfs subvolume path.</p>
<p>In practice I think on old systems without findmnt there will be no
btrfs used and then the old systems get recreated as all the time before
by plain "mount".</p>
<h4 id="jsmeix_commented_at_2015-03-05_1131"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77348964">2015-03-05 11:31</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1131" title="Permanent link">&para;</a></h4>
<p>On RHEL 5.9 it is (at least by default) the same as on RHEL 5.1:</p>
<pre>
# cat /etc/redhat-release
Red Hat Enterprise Linux Server release 5.9 (Tikanga)
# findmnt -alnv -o SOURCE,TARGET,FSTYPE,OPTIONS
-bash: findmnt: command not found
# type -a findmnt
-bash: type: findmnt: not found
# mount -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs | tr -s '[:blank:]' ' ' | cut -d ' ' -f 1,3,5,6
/dev/mapper/VolGroup00-LogVol00 / ext3 (rw)
/dev/hda1 /boot ext3 (rw)
</pre>

<h4 id="schlomo_commented_at_2015-03-05_1133"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77349210">2015-03-05 11:33</a>:<a class="headerlink" href="#schlomo_commented_at_2015-03-05_1133" title="Permanent link">&para;</a></h4>
<p>I guess systems without findmnt won't notice much difference then?</p>
<p>On 5 March 2015 at 12:31, Johannes Meixner <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a>
wrote:</p>
<blockquote>
<p>On RHEL 5.9 it is (at least by default) the same as on RHEL 5.1:</p>
<h1 id="cat_etcredhat-release_1">cat /etc/redhat-release<a class="headerlink" href="#cat_etcredhat-release_1" title="Permanent link">&para;</a></h1>
<p>Red Hat Enterprise Linux Server release 5.9 (Tikanga)</p>
<h1 id="findmnt_-alnv_-o_sourcetargetfstypeoptions_1">findmnt -alnv -o SOURCE,TARGET,FSTYPE,OPTIONS<a class="headerlink" href="#findmnt_-alnv_-o_sourcetargetfstypeoptions_1" title="Permanent link">&para;</a></h1>
<p>-bash: findmnt: command not found</p>
<h1 id="type_-a_findmnt_1">type -a findmnt<a class="headerlink" href="#type_-a_findmnt_1" title="Permanent link">&para;</a></h1>
<p>-bash: type: findmnt: not found</p>
<h1 id="mount_-t_ext2ext3ext4vfatxfsreiserfsbtrfs_tr_-s_blank_cut_-d_-f_1357">mount -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs | tr -s '[:blank:]' ' ' | cut -d ' ' -f 1,3,5,6<a class="headerlink" href="#mount_-t_ext2ext3ext4vfatxfsreiserfsbtrfs_tr_-s_blank_cut_-d_-f_1357" title="Permanent link">&para;</a></h1>
<p>/dev/mapper/VolGroup00-LogVol00 / ext3 (rw)<br />
/dev/hda1 /boot ext3 (rw)</p>
<p>—<br />
Reply to this email directly or view it on GitHub<br />
<a href="https://github.com/rear/rear/issues/555#issuecomment-77348964">https://github.com/rear/rear/issues/555#issuecomment-77348964</a>.</p>
</blockquote>
<h4 id="jsmeix_commented_at_2015-03-05_1141"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77350188">2015-03-05 11:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1141" title="Permanent link">&para;</a></h4>
<p>I did my changes in 23_filesystem_layout.sh so that on systems without
findmnt everything should work as before.</p>
<p>But on systems with findmnt it now uses findmnt and then issues like
this one appear.</p>
<h4 id="schlomo_commented_at_2015-03-05_1145"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77350637">2015-03-05 11:45</a>:<a class="headerlink" href="#schlomo_commented_at_2015-03-05_1145" title="Permanent link">&para;</a></h4>
<p>That is why I suggest that we use findmnt only if it supports the -u
option.</p>
<p>On 5 March 2015 at 12:41, Johannes Meixner <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a>
wrote:</p>
<blockquote>
<p>I did my changes in 23_filesystem_layout.sh so that on systems
without<br />
findmnt everything should work as before.</p>
<p>But on systems with findmnt it now uses findmnt and then issues like
this<br />
one appear.</p>
<p>—<br />
Reply to this email directly or view it on GitHub<br />
<a href="https://github.com/rear/rear/issues/555#issuecomment-77350188">https://github.com/rear/rear/issues/555#issuecomment-77350188</a>.</p>
</blockquote>
<h4 id="jsmeix_commented_at_2015-03-05_1149"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77351120">2015-03-05 11:49</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1149" title="Permanent link">&para;</a></h4>
<p>@schlomo<br />
do you know a Linux distribution with findmnt where findmnt does not
support the 'u' option?</p>
<h4 id="schlomo_commented_at_2015-03-05_1200"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77352319">2015-03-05 12:00</a>:<a class="headerlink" href="#schlomo_commented_at_2015-03-05_1200" title="Permanent link">&para;</a></h4>
<p>No, but I find it simpler to require that findmnt can handle -u than
to<br />
worry about the case of meeting a findmnt that does not.</p>
<p>Actually, before this thread I was not consciously aware of findmnt,
so<br />
thanks a lot for that.</p>
<p>On 5 March 2015 at 12:49, Johannes Meixner <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a>
wrote:</p>
<blockquote>
<p>@schlomo <a href="https://github.com/schlomo">https://github.com/schlomo</a><br />
do you know a Linux disrtibution with findmnt where findmnt does not<br />
support the 'u' option?</p>
<p>—<br />
Reply to this email directly or view it on GitHub<br />
<a href="https://github.com/rear/rear/issues/555#issuecomment-77351120">https://github.com/rear/rear/issues/555#issuecomment-77351120</a>.</p>
</blockquote>
<h4 id="jsmeix_commented_at_2015-03-05_1210"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77353575">2015-03-05 12:10</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1210" title="Permanent link">&para;</a></h4>
<p>@schlomo<br />
how would you implement a test to find out whether or not findmnt can
handle the '-u' option?</p>
<p>I am currently installing RHEL 6 to find out about findmnt there...</p>
<p>FYI, regarding findmnt in general:<br />
With btrfs and subvolumes everyone basically must use it because plain
mount reports insufficient/misleading information because mount only
reports the plain device like /dev/sda2 mounted multiple times at
various mount points but not what subvolume of the btrfs on /dev/sda2 is
mounted cf.
<a href="https://github.com/rear/rear/issues/497">https://github.com/rear/rear/issues/497</a>
in particular
<a href="https://github.com/rear/rear/issues/497#issuecomment-66615699">https://github.com/rear/rear/issues/497#issuecomment-66615699</a></p>
<h4 id="jsmeix_commented_at_2015-03-05_1309"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77360769">2015-03-05 13:09</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1309" title="Permanent link">&para;</a></h4>
<p>On RHEL 6.5:</p>
<pre>
# cat /etc/redhat-release 
Red Hat Enterprise Linux Server release 6.5 (Santiago)
# findmnt -alnv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs | tr -s '[:blank:]' ' '
/dev/mapper/VolGroup-lv_root / ext4 rw,relatime,seclabel,barrier=1,data=ordered
/dev/sda1 /boot ext4 rw,relatime,seclabel,barrier=1,data=ordered
# findmnt -alnuv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs | tr -s '[:blank:]' ' '
/dev/mapper/VolGroup-lv_root / ext4 rw,relatime,seclabel,barrier=1,data=ordered
/dev/sda1 /boot ext4 rw,relatime,seclabel,barrier=1,data=ordered
# mount -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs | tr -s '[:blank:]' ' ' | cut -d ' ' -f 1,3,5,6
/dev/mapper/VolGroup-lv_root / ext4 (rw)
/dev/sda1 /boot ext4 (rw)
</pre>

<p>Currently I don't know how to trigger that findmnt truncates FSTYPE or
OPTIONS output.</p>
<h4 id="jsmeix_commented_at_2015-03-05_1312"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77361121">2015-03-05 13:12</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1312" title="Permanent link">&para;</a></h4>
<p>It depends on the width of the terminal wherein findmnt is run whether
or not it truncates output.</p>
<p>On RHEL 6.5 in a smaller-width xterm:</p>
<pre>
# findmnt -alnv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs | tr -s '[:blank:]' ' '
/dev/mapper/VolGroup-lv_root / ext4 rw,relatime,seclabel,barrier=1,data=o
/dev/sda1 /boot ext4 rw,relatime,seclabel,barrier=1,data=o
# findmnt -alnuv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs | tr -s '[:blank:]' ' '
/dev/mapper/VolGroup-lv_root
 / ext4 rw,relatime,seclabel,barrier=1,data=ordered
/dev/sda1 /boot ext4 rw,relatime,seclabel,barrier=1,data=ordered
# findmnt -alnuv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs | tr -s '[:blank:]' ' ' | od -a
0000000   /   d   e   v   /   m   a   p   p   e   r   /   V   o   l   G
0000020   r   o   u   p   -   l   v   _   r   o   o   t  nl  sp   /  sp
0000040   e   x   t   4  sp   r   w   ,   r   e   l   a   t   i   m   e
0000060   ,   s   e   c   l   a   b   e   l   ,   b   a   r   r   i   e
0000100   r   =   1   ,   d   a   t   a   =   o   r   d   e   r   e   d
0000120  nl   /   d   e   v   /   s   d   a   1  sp   /   b   o   o   t
0000140  sp   e   x   t   4  sp   r   w   ,   r   e   l   a   t   i   m
0000160   e   ,   s   e   c   l   a   b   e   l   ,   b   a   r   r   i
0000200   e   r   =   1   ,   d   a   t   a   =   o   r   d   e   r   e
0000220   d  nl
0000222
</pre>

<p>Scaring!</p>
<p>With '-u' findmnt inserts a newline character when the output is too
long for one line.</p>
<h4 id="jsmeix_commented_at_2015-03-05_1316"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77361704">2015-03-05 13:16</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1316" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
the issue is not yet fixed!</p>
<h4 id="jsmeix_commented_at_2015-03-05_1325"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77362754">2015-03-05 13:25</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1325" title="Permanent link">&para;</a></h4>
<p>I think using the '-r' option alone helps - at least on RHEL 6.5:</p>
<pre>
# findmnt -nrv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs
/dev/mapper/VolGroup-lv_root / ext4 rw,relatime,seclabel,barrier=1,data=ordered
/dev/sda1 /boot ext4 rw,relatime,seclabel,barrier=1,data=ordered
</pre>

<h4 id="jsmeix_commented_at_2015-03-05_1340"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77364785">2015-03-05 13:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1340" title="Permanent link">&para;</a></h4>
<p>Also on SLE12 "findmnt -nrv -o .." seems to output the right thing:</p>
<pre>
# findmnt -nrv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs
/dev/sda2 / btrfs rw,relatime,space_cache
/dev/sda2 /.snapshots btrfs rw,relatime,space_cache
/dev/sda2 /var/tmp btrfs rw,relatime,space_cache
/dev/sda2 /var/spool btrfs rw,relatime,space_cache
/dev/sda2 /var/opt btrfs rw,relatime,space_cache
/dev/sda2 /var/log btrfs rw,relatime,space_cache
/dev/sda2 /var/lib/named btrfs rw,relatime,space_cache
/dev/sda2 /var/lib/pgsql btrfs rw,relatime,space_cache
/dev/sda2 /var/lib/mailman btrfs rw,relatime,space_cache
/dev/sda2 /usr/local btrfs rw,relatime,space_cache
/dev/sda2 /var/crash btrfs rw,relatime,space_cache
/dev/sda2 /opt btrfs rw,relatime,space_cache
/dev/sda2 /tmp btrfs rw,relatime,space_cache
/dev/sda2 /srv btrfs rw,relatime,space_cache
/dev/sda2 /boot/grub2/x86_64-efi btrfs rw,relatime,space_cache
/dev/sda2 /home btrfs rw,relatime,space_cache
/dev/sda2 /boot/grub2/i386-pc btrfs rw,relatime,space_cache
# findmnt -nrv -o SOURCE,TARGET,OPTIONS,FSROOT -t btrfs
/dev/sda2 / rw,relatime,space_cache /@
/dev/sda2 /.snapshots rw,relatime,space_cache /@/.snapshots
/dev/sda2 /var/tmp rw,relatime,space_cache /@/var/tmp
/dev/sda2 /var/spool rw,relatime,space_cache /@/var/spool
/dev/sda2 /var/opt rw,relatime,space_cache /@/var/opt
/dev/sda2 /var/log rw,relatime,space_cache /@/var/log
/dev/sda2 /var/lib/named rw,relatime,space_cache /@/var/lib/named
/dev/sda2 /var/lib/pgsql rw,relatime,space_cache /@/var/lib/pgsql
/dev/sda2 /var/lib/mailman rw,relatime,space_cache /@/var/lib/mailman
/dev/sda2 /usr/local rw,relatime,space_cache /@/usr/local
/dev/sda2 /var/crash rw,relatime,space_cache /@/var/crash
/dev/sda2 /opt rw,relatime,space_cache /@/opt
/dev/sda2 /tmp rw,relatime,space_cache /@/tmp
/dev/sda2 /srv rw,relatime,space_cache /@/srv
/dev/sda2 /boot/grub2/x86_64-efi rw,relatime,space_cache /@/boot/grub2/x86_64-efi
/dev/sda2 /home rw,relatime,space_cache /@/home
/dev/sda2 /boot/grub2/i386-pc rw,relatime,space_cache /@/boot/grub2/i386-pc
</pre>

<h4 id="jsmeix_commented_at_2015-03-05_1406"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77368735">2015-03-05 14:06</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1406" title="Permanent link">&para;</a></h4>
<p>On RHEL 6.0 there is no findmnt (in contrast to RHEL 6.5) - at least not
by default:</p>
<pre>
# cat /etc/redhat-release
Red Hat Enterprise Linux Server release 6.0 (Santiago)
# type -a findmnt
-bash: type: findmnt: not found
# mount -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs | cut -d ' ' -f 1,3,5,6
/dev/mapper/VolGroup-lv_root / ext4 (rw)
/dev/sda1 /boot ext4 (rw)
</pre>

<h4 id="jsmeix_commented_at_2015-03-05_1412"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77369569">2015-03-05 14:12</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1412" title="Permanent link">&para;</a></h4>
<p>On RHEL 6.x findmnt was added to the util-linux-ng RPM<br />
on "Thu Jan 27 2011":</p>
<pre>
# rpm -q --changelog util-linux-ng
.
.
.
* Thu Jan 27 2011 Karel Zak <kzak@redhat.com> 2.17.2-8
...
- fix #616325 - Include findmnt in util-linux-ng package
</pre>

<h4 id="jsmeix_commented_at_2015-03-05_1459"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77378064">2015-03-05 14:59</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1459" title="Permanent link">&para;</a></h4>
<p>findmnt is available since RHEL 6.1 and works there as needed:</p>
<pre>
# cat /etc/redhat-release
Red Hat Enterprise Linux Server release 6.1 (Santiago)
# findmnt -nrv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs
/dev/mapper/VolGroup-lv_root / ext4 rw,relatime,seclabel,barrier=1,data=ordered
/dev/sda1 /boot ext4 rw,relatime,seclabel,barrier=1,data=ordered
# mount -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs | cut -d ' ' -f 1,3,5,6
/dev/mapper/VolGroup-lv_root / ext4 (rw)
/dev/sda1 /boot ext4 (rw)
</pre>

<h4 id="jsmeix_commented_at_2015-03-05_1517"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77381590">2015-03-05 15:17</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1517" title="Permanent link">&para;</a></h4>
<p>I submitted
<a href="https://github.com/rear/rear/pull/559">https://github.com/rear/rear/pull/559</a>
that should hopefully fix it.</p>
<h4 id="gdha_commented_at_2015-03-05_1523"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77382887">2015-03-05 15:23</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-05_1523" title="Permanent link">&para;</a></h4>
<p>@bbeaver @jsmeix and what if we do the following:</p>
<pre><code>COLUMNS=254 findmnt -alnuv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs
/dev/mapper/vg00-lv00 /          ext3   rw,relatime,errors=continue,user_xattr,acl,barrier=1,data=ordered

or

COLUMNS=254 findmnt -nrv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs
/dev/mapper/vg00-lv00 / ext3 rw,relatime,errors=continue,user_xattr,acl,barrier=1,data=ordered
</code></pre>
<h4 id="jsmeix_commented_at_2015-03-05_1532"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/555#issuecomment-77384767">2015-03-05 15:32</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-05_1532" title="Permanent link">&para;</a></h4>
<p>With '-r' findmnt results the right output regardless of the terminal
width.</p>
<p>I had tried "COLUMNS=900" before but that did not make a difference for
me.</p>
<p>I think the whole issue is that by default findmnt tries (too?) hard to
make the output nice looking for interactive usage and only with '-r'
one gets the real hard facts for real hard men ;-)</p>
<p>With RHEL 6.1 in a smaller xterm:</p>
<pre>
# COLUMNS=254 findmnt -alnuv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs        
/dev/mapper/VolGroup-lv_root
                          /      ext4   rw,relatime,seclabel,barrier=1,data=ordered
/dev/sda1                 /boot  ext4   rw,relatime,seclabel,barrier=1,data=ordered
# findmnt -nrv -o SOURCE,TARGET,FSTYPE,OPTIONS -t ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs
/dev/mapper/VolGroup-lv_root / ext4 rw,relatime,seclabel,barrier=1,data=ordered
/dev/sda1 /boot ext4 rw,relatime,seclabel,barrier=1,data=ordered
</pre>

<p>Note the additional newline in the first findmnt output that breaks what
belongs to /dev/mapper/VolGroup-lv_root</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2015-03-02.555.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
