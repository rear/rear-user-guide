<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1116 Issue closed: Wrong progress 'Restored' values while backup restore - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1116 Issue closed: Wrong progress \u0027Restored\u0027 values while backup restore";
        var mkdocs_page_input_path = "issues/2016-12-08.1116.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1116 Issue closed: Wrong progress 'Restored' values while backup restore</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1116_issue_closed_wrong_progress_restored_values_while_backup_restore"><a href="https://github.com/rear/rear/issues/1116">#1116 Issue</a> <code>closed</code>: Wrong progress 'Restored' values while backup restore<a class="headerlink" href="#1116_issue_closed_wrong_progress_restored_values_while_backup_restore" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>fixed / solved / done</code>, <code>minor bug</code></p>
<h4 id="jsmeix_opened_issue_at_2016-12-08_1551"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> opened issue at <a href="https://github.com/rear/rear/issues/1116">2016-12-08 15:51</a>:<a class="headerlink" href="#jsmeix_opened_issue_at_2016-12-08_1551" title="Permanent link">&para;</a></h4>
<p>I did a restore of mutiple backups.<br />
Actually everything was correctly restored but<br />
the progress 'Restored' values while it runs<br />
are wrong:</p>
<pre>
RESCUE f79:~ # rear -C home_backup -d -D restoreonly & rear -C opt_backup -d -D restoreonly & wait
[1] 2935
[2] 2936
...
2935: Backup archive size is 1.2G       /tmp/rear.pXHHHCOVcXR7NCH/outputfs/f79/backup-home_backup.tar.gz (compressed)
2936: Backup archive size is 1.1G       /tmp/rear.UBikrzrDRQSEiIs/outputfs/f79/backup-opt_backup.tar.gz (compressed)
2935: Restoring from '/tmp/rear.pXHHHCOVcXR7NCH/outputfs/f79/backup-home_backup.tar.gz'...
2936: Restoring from '/tmp/rear.UBikrzrDRQSEiIs/outputfs/f79/backup-opt_backup.tar.gz'...
2935: Restoring... 
2936: Restoring... 
2935: Restored 34 MiB [avg 11857 KiB/sec] 
2936: Restored 0 MiB [avg 0 KiB/sec] 
2935: Restored 34 MiB [avg 5928 KiB/sec] 
2936: Restored 0 MiB [avg 0 KiB/sec] 
2935: Restored 192 MiB [avg 21944 KiB/sec] 
2936: Restored 0 MiB [avg 0 KiB/sec] 
...
2935: Restored 192 MiB [avg 6370 KiB/sec] 
2936: Restored 0 MiB [avg 0 KiB/sec] 
2935: Restored 192 MiB [avg 5808 KiB/sec] 
2936: OK
2936: Restored 0 MiB in 34 seconds [avg 0 KiB/sec]
2936: Restoring finished.
...
2935: Restored 192 MiB in 37 seconds [avg 5337 KiB/sec]
2935: Restoring finished.
</pre>

<h4 id="jsmeix_commented_at_2016-12-08_1558"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1116#issuecomment-265776028">2016-12-08 15:58</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-08_1558" title="Permanent link">&para;</a></h4>
<p>FWIW:<br />
For the opposite operation multiple mkbackuponly<br />
the progress 'Archived' values are o.k.:</p>
<pre>
# usr/sbin/rear -C home_backup -d -D mkbackuponly & usr/sbin/rear -C opt_backup -d -D mkbackuponly & wait
[1] 1918
[2] 1919
...
1919: Creating tar archive '/tmp/rear.nfyWpBWU4xGyqLG/outputfs/f79/backup-opt_backup.tar.gz'
1919: Preparing archive operation
1918: Creating tar archive '/tmp/rear.SpO43ouDMJMPv00/outputfs/f79/backup-home_backup.tar.gz'
1918: Preparing archive operation
1919: Archived 133 MiB [avg 22818 KiB/sec] 
1918: Archived 121 MiB [avg 20656 KiB/sec] 
1918: Archived 214 MiB [avg 22008 KiB/sec] 
1919: Archived 236 MiB [avg 24228 KiB/sec] 
1919: Archived 347 MiB [avg 25403 KiB/sec] 
...
1919: Archived 998 MiB [avg 25548 KiB/sec] 
1918: Archived 954 MiB [avg 24442 KiB/sec] 
1919: OK
1918: Archived 1058 MiB [avg 24634 KiB/sec] 
1919: Archived 998 MiB in 43 seconds [avg 23766 KiB/sec]
...
1918: Archived 1165 MiB [avg 25397 KiB/sec] 
1918: OK
1918: Archived 1165 MiB in 50 seconds [avg 23873 KiB/sec]
</pre>

<h4 id="jsmeix_commented_at_2016-12-14_1450"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1116#issuecomment-267052887">2016-12-14 14:50</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-14_1450" title="Permanent link">&para;</a></h4>
<p>Restoring sequentially does not make a difference:</p>
<pre>
RESCUE f79:~ # rear -C basic_system -d -D recover
...
724: Restoring... 
724: Restored 167 MiB [avg 57105 KiB/sec] 
724: Restored 387 MiB [avg 66074 KiB/sec] 
724: Restored 552 MiB [avg 62912 KiB/sec] 
724: Restored 727 MiB [avg 62116 KiB/sec] 
724: Restored 895 MiB [avg 61103 KiB/sec] 
724: Restored 1195 MiB [avg 68023 KiB/sec] 
724: Restored 1505 MiB [avg 73394 KiB/sec] 
724: Restored 1721 MiB [avg 73435 KiB/sec] 
724: Restored 1995 MiB [avg 75696 KiB/sec] 
724: Restored 2223 MiB [avg 75884 KiB/sec] 
724: Restored 2456 MiB [avg 76216 KiB/sec] 
724: Restored 2687 MiB [avg 76433 KiB/sec] 
724: OK
724: +++ grep -m1 'Total bytes written: ' in 39 seconds.
724: Restoring finished.
...

RESCUE f79:~ # rear -C home_backup -d -D restoreonly
...
2935: Restoring... 
2935: Restored 192 MiB [avg 65833 KiB/sec] 
2935: Restored 192 MiB [avg 32916 KiB/sec] 
2935: Restored 192 MiB [avg 21944 KiB/sec] 
2935: Restored 192 MiB [avg 16458 KiB/sec] 
2935: Restored 192 MiB [avg 13166 KiB/sec] 
2935: Restored 192 MiB [avg 10972 KiB/sec] 
2935: OK
2935: +++ grep -m1 'Total bytes written: ' in 21 seconds.
2935: Restoring finished.
...

RESCUE f79:~ # rear -C opt_backup -d -D restoreonly
...
3832: Restoring... 
3832: Restored 0 MiB [avg 0 KiB/sec] 
3832: Restored 0 MiB [avg 0 KiB/sec] 
3832: Restored 0 MiB [avg 0 KiB/sec] 
3832: Restored 0 MiB [avg 0 KiB/sec] 
3832: Restored 0 MiB [avg 0 KiB/sec] 
3832: OK
3832: +++ grep -m1 'Total bytes written: ' in 18 seconds.
3832: Restoring finished.
...
</pre>

<p>It only works for 'recover' but not for 'rstoreonly'<br />
and there is a bug regarding a 'grep' command in<br />
restore/NETFS/default/400_restore_backup.sh</p>
<h4 id="jsmeix_commented_at_2016-12-14_1534"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1116#issuecomment-267065150">2016-12-14 15:34</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-14_1534" title="Permanent link">&para;</a></h4>
<p>Argh!<br />
The whole issue is basically false alarm.</p>
<p>It is caused by my special huge testing files that I created via</p>
<pre>
# cat /dev/urandom | head -c 1G >/home/urandom.data
# cat /dev/urandom | head -c 1G >/root/urandom.data
</pre>

<p>cf.<br />
<a href="https://github.com/rear/rear/issues/1088#issuecomment-264463210">https://github.com/rear/rear/issues/1088#issuecomment-264463210</a></p>
<p>During restore those single huge files<br />
result no useful output from 'tar' into<br />
${TMP_DIR}/${BACKUP_PROG_ARCHIVE}-restore.log<br />
so that those *-restore.log look as follows:</p>
<pre>
RESCUE f79:~ # cat /tmp/rear.dntbRYvtw7mWH4d/tmp/backup-basic_system-restore.log
block 3: ./
block 6: dev/
block 9: home/
block 12: sys/
...
block 5881707: lib64/libfreebl3.so
block 5882676: lib64/libcom_err.so.2
block 5882679: root/rear/var/log/rear/rear-f79.28698.log
block 5882679: ** Block of NULs **

RESCUE f79:~ # cat /tmp/rear.rKkQ3AcACB0UqNP/tmp/backup-home_backup-restore.log
block 3: home/johannes/
block 6: home/johannes/.xinitrc.template
block 12: home/johannes/.inputrc
block 17: home/johannes/.bashrc
...
block 394959: home/stuff/usr/sbin/rear
block 394998: home/urandom.data
block 2492153: root/rear/var/log/rear/rear-f79.32141.log
block 2492881: ** Block of NULs **

RESCUE f79:~ # cat /tmp/rear.CKoGevFoVc7cPow/tmp/backup-opt_backup-restore.log
block 3: opt/urandom.data
block 2097158: root/rear/var/log/rear/rear-f79.3499.log
block 2097882: ** Block of NULs **
</pre>

<p>I.e. during restore of huge files there is no useful 'tar' output<br />
and that leads to useless progress 'Restored' values.</p>
<h4 id="jsmeix_commented_at_2016-12-14_1652"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1116#issuecomment-267088049">2016-12-14 16:52</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-14_1652" title="Permanent link">&para;</a></h4>
<p>For me<br />
<a href="https://github.com/rear/rear/pull/1129">https://github.com/rear/rear/pull/1129</a><br />
fixes it and works really well.</p>
<p>For example now it looks like</p>
<pre>
RESCUE f79:~ # rear -C home_backup -d -D restoreonly
...
9642: Restoring... 
9642: Restored 34 MiB [avg 11857 KiB/sec] 
9642: Restored 192 MiB [avg 32916 KiB/sec] 
9642: Restoring home/urandom.data 
9642: Restoring home/urandom.data 
9642: Restoring home/urandom.data 
9642: Restoring home/urandom.data 
9642: OK
9642: Restored 1217 MiB in 21 seconds [avg 59354 KiB/sec] 
9642: Restoring finished.
...
</pre>

<h4 id="jsmeix_commented_at_2016-12-15_1530"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1116#issuecomment-267356217">2016-12-15 15:30</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-12-15_1530" title="Permanent link">&para;</a></h4>
<p>With
<a href="https://github.com/rear/rear/pull/1129">https://github.com/rear/rear/pull/1129</a>
merged<br />
the whole backup 'tar' restore messaging should<br />
be much improved now.</p>
<p>For example how it looks now for me<br />
(2 parallel restores with 1GB urandom.data files):</p>
<pre>
RESCUE f79:~ # rear -C home_backup -d -D restoreonly & rear -C opt_backup -d -D restoreonly & wait
...
15106: Backup restore program 'tar' started in subshell (PID=16351)
15107: Backup restore program 'tar' started in subshell (PID=16353)
15106: Restored 34 MiB [avg. 11857 KiB/sec] 
15107: Restored 0 MiB [avg. 0 KiB/sec] 
15106: Restoring home/stuff/var/lib/rear/output/rear-d25.iso 
15107: Restoring opt/urandom.data 
15106: Restored 192 MiB [avg. 21944 KiB/sec] 
15107: Restoring opt/urandom.data 
15106: Restoring home/urandom.data 
15107: Restoring opt/urandom.data 
15106: Restoring home/urandom.data 
15107: Restoring opt/urandom.data 
15106: Restoring home/urandom.data 
15107: Restoring opt/urandom.data 
15106: Restoring home/urandom.data 
15107: Restoring opt/urandom.data 
15106: Restoring home/urandom.data 
15107: Restoring opt/urandom.data 
15106: Restoring home/urandom.data 
15107: Restoring opt/urandom.data 
15106: Restoring home/urandom.data 
15107: Restoring opt/urandom.data 
15107: OK
15106: Restoring home/urandom.data 
15107: Restored 1024 MiB in 34 seconds [avg. 30851 KiB/sec]
15107: Restoring finished.
...
15106: Restoring home/urandom.data 
15106: OK
15106: Restored 1217 MiB in 40 seconds [avg. 31161 KiB/sec]
15106: Restoring finished.
</pre>

<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2023 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-12-08.1116.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
