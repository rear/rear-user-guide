<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#558 Issue closed: Error recreating file systems (mkfs.ext4: invalid option -- 'f') - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#558 Issue closed: Error recreating file systems (mkfs.ext4: invalid option -- \u0027f\u0027)";
        var mkdocs_page_input_path = "issues/2015-03-04.558.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rsync.html">Internal Backup using BACKUP=RSYNC method</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#558 Issue closed: Error recreating file systems (mkfs.ext4: invalid option -- 'f')</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="558_issue_closed_error_recreating_file_systems_mkfsext4_invalid_option_--_f"><a href="https://github.com/rear/rear/issues/558">#558 Issue</a> <code>closed</code>: Error recreating file systems (mkfs.ext4: invalid option -- 'f')<a class="headerlink" href="#558_issue_closed_error_recreating_file_systems_mkfsext4_invalid_option_--_f" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>bug</code>, <code>documentation</code>, <code>support / question</code></p>
<h4 id="cocampbe_opened_issue_at_2015-03-04_1916"><img src="https://avatars.githubusercontent.com/u/2211329?u=4cd2be2e33c0e225dd2ffa8fe52fc0015c498af1&v=4" width="50"><a href="https://github.com/cocampbe">cocampbe</a> opened issue at <a href="https://github.com/rear/rear/issues/558">2015-03-04 19:16</a>:<a class="headerlink" href="#cocampbe_opened_issue_at_2015-03-04_1916" title="Permanent link">&para;</a></h4>
<p>OS: OEL 6.6<br />
REAR: 1.16.1-git201503031650<br />
Kernel: 3.8.13-55.1.2.el6uek.x86_64</p>
<p>I recently updated from a 1.13 release because mounting nfs shares would
not work. That issue was resolved in the update. Now the issue is in
creating ext4 file systems. The diskrestore.sh script uses a -f for the
fragment size, but the copy of mkfs.ext4 does not support fragment size
and halts. The version f e2fsprogs on the system is
e2fsprogs-1.42.8-1.0.2.el6.x86_64.</p>
<p>error from log file:</p>
<blockquote>
<p>+++ mkfs.ext4 -b 4096 -f 4096 -i 16384 /dev/mapper/vg00-lvol3<br />
mkfs.ext4: invalid option -- 'f'<br />
Usage: mkfs.ext4 [-c|-l filename] [-b block-size] [-C
cluster-size]<br />
[-i bytes-per-inode] [-I inode-size] [-J journal-options]<br />
[-G flex-group-size] [-N number-of-inodes]<br />
[-m reserved-blocks-percentage] [-o creator-os]<br />
[-g blocks-per-group] [-L volume-label] [-M
last-mounted-directory]<br />
[-O feature[,...]] [-r fs-revision] [-E
extended-option[,...]]<br />
[-t fs-type] [-T usage-type ] [-U UUID] [-jnqvDFKSV] device
[blocks-count]<br />
2015-03-04 12:46:17 An error occurred during layout recreation.</p>
</blockquote>
<p>I removed the fragment size and was able to restore. The server came
back online without issue.</p>
<h4 id="gdha_commented_at_2015-03-05_0823"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77324272">2015-03-05 08:23</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-05_0823" title="Permanent link">&para;</a></h4>
<p>Thank you - I'll add it to the release notes to watch out for - will not
change the code as far I could verify all other distro's are OK with the
<code>-f</code>option</p>
<h4 id="gdha_commented_at_2015-03-05_0825"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77324554">2015-03-05 08:25</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-05_0825" title="Permanent link">&para;</a></h4>
<p>@cocampbe could you post the <code>/var/lib/rear/layout/disklayout.conf</code> file
please. The fragmentsize must have been listed via <code>e2label</code> -
personally I think this is a defect in OEL 6.6 (not being consistent in
options)</p>
<h4 id="cocampbe_commented_at_2015-03-05_1501"><img src="https://avatars.githubusercontent.com/u/2211329?u=4cd2be2e33c0e225dd2ffa8fe52fc0015c498af1&v=4" width="50"><a href="https://github.com/cocampbe">cocampbe</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77378531">2015-03-05 15:01</a>:<a class="headerlink" href="#cocampbe_commented_at_2015-03-05_1501" title="Permanent link">&para;</a></h4>
<pre><code>disk /dev/sda 450064605184 msdos
part /dev/sda 524288000 1048576 primary boot /dev/sda1
part /dev/sda 449539211264 525336576 primary lvm /dev/sda2
#disk /dev/sdb 53687091200
#disk /dev/sdc 26843545600
#disk /dev/sdd 53687091200
#disk /dev/sde 26843545600
#disk /dev/sdf 53687091200
#disk /dev/sdg 26843545600
#disk /dev/sdh 53687091200
#disk /dev/sdi 26843545600
#lvmdev /dev/vgtest /dev/mapper/test_lun uJOvjW-AvMq-bnYk-X3XY-bI5h-BWbj-5zW0oT 52428800
lvmdev /dev/vg00 /dev/sda2 8evCPt-9SzP-wgYP-VgBL-1JUV-mGAH-z4aoFU 878006272
#lvmgrp /dev/vgtest 4096 6396 26198016
lvmgrp /dev/vg00 4096 107178 439001088
#lvmvol /dev/vgtest data 1280 10485760
#lvmvol /dev/vgtest ctl 1280 10485760
#lvmvol /dev/vgtest arch 1280 10485760
lvmvol /dev/vg00 lv_swap 992 8126464
lvmvol /dev/vg00 lvol3 512 4194304
lvmvol /dev/vg00 lvol4 1280 10485760
lvmvol /dev/vg00 lvol5 2560 20971520
lvmvol /dev/vg00 lvol6 1280 10485760
lvmvol /dev/vg00 lvol7 2560 20971520
lvmvol /dev/vg00 lvol8 2560 20971520
lvmvol /dev/vg00 lvol9 1280 10485760
# Filesystems (only ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs are supported).
# Format: fs &lt;device&gt; &lt;mountpoint&gt; &lt;fstype&gt; [uuid=&lt;uuid&gt;] [label=&lt;label&gt;] [&lt;attributes&gt;]
fs /dev/mapper/vg00-lvol3 / ext4 uuid=1081d79d-59d8-42ca-b39d-5a624021228c label= blocksize=4096 fragmentsize=4096 reserved_blocks=2% max_mounts=-1 check_interval=0d bytes_per_inode=16384 default_mount_options=user_xattr,acl options=rw,relatime,stripe=64,data=ordered
fs /dev/mapper/vg00-lvol4 /home ext4 uuid=385e252e-d2bc-4a14-b1d7-928a0828e160 label= blocksize=4096 fragmentsize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16384 default_mount_options=user_xattr,acl options=rw,relatime,stripe=64,data=ordered
fs /dev/mapper/vg00-lvol5 /opt ext4 uuid=f56fc2dd-d4b9-442c-a5e7-bb7b030a367f label= blocksize=4096 fragmentsize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16384 default_mount_options=user_xattr,acl options=rw,relatime,stripe=64,data=ordered
fs /dev/mapper/vg00-lvol6 /tmp ext4 uuid=1d6472ac-df06-427f-a71e-e27c310b608d label= blocksize=4096 fragmentsize=4096 reserved_blocks=2% max_mounts=-1 check_interval=0d bytes_per_inode=16384 default_mount_options=user_xattr,acl options=rw,relatime,stripe=64,data=ordered
fs /dev/mapper/vg00-lvol7 /usr ext4 uuid=7cf0269c-977c-4371-a42d-e1c74cbea3a7 label= blocksize=4096 fragmentsize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16384 default_mount_options=user_xattr,acl options=rw,relatime,stripe=64,data=ordered
fs /dev/mapper/vg00-lvol8 /var ext4 uuid=f3f52bdb-c5c8-49f6-b33b-098ae02d8cb4 label= blocksize=4096 fragmentsize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16384 default_mount_options=user_xattr,acl options=rw,relatime,stripe=64,data=ordered
fs /dev/mapper/vg00-lvol9 /oma ext4 uuid=e301a61d-1a5b-4162-b0c9-6564c26bc6f1 label= blocksize=4096 fragmentsize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16384 default_mount_options=user_xattr,acl options=rw,relatime,stripe=64,data=ordered
#fs /dev/mapper/vgtest-arch /test/arch ext4 uuid=98c70e58-01cf-4ee9-afda-68ee30373b24 label= blocksize=4096 fragmentsize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16384 default_mount_options=user_xattr,acl options=rw,relatime,stripe=4096,data=ordere
#fs /dev/mapper/vgtest-ctl /test/oractl ext4 uuid=dff9e845-6c78-403b-8393-0ec95f486fdb label= blocksize=4096 fragmentsize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16384 default_mount_options=user_xattr,acl options=rw,relatime,stripe=4096,data=ordere
#fs /dev/mapper/vgtest-data /test/oradata ext4 uuid=302313c2-e6cc-44d6-822e-e23771ee169d label= blocksize=4096 fragmentsize=4096 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=16384 default_mount_options=user_xattr,acl options=rw,relatime,stripe=4096,data=ordere
fs /dev/sda1 /boot ext4 uuid=8be4a07a-5436-4ed7-b57c-35b82c0d94a6 label= blocksize=1024 fragmentsize=1024 reserved_blocks=5% max_mounts=-1 check_interval=0d bytes_per_inode=4063 default_mount_options=user_xattr,acl options=rw,relatime,stripe=256,data=ordered
swap /dev/mapper/vg00-lv_swap uuid=f6001d7e-c83e-4606-aad5-c1f4ce538dff label=
logicaldrive /dev/sda 0|A|1 raid=1 drives=1I:1:1,1I:1:2, spares= sectors=32 stripesize=256
smartarray 0
#multipath /dev/mapper/mpathe /dev/sdb,/dev/sdd,/dev/sdf,/dev/sdh
#multipath /dev/mapper/test_lun /dev/sdc,/dev/sde,/dev/sdg,/dev/sdi
</code></pre>
<h4 id="cocampbe_commented_at_2015-03-05_1503"><img src="https://avatars.githubusercontent.com/u/2211329?u=4cd2be2e33c0e225dd2ffa8fe52fc0015c498af1&v=4" width="50"><a href="https://github.com/cocampbe">cocampbe</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77379058">2015-03-05 15:03</a>:<a class="headerlink" href="#cocampbe_commented_at_2015-03-05_1503" title="Permanent link">&para;</a></h4>
<p>@gdha I would think that this would affect RHEL instances as well. OEL
is, for the most part, a binary equivalent of RHEL. And I would also see
CENTOS as having this issue. I don't have a RHEL or CENTOS instance to
test with.</p>
<h4 id="cocampbe_commented_at_2015-03-05_2133"><img src="https://avatars.githubusercontent.com/u/2211329?u=4cd2be2e33c0e225dd2ffa8fe52fc0015c498af1&v=4" width="50"><a href="https://github.com/cocampbe">cocampbe</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77456679">2015-03-05 21:33</a>:<a class="headerlink" href="#cocampbe_commented_at_2015-03-05_2133" title="Permanent link">&para;</a></h4>
<p>Argh. I am not sure why this is so. The man page for mkfs.ext4 shows the
fragment size option, but compiled binary throws an error. The package
is e2fsprogs-1.42.8-1.0.2.el6.x86_64. Again, I am going to assume that
anyone with this package installed will see the issue. Balls.</p>
<h4 id="schlomo_commented_at_2015-03-05_2141"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77458086">2015-03-05 21:41</a>:<a class="headerlink" href="#schlomo_commented_at_2015-03-05_2141" title="Permanent link">&para;</a></h4>
<p>A couple of years ago @dagwieers brought the concept of capabilities
(with regard to syslinux). Maybe this approach would help here as well?
Query which features mkfs.ext4 supports and include only compatible
options?</p>
<h4 id="cocampbe_commented_at_2015-03-05_2159"><img src="https://avatars.githubusercontent.com/u/2211329?u=4cd2be2e33c0e225dd2ffa8fe52fc0015c498af1&v=4" width="50"><a href="https://github.com/cocampbe">cocampbe</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77461184">2015-03-05 21:59</a>:<a class="headerlink" href="#cocampbe_commented_at_2015-03-05_2159" title="Permanent link">&para;</a></h4>
<p>@schlomo I think that makes sense. But I feel the fragment size is not
necessary. I cannot speak for all cases, but most people do not specify
a block size or fragment size when creating file systems. It seems to me
that needing those for a recovery is more a closet case, than the norm.
But alas, I am not a developer. And you guys have done a great job
maintaining this project. So I don't want to be too critical.</p>
<h4 id="schlomo_commented_at_2015-03-05_2209"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77463008">2015-03-05 22:09</a>:<a class="headerlink" href="#schlomo_commented_at_2015-03-05_2209" title="Permanent link">&para;</a></h4>
<p>Well, a recovered system will always have some little differences from
the original. But we try our best. I personally could also live with
emitting a warning about the filesystem features that could not be
recovered.</p>
<p><img alt="" src="http://upload.wikimedia.org/wikipedia/commons/thumb/6/6e/Dolly_face_closeup.jpg/320px-Dolly_face_closeup.jpg" /><br />
Probably same like sheep cloning is not yet perfect.</p>
<p>However, your initial problem was that recovery <strong>failed</strong> so there I
see a bug which is caused by trying to be too perfect, at least for your
version of mkfs.ext4. I guess that since a successful recovery is the
main objective we either have to use that feature only if it is
available or we have to remove support for setting the fragment size
till we can do that.</p>
<p>@gdha what do you think?</p>
<h4 id="gdha_commented_at_2015-03-06_0707"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77516351">2015-03-06 07:07</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-06_0707" title="Permanent link">&para;</a></h4>
<p>@schlomo @cocampbe @jsmeix Indeed Centos 7 has the same bug with
<code>mkfs.ext4: invalid option -- 'f'</code><br />
Centos 7 has rpm e2fsprogs-1.42.9-4.el7.x86_64 containing the
executable and man-page (which do describe the feature). The
fragmentsize was introduced recently via issue #549. I think it is
better that we just make the variable empty for the moment as it is an
unkown fact when e2fprogs will enable the fragmentsize feauture. Any
objections?</p>
<h4 id="schlomo_commented_at_2015-03-06_0749"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77519651">2015-03-06 07:49</a>:<a class="headerlink" href="#schlomo_commented_at_2015-03-06_0749" title="Permanent link">&para;</a></h4>
<p>No. Can you make it transparent to the end user that the recreated
filesystem is not 100% identical?</p>
<p>Also, I could imagine the recovery to fail on very large file systems
and the recovered system to be inefficient on 4k hard disks. Or are
these unrelated?</p>
<h4 id="jsmeix_commented_at_2015-03-06_0932"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77530781">2015-03-06 09:32</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-06_0932" title="Permanent link">&para;</a></h4>
<p>I think rear should remove the newly added actual support for
fragmentsize everywhere which makes rear again work as it actually did
all the time before (i.e. all the time before rear did not actually
support fragmentsize).</p>
<p>Reasoning:</p>
<p>In
<a href="https://github.com/rear/rear/issues/549">https://github.com/rear/rear/issues/549</a>
I wrote</p>
<pre>
It seems ${fragmentsize} in usr/share/rear/layout/prepare/GNU/Linux/13_include_filesystem_code.sh is used but nowhere defined.
</pre>

<p>Because in the past ${fragmentsize} was nowhere defined, the value of
${fragmentsize} was empty so that the mkfs command was always done
without any kind of fragmentsize support.</p>
<p>Because I had found out that ${fragmentsize} is used but nowhere
defined, @gdha had added actual support for it by defining it in
13_include_filesystem_code.sh and 23_filesystem_layout.sh see
<a href="https://github.com/rear/rear/commit/ca41fe5046729fd30a7832ad2985adb18896d631">https://github.com/rear/rear/commit/ca41fe5046729fd30a7832ad2985adb18896d631</a></p>
<p>But this issue here now shows that the actually right way how to deal
with fragmentsize is to not use it because it does not work.</p>
<p>Therefore I suggest to remove both defining it and using it from
13_include_filesystem_code.sh and 23_filesystem_layout.sh</p>
<p>Any time later when the tools not only describe stuff in their man pages
but even actually support it, then rear might even also support it ;-)</p>
<p>I think the rear code should not contain "fragmentsize" when it does not
actually support it (i.e. I think having a variable ${fragmentsize} but
with empty value because actually it does not work is misleading).</p>
<h4 id="jsmeix_commented_at_2015-03-06_1015"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77536276">2015-03-06 10:15</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-03-06_1015" title="Permanent link">&para;</a></h4>
<p>@schlomo<br />
I think it is not possible with reasonable effort to determine the cases
when the recreated filesystem is not 100% identical.</p>
<p>I think in gereral after a system was recreated with rear it is no
longer 100% identical but there are zillions of individual possible
cases what exactly is no longer 100% identical.</p>
<p>Therefore I suggest rear should make it transparent to its end users (by
the way rear is not used by usual "end users" but by experienced admins)
that in general the recreated system will not be 100% identical.</p>
<p>For example after recreation the system performance might unexpectedly
speed up because tons of fragmented files are now contiguous on the disk
and we should really warn the admin to be prepared against possible dumb
questions from his big boss why the system wasn't already as fast before
the recreation ;-)</p>
<p>And don't forget unexpectedly more free disk space after recreation
because this or that big file that was removed but still in use by some
process that runs "since ever" is now really gone after recreation :-)</p>
<h4 id="schlomo_commented_at_2015-03-06_1116"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77543973">2015-03-06 11:16</a>:<a class="headerlink" href="#schlomo_commented_at_2015-03-06_1116" title="Permanent link">&para;</a></h4>
<p>+1 for removing it.</p>
<p>Thanks!</p>
<h4 id="gdha_commented_at_2015-03-06_1408"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77563480">2015-03-06 14:08</a>:<a class="headerlink" href="#gdha_commented_at_2015-03-06_1408" title="Permanent link">&para;</a></h4>
<p>Fine in script <code>layout/save/GNU/Linux/23_filesystem_layout.sh</code> I
disabled <em>fragmentsize</em> to be written into the disklayout.conf file.<br />
I will not change the script
<code>layout/prepare/GNU/Linux/13_include_filesystem_code.sh</code> as
<em>fragmentsize</em> will not be found anymore in the disklayout.conf and is
therefore completely harmless.</p>
<h4 id="cocampbe_commented_at_2015-03-09_1224"><img src="https://avatars.githubusercontent.com/u/2211329?u=4cd2be2e33c0e225dd2ffa8fe52fc0015c498af1&v=4" width="50"><a href="https://github.com/cocampbe">cocampbe</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77843975">2015-03-09 12:24</a>:<a class="headerlink" href="#cocampbe_commented_at_2015-03-09_1224" title="Permanent link">&para;</a></h4>
<p>I just installed rear-1.16.1-151.git201503061713.el6.noarch.rpm. I'll
let you know what happens.</p>
<h4 id="cocampbe_commented_at_2015-03-09_1310"><img src="https://avatars.githubusercontent.com/u/2211329?u=4cd2be2e33c0e225dd2ffa8fe52fc0015c498af1&v=4" width="50"><a href="https://github.com/cocampbe">cocampbe</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-77849924">2015-03-09 13:10</a>:<a class="headerlink" href="#cocampbe_commented_at_2015-03-09_1310" title="Permanent link">&para;</a></h4>
<p>OK. It worked like a champ. Thanks so much.</p>
<h4 id="cocampbe_commented_at_2015-03-17_1833"><img src="https://avatars.githubusercontent.com/u/2211329?u=4cd2be2e33c0e225dd2ffa8fe52fc0015c498af1&v=4" width="50"><a href="https://github.com/cocampbe">cocampbe</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-82514006">2015-03-17 18:33</a>:<a class="headerlink" href="#cocampbe_commented_at_2015-03-17_1833" title="Permanent link">&para;</a></h4>
<blockquote>
<p>I just wanted to update with some info I got from oracle support</p>
<p>I got more information about this SR.</p>
<p>Fragment size was a feature of ext2/ext3 which was removed in ext4
as<br />
part of implementing the 'bigalloc' feature:</p>
<p><a href="https://ext4.wiki.kernel.org/index.php/Design_for_Large_Allocation_Blocks">https://ext4.wiki.kernel.org/index.php/Design_for_Large_Allocation_Blocks</a></p>
<p>So, the information related with '-f' from manpage is wrong.</p>
</blockquote>
<h4 id="schlomo_commented_at_2015-03-18_1048"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-82889198">2015-03-18 10:48</a>:<a class="headerlink" href="#schlomo_commented_at_2015-03-18_1048" title="Permanent link">&para;</a></h4>
<p>@cocampbe thanks a lot for finding this information, it explains a lot.
I think that the man page is the same for mkfs.ext4 and mkfs.ext3, but
of course they should be more specific.</p>
<p>Do you think that ReaR should do <code>-f</code> for ext3? Of course provided that
<code>mkfs.ext3?</code> actually does support it.</p>
<h4 id="cocampbe_commented_at_2015-03-18_1147"><img src="https://avatars.githubusercontent.com/u/2211329?u=4cd2be2e33c0e225dd2ffa8fe52fc0015c498af1&v=4" width="50"><a href="https://github.com/cocampbe">cocampbe</a> commented at <a href="https://github.com/rear/rear/issues/558#issuecomment-82925619">2015-03-18 11:47</a>:<a class="headerlink" href="#cocampbe_commented_at_2015-03-18_1147" title="Permanent link">&para;</a></h4>
<p>@schlomo Personally, I would leave -f out. Usually the default settings
for mkfs are sufficient. I would think most people are only using rear
for the OS disk.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2015-03-04.558.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
