<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#991 Issue closed: mount_NETFS_path issue - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#991 Issue closed: mount_NETFS_path issue";
        var mkdocs_page_input_path = "issues/2016-08-30.991.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#991 Issue closed: mount_NETFS_path issue</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="991_issue_closed_mount_netfs_path_issue"><a href="https://github.com/rear/rear/issues/991">#991 Issue</a> <code>closed</code>: mount_NETFS_path issue<a class="headerlink" href="#991_issue_closed_mount_netfs_path_issue" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="gigawatts_opened_issue_at_2016-08-30_1915"><img src="https://avatars.githubusercontent.com/u/1954516?v=4" width="50"><a href="https://github.com/gigawatts">gigawatts</a> opened issue at <a href="https://github.com/rear/rear/issues/991">2016-08-30 19:15</a>:<a class="headerlink" href="#gigawatts_opened_issue_at_2016-08-30_1915" title="Permanent link">&para;</a></h4>
<ul>
<li>Relax-and-Recover 1.17.2 / Git</li>
<li>OS_VENDOR=RedHatEnterpriseServer OS_VERSION=6</li>
<li><strong>Issue:</strong> We define a custom <code>NETFS_UMOUNTCMD</code> variable in our
    site.conf, with a function that basically spits out a backup
    complete message, along with a timestamp and where the backup was
    stored so that we can insert that result into a database. The
    problem is that it seems during the
    <code>backup/NETFS/default/10_mount_NETFS_path.sh</code> script step, it is
    trying to run this above custom defined UMOUNT command instead of a
    stock MOUNT command, even though the <code>NETFS_MOUNTCMD</code> variable is
    not defined. See the <strong>Mounting with</strong> line below from my log.
    Besides failing to mount, since it is running the wrong command, it
    does not error out, and continues writing the tar.gz file to the
    /tmp/rear.xxxx directory, filling up the /tmp filesystem.</li>
</ul>
<!-- -->

<pre><code>2016-08-29 16:07:28 Including output/default/98_umount_output_dir.sh
2016-08-29 16:07:28 Unmounting '/tmp/rear.SEVLuCsI5908TRZ/outputfs'
NFSv4 mount point detected
nfs-server.example.com:/rear-backups/Linux umounted
rmdir: removing directory, `/tmp/rear.SEVLuCsI5908TRZ/outputfs'
2016-08-29 16:07:28 Finished running 'output' stage in 1 seconds
2016-08-29 16:07:28 Running 'backup' stage
2016-08-29 16:07:28 Including backup/default/00_valid_backup_methods.sh
2016-08-29 16:07:28 Including backup/NETFS/default/10_mount_NETFS_path.sh
mkdir: created directory `/tmp/rear.SEVLuCsI5908TRZ/outputfs'
2016-08-29 16:07:28 Mounting with 'custom_umount  /tmp/rear.SEVLuCsI5908TRZ/outputfs'
2016-08-29 16:07:28 Backup_Result|nfs://nfs-server.example.com:/rear-backups/Linux/client.example.com/client.example.com-backup.tar.gz|client.example.com|2016-08-29 16:07:28
umount: /tmp/rear.SEVLuCsI5908TRZ/outputfs: not mounted
2016-08-29 16:07:28 Including backup/NETFS/default/15_save_copy_of_prefix_dir.sh
2016-08-29 16:07:28 Including backup/NETFS/default/20_make_prefix_dir.sh
mkdir: created directory `/tmp/rear.SEVLuCsI5908TRZ/outputfs/client.example.com'
2016-08-29 16:07:28 Including backup/NETFS/default/25_create_lock.sh
</code></pre>
<p>I even modified the <code>backup/NETFS/default/10_mount_NETFS_path.sh</code>
script, for debug purposes, to spit out the contents of all the MOUNTCMD
and UMOUNTCMD variables, and none of the UMOUNT variables contain
anything, so I don't know where its picking this botched mount command
up from.</p>
<pre><code>2016-08-30 15:04:51 Including backup/NETFS/default/10_mount_NETFS_path.sh
mkdir: created directory `/tmp/rear.9ttQqoQPAKL9Dq2/outputfs'
BACKUP_MOUNTCMD =
BACKUP_UMOUNTCMD = custom_umount
NETFS_MOUNTCMD =
NETFS_UMOUNTCMD =
OUTPUT_MOUNTCMD =
OUTPUT_UMOUNTCMD =
2016-08-30 15:04:51 Mounting with 'custom_umount  /tmp/rear.9ttQqoQPAKL9Dq2/outputfs'
...
umount: /tmp/rear.9ttQqoQPAKL9Dq2/outputfs: not mounted
</code></pre>
<p>It doesn't seem to matter if I set BACKUP_UMOUNTCMD or NETFS_UMOUNTCMD
to my custom umount function, same result either way.</p>
<p>One other thought, we store both the ISO and BACKUP in the same spot on
our NFS server, but during the course of the rear mkbackup, the NFS
share is mounted and un-mounted 3 times, I believe. Is there any way to
let it stay mounted the whole time so only 1 mount and 1 un-mount is
required? The first 2 mounts and un-mounts work just fine, its only that
3rd / last mount, during the backup phase, that fails.</p>
<p>A better option (for us) would be a variable we could set that would run
at the very end, perhaps during
<code>backup/NETFS/default/98_umount_NETFS_dir.sh</code> script, to avoid having to
hijack the umount command in the way that we do. Does something like
that already exist? I didn't turn up anything obvious in my search.</p>
<p>Thank you in advance for any help you can provide.</p>
<h4 id="gdha_commented_at_2016-09-15_1731"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/991#issuecomment-247395920">2016-09-15 17:31</a>:<a class="headerlink" href="#gdha_commented_at_2016-09-15_1731" title="Permanent link">&para;</a></h4>
<p>@gigawatts try running with the debug option turned on to see where it
goes wrong. To be honest I never used this option myself (I believe
@schlomo wrote this piece)</p>
<h4 id="ajitmote_commented_at_2016-10-21_0713"><img src="https://avatars.githubusercontent.com/u/22973461?v=4" width="50"><a href="https://github.com/ajitmote">ajitmote</a> commented at <a href="https://github.com/rear/rear/issues/991#issuecomment-255310891">2016-10-21 07:13</a>:<a class="headerlink" href="#ajitmote_commented_at_2016-10-21_0713" title="Permanent link">&para;</a></h4>
<p>I debug this issue further and below are my observations.</p>
<p>// From backup/NETFS/default/10_mount_NETFS_path.sh<br />
`<br />
mkdir -p $v "$BUILD_DIR/outputfs" &gt;&amp;2<br />
StopIfError "Could not mkdir '$BUILD_DIR/outputfs'"</p>
<p>AddExitTask "rmdir $v $BUILD_DIR/outputfs &gt;&amp;2"</p>
<p>if [[ "$BACKUP_MOUNTCMD" ]] ; then<br />
BACKUP_URL="var://BACKUP_MOUNTCMD"<br />
fi</p>
<p>mount_url $BACKUP_URL $BUILD_DIR/outputfs $BACKUP_OPTIONS
&lt;&lt;&lt;&lt;&lt;&lt; this is where actual failure is triggered<br />
`</p>
<p>So it means $BACKUP_URL is not correct.</p>
<p>I added debug statement here and got below :</p>
<p>2016-09-14 04:37:53 amote var://BACKUP_UMOUNTCMD..
/tmp/rear.iAtsBx6RCk9ODs2/outputfs.. rw,noatime ......</p>
<p>It means $BACKUP_URL is set to var://BACKUP_UMOUNTCMD which is causing
this issue.</p>
<p>Checking further, I see that BACKUP_URL is set in below two places
which is relevant to our analysis :<br />
<code>[root@rhel7 rear]# grep -rn BACKUP_URL *  | grep var  backup/NETFS/default/10_mount_NETFS_path.sh:8:    BACKUP_URL="var://BACKUP_MOUNTCMD" backup/NETFS/default/98_umount_NETFS_dir.sh:4:    BACKUP_URL="var://BACKUP_UMOUNTCMD" prep/NETFS/default/05_check_NETFS_requirements.sh:17:    ### set other variables from BACKUP_URL</code></p>
<p>I ran "rear -v mkbackup" command and observed logs from
/var/log/rear/rear-rhel7.log file. Along with this, I added debug
statement in other places as well.</p>
<p>When mkbackup command is run, it go through all below stages :</p>
<p><code>2016-09-14 05:16:31 Running 'init' stage 2016-09-14 05:16:31 Running mkbackup workflow 2016-09-14 05:16:31 Running 'prep' stage 2016-09-14 05:16:31 Running DHCP client found, enabling USE_DHCLIENT 2016-09-14 05:16:31 Running 'layout/save' stage 2016-09-14 05:16:33 Running 'rescue' stage 2016-09-14 05:16:34 Running 'build' stage 2016-09-14 05:16:42 Running 'pack' stage 2016-09-14 05:16:59 Running 'output' stage 2016-09-14 05:17:05 Running 'backup' stage 2016-09-14 05:17:05 Running exit tasks.</code></p>
<p>During 'prep' stage, I see that 98_umount_NETFS_dir.sh is sourced and
that's where BACKUP_URL gets set.</p>
<p>// from 98_umount_NETFS_dir.sh , as we have set BACKUP_UMOUNTCMD in
site.conf file, if is true and then set BACKUP_URL</p>
<p><code>if [[ "$BACKUP_UMOUNTCMD" ]] ; then BACKUP_URL="var://BACKUP_UMOUNTCMD" fi</code></p>
<p>2016-09-14 05:16:31 Running 'prep' stage<br />
`<br />
2016-09-14 05:16:31 amote Including
prep/NETFS/default/06_mount_NETFS_path.sh<br />
mkdir: created directory '/tmp/rear.ydwE7wMMk8Y5fme/outputfs'<br />
2016-09-14 05:16:31 amote nfs://192.168.122.1/home/amote/nfs..
/tmp/rear.ydwE7wMMk8Y5fme/outputfs.. rw,noatime ......<br />
2016-09-14 05:16:31 Mounting with 'mount -v -t nfs -o rw,noatime
192.168.122.1:/home/amote/nfs /tmp/rear.ydwE7wMMk8Y5fme/outputfs'<br />
mount.nfs: timeout set for Wed Sep 14 05:18:31 2016<br />
mount.nfs: trying text-based options
'vers=4,addr=192.168.122.1,clientaddr=192.168.122.137'</p>
<p>2016-09-14 05:16:31
amoteSource.../usr/share/rear/prep/NETFS/default/98_umount_NETFS_dir.sh...
&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />
2016-09-14 05:16:31 amote Including
prep/NETFS/default/98_umount_NETFS_dir.sh<br />
2016-09-14 05:16:31 Unmounting with 'my_umount
/tmp/rear.ydwE7wMMk8Y5fme/outputfs'<br />
rmdir: removing directory, '/tmp/rear.ydwE7wMMk8Y5fme/outputfs'</p>
<p>2016-09-14 05:16:31 Finished running 'prep' stage in 0 seconds<br />
`</p>
<p>2016-09-14 05:16:31 Running 'layout/save' stage<br />
<code>55767 extents written (108 MB) 2016-09-14 04:37:51 Wrote ISO image: /var/lib/rear/output/rhel7-09142016-rescue.iso (128M) ... 2016-09-14 04:37:51 Copying files '/var/lib/rear/output/rhel7-09142016-rescue.iso' to nfs location '/var/lib/rear/output/rhel7-09142016-rescue.iso' -&gt; '/tmp/rear.iAtsBx6RCk9ODs2/outputfs/rhel7/rhel7-09142016-rescue.iso' '/usr/share/rear/conf/templates/RESULT_usage_ISO.txt' -&gt; '/tmp/rear.iAtsBx6RCk9ODs2/outputfs/rhel7/README' 2016-09-14 04:37:53 Saved /var/log/rear/rear-rhel7.log as rear.log ... removed '/tmp/rear.iAtsBx6RCk9ODs2/outputfs/rhel7/.lockfile' 2016-09-14 04:37:53 amoteSource.../usr/share/rear/output/default/98_umount_output_dir.sh... 2016-09-14 04:37:53 amote Including output/default/98_umount_output_dir.sh 2016-09-14 04:37:53 Unmounting '/tmp/rear.iAtsBx6RCk9ODs2/outputfs' /tmp/rear.iAtsBx6RCk9ODs2/outputfs: nfs4 mount point detected /tmp/rear.iAtsBx6RCk9ODs2/outputfs: umounted rmdir: removing directory, '/tmp/rear.iAtsBx6RCk9ODs2/outputfs' 2016-09-14 04:37:53 Finished running 'output' stage in 3 seconds</code></p>
<p>Now during last 'backup' stage, 10_mount_NETFS_path.sh script access
BACKUP_URL variable which is already set in 'prep' stage to
"var://BACKUP_UMOUNTCMD". Because of this, its getting failed here.<br />
<code>2016-09-14 04:37:53 Running 'backup' stage 2016-09-14 04:37:53 amote SourceStage... default/00_valid_backup_methods.sh.../usr/share/rear...backup 2016-09-14 04:37:53 amoteSource.../usr/share/rear/backup/default/00_valid_backup_methods.sh... 2016-09-14 04:37:53 amote Including backup/default/00_valid_backup_methods.sh 2016-09-14 04:37:53 amoteSource.../usr/share/rear/backup/NETFS/default/10_mount_NETFS_path.sh... 2016-09-14 04:37:53 amote Including backup/NETFS/default/10_mount_NETFS_path.sh mkdir: created directory '/tmp/rear.iAtsBx6RCk9ODs2/outputfs' 2016-09-14 04:37:53 amote var://BACKUP_UMOUNTCMD.. /tmp/rear.iAtsBx6RCk9ODs2/outputfs.. rw,noatime ...... 2016-09-14 04:37:53 amote1 var..my_umount /tmp/rear.iAtsBx6RCk9ODs2/outputfs..  2016-09-14 04:37:53 Mounting with 'my_umount /tmp/rear.iAtsBx6RCk9ODs2/outputfs' TRYING TO RUN UN-MOUNT COMMAND umount: /tmp/rear.iAtsBx6RCk9ODs2/outputfs: not mounted 2016-09-14 04:37:53 ERROR: Mount command 'my_umount /tmp/rear.iAtsBx6RCk9ODs2/outputfs' failed.</code><br />
=== Stack trace ===<br />
<code>Trace 0: /usr/sbin/rear:251 main Trace 1: /usr/share/rear/lib/mkbackup-workflow.sh:26 WORKFLOW_mkbackup Trace 2: /usr/share/rear/lib/framework-functions.sh:73 SourceStage Trace 3: /usr/share/rear/lib/framework-functions.sh:32 Source Trace 4: /usr/share/rear/backup/NETFS/default/10_mount_NETFS_path.sh:11 source Trace 5: /usr/share/rear/lib/global-functions.sh:155 mount_url Trace 6: /usr/share/rear/lib/_input-output-functions.sh:132 StopIfError Message: Mount command 'my_umount /tmp/rear.iAtsBx6RCk9ODs2/outputfs' failed.</code></p>
<p>To workaround this issue, I defined NETFS_MOUNTCMD in site.conf file
and "rear -v mkbackup" is properly executed without any failure.<br />
<code>$ cat /etc/rear/site.conf  NETFS_URL=nfs://192.168.122.1/home/amote/nfs BACKUP_PROG_ARCHIVE=</code>hostname
-s<code>-backup OUTPUT=ISO ISO_PREFIX="</code>hostname -s<code>-</code>date
+%m%d%Y<code>-rescue" BACKUP=NETFS NETFS_SKIP_WARNING=1 NETFS_PREFIX="$(uname -n)" OUTPUT_PREFIX="$(uname -n)" NETFS_MOUNTCMD="mount -v -t nfs -o rw,noatime 192.168.122.1:/home/amote/nfs" NETFS_UMOUNTCMD="my_umount" my_umount() { echo "TRYING TO RUN UN-MOUNT COMMAND"; umount $1 } ...</code></p>
<h4 id="gdha_commented_at_2016-12-31_0942"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/991#issuecomment-269857735">2016-12-31 09:42</a>:<a class="headerlink" href="#gdha_commented_at_2016-12-31_0942" title="Permanent link">&para;</a></h4>
<p>@gigawatts @ajitmote In the latest development release of ReaR we have
modified the exit messages so that the <code>NETFS_UMOUNTCMD</code> may be
unnecessary. Just give it a try.<br />
If it was just for me I rather see the <code>NETFS_UMOUNTCMD</code> and
<code>NETFS_MOUNTCMD</code> go away. It should be enough to use <code>BACKUP_URL</code><br />
@jsmeix @schlomo Any comments or thoughts?</p>
<h4 id="jsmeix_commented_at_2017-01-02_0956"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/991#issuecomment-269951687">2017-01-02 09:56</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-01-02_0956" title="Permanent link">&para;</a></h4>
<p>The initial comment<br />
<a href="https://github.com/rear/rear/issues/991#issue-174101377">https://github.com/rear/rear/issues/991#issue-174101377</a><br />
reads</p>
<pre>
We define a custom NETFS_UMOUNTCMD variable in our site.conf,
with a function that basically spits out a backup complete message,
along with a timestamp and where the backup was stored
...
A better option (for us) would be a variable we could set
that would run at the very end ... to avoid having to hijack
the umount command in the way that we do.
Does something like that already exist?
</pre>

<p>I think one cannot expect that misuse of NETFS_UMOUNTCMD<br />
has no unexpected side effects.</p>
<p>NETFS_UMOUNTCMD is deprectated.<br />
nowadays it is BACKUP_UMOUNTCMD,<br />
see default.conf.</p>
<p>BACKUP_UMOUNTCMD is meant to be used together<br />
with a matching BACKUP_MOUNTCMD.</p>
<p>To run arbitrary commands at the very end use<br />
POST_BACKUP_SCRIPT</p>
<p>To spit out a backup complete message see<br />
<a href="https://github.com/rear/rear/pull/1022#issuecomment-255323450">https://github.com/rear/rear/pull/1022#issuecomment-255323450</a></p>
<p>I think this issue is sufficiently answered via<br />
<a href="https://github.com/rear/rear/pull/1022">https://github.com/rear/rear/pull/1022</a><br />
so that I close it.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-08-30.991.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
