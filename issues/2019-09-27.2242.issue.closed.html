<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2242 Issue closed: Integration REAR and NetBackup. Script "400_restore_with_nbu.sh". How to create a new variable "sdate" - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2242 Issue closed: Integration REAR and NetBackup. Script \"400_restore_with_nbu.sh\". How to create a new variable \"sdate\"";
        var mkdocs_page_input_path = "issues/2019-09-27.2242.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2242 Issue closed: Integration REAR and NetBackup. Script "400_restore_with_nbu.sh". How to create a new variable "sdate"</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2242_issue_closed_integration_rear_and_netbackup_script_400_restore_with_nbush_how_to_create_a_new_variable_sdate"><a href="https://github.com/rear/rear/issues/2242">#2242 Issue</a> <code>closed</code>: Integration REAR and NetBackup. Script "400_restore_with_nbu.sh". How to create a new variable "sdate"<a class="headerlink" href="#2242_issue_closed_integration_rear_and_netbackup_script_400_restore_with_nbush_how_to_create_a_new_variable_sdate" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code>,
<code>external tool</code></p>
<h4 id="cge77_opened_issue_at_2019-09-27_1828"><img src="https://avatars.githubusercontent.com/u/55893275?v=4" width="50"><a href="https://github.com/cge77">cge77</a> opened issue at <a href="https://github.com/rear/rear/issues/2242">2019-09-27 18:28</a>:<a class="headerlink" href="#cge77_opened_issue_at_2019-09-27_1828" title="Permanent link">&para;</a></h4>
<p>Hi all.</p>
<p>I am with the integration of REAR with NetBackup. I have all fine more
or less but I have a problem I cannot solve because my develop knowledge
is limited :)</p>
<p>The issue is if I do a point in time restore, the date and time I type
is configured in the script "400_restore_with_nbu.sh" in the command
"bprestore" as the variable "edate", that is perfect but when you launch
the recover, NetBackup restores all the full backups of the server from
the date and time you specified and also to the past... This does
obviously the backup is not consistent. You can specify a time interval
in the "bprestore" command using the parameters "-s" (start) and the
previously mentioned "-e" (end). What I intend is to create a new
variable "sdate" for example with the date and time of the variable
"edate" -1 second. I have tested this manually in the command
"bprestore" and works fine. Curiously, you have to put these parameters
in the next order to works fine: "bprestore -e -s", if you do not follow
this order, the command fails. With the parameters "-e" and "-s", you
can restore the exactly backup you want :D</p>
<p>My question is, how I can create a new variable "sdate" getting the
information (date and time) of the variable "edate" and subtracting 1
second? I am checking the proper script "400_restore_with_nbu.sh" and
the script "390_request_point_in_time_restore_parameters.sh" (the
script that treat when REAR ask about the date and time of the restore).
But here are inputs outputs topics and others and I am lost here...</p>
<p>As we commented above, my develop knowledge is limited and I am not be
able to solve this problem... Solve it it would be nice because we would
get REAR and NetBackup able to restore the exact backup :)</p>
<p>Thank you very much!</p>
<p>P.D: a good idea could be using the same date and time in the "-e" and
"-s" parameters and, if this works, we have not do nothing but I tested
and NetBackup give an error 127 that means NetBackup does not find the
backup required.</p>
<p>P.D.2: I can share what I do to integrate REAR and NetBackup if it can
be useful for the community :)</p>
<h4 id="jsmeix_commented_at_2019-10-01_1421"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2242#issuecomment-537059827">2019-10-01 14:21</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-10-01_1421" title="Permanent link">&para;</a></h4>
<p>@cge77<br />
in general please provide the generic information we request in<br />
<a href="https://github.com/rear/rear/blob/master/.github/ISSUE_TEMPLATE.md">https://github.com/rear/rear/blob/master/.github/ISSUE_TEMPLATE.md</a><br />
in particular your /etc/rear/local.conf file and ReaR debug log files<br />
for <code>rear -D mkbackup</code> and <code>rear -D recover</code> could help us<br />
to better see what exactly is going on in your particular case,<br />
cf. "Debugging issues with Relax-and-Recover" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>In general regarding enhanchements for ReaR bash scripts<br />
we would need to get your complete and excat current code<br />
so that we can have a look what exactly the code changes are about<br />
(regardless whether or not your current code changes do actually work).</p>
<p>In particular regarding <code>BACKUP=NBU</code>:<br />
In general there is nothing at all what I could do in case of issues<br />
with third-party backup tools or any other third-party software<br />
because I do not have such software on my test systems<br />
so that I can neither test nor reproduce anything.<br />
But I can help with generic bash scripting issues.</p>
<p>The latest changes related to <code>NBU_*</code> config variables in default conf<br />
<a href="https://github.com/rear/rear/blame/master/usr/share/rear/conf/default.conf#L1616">https://github.com/rear/rear/blame/master/usr/share/rear/conf/default.conf#L1616</a><br />
and<br />
<a href="https://github.com/rear/rear/blame/master/usr/share/rear/conf/default.conf#L1618">https://github.com/rear/rear/blame/master/usr/share/rear/conf/default.conf#L1618</a><br />
point to the GitHub commits<br />
<a href="https://github.com/rear/rear/commit/befc545c679f3be0baaa07ce023f573663df395a">https://github.com/rear/rear/commit/befc545c679f3be0baaa07ce023f573663df395a</a><br />
and<br />
<a href="https://github.com/rear/rear/commit/9d77b78380621741144fe7ccfd041342be1e3d96">https://github.com/rear/rear/commit/9d77b78380621741144fe7ccfd041342be1e3d96</a><br />
that point to the GitHub pull requests and issues<br />
<a href="https://github.com/rear/rear/pull/2132">https://github.com/rear/rear/pull/2132</a><br />
where @rmetrich was working on it<br />
and<br />
<a href="https://github.com/rear/rear/issues/2105">https://github.com/rear/rear/issues/2105</a><br />
where @ofalk was working on it.</p>
<p>@rmetrich @ofalk<br />
could you please have a look here?</p>
<p>@rmetrich<br />
as in<br />
<a href="https://github.com/rear/rear/issues/2105#issuecomment-483186203">https://github.com/rear/rear/issues/2105#issuecomment-483186203</a><br />
I dared to also assign this issue to you.</p>
<h4 id="ofalk_commented_at_2019-10-01_1448"><img src="https://avatars.githubusercontent.com/u/634172?v=4" width="50"><a href="https://github.com/ofalk">ofalk</a> commented at <a href="https://github.com/rear/rear/issues/2242#issuecomment-537072242">2019-10-01 14:48</a>:<a class="headerlink" href="#ofalk_commented_at_2019-10-01_1448" title="Permanent link">&para;</a></h4>
<p>I'd love to help our here, but I do not have this running in my env,
only in some customer environment. Sorry.</p>
<h4 id="cge77_commented_at_2019-10-04_1402"><img src="https://avatars.githubusercontent.com/u/55893275?v=4" width="50"><a href="https://github.com/cge77">cge77</a> commented at <a href="https://github.com/rear/rear/issues/2242#issuecomment-538410387">2019-10-04 14:02</a>:<a class="headerlink" href="#cge77_commented_at_2019-10-04_1402" title="Permanent link">&para;</a></h4>
<p>Hi all.</p>
<p>Thanks for the information and for the help.</p>
<p>I solved the issue using the parameter "-T" (True Image Restore) in the
"bprestore" command in the script "400_restore_with_nbu.sh".</p>
<p>Many thanks!</p>
<h4 id="jsmeix_commented_at_2019-10-05_1251"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2242#issuecomment-538647178">2019-10-05 12:51</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-10-05_1251" title="Permanent link">&para;</a></h4>
<p>@ofalk<br />
thank you for your prompt reply!</p>
<p>@cge77<br />
thank you for your feedback how you got it working for you.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2019-09-27.2242.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
