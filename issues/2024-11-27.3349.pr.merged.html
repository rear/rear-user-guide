<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#3349 PR merged: After doing lots of experiments with RAMdisks it is good to have some… - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#3349 PR merged: After doing lots of experiments with RAMdisks it is good to have some\u2026";
        var mkdocs_page_input_path = "issues/2024-11-27.3349.pr.merged.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#3349 PR merged: After doing lots of experiments with RAMdisks it is good to have some…</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="3349_pr_merged_after_doing_lots_of_experiments_with_ramdisks_it_is_good_to_have_some"><a href="https://github.com/rear/rear/pull/3349">#3349 PR</a> <code>merged</code>: After doing lots of experiments with RAMdisks it is good to have some…<a class="headerlink" href="#3349_pr_merged_after_doing_lots_of_experiments_with_ramdisks_it_is_good_to_have_some" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>fixed / solved / done</code>,
<code>Dedicated Priority Support</code></p>
<h4 id="gdha_opened_issue_at_2024-11-27_1032"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> opened issue at <a href="https://github.com/rear/rear/pull/3349">2024-11-27 10:32</a>:<a class="headerlink" href="#gdha_opened_issue_at_2024-11-27_1032" title="Permanent link">&para;</a></h4>
<h5 id="pull_request_details">Pull Request Details:<a class="headerlink" href="#pull_request_details" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p>Type: <strong>Enhancement</strong></p>
</li>
<li>
<p>Impact: <strong>Low</strong></p>
</li>
<li>
<p>Reference to related issue (URL): n/a</p>
</li>
<li>
<p>How was this pull request tested? many times for a customer project</p>
</li>
<li>
<p>Description of the changes in this pull request: adding 2 extra
    software pieces to the default PROGS array to assist in grub2 steps</p>
</li>
</ul>
<h4 id="jsmeix_commented_at_2024-11-27_1254"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/3349#issuecomment-2503808679">2024-11-27 12:54</a>:<a class="headerlink" href="#jsmeix_commented_at_2024-11-27_1254" title="Permanent link">&para;</a></h4>
<p>I would like to clarify here via comment<br />
WHY it is "the right thing" that<br />
systemd-detect-virt grub2-editenv grubby<br />
are added to the PROGS array<br />
and not to the REQUIRED_PROGS array<br />
regardless that the comments in the code</p>
<pre><code># In some cases to detect an USB device properly we need:
systemd-detect-virt
# In case we want to recreate initial ramdisks it is good to have:
grub2-editenv
grubby
</code></pre>
<p>indicate that REQUIRED_PROGS might be even better?</p>
<p>I think the PROGS array is exactly right here because<br />
we can sufficiently safely assume that on systems where<br />
systemd-detect-virt is needed to detect an USB device properly<br />
systemd-detect-virt is installed<br />
and same argument for grub2-editenv and grubby:<br />
On systems where grub2-editenv and/or grubby are needed<br />
to recreate the initial ramdisk, we can sufficiently safely<br />
assume that there grub2-editenv and/or grubby are installed.</p>
<p>So using the PROGS array is exactly right because<br />
this way things behave backward compatible on systems<br />
where systemd-detect-virt grub2-editenv grubby do not exist,<br />
e.g. on my openSUSE Leap 15.5 system where grubby is not installed:</p>
<pre><code># for p in systemd-detect-virt grub2-editenv grubby ; do type -a $p ; done
systemd-detect-virt is /usr/bin/systemd-detect-virt
grub2-editenv is /usr/bin/grub2-editenv
-bash: type: grubby: not found

# rpm -qf /usr/bin/systemd-detect-virt
systemd-249.17-150400.8.43.1.x86_64

# rpm -qf /usr/bin/grub2-editenv
grub2-2.06-150500.29.34.2.x86_64

# zypper search grubby
S  | Name   | Summary                                           | Type
---+--------+---------------------------------------------------+--------
   | grubby | Command line tool for updating bootloader configs | package
</code></pre>
<h4 id="pcahyna_commented_at_2024-12-02_1802"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/3349#issuecomment-2512306781">2024-12-02 18:02</a>:<a class="headerlink" href="#pcahyna_commented_at_2024-12-02_1802" title="Permanent link">&para;</a></h4>
<p>It is right to use <code>PROGS</code> and not <code>REQUIRED_PROGS</code> - GRUB2 is not the
only bootloader and we still support non-systemd distros to some extent.
<code>grubby</code> is not even a standard tool packaged with GRUB2, it is a
separate tool, not always available.</p>
<p>However, adding GRUB tools here does not seem right, all other GRUB
tools get added in
<code>usr/share/rear/prep/GNU/Linux/300_include_grub_tools.sh</code>. Would you
agree to moving the <code>grub2-editenv</code> line and perhaps the <code>grubby</code> line
there?</p>
<p>By the way, @gdha , can you please share details of your experiments and
how/where have you recreated initial ramdisks? I am curious why you have
needed to include anything more for this, because ramdisk recreation
should run in the recreated system (under <code>chroot $TARGET_FS_ROOT</code>), and
I checked the sources that this is indeed happening, and all the tools
are available there, even if they are not in in the ReaR rescue ramdisk.
Even Grubby should be IMO used only in the chroot and not in the ReaR
rescue ramdisk.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2024-11-27.3349.pr.merged.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
