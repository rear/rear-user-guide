<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2331 Issue closed: Hard-coded home directory of root - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2331 Issue closed: Hard-coded home directory of root";
        var mkdocs_page_input_path = "issues/2020-02-07.2331.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_rsync.html">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2331 Issue closed: Hard-coded home directory of root</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2331_issue_closed_hard-coded_home_directory_of_root"><a href="https://github.com/rear/rear/issues/2331">#2331 Issue</a> <code>closed</code>: Hard-coded home directory of root<a class="headerlink" href="#2331_issue_closed_hard-coded_home_directory_of_root" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>cleanup</code>, <code>fixed / solved / done</code></p>
<h4 id="gozora_opened_issue_at_2020-02-07_0847"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> opened issue at <a href="https://github.com/rear/rear/issues/2331">2020-02-07 08:47</a>:<a class="headerlink" href="#gozora_opened_issue_at_2020-02-07_0847" title="Permanent link">&para;</a></h4>
<p>ReaR have on multiple places hard-coded home directory of <em>root</em> user.
This is OK most of the time, but I've came across multiple servers that
had home directory of root user relocated (for various reasons) to
different locations (e.g. <em>/root/home/root</em>).<br />
Since ReaR requires to be launched under <em>root</em> user, I think that we
should replace static string <em>root/.ssh/*</em> with <em>$HOME/.ssh/*</em> to
reflect real home directory of <em>root</em>.</p>
<p>What do you guys think?</p>
<p>If there are no objections I would prepare PR ...</p>
<p>V.</p>
<h4 id="jsmeix_commented_at_2020-02-07_1018"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583325638">2020-02-07 10:18</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-02-07_1018" title="Permanent link">&para;</a></h4>
<p>I am wondering what the officially right home directory for the root
user is.</p>
<p><a href="https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard">https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard</a><br />
tells</p>
<pre><code>/root    Home directory for the root user.
</code></pre>
<p>so on first glance according to plain reading only that piece of text<br />
it seems the "officially right home directory for the root user"<br />
could be indeed hardcoded <code>/root</code>.</p>
<p>On the other hand "Dirty hacks welcome" in<br />
<a href="https://github.com/rear/rear/wiki/Coding-Style">https://github.com/rear/rear/wiki/Coding-Style</a><br />
reads</p>
<pre><code>it is more important that the Relax-and-Recover code works
than having nice looking clean code that sometimes fails
</code></pre>
<p>I fear there are cases (e.g crazy admins or whatever ;-)<br />
where <code>/root</code> exists but for the root user $HOME<br />
is set to a different directory so we cannot make<br />
a hardcoded decision in our code if hardcoded <code>/root</code><br />
or the root user's $HOME value is the right place.<br />
In this case the usual way out of "*nix diversity hell"<br />
is to have just another config variable in default.conf</p>
<pre><code># According to the Filesystem Hierarchy Standard
# the home directory for the root user has to be '/root'
# cf. https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard
# but you may set it as needed like ROOT_HOME_DIR="$HOME"
ROOT_HOME_DIR="/root"
</code></pre>
<p>and use its value in our scripts.</p>
<h4 id="jsmeix_commented_at_2020-02-07_1030"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583330360">2020-02-07 10:30</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-02-07_1030" title="Permanent link">&para;</a></h4>
<p>What scripts I found where a hardcoded <code>/root</code> is used<br />
for the home directory of the root user:</p>
<pre><code># find usr/sbin/rear usr/share/rear/ -type f \
 | xargs grep '/root' \
 | egrep -v ': *#|TARGET_FS_ROOT/root|/rootfs|ROOTFS_DIR/root|EFI_STUB_EFIBOOTMGR_ARGS|FHSdirectories' \
 | cut -d ':' -f1 | sort -u

usr/share/rear/conf/examples/borg-example.conf
usr/share/rear/lib/global-functions.sh
usr/share/rear/prep/DUPLICITY/default/050_prep_duplicity.sh
usr/share/rear/prep/DUPLICITY/default/200_find_duply_profile.sh
usr/share/rear/rescue/default/500_ssh.sh
usr/share/rear/restore/DUPLICITY/default/110_check_temp_dir_with_duply.sh
usr/share/rear/setup/default/005_ssh_agent_start.sh
usr/share/rear/skel/default/bin/login
usr/share/rear/skel/default/etc/passwd
</code></pre>
<h4 id="gozora_commented_at_2020-02-07_1031"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583330661">2020-02-07 10:31</a>:<a class="headerlink" href="#gozora_commented_at_2020-02-07_1031" title="Permanent link">&para;</a></h4>
<p>Hmm, I'd prefer to have ROOT_HOME_DIR=$HOME as default because home is
wherever $HOME points to :-), and use "/root" as reasonable fallback
when $ROOT_HOME_DIR is empty/unset or non existing.</p>
<p>V.</p>
<h4 id="jsmeix_commented_at_2020-02-07_1035"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583332190">2020-02-07 10:35</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-02-07_1035" title="Permanent link">&para;</a></h4>
<p>Any reasonable default is o.k. for me<br />
but it should be sufficiently fail-safe e.g. like</p>
<pre><code>test -d "$HOME" &amp;&amp; ROOT_HOME_DIR="$HOME" || ROOT_HOME_DIR='/root'
</code></pre>
<p>because I think it is not impossible that $HOME migt be unset<br />
or false set at the time when "rear" is run.</p>
<h4 id="jsmeix_commented_at_2020-02-07_1037"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583333178">2020-02-07 10:37</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-02-07_1037" title="Permanent link">&para;</a></h4>
<p>@gozora<br />
sorry for my weisenheimer comment - I had not read that you<br />
had already described the exact same fallback behaviour.</p>
<h4 id="gozora_commented_at_2020-02-07_1038"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583333364">2020-02-07 10:38</a>:<a class="headerlink" href="#gozora_commented_at_2020-02-07_1038" title="Permanent link">&para;</a></h4>
<p><code>test -d "$HOME" &amp;&amp; ROOT_HOME_DIR="$HOME" || ROOT_HOME_DIR='/root'</code>
looks good.</p>
<p>Do you think it could be verbatim used in <em>default.conf</em></p>
<h4 id="jsmeix_commented_at_2020-02-07_1041"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583334569">2020-02-07 10:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-02-07_1041" title="Permanent link">&para;</a></h4>
<p>Why not?<br />
All config files are sourced and executed as sctipts, cf.<br />
<a href="https://github.com/rear/rear/issues/2311">https://github.com/rear/rear/issues/2311</a><br />
and for an example see<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L87">https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L87</a></p>
<h4 id="gozora_commented_at_2020-02-07_1042"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583335042">2020-02-07 10:42</a>:<a class="headerlink" href="#gozora_commented_at_2020-02-07_1042" title="Permanent link">&para;</a></h4>
<p>OK, see you in comments under PR ;-).</p>
<p>Thanks for now!</p>
<p>V.</p>
<h4 id="jsmeix_commented_at_2020-02-07_1055"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583339597">2020-02-07 10:55</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-02-07_1055" title="Permanent link">&para;</a></h4>
<p>I promise to refrain from "by the way while you are at it" ideas<br />
in your upcoming pull request (at least this time ;-)</p>
<h4 id="gozora_commented_at_2020-02-07_1130"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583351946">2020-02-07 11:30</a>:<a class="headerlink" href="#gozora_commented_at_2020-02-07_1130" title="Permanent link">&para;</a></h4>
<p>@jsmeix you don't need to! If something has to be fixed, then it has to
be fixed ;-)</p>
<p>V.</p>
<h4 id="jsmeix_commented_at_2020-02-07_1154"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583359508">2020-02-07 11:54</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-02-07_1154" title="Permanent link">&para;</a></h4>
<p>No worries!<br />
Deliberately I had only promised for "at least this time" ;-))</p>
<h4 id="pcahyna_commented_at_2020-02-07_1321"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583386202">2020-02-07 13:21</a>:<a class="headerlink" href="#pcahyna_commented_at_2020-02-07_1321" title="Permanent link">&para;</a></h4>
<p>I would say the usual idiom is<br />
<code>ROOT_HOME_DIR="${HOME:-/root}"</code></p>
<p>Also, is the intent to let the user set it? If not, it probably should
not be in default.conf because it serves as documentation of what are
all the supported user-settable variables.</p>
<h4 id="gozora_commented_at_2020-02-07_1328"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583388684">2020-02-07 13:28</a>:<a class="headerlink" href="#gozora_commented_at_2020-02-07_1328" title="Permanent link">&para;</a></h4>
<p>Hello @pcahyna,</p>
<blockquote>
<p>I would say the usual idiom is<br />
ROOT_HOME_DIR="${HOME:-/root}"</p>
</blockquote>
<p>That look handy, I'll certainly consider using it.</p>
<blockquote>
<p>Also, is the intent to let the user set it?</p>
</blockquote>
<p>As far as I know, everything in default.conf can be overridden by
local.conf/site.conf.</p>
<p>V.</p>
<h4 id="jsmeix_commented_at_2020-02-07_1334"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583390878">2020-02-07 13:34</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-02-07_1334" title="Permanent link">&para;</a></h4>
<p>@pcahyna<br />
thank you for the much simpler code.</p>
<p>The intent is that the user could specify ROOT_HOME_DIR<br />
to anything as needed in even special exceptional cases<br />
(cf. "final power to the user") regardless that I assume</p>
<pre><code>ROOT_HOME_DIR="${HOME:-/root}"
</code></pre>
<p>does the right thing in 99.999999% of the cases.</p>
<h4 id="pcahyna_commented_at_2020-02-07_1346"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583395507">2020-02-07 13:46</a>:<a class="headerlink" href="#pcahyna_commented_at_2020-02-07_1346" title="Permanent link">&para;</a></h4>
<p>One possible problem with this approach is if one wants to run ReaR as
not-root user (it would have to be a user which is granted some special
capabilities). In that case, does one really intend to use the $HOME of
that user? If so, this approach is fine. OTOH if one really means the
home directory of root, it could be better to use ~root. (Executing as
non-root is currently not supported, but should not be prevented in the
future.)</p>
<p>IMO it is also necessary to distinguish the original system - where rear
mkrescue or rear mkbackup is being executed and where root may have a
non-standard $HOME (so this concern is valid), and the rescue ramdisk,
which is created by us and we can hardcode /root, because we know where
we put it.</p>
<h4 id="gozora_commented_at_2020-02-07_1350"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583396787">2020-02-07 13:50</a>:<a class="headerlink" href="#gozora_commented_at_2020-02-07_1350" title="Permanent link">&para;</a></h4>
<p>I'm intending to change only hard coded values only for original system
(where mkbackup or mkrescue) is launched, ReaR recovery system should
remain unchanged.</p>
<p>V.</p>
<h4 id="gozora_commented_at_2020-02-07_1358"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583399848">2020-02-07 13:58</a>:<a class="headerlink" href="#gozora_commented_at_2020-02-07_1358" title="Permanent link">&para;</a></h4>
<blockquote>
<p>One possible problem with this approach is if one wants to run ReaR as
not-root user (it would have to be a user which is granted some
special capabilities). In that case, does one really intend to use the
$HOME of that user? If so, this approach is fine. OTOH if one really
means the home directory of root, it could be better to use ~root.
(Executing as non-root is currently not supported, but should not be
prevented in the future.)</p>
</blockquote>
<p>This is a good point, although I'm not sure if anybody ever tried to
launch ReaR just with capabilities, but to be on safe side <code>~root</code>
should be more suitable than <em>$HOME</em>. Even further, how about reading
root home directory from <em>/etc/passwd</em> to avoid possible problems with
<code>~root</code> (I'm not sure how fail safe <code>~root</code> is, despite I'm using it
quite often).</p>
<p>V.</p>
<h4 id="pcahyna_commented_at_2020-02-07_1409"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583404066">2020-02-07 14:09</a>:<a class="headerlink" href="#pcahyna_commented_at_2020-02-07_1409" title="Permanent link">&para;</a></h4>
<p>@gozora this is more a discussion point, in fact <code>$HOME</code> might be
entirely appropriate (one might prefer to copy the invoking user's ssh
keys instead of root's ssh keys - assuming that recovery will be
executed as the same user).</p>
<p>Concerning ~root, if root's home is indeed intended, I think ~root is
preferable to parsing of /etc/passwd, the latter seems more error-prone.</p>
<h4 id="gozora_commented_at_2020-02-07_1418"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583407591">2020-02-07 14:18</a>:<a class="headerlink" href="#gozora_commented_at_2020-02-07_1418" title="Permanent link">&para;</a></h4>
<p>I'm looking here for replacing <em>/root/</em> with actual <strong>root</strong> home
directory so I think that additional complexity with "invoking user"
should not be messed with. So let's stick with <code>~root</code> for now.</p>
<p>V.</p>
<h4 id="pcahyna_commented_at_2020-02-07_1424"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583410323">2020-02-07 14:24</a>:<a class="headerlink" href="#pcahyna_commented_at_2020-02-07_1424" title="Permanent link">&para;</a></h4>
<p>Makes sense, the transition to $HOME where appropriate can be made
separately.</p>
<h4 id="jsmeix_commented_at_2020-02-07_1447"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583421695">2020-02-07 14:47</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-02-07_1447" title="Permanent link">&para;</a></h4>
<p>I think currently it is totally unsupported to run ReaR as non-<code>root</code>
user<br />
like a user with effective user ID 0 that is not named <code>root</code>.<br />
I.e. I would not be surprised if the user name must be <code>root</code>.</p>
<p>But I never even tried to run ReaR as non-<code>root</code> user<br />
except by accident where I was exited at<br />
<a href="https://github.com/rear/rear/blob/master/usr/sbin/rear#L288">https://github.com/rear/rear/blob/master/usr/sbin/rear#L288</a></p>
<pre><code># ReaR must run as 'root' (i.e. abort if effective user ID is not 0):
if test "$( id --user )" != "0" ; then
    echo "ERROR: $PRODUCT needs 'root' privileges (effective user ID is not 0)" &gt;&amp;2
    exit 1
fi
</code></pre>
<h4 id="gozora_commented_at_2020-02-07_1452"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583424058">2020-02-07 14:52</a>:<a class="headerlink" href="#gozora_commented_at_2020-02-07_1452" title="Permanent link">&para;</a></h4>
<p>@jsmeix maybe one day, when there is nothing more to fix, we can take a
look into thins :-).</p>
<p>V.</p>
<h4 id="jsmeix_commented_at_2020-02-07_1511"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-583444031">2020-02-07 15:11</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-02-07_1511" title="Permanent link">&para;</a></h4>
<p>Yes!<br />
Preferably on a relaxed weekend when nothing else is to do ;-)</p>
<p>Have a nice and relaxed weekend!</p>
<h4 id="jsmeix_commented_at_2020-02-12_0907"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2331#issuecomment-585103884">2020-02-12 09:07</a>:<a class="headerlink" href="#jsmeix_commented_at_2020-02-12_0907" title="Permanent link">&para;</a></h4>
<p>According to what<br />
<a href="http://relax-and-recover.org/documentation/getting-started">http://relax-and-recover.org/documentation/getting-started</a><br />
reads (excerpts)</p>
<pre><code>git clone https://github.com/rear/rear.git
cd rear/
sudo usr/sbin/rear format /dev/sdb
sudo usr/sbin/rear -v mkrescue
sudo usr/sbin/rear -v mkbackup
</code></pre>
<p>it seems ReaR works when a normal user calls it via <code>sudo</code><br />
which seems to be sufficient at least as far as <code>sudo</code> works<br />
on my openSUSE Leap 15.1 system:</p>
<pre><code>johannes@host:~&gt; sudo bash -c '( set -x ; pwd ; echo $HOME ~root ~ ; id )'
[sudo] password for root:

+ pwd
/home/johannes
+ echo /root /root /root
/root /root /root
+ id
uid=0(root) gid=0(root) groups=0(root)
</code></pre>
<p>so it seems <code>sudo</code> behaves more like <code>su root</code> than <code>su - root</code><br />
but it seems for ReaR <code>sudo</code> and <code>su root</code> are sufficient.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2020-02-07.2331.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
