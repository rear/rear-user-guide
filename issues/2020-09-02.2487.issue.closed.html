<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2487 Issue closed: RPC Portmapper "rpcbind" unavailable - Proxmox Recovery - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2487 Issue closed: RPC Portmapper \"rpcbind\" unavailable - Proxmox Recovery";
        var mkdocs_page_input_path = "issues/2020-09-02.2487.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2487 Issue closed: RPC Portmapper "rpcbind" unavailable - Proxmox Recovery</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2487_issue_closed_rpc_portmapper_rpcbind_unavailable_-_proxmox_recovery"><a href="https://github.com/rear/rear/issues/2487">#2487 Issue</a> <code>closed</code>: RPC Portmapper "rpcbind" unavailable - Proxmox Recovery<a class="headerlink" href="#2487_issue_closed_rpc_portmapper_rpcbind_unavailable_-_proxmox_recovery" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code></p>
<h4 id="aftermath8_opened_issue_at_2020-09-02_1618"><img src="https://avatars.githubusercontent.com/u/61789098?v=4" width="50"><a href="https://github.com/aftermath8">aftermath8</a> opened issue at <a href="https://github.com/rear/rear/issues/2487">2020-09-02 16:18</a>:<a class="headerlink" href="#aftermath8_opened_issue_at_2020-09-02_1618" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"):<br />
    2.4 Git</p>
</li>
<li>
<p>OS version ("cat /etc/os-release" or "lsb_release -a" or "cat
    /etc/rear/os.conf"):<br />
    No LSB modules are available.<br />
    Distributor ID: Debian<br />
    Description: Debian GNU/Linux 10 (buster)<br />
    Release: 10<br />
    Codename: buster</p>
</li>
<li>
<p>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):</p>
</li>
</ul>
<!-- -->

<pre><code>OUTPUT=ISO
OUTPUT_URL="nfs://192.168.178.110/mnt/proxmox_share"
BACKUP=NETFS
BACKUP_URL="nfs://192.168.178.110/mnt/proxmox_share"
BACKUP_OPTIONS="nfsvers=4,nolock"
</code></pre>
<ul>
<li>
<p>Hardware (PC or PowerNV BareMetal or ARM) or virtual machine (KVM
    guest or PoverVM LPAR):<br />
    KVM</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device):</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot):<br />
    BIOS</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe):</p>
</li>
<li>
<p>Storage layout ("lsblk -ipo
    NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,SIZE,MOUNTPOINT" or "lsblk" as
    makeshift):</p>
</li>
</ul>
<!-- -->

<pre><code>$ lsblk
NAME               MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sda                  8:0    0 465.8G  0 disk 
`-sda1               8:1    0 465.8G  0 part /mnt/pve/ExternF1
sdb                  8:16   0 238.5G  0 disk 
|-sdb1               8:17   0  1007K  0 part 
|-sdb2               8:18   0   512M  0 part 
`-sdb3               8:19   0   238G  0 part 
  |-pve-swap       253:0    0     8G  0 lvm  [SWAP]
  |-pve-root       253:1    0  59.3G  0 lvm  /
  |-pve-data_tmeta 253:2    0   1.6G  0 lvm  
  | `-pve-data     253:4    0 151.6G  0 lvm  
  `-pve-data_tdata 253:3    0 151.6G  0 lvm  
    `-pve-data     253:4    0 151.6G  0 lvm  
sdc                  8:32   1   3.8G  0 disk 
`-sdc1               8:33   1   3.8G  0 part 
sdd                  8:48   1  15.1G  0 disk 
sde                  8:64   0 465.8G  0 disk 
|-sde1               8:65   0 121.1G  0 part 
`-sde2               8:66   0 344.7G  0 part 
sr0                 11:0    1  1024M  0 rom
</code></pre>
<p>Hello,</p>
<p>First of all, I would like to thank you for this excellent software that
makes life easier for all sysadmins.</p>
<p>Actually I am implementing a Backup/Disaster Recovery strategy for a
medical environment, with virtual servers hosted on Proxmox
(<a href="https://pve.proxmox.com/wiki/Main_Page"></a>) for my license thesis.<br />
The project is still in the simulation phase but the idea is to make
Backups and Disaster Recovery of virtual machines, but also of Proxmox
itself (more precisely of the node in which the virtual machines are
located) in order to be able to facilitate the Disaster Recovery
process. It's indeed quite possible to do it by saving the configuration
of <code>/etc</code> and <code>/var/lib/pve-cluster</code> with periodic cronjobs and then do
some tinkering, but this is not very intuitive.</p>
<p>ReaR works perfectly fine with virtual machines but it's when I try to
apply it to the Proxmox server that things get complicated. First, by
running the simulation command, this is what I get:</p>
<p><a href="https://github.com/aftermath8/Bachelorarbeit/files/5162818/rear.-s.mkbackup.txt">rear -s
mkbackup.txt</a></p>
<ul>
<li>This is the first dysfunction I've noticed:</li>
</ul>
<!-- -->

<pre><code>Exiting rear mkbackup (PID 16241) and its descendant processes
Running exit tasks
</code></pre>
<p>I call it a <em>dysfunction</em> because I don't get any error message but also
this is not how it should run (at least, it did not appear for virtual
machines' simulation)</p>
<p>So once I run <code>rear -v mkbackup</code>, ReaR does the job with obviously the
same dysfunction message at the end:<br />
<a href="https://github.com/aftermath8/Bachelorarbeit/files/5163194/rear.-v.mkbackup.txt">rear -v
mkbackup.txt</a></p>
<ul>
<li>
<p>So I create a VM and try to restore my Proxmox on it. The second
    dysfunction is that when I access the recovery terminal, I notice
    that my virtual machine has the same IP address as my Proxmox server
    (this should not happen because Proxmox generates a new IP for every
    VM). So I ping to see which address is free on the router and I
    change it manually in <code>/etc/hosts</code>, then reboot, but it doesn't
    change anything.</p>
</li>
<li>
<p>This is what I get after <code>rear -v recover</code></p>
</li>
</ul>
<p><img alt="Screenshot" src="https://user-images.githubusercontent.com/61789098/92006625-42f37800-ed45-11ea-9d87-0f4ba492a423.png" /></p>
<p><img alt="Screenshot2" src="https://user-images.githubusercontent.com/61789098/92006631-4555d200-ed45-11ea-9a06-b84c1259d637.png" /></p>
<p>Sorry for being maybe too "amateur", I'm learning the job :man_student:</p>
<p>Thank you!</p>
<h4 id="gdha_commented_at_2020-09-04_1132"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2487#issuecomment-687088736">2020-09-04 11:32</a>:<a class="headerlink" href="#gdha_commented_at_2020-09-04_1132" title="Permanent link">&para;</a></h4>
<p>@aftermath8 See
<a href="http://relax-and-recover.org/documentation/faq">http://relax-and-recover.org/documentation/faq</a>
section IP Migration. You could also use DHCP via defining the vairable
<strong>USE_DHCLIENT=yes</strong> in the <code>/etc/rear/local.conf</code> file.</p>
<h4 id="aftermath8_commented_at_2020-09-04_1328"><img src="https://avatars.githubusercontent.com/u/61789098?v=4" width="50"><a href="https://github.com/aftermath8">aftermath8</a> commented at <a href="https://github.com/rear/rear/issues/2487#issuecomment-687145630">2020-09-04 13:28</a>:<a class="headerlink" href="#aftermath8_commented_at_2020-09-04_1328" title="Permanent link">&para;</a></h4>
<p>Hi @gdha<br />
Thank you for your answer! I used the variable <code>USE_DHCLIENT=yes</code> and
the IP address is indeed not the same anymore, but there is still a
problem with <code>rpcbind</code>, which means that the Recovery process cannot be
executed:</p>
<p><img alt="Screenshot22" src="https://user-images.githubusercontent.com/61789098/92244438-3432cf80-eec3-11ea-99da-92ec0012eba6.png" /></p>
<h4 id="gdha_commented_at_2020-09-05_0801"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2487#issuecomment-687569198">2020-09-05 08:01</a>:<a class="headerlink" href="#gdha_commented_at_2020-09-05_0801" title="Permanent link">&para;</a></h4>
<p>@aftermath8 Check if issue #2341 could help you with your problem? It
is for RHEL, but yeah you never know.<br />
And, issue #2250 is maybe a better one to check.</p>
<h4 id="aftermath8_commented_at_2020-09-05_1746"><img src="https://avatars.githubusercontent.com/u/61789098?v=4" width="50"><a href="https://github.com/aftermath8">aftermath8</a> commented at <a href="https://github.com/rear/rear/issues/2487#issuecomment-687641097">2020-09-05 17:46</a>:<a class="headerlink" href="#aftermath8_commented_at_2020-09-05_1746" title="Permanent link">&para;</a></h4>
<p>Both issues helped, no such error message anymore, thanks!</p>
<p>Summary of the solution:</p>
<ul>
<li>Added <code>USE_DHCLIENT=yes</code></li>
<li>Replaced<br />
<code>test "ok" = $attempt || Error "RPC portmapper '$portmapper_program' unavailable."</code><br />
    by<br />
<code>test "ok" = $attempt || LogPrint "RPC portmapper '$portmapper_program' unavailable."</code></li>
<li>Replaced<br />
<code>rpcinfo -p 2&gt;/dev/null | grep -q 'portmapper' &amp;&amp; { attempt="ok" ; break ; }</code><br />
    by<br />
<code>rpcinfo -p | tee -a $RUNTIME_LOGFILE | grep -q 'portmapper' &amp;&amp; { attempt="ok" ; break ; }</code></li>
</ul>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2020-09-02.2487.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
