<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#924 Issue closed: Missing cifs credentials file in rescue image - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#924 Issue closed: Missing cifs credentials file in rescue image";
        var mkdocs_page_input_path = "issues/2016-07-18.924.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#924 Issue closed: Missing cifs credentials file in rescue image</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="924_issue_closed_missing_cifs_credentials_file_in_rescue_image"><a href="https://github.com/rear/rear/issues/924">#924 Issue</a> <code>closed</code>: Missing cifs credentials file in rescue image<a class="headerlink" href="#924_issue_closed_missing_cifs_credentials_file_in_rescue_image" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>bug</code>, <code>documentation</code>, <code>fixed / solved / done</code></p>
<h4 id="tcerna_opened_issue_at_2016-07-18_0841"><img src="https://avatars.githubusercontent.com/u/17880584?u=6b03fa3ad0e06b52aa12a38c04e4d31e92686106&v=4" width="50"><a href="https://github.com/tcerna">tcerna</a> opened issue at <a href="https://github.com/rear/rear/issues/924">2016-07-18 08:41</a>:<a class="headerlink" href="#tcerna_opened_issue_at_2016-07-18_0841" title="Permanent link">&para;</a></h4>
<ul>
<li>rear version (/usr/sbin/rear -V):<br />
    rear-1.17.2-1.el7.noarch</li>
<li>OS version (cat /etc/rear/os.conf or lsb_release -a):<br />
    RHEL-7</li>
<li>rear configuration files (cat /etc/rear/site.conf or cat
    /etc/rear/local.conf):</li>
</ul>
<!-- -->

<pre><code>[root@rearclient ~]# cat /etc/rear/local.conf
OUTPUT=ISO
OUTPUT_URL=cifs://192.168.122.129/rear
OUTPUT_OPTIONS="cred=/etc/rear/.cifs"
BACKUP=NETFS
BACKUP_URL=cifs://192.168.122.129/rear
BACKUP_OPTIONS="cred=/etc/rear/.cifs"

[root@rearclient ~]# cat /etc/rear/.cifs
username=root 
password=root
</code></pre>
<ul>
<li>Brief description of the issue:</li>
</ul>
<p>Rescue image does not contain cifs credentials file specified during
image &amp; backup creation which causes an error during the backup
restoration procedure. Even though this file can be manually recreated
in rear's rescue shell, you should consider adding it to the final
rescue image, especially when it is explicitly mentioned in the man page
under BACKUP_URL=cifs:// section.</p>
<h4 id="jsmeix_commented_at_2016-07-18_1018"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-233292979">2016-07-18 10:18</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-18_1018" title="Permanent link">&para;</a></h4>
<p>Regardless that I don't know about cifs:</p>
<p>In general when something is missing<br />
in the rear recovery system ("rescue image"),<br />
you can specify what you need therein via</p>
<pre>
COPY_AS_IS=( "${COPY_AS_IS[@]}" /path/to/file1 /path/to/file2 )
REQUIRED_PROGS=( "${REQUIRED_PROGS[@]}" program1 program2 )
</pre>

<p>See usr/share/rear/conf/default.conf</p>
<p>For an example you may have a look at<br />
usr/share/rear/conf/examples/SLE12-SP1-btrfs-example.conf</p>
<p>In particular to get those automatocally for cifs<br />
you need to implement something appropriate<br />
in the rear scripts that works for you and<br />
then provide that as Github pull request.</p>
<h4 id="jsmeix_commented_at_2016-07-22_1116"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-234518928">2016-07-22 11:16</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-22_1116" title="Permanent link">&para;</a></h4>
<p>@tcerna<br />
does it work for you with appropriate COPY_AS_IS<br />
and/or REQUIRED_PROGS settings?</p>
<h4 id="jsmeix_commented_at_2016-07-29_1024"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-236146849">2016-07-29 10:24</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-29_1024" title="Permanent link">&para;</a></h4>
<p>No feedback.<br />
Assuming no news is good news.<br />
Closing.</p>
<h4 id="jsmeix_commented_at_2016-08-01_1229"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-236567264">2016-08-01 12:29</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-01_1229" title="Permanent link">&para;</a></h4>
<p>By chance I noticed in<br />
<a href="https://github.com/rear/rear/issues/943#issue-167618522">https://github.com/rear/rear/issues/943#issue-167618522</a></p>
<pre>
BACKUP_URL="cifs://192.168.0.13/g/BACKUPS/rear"
BACKUP_OPTIONS="cred=/etc/rear/creds"
</pre>

<p>I tested what happens when one has</p>
<pre>
etc/rear/.cifs
</pre>

<p>versus</p>
<pre>
etc/rear/cifs
</pre>

<p>and - guess what - etc/rear/.cifs does not get<br />
automatically copied into the rear recovery system<br />
but etc/rear/cifs gets automatically copied into<br />
the rear recovery system.</p>
<p>Therefore there is a bug in the man page.<br />
Instead of using a dot file it should describe<br />
using a normal file name.</p>
<h4 id="jsmeix_commented_at_2016-08-01_1237"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-236568869">2016-08-01 12:37</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-01_1237" title="Permanent link">&para;</a></h4>
<p>The reason is in<br />
usr/share/rear/build/GNU/Linux/10_copy_as_is.sh<br />
that code:</p>
<pre>
### Copy configuration directory
mkdir $v -p $ROOTFS_DIR/etc/rear
cp $v -r $CONFIG_DIR/* $ROOTFS_DIR/etc/rear/ >&2
</pre>

<h4 id="jsmeix_commented_at_2016-08-01_1254"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-236572324">2016-08-01 12:54</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-01_1254" title="Permanent link">&para;</a></h4>
<p>With
<a href="https://github.com/rear/rear/pull/947">https://github.com/rear/rear/pull/947</a>
merged<br />
I consider the issue to be fixed.</p>
<h4 id="gdha_commented_at_2016-08-01_1427"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-236596211">2016-08-01 14:27</a>:<a class="headerlink" href="#gdha_commented_at_2016-08-01_1427" title="Permanent link">&para;</a></h4>
<p>@jsmeix what prevents us from doing
<code>cp $v -r $CONFIG_DIR/   $ROOTFS_DIR/etc/ &gt;&amp;2</code> to also include the dot
files? And, the <code>mkdir</code> line wouldn't be needed as well then...</p>
<h4 id="jsmeix_commented_at_2016-08-02_1133"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-236878112">2016-08-02 11:33</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-02_1133" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
there are no comments in the code that explain<br />
why the code is as it is so that I cannot know<br />
why dot files are not copied.<br />
I assumed this behaviour is intentional but I did not want<br />
to do forensics in this case to find out what might be<br />
actually meant with this code.<br />
Therefore I simply adapted the documentation to match<br />
what the current code does.</p>
<h4 id="jsmeix_commented_at_2016-08-02_1139"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-236879222">2016-08-02 11:39</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-02_1139" title="Permanent link">&para;</a></h4>
<p>FYI, some forensics:<br />
git log -p usr/share/rear/build/GNU/Linux/10_copy_as_is.sh<br />
shows this inital commit where that code was added:</p>
<pre>
commit 28bac7ad4e6ab67e4e955fec27fc3556082c896e
Author: Jeroen Hoekx <jeroen@hoekx.be>
Date:   Wed Apr 3 11:39:56 2013 +0200
    Add option to set configuration directory from command line.
...
+### Copy configuration directory
+mkdir $v -p $ROOTFS_DIR/etc/rear
+cp $v -r $CONFIG_DIR/* $ROOTFS_DIR/etc/rear/
</pre>

<p>a bit later it was changed to</p>
<pre>
+cp $v -r $CONFIG_DIR/* $ROOTFS_DIR/etc/rear/ >&2
</pre>

<p>Perhaps it never was intentional that dot files are not copied?</p>
<h4 id="jsmeix_commented_at_2016-08-02_1143"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-236880032">2016-08-02 11:43</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-02_1143" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
when $CONFIG_DIR is not '/etc/rear' wouldn't then</p>
<pre>
cp .. $CONFIG_DIR/* $ROOTFS_DIR/etc
</pre>

<p>be wrong because shouldn't then also the $CONFIG_DIR<br />
value be used as target directory in the recovery system?</p>
<h4 id="gdha_commented_at_2016-08-02_1307"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-236898181">2016-08-02 13:07</a>:<a class="headerlink" href="#gdha_commented_at_2016-08-02_1307" title="Permanent link">&para;</a></h4>
<p>@jsmeix indeed you are right - forget about it - close it again</p>
<h4 id="gdha_commented_at_2016-08-05_1527"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-237881185">2016-08-05 15:27</a>:<a class="headerlink" href="#gdha_commented_at_2016-08-05_1527" title="Permanent link">&para;</a></h4>
<p>@jsmeix Sorry couldn't help to get files starting with a dot on-board:<br />
<code>cp $v -r $CONFIG_DIR/.[a-z]* $ROOTFS_DIR/etc/rear/ &gt;&amp;2</code><br />
It is working - now I'm pleased as well:</p>
<pre><code># ls -a /tmp/rear.Pp6tp8LYOttYS0c/rootfs/etc/rear
.  ..  .cifs  local.conf  local-lab-with-bareos.conf  local-with-nfs.conf  os.conf  rescue.conf
</code></pre>
<h4 id="jsmeix_commented_at_2016-08-08_0919"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/924#issuecomment-238184001">2016-08-08 09:19</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-08-08_0919" title="Permanent link">&para;</a></h4>
<p>For me it is perfectly fine when it also works for dot files.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-07-18.924.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
