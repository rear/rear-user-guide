<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#3108 PR merged: Set 'dmesg -n 5' in etc/scripts/boot - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#3108 PR merged: Set \u0027dmesg -n 5\u0027 in etc/scripts/boot";
        var mkdocs_page_input_path = "issues/2023-12-14.3108.pr.merged.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#3108 PR merged: Set 'dmesg -n 5' in etc/scripts/boot</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="3108_pr_merged_set_dmesg_-n_5_in_etcscriptsboot"><a href="https://github.com/rear/rear/pull/3108">#3108 PR</a> <code>merged</code>: Set 'dmesg -n 5' in etc/scripts/boot<a class="headerlink" href="#3108_pr_merged_set_dmesg_-n_5_in_etcscriptsboot" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>fixed / solved / done</code></p>
<h4 id="jsmeix_opened_issue_at_2023-12-14_1202"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> opened issue at <a href="https://github.com/rear/rear/pull/3108">2023-12-14 12:02</a>:<a class="headerlink" href="#jsmeix_opened_issue_at_2023-12-14_1202" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>Type: <strong>Enhancement</strong></p>
</li>
<li>
<p>Impact: <strong>Normal</strong></p>
</li>
<li>
<p>Reference to related issue (URL):<br />
<a href="https://github.com/rear/rear/issues/3107">https://github.com/rear/rear/issues/3107</a></p>
</li>
<li>
<p>How was this pull request tested?</p>
</li>
</ul>
<p>I tested various 'dmesg -n [1-7]' during "rear recover"<br />
and up to 'dmesg -n 5' i.e. up to warning messages<br />
there are almost no kernel messages so that level 5<br />
does not "pollute" the usual ReaR messages.<br />
In contrast level 6 (notice messages) shows some more<br />
kernel messages which could be considered as disturbing<br />
and with level 7 (info messages) it really gets too much.</p>
<ul>
<li>Description of the changes in this pull request:</li>
</ul>
<p>In [skel/default]/etc/scripts/boot set</p>
<pre><code>dmesg -n 5
</code></pre>
<p>to limit console logging for 'dmesg' messages to level 5<br />
so that kernel error and warning messages appear<br />
(intermixed with ReaR messages) on the console<br />
so that the user can notice when things go wrong<br />
in kernel area which helps to understand problems.</p>
<h4 id="pcahyna_commented_at_2023-12-14_1236"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/3108#issuecomment-1855773600">2023-12-14 12:36</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-12-14_1236" title="Permanent link">&para;</a></h4>
<p>Unfortunately the console log in CI is not useful to see the result
after successful recovery. The console log is limited to 64 kB, and
successful recovery reboots multiple times (due to SELinux relabeling),
so the console messages from the recovery run get scrolled into the
memory hole.</p>
<h4 id="pcahyna_commented_at_2023-12-14_1253"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/3108#issuecomment-1855799019">2023-12-14 12:53</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-12-14_1253" title="Permanent link">&para;</a></h4>
<p>Here is the console log from the <code>centos-stream-8-x86_64</code> CI run - it
errored out because of timeout
<a href="https://artifacts.dev.testing-farm.io/f6bd055b-71dd-4cb7-9550-89007881c9fa/">https://artifacts.dev.testing-farm.io/f6bd055b-71dd-4cb7-9550-89007881c9fa/</a>
<a href="https://github.com/rear/rear/pull/3108/checks?check_run_id=19639265907">https://github.com/rear/rear/pull/3108/checks?check_run_id=19639265907</a></p>
<pre><code>        Starting Relax-and-Recover boot script...
[[0;32m  OK  [0m] Created slice system-serial\x2dgetty.slice.
[[0;32m  OK  [0m] Started udev Kernel Device Manager.
         Starting Initialize Rescue System...
[[0;32m  OK  [0m] Started Relax-and-Recover boot script.
[[0;32m  OK  [0m] Started udev Coldplug all Devices.
[    3.824928] Error: Driver 'pcspkr' is already registered, aborting...
[[0;32m  OK  [0m] Found device /dev/ttyS0.

Verifying md5sums of the files in the Relax-and-Recover rescue system
md5sums are OK

Configuring Relax-and-Recover rescue system

Running 00-functions.sh...
Running 01-run-ldconfig.sh...
Running 10-console-setup.sh...
Using keymap of the original system
Running 20-check-boot-options.sh...
Running 40-start-udev-or-load-modules.sh...
Loading modules specified in /etc/modules ...
insmod /lib/modules/4.18.0-527.el8.x86_64/kernel/drivers/net/xen-netfront.ko.xz 
modprobe: ERROR: could not insert 'xen_netfront': No such device
insmod /lib/modules/4.18.0-527.el8.x86_64/kernel/drivers/block/xen-blkfront.ko.xz 
modprobe: ERROR: could not insert 'xen_blkfront': No such device
Waiting for udev ... [    8.678961] Error: Driver 'pcspkr' is already registered, aborting...
done.
Running 41-load-special-modules.sh...
Running 42-engage-scsi.sh...
Running 45-serial-console.sh...
Serial console support enabled for ttyS0 at speed 115200
Running 55-migrate-network-devices.sh...
Running 58-start-dhclient.sh...
Attempting to start the DHCP client daemon
Running 60-network-devices.sh...
Running 62-routing.sh...
Running 65-sysctl.sh...
Running 99-makedev.sh...

Relax-and-Recover rescue system is ready

Launching 'rear recover' automatically
(...)
</code></pre>
<p>It shows that the only added message during boot is the repeated<br />
<code>Error: Driver 'pcspkr' is already registered, aborting...</code></p>
<h4 id="jsmeix_commented_at_2023-12-14_1259"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/3108#issuecomment-1855807440">2023-12-14 12:59</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-12-14_1259" title="Permanent link">&para;</a></h4>
<p>Regardless whether or not the kernel ring buffer<br />
is useful for debugging CI problems,<br />
I like 'dmesg -n 5' in general because<br />
it is much better than 'dmesg -n1', see<br />
<a href="https://github.com/rear/rear/issues/3107#issuecomment-1855783591">https://github.com/rear/rear/issues/3107#issuecomment-1855783591</a></p>
<h4 id="pcahyna_commented_at_2023-12-14_1429"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/3108#issuecomment-1855954462">2023-12-14 14:29</a>:<a class="headerlink" href="#pcahyna_commented_at_2023-12-14_1429" title="Permanent link">&para;</a></h4>
<p>right, and it actually is useful, see
<a href="https://github.com/rear/rear/issues/3107#issuecomment-1855953570">https://github.com/rear/rear/issues/3107#issuecomment-1855953570</a></p>
<h4 id="jsmeix_commented_at_2023-12-15_0907"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/3108#issuecomment-1857527905">2023-12-15 09:07</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-12-15_0907" title="Permanent link">&para;</a></h4>
<p>@rear/contributors<br />
unless there is a critical objection<br />
I would "just merge" it today afternoon<br />
because I think nothing could get actually wrong<br />
with 'dmesg -n 5' compared to 'dmesg -n1' before.<br />
I think at most some unwanted kernel messages<br />
could appear intermixed with ReaR messages<br />
on the console - but only on the console<br />
so when "rear recover" is not run on the console<br />
e.g from remote via 'ssh' then no kernel messages<br />
appear on the remote terminal where 'ssh' is run.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2023-12-14.3108.pr.merged.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
