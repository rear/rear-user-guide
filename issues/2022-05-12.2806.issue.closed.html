<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2806 Issue closed: Recover RHEL 7.9 backup on different machine with new MAC addresses for Network Interfaces. Doesn't keep old Network Interface names. - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2806 Issue closed: Recover RHEL 7.9 backup on different machine with new MAC addresses for Network Interfaces. Doesn\u0027t keep old Network Interface names.";
        var mkdocs_page_input_path = "issues/2022-05-12.2806.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2806 Issue closed: Recover RHEL 7.9 backup on different machine with new MAC addresses for Network Interfaces. Doesn't keep old Network Interface names.</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2806_issue_closed_recover_rhel_79_backup_on_different_machine_with_new_mac_addresses_for_network_interfaces_doesnt_keep_old_network_interface_names"><a href="https://github.com/rear/rear/issues/2806">#2806 Issue</a> <code>closed</code>: Recover RHEL 7.9 backup on different machine with new MAC addresses for Network Interfaces. Doesn't keep old Network Interface names.<a class="headerlink" href="#2806_issue_closed_recover_rhel_79_backup_on_different_machine_with_new_mac_addresses_for_network_interfaces_doesnt_keep_old_network_interface_names" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>no-issue-activity</code></p>
<h4 id="drayinsane_opened_issue_at_2022-05-12_1445"><img src="https://avatars.githubusercontent.com/u/41330733?u=1bbd1ee1d5995ce7ff3dfdd35a2648b5e910ccf5&v=4" width="50"><a href="https://github.com/DrayInsane">DrayInsane</a> opened issue at <a href="https://github.com/rear/rear/issues/2806">2022-05-12 14:45</a>:<a class="headerlink" href="#drayinsane_opened_issue_at_2022-05-12_1445" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Relax-and-Recover: Version 2.6</p>
<p>RHEL 7.9</p>
<p>local.conf:</p>
<pre><code>OUTPUT=ISO
BACKUP=NETFS
OUTPUT_URL=null
BACKUP_URL="iso:///backup/"
</code></pre>
<ul>
<li>
<p>Hardware vendor/product (PC or PowerNV BareMetal or ARM) or VM (KVM
    guest or PowerVM LPAR):<br />
    Oracle Virtual Box 6.1</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device):<br />
    Host is Dell Latitude</p>
</li>
<li>
<p>Description of the issue (ideally so that others can reproduce it):</p>
</li>
</ul>
<p>I am creating a backup of a machine where the interface names are
configured using the ifcfg-X files which have the old interfaces renamed
using the DEVICE= parameter. (I.E. DEVICE=Internet which renames the
interface name to Internet). I have software running on the build that
look for the interface name so I want the name to remain consistent even
on different hardware.</p>
<p>When I try to recover the image on the new machine that has different
MAC addresses for the network interfaces I get the standard prompt
telling me that the old interface cannot be found and gives me the
option to replace it with one of the newer ones. Instead of completely
replacing the interface which changes the name of the file adds the new
mac and adds the new device(interface) name I need it to only replace
the MAC address in the file and not the file name or device name. I
tried altering the local.conf, altering the kernel cmdline, and changing
some of the parameters in the 55-migrate-network-devices.sh but I am
unable to figure out how to keep the device name from changing after
rear recover is run.</p>
<p>I essentially want to take (Old machine - Old MAC Address / Old
Interface Name) and end up with<br />
(New machine - New MAC Address / Old Interface Name).</p>
<p>Is there any way to do this?</p>
<h4 id="jsmeix_commented_at_2022-05-13_0917"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2806#issuecomment-1125833941">2022-05-13 09:17</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-05-13_0917" title="Permanent link">&para;</a></h4>
<p>@rmetrich<br />
if time permits could you perhaps have a look here?<br />
My networking knowledge is basically limited<br />
to let DHCP automatically do "the right thing" ;-)</p>
<p>@DrayInsane<br />
as a generic method you could after "rear recover" finished<br />
in the still running ReaR recovery system manually change<br />
the (config) files of the recreated system as you like.<br />
The recreated filesystems with the restored files<br />
are mounted below /mnt/local in the ReaR recovery system.</p>
<h4 id="jsmeix_commented_at_2022-05-13_0925"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2806#issuecomment-1125841363">2022-05-13 09:25</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-05-13_0925" title="Permanent link">&para;</a></h4>
<p>@DrayInsane<br />
now I see you mentioned 55-migrate-network-devices.sh which is<br />
skel/default/etc/scripts/system-setup.d/55-migrate-network-devices.sh<br />
so it seems you do not want to adapt some restored config files<br />
to make the recreated system boot with proper networking setup<br />
but you want to adapt the networking setup of the ReaR recovery system?</p>
<p>If yes, see "RESCUE IMAGE KERNEL COMMAND LINE OPTIONS"<br />
in "man rear" e.g. for current master code it is online at<br />
<a href="https://github.com/rear/rear/blob/master/doc/rear.8.adoc">https://github.com/rear/rear/blob/master/doc/rear.8.adoc</a><br />
and "NETWORKING_PREPARATION_COMMANDS" in<br />
usr/share/rear/conf/default.conf which is currently online at<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L3108">https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf#L3108</a></p>
<h4 id="drayinsane_commented_at_2022-05-13_1829"><img src="https://avatars.githubusercontent.com/u/41330733?u=1bbd1ee1d5995ce7ff3dfdd35a2648b5e910ccf5&v=4" width="50"><a href="https://github.com/DrayInsane">DrayInsane</a> commented at <a href="https://github.com/rear/rear/issues/2806#issuecomment-1126329537">2022-05-13 18:29</a>:<a class="headerlink" href="#drayinsane_commented_at_2022-05-13_1829" title="Permanent link">&para;</a></h4>
<p>Thanks I'll take a look into it and see if I can figure something out.
Is there any way I can get rear to kick off a custom script before the
reboot of the system? I could then create the script to rename the
interface files back to how we need them to be and everything could be
done before booting into the system after recovery.</p>
<h4 id="jsmeix_commented_at_2022-05-16_0808"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2806#issuecomment-1127360975">2022-05-16 08:08</a>:<a class="headerlink" href="#jsmeix_commented_at_2022-05-16_0808" title="Permanent link">&para;</a></h4>
<p>See POST_RECOVERY_SCRIPT in<br />
usr/share/rear/conf/default.conf</p>
<p>See<br />
usr/share/rear/wrapup/default/500_post_recovery_script.sh<br />
how POST_RECOVERY_SCRIPT is called.</p>
<p>For an example of a POST_RECOVERY_SCRIPT see<br />
usr/share/rear/conf/examples/SLE12-SP2-btrfs-example.conf</p>
<p>Instead of doing all as a single command in<br />
POST_RECOVERY_SCRIPT it should be usually easier<br />
to make a separated script and include it<br />
into the ReaR recovery system via</p>
<pre><code>COPY_AS_IS+=( /path/to/script.sh )
</code></pre>
<p>and call that script via POST_RECOVERY_SCRIPT,<br />
see the COPY_AS_IS description in default.conf.</p>
<p>Because the default</p>
<pre><code>COPY_AS_IS=( $SHARE_DIR $VAR_DIR )
</code></pre>
<p>and because SHARE_DIR is usr/share/rear<br />
you could place your script in usr/share/rear<br />
so it gets automatically included in the<br />
ReaR recovery system.</p>
<h4 id="github-actions_commented_at_2022-07-16_0315"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2806#issuecomment-1186076672">2022-07-16 03:15</a>:<a class="headerlink" href="#github-actions_commented_at_2022-07-16_0315" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2022-05-12.2806.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
