<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#425 Issue closed: AES-SHA256 on Ubuntu (precise) Cryptloop - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#425 Issue closed: AES-SHA256 on Ubuntu (precise) Cryptloop";
        var mkdocs_page_input_path = "issues/2014-06-14.425.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#425 Issue closed: AES-SHA256 on Ubuntu (precise) Cryptloop</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="425_issue_closed_aes-sha256_on_ubuntu_precise_cryptloop"><a href="https://github.com/rear/rear/issues/425">#425 Issue</a> <code>closed</code>: AES-SHA256 on Ubuntu (precise) Cryptloop<a class="headerlink" href="#425_issue_closed_aes-sha256_on_ubuntu_precise_cryptloop" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code></p>
<h4 id="tyl0re_opened_issue_at_2014-06-14_2129"><img src="https://avatars.githubusercontent.com/u/1512325?v=4" width="50"><a href="https://github.com/tyl0re">tyl0re</a> opened issue at <a href="https://github.com/rear/rear/issues/425">2014-06-14 21:29</a>:<a class="headerlink" href="#tyl0re_opened_issue_at_2014-06-14_2129" title="Permanent link">&para;</a></h4>
<p>On Ubuntu precise + Cryptloop<br />
when booting rear</p>
<p>the step:<br />
cryptsetup --debug luksFormat -q --cypher aes-sha256 --hash sha1 --uuid</p>
<p>Failed to setup dm-crypt key mapping for device /dev/sda5</p>
<p>Check that kernel supports aes-sha256 cipher (Check Syslog for more
information)<br />
Gets: Command failed with code 5: Failed to write to key Storage</p>
<p>Syslog:<br />
davice-mapper: table 252:0: crypt: IV mechanism required<br />
davice-mapper: error adding target to table</p>
<p>Changing it to twofish has worked. for the cryptsetup, seems there is
some modules missing</p>
<h4 id="gdha_commented_at_2014-06-16_0917"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-46156915">2014-06-16 09:17</a>:<a class="headerlink" href="#gdha_commented_at_2014-06-16_0917" title="Permanent link">&para;</a></h4>
<p>@tyl0re could you find out to see which module is present on production
side? Perhaps dm-crypt needs an extra module??</p>
<h4 id="gdha_commented_at_2014-06-16_1345"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-46179617">2014-06-16 13:45</a>:<a class="headerlink" href="#gdha_commented_at_2014-06-16_1345" title="Permanent link">&para;</a></h4>
<p>Looked at the sources of
<code>https://code.google.com/p/cryptsetup/source/browse/src/cryptsetup.h</code>
and noticed that it relies on OpenSSL. So my guess is that <code>openssl</code>
should be added to the rescue image... worth trying.</p>
<h4 id="gdha_commented_at_2014-06-25_1206"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-47092252">2014-06-25 12:06</a>:<a class="headerlink" href="#gdha_commented_at_2014-06-25_1206" title="Permanent link">&para;</a></h4>
<p>@tyl0re any luck so far?</p>
<h4 id="tyl0re_commented_at_2014-06-25_1213"><img src="https://avatars.githubusercontent.com/u/1512325?v=4" width="50"><a href="https://github.com/tyl0re">tyl0re</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-47092850">2014-06-25 12:13</a>:<a class="headerlink" href="#tyl0re_commented_at_2014-06-25_1213" title="Permanent link">&para;</a></h4>
<p>I have written you an email to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#103;&#114;&#97;&#116;&#105;&#101;&#110;&#46;&#100;&#104;&#97;&#101;&#115;&#101;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">&#103;&#114;&#97;&#116;&#105;&#101;&#110;&#46;&#100;&#104;&#97;&#101;&#115;&#101;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;</a>, so you could
have a look for your self, mayby its faster,since there a two Ubuntu
Problems</p>
<h4 id="gdha_commented_at_2014-06-26_1403"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-47229167">2014-06-26 14:03</a>:<a class="headerlink" href="#gdha_commented_at_2014-06-26_1403" title="Permanent link">&para;</a></h4>
<p><em>Finding 1</em>:</p>
<pre><code>root@test-rear:~# cat /proc/crypto | grep aes
name         : cbc(aes)
driver       : cbc(aes-generic)
name         : cbc(aes)
driver       : cbc(aes-generic)
name         : aes
driver       : aes-generic
root@test-rear:~# cat /proc/crypto | grep sha256
name         : hmac(sha256)
driver       : hmac(sha256-generic)
name         : sha256
driver       : sha256-generic

RESCUE test-rear:/var/lib/rear/layout # cat /proc/crypto | grep aes
name         : cbc(aes)
driver       : cbc(aes-generic)
name         : cbc(aes)
driver       : cbc(aes-generic)
name         : aes
driver       : aes-generic
RESCUE test-rear:/var/lib/rear/layout # cat /proc/crypto | grep sha256
name         : hmac(sha256)
driver       : hmac(sha256-generic)
name         : sha256
driver       : sha256-generic
</code></pre>
<p>so, all required drivers are available in the kernel on both systems.
That is not the issue here.</p>
<h4 id="tyl0re_commented_at_2014-06-27_0928"><img src="https://avatars.githubusercontent.com/u/1512325?v=4" width="50"><a href="https://github.com/tyl0re">tyl0re</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-47324494">2014-06-27 09:28</a>:<a class="headerlink" href="#tyl0re_commented_at_2014-06-27_0928" title="Permanent link">&para;</a></h4>
<p>Crypting it with other then aes-sha256 seems to work, only aes-sha256
fails</p>
<h4 id="gdha_commented_at_2014-06-27_1002"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-47327301">2014-06-27 10:02</a>:<a class="headerlink" href="#gdha_commented_at_2014-06-27_1002" title="Permanent link">&para;</a></h4>
<p>Does it aes-sha256 work fine on your test system (not recovery system)?</p>
<h4 id="tyl0re_commented_at_2014-06-27_1007"><img src="https://avatars.githubusercontent.com/u/1512325?v=4" width="50"><a href="https://github.com/tyl0re">tyl0re</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-47327704">2014-06-27 10:07</a>:<a class="headerlink" href="#tyl0re_commented_at_2014-06-27_1007" title="Permanent link">&para;</a></h4>
<p>There are 2 Testsystems (1 Bootet Rear cd) 1 the Orginal System (2
Ports) So its easier to try and compare them</p>
<h4 id="gdha_commented_at_2014-08-21_1543"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-52938708">2014-08-21 15:43</a>:<a class="headerlink" href="#gdha_commented_at_2014-08-21_1543" title="Permanent link">&para;</a></h4>
<p>not sure what added value I still can deliver for this case?</p>
<h4 id="tyl0re_commented_at_2014-08-30_1626"><img src="https://avatars.githubusercontent.com/u/1512325?v=4" width="50"><a href="https://github.com/tyl0re">tyl0re</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-53963186">2014-08-30 16:26</a>:<a class="headerlink" href="#tyl0re_commented_at_2014-08-30_1626" title="Permanent link">&para;</a></h4>
<p>Hi Sorry for the late answer, i have been in Holliday.<br />
I found the Error! :-)</p>
<p>The Orginal System is:</p>
<p>root@mail:/etc# cryptsetup status sda5_crypt<br />
/dev/mapper/sda5_crypt is active and is in use.<br />
type: LUKS1<br />
cipher: aes-cbc-essiv:sha256<br />
keysize: 256 bits<br />
device: /dev/sda5<br />
offset: 4096 sectors<br />
size: 209207296 sectors<br />
mode: read/write</p>
<p>The command in Rear is:<br />
cryptsetup luksFormat -q --cypher aes-sha256 -hash sha1 --uid [NR]
/dev/sda5</p>
<p>When Changing it to:<br />
cryptsetup luksFormat -q --cypher aes-cbc-essiv:sha256 -hash sha1 --uid
[NR] /dev/sda5</p>
<p>Works (Changed in the Cypher from the Orginal machine) Seems somehow
rear seems to get the cypher wrong</p>
<h4 id="gdha_commented_at_2014-09-01_0827"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-54033644">2014-09-01 08:27</a>:<a class="headerlink" href="#gdha_commented_at_2014-09-01_0827" title="Permanent link">&para;</a></h4>
<p>@tyl0re Ok, thx for the feedback - so in
<code>/var/lib/rear/layout/disklayout.conf</code> the cypher was wrong?<br />
Perhaps, if you could debug the script
<code>./usr/share/rear/layout/save/GNU/Linux/26_crypt_layout.sh</code> to where it
goes wrong for me?</p>
<h4 id="tyl0re_commented_at_2014-09-01_0921"><img src="https://avatars.githubusercontent.com/u/1512325?v=4" width="50"><a href="https://github.com/tyl0re">tyl0re</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-54038431">2014-09-01 09:21</a>:<a class="headerlink" href="#tyl0re_commented_at_2014-09-01_0921" title="Permanent link">&para;</a></h4>
<p>Errror is in:<br />
mode=$(cryptsetup luksDump $device |grep "Cipher mode"| sed -r
's/^.+:\s*(.+)$/\1/'</p>
<p>Cipher mode: cbc-essiv:sha256</p>
<p>since the mode has an : in it, it cuts only the last part instead the
complete mode</p>
<p>mode=$(cryptsetup luksDump $device |grep "Cipher mode"|cut -d : -f
2-|awk '{printf("%s",$1)};')</p>
<p>Works,mayby there is an more elegant way to do it</p>
<h4 id="tyl0re_commented_at_2014-10-21_0831"><img src="https://avatars.githubusercontent.com/u/1512325?v=4" width="50"><a href="https://github.com/tyl0re">tyl0re</a> commented at <a href="https://github.com/rear/rear/issues/425#issuecomment-59895177">2014-10-21 08:31</a>:<a class="headerlink" href="#tyl0re_commented_at_2014-10-21_0831" title="Permanent link">&para;</a></h4>
<p>Forgott to close ,since its working</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2014-06-14.425.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
