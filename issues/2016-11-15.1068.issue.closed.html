<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1068 Issue closed: Possibly faulty usage of '[*]' subscript for arrays - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1068 Issue closed: Possibly faulty usage of \u0027[*]\u0027 subscript for arrays";
        var mkdocs_page_input_path = "issues/2016-11-15.1068.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1068 Issue closed: Possibly faulty usage of '[*]' subscript for arrays</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1068_issue_closed_possibly_faulty_usage_of_subscript_for_arrays"><a href="https://github.com/rear/rear/issues/1068">#1068 Issue</a> <code>closed</code>: Possibly faulty usage of '[*]' subscript for arrays<a class="headerlink" href="#1068_issue_closed_possibly_faulty_usage_of_subscript_for_arrays" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>cleanup</code>, <code>won't fix / can't fix / obsolete</code>, <code>minor bug</code></p>
<h4 id="jsmeix_opened_issue_at_2016-11-15_1108"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> opened issue at <a href="https://github.com/rear/rear/issues/1068">2016-11-15 11:08</a>:<a class="headerlink" href="#jsmeix_opened_issue_at_2016-11-15_1108" title="Permanent link">&para;</a></h4>
<p>Current ReaR code uses in very most cases<br />
(actually in 682 cases)</p>
<pre>
${array[@]}
</pre>

<p>when "the whole array" is meant.</p>
<p>But sometimes (actually in 22 cases)</p>
<pre>
${array[*]}
</pre>

<p>is used.</p>
<p>I think I should investigate the array[*] cases and try to find out<br />
whether or not each array[*] usage is actually right.</p>
<p>FYI: I used</p>
<pre>
find usr/share/rear/* | xargs grep -ho '[[:alnum:]_]*\[@\]'
</pre>

<p>versus</p>
<pre>
find usr/share/rear/* | xargs grep -ho '[[:alnum:]_]*\[\*\]'
</pre>

<p>to find array[@] versus array[*] usage.</p>
<p>Background information:</p>
<p>See "man bash" for the difference:</p>
<pre>
If subscript is @ or *, the word expands to all members of name.
These subscripts differ only when the word appears within
double quotes. If the word is double-quoted, ${name[*]}
expands to a single word with the value of each array
member separated by the first character of the IFS special
variable, and ${name[@]} expands each element of name
to a separate word.
</pre>

<p>In general ${array[*]} is problematic and<br />
using ${array[@]} without double-quotes is also problematic.</p>
<p>For example see how using ${array[*]} or "${array[*]}"<br />
or even ${array[@]} results probably unexpected stuff<br />
(unless those results are actually intended) while<br />
only "${array[@]}" results what is usually expected:</p>
<pre>
# arr1=( 'first1 first2' 'second1 second2' )

# for e in ${arr1[*]} ; do echo "'$e'" ; done
'first1'
'first2'
'second1'
'second2'

# for e in ${arr1[@]} ; do echo "'$e'" ; done
'first1'
'first2'
'second1'
'second2'

# for e in "${arr1[*]}" ; do echo "'$e'" ; done
'first1 first2 second1 second2'

# for e in "${arr1[@]}" ; do echo "'$e'" ; done
'first1 first2'
'second1 second2'

# arr2=( ${arr1[*]} 'third1 third2' )

# for e in "${arr2[@]}" ; do echo "'$e'" ; done
'first1'
'first2'
'second1'
'second2'
'third1 third2'

# arr2=( ${arr1[@]} 'third1 third2' )

# for e in "${arr2[@]}" ; do echo "'$e'" ; done
'first1'
'first2'
'second1'
'second2'
'third1 third2'

# arr2=( "${arr1[*]}" 'third1 third2' )

# for e in "${arr2[@]}" ; do echo "'$e'" ; done
'first1 first2 second1 second2'
'third1 third2'

# arr2=( "${arr1[@]}" 'third1 third2' )

# for e in "${arr2[@]}" ; do echo "'$e'" ; done
'first1 first2'
'second1 second2'
'third1 third2'
</pre>

<h4 id="jsmeix_commented_at_2016-11-15_1112"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1068#issuecomment-260614342">2016-11-15 11:12</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-11-15_1112" title="Permanent link">&para;</a></h4>
<p>I found only 589 cases where "${array[@]}"<br />
with double-quotes is used...</p>
<h4 id="schlomo_commented_at_2016-11-16_1946"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/1068#issuecomment-261051124">2016-11-16 19:46</a>:<a class="headerlink" href="#schlomo_commented_at_2016-11-16_1946" title="Permanent link">&para;</a></h4>
<p>Please post here the 22 cases of "${array[*]}", I remember using that
in<br />
some very specific cases on purpose.</p>
<p>On 15 November 2016 at 12:12, Johannes Meixner
<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
wrote:</p>
<blockquote>
<p>I found only 589 cases where "${array[@]}"<br />
with double-quotes is used...</p>
<p>â€”<br />
You are receiving this because you are subscribed to this thread.<br />
Reply to this email directly, view it on GitHub<br />
<a href="https://github.com/rear/rear/issues/1068#issuecomment-260614342">https://github.com/rear/rear/issues/1068#issuecomment-260614342</a>,
or mute<br />
the thread<br />
<a href="https://github.com/notifications/unsubscribe-auth/AAGMCNiVGl3vWKAkKHPzG7HDP1GgpiK2ks5q-ZOfgaJpZM4KyZsX">https://github.com/notifications/unsubscribe-auth/AAGMCNiVGl3vWKAkKHPzG7HDP1GgpiK2ks5q-ZOfgaJpZM4KyZsX</a><br />
.</p>
</blockquote>
<h4 id="jsmeix_commented_at_2016-11-17_0804"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1068#issuecomment-261180802">2016-11-17 08:04</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-11-17_0804" title="Permanent link">&para;</a></h4>
<p>In current ReaR GitHUb master code<br />
in the usr/share/rear directory:</p>
<p>The array variables where "${array[*]}" is used:</p>
<pre>
$ find * | xargs grep -ho '[[:alnum:]_]*\[\*\]' | sort -u
[*]
ADDR[*]
array[*]
deps[*]
dev[*]
name[*]
NETWORKING_PREPARATION_COMMANDS[*]
NEW_INITRD_MODULES[*]
OLD_INITRD_MODULES[*]
RESULT_FILES[*]
TSM_FILESPACE_INCLUDED_NUMS[*]
TSM_FILESPACE_NUMS[*]
</pre>

<p>The files where "${array[*]}" is used:</p>
<pre>
$ find * | xargs grep -o '[[:alnum:]_]*\[\*\]' | sort -u
finalize/Fedora/i386/170_rebuild_initramfs.sh:NEW_INITRD_MODULES[*]
finalize/SUSE_LINUX/i386/170_rebuild_initramfs.sh:NEW_INITRD_MODULES[*]
finalize/SUSE_LINUX/i386/170_rebuild_initramfs.sh:OLD_INITRD_MODULES[*]
finalize/SUSE_LINUX/ppc64/500_rebuild_initramfs.sh:NEW_INITRD_MODULES[*]
finalize/SUSE_LINUX/ppc64/500_rebuild_initramfs.sh:OLD_INITRD_MODULES[*]
layout/prepare/default/540_generate_device_code.sh:deps[*]
layout/save/GNU/Linux/250_drbd_layout.sh:dev[*]
output/default/950_copy_result_files.sh:array[*]
output/default/950_copy_result_files.sh:RESULT_FILES[*]
rescue/GNU/Linux/310_network_devices.sh:name[*]
rescue/GNU/Linux/310_network_devices.sh:NETWORKING_PREPARATION_COMMANDS[*]
rescue/GNU/Linux/360_teaming.sh:ADDR[*]
verify/TSM/default/400_verify_tsm.sh:[*]
verify/TSM/default/400_verify_tsm.sh:TSM_FILESPACE_INCLUDED_NUMS[*]
verify/TSM/default/400_verify_tsm.sh:TSM_FILESPACE_NUMS[*]
</pre>

<p>The files with the actual code lines where "${array[*]}" is used:</p>
<pre>
$ find * | xargs grep '[[:alnum:]_]*\[\*\]'
finalize/Fedora/i386/170_rebuild_initramfs.sh:  NEW_INITRD_MODULES=( $(tr " " "\n" &lt;&lt;&lt; "${NEW_INITRD_MODULES[*]}" | sort | uniq -u) )
finalize/SUSE_LINUX/i386/170_rebuild_initramfs.sh:      NEW_INITRD_MODULES=( $(tr " " "\n" &lt;&lt;&lt; "${NEW_INITRD_MODULES[*]}" | sort | uniq -u) )
finalize/SUSE_LINUX/i386/170_rebuild_initramfs.sh:      sed -i -e '/^INITRD_MODULES/s/^.*$/#&\nINITRD_MODULES="'"${OLD_INITRD_MODULES[*]} ${NEW_INITRD_MODULES[*]}"'"/' $TARGET_FS_ROOT/etc/sysconfig/kernel
finalize/SUSE_LINUX/ppc64/500_rebuild_initramfs.sh:     NEW_INITRD_MODULES=( $(tr " " "\n" &lt;&lt;&lt; "${NEW_INITRD_MODULES[*]}" | sort | uniq -u) )
finalize/SUSE_LINUX/ppc64/500_rebuild_initramfs.sh:     sed -i -e '/^INITRD_MODULES/s/^.*$/#&\nINITRD_MODULES="'"${OLD_INITRD_MODULES[*]} ${NEW_INITRD_MODULES[*]}"'"/' $TARGET_FS_ROOT/etc/sysconfig/kernel
layout/prepare/default/540_generate_device_code.sh:        Debug "deps (${#deps[@]}): ${deps[*]}"
layout/save/GNU/Linux/250_drbd_layout.sh:        for i in ${!dev[*]}; do
output/default/950_copy_result_files.sh:        # FIXME: Verify if usage of $array[*] instead of "${array[@]}" is actually intended here
output/default/950_copy_result_files.sh:        LogPrint "Copying result files '${RESULT_FILES[*]}' to $scheme location"
output/default/950_copy_result_files.sh:        Log "lftp -c open $OUTPUT_URL; mput ${RESULT_FILES[*]}"
output/default/950_copy_result_files.sh:        lftp -c "open $OUTPUT_URL; mput ${RESULT_FILES[*]}" || Error "Problem transferring result files to $OUTPUT_URL"
rescue/GNU/Linux/310_network_devices.sh:if test "${NETWORKING_PREPARATION_COMMANDS[*]}" ; then
rescue/GNU/Linux/310_network_devices.sh:    # For the above 'test' one must have all array members as a single word i.e. "${name[*]}"
rescue/GNU/Linux/360_teaming.sh:    if [[ ${ADDR[*]} ]]
verify/TSM/default/400_verify_tsm.sh:# NOTE: In this script we use '"${TSM_FILESPACE_NUMS[*]}"' (instead of [@]) and it seems to be intentionally
verify/TSM/default/400_verify_tsm.sh:# 2009-10-12 Schlomo as part of a code review to fix all occurences of [*]
verify/TSM/default/400_verify_tsm.sh:read -t $WAIT_SECS -p "(default: ${TSM_FILESPACE_INCLUDED_NUMS[*]}): [$WAIT_SECS secs] " -r TSM_RESTORE_FILESPACE_NUMS 2&gt;&1
verify/TSM/default/400_verify_tsm.sh:   TSM_RESTORE_FILESPACE_NUMS="${TSM_FILESPACE_INCLUDED_NUMS[*]}" # set default on ENTER
verify/TSM/default/400_verify_tsm.sh:   Log "User pressed ENTER, setting default of ${TSM_FILESPACE_INCLUDED_NUMS[*]}"
</pre>

<h4 id="gdha_commented_at_2016-11-18_0911"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/1068#issuecomment-261483257">2016-11-18 09:11</a>:<a class="headerlink" href="#gdha_commented_at_2016-11-18_0911" title="Permanent link">&para;</a></h4>
<p>@jsmeix Please be extremely careful with changing the array expansions -
you might create new problems. Do not change to just change things.</p>
<h4 id="jsmeix_commented_at_2016-11-18_0947"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1068#issuecomment-261490585">2016-11-18 09:47</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-11-18_0947" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
don't worry, as long as things are well documented<br />
no ReaR contributor would inadvertently change it<br />
to a wrong behaviour because he (falsely) assumes<br />
he would improve things.</p>
<p>E.g. (shameless self-praise ;-) see<br />
rescue/GNU/Linux/310_network_devices.sh</p>
<pre>
if test "${NETWORKING_PREPARATION_COMMANDS[*]}" ; then
    # For the above 'test' one must have all array members as a single word i.e. "${name[*]}"
    # (the test should succeed when there is any non-empty array member, not necessarily the first one)
    # while later one must have the array members as separated 'command' words i.e. "${name[@]}".
    echo "# Prepare network devices setup as specified in NETWORKING_PREPARATION_COMMANDS:" >>$network_devices_setup_script
    for command in "${NETWORKING_PREPARATION_COMMANDS[@]}" ; do
</pre>

<p>in contrast to e.g. in verify/TSM/default/400_verify_tsm.sh<br />
where Schlomo Schapiro added an initial comment about<br />
that issue but - as far as I understand his comment - he was<br />
unable to find out whether or not the "[*]" usage is really<br />
on purpose (and if yes what that purpose actually is).</p>
<h4 id="jsmeix_commented_at_2016-11-18_0956"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1068#issuecomment-261492546">2016-11-18 09:56</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-11-18_0956" title="Permanent link">&para;</a></h4>
<p>I change it from "bug" to "minor bug" because<br />
currently things seem to work.</p>
<p>As long as the array members do not contain blanks<br />
there is no difference beween "[@]" and "[*]" usage<br />
but probably there are some cases where things break<br />
if array members contain blanks.</p>
<p>I am waiting for the first user who has blanks<br />
in system file names or system directory names<br />
that are used by ReaR e.g. things like</p>
<pre>
BACKUP_PROG_INCLUDE=( '/my important stuff/*' )
</pre>

<p>I never tested if things like that would work.</p>
<h4 id="jsmeix_commented_at_2017-01-03_0804"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1068#issuecomment-270065669">2017-01-03 08:04</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-01-03_0804" title="Permanent link">&para;</a></h4>
<p>Nothing is urgent here.<br />
In particular nothing needs to be done for ReaR 2.0.</p>
<h4 id="jsmeix_commented_at_2017-02-27_1452"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1068#issuecomment-282741981">2017-02-27 14:52</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-02-27_1452" title="Permanent link">&para;</a></h4>
<p>Using the '[*]' subscript is required when testing arrays:</p>
<pre>
# arr1=( 'first1 first2' 'second1 second2' )

# test "${arr1[@]:-}" && echo ok || echo empty
-bash: test: first1 first2: unary operator expected
empty

# test "${arr1[*]:-}" && echo ok || echo empty
ok
</pre>

<h4 id="jsmeix_commented_at_2017-05-08_1129"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1068#issuecomment-299842430">2017-05-08 11:29</a>:<a class="headerlink" href="#jsmeix_commented_at_2017-05-08_1129" title="Permanent link">&para;</a></h4>
<p>An even more complicated usage of the '[*]' subscript<br />
plus an interposed 'echo -n' is required when testing arrays<br />
if there is any non-empty array member (not necessarily the first one)<br />
but on the other hand the test should not succeed when there are<br />
only empty or blank members:</p>
<pre>
# arr1=( '' ' ' )

# test "${arr1[*]}" && echo non-empty || echo empty
non-empty

# test "$( echo -n ${arr1[*]} )" && echo non-empty || echo empty
empty

# echo -n ${arr1[*]} | wc -c
0

# arr1=( '' ' ' 'some thing' ' ' 'something else' )

# test "$( echo -n ${arr1[*]} )" && echo non-empty || echo empty
non-empty

# echo -n ${arr1[*]} | wc -c
25

# echo -n ${arr1[*]} | od -a
# echo -n ${arr1[*]} | od -a
0000000   s   o   m   e  sp   t   h   i   n   g  sp   s   o   m   e   t
0000020   h   i   n   g  sp   e   l   s   e
</pre>

<p>cf.
<a href="https://github.com/rear/rear/pull/1334">https://github.com/rear/rear/pull/1334</a><br />
and the thereby added explanatory comment<br />
in prep/default/950_check_missing_programs.sh<br />
that reads (excerpts):</p>
<pre>
For the 'test' one must have all array members
as a single word like "${arr[*]}" with double-quotes
because it should detect when there is any non-empty
array member (not necessarily the first one)
But on the other hand the test should not succeed
when there are only empty or blank members
which would falsely succeed when the
array is e.g. something like arr=( '' ' ' )
because then "${arr[*]}" evaluates to "  "
(the empty and blank members separated
by the first character of IFS) and test "${arr[*]}"
results true for any non-empty argument
(e.g. test " " results true).
Therefore 'echo -n' is interposed because
the output of arr=( '' ' ' ) ; echo -n ${arr[*]}
is empty when the array has only empty
or blank array members
</pre>

<p>Note that there must be no double-quotes in the</p>
<pre>
echo -n ${arr[*]}
</pre>

<p>command because otherwise</p>
<pre>
# arr=( '' '' )

# test "$( echo -n "${arr[*]}" )" && echo non-empty || echo empty
non-empty

# echo -n "${arr[*]}" | od -a
0000000  sp
</pre>

<h4 id="jsmeix_commented_at_2019-03-25_0946"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1068#issuecomment-476122565">2019-03-25 09:46</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-03-25_0946" title="Permanent link">&para;</a></h4>
<p>FYI:</p>
<p><a href="https://github.com/rear/rear/pull/2098">https://github.com/rear/rear/pull/2098</a><br />
is a good example how much care is needed to use<br />
the specific right syntax for array expansion:</p>
<p>Within a longer string with double quotes <code>${arr[@]}</code> may expand<br />
to something unexpeced.</p>
<p>E.g. see the following artificial example what happens:</p>
<pre><code># arr=( 'first element' 'second element' )

# ls "this ${arr[@]} that"
ls: cannot access 'this first element': No such file or directory
ls: cannot access 'second element that': No such file or directory
</code></pre>
<p>The "embedded" <code>${arr[@]}</code> expands to separated words/strings<br />
(which result two separated <code>ls</code> error messages)<br />
plus (see "man bash"):</p>
<pre><code>  Arrays
    ...
    If the double-quoted expansion occurs within a word,
    the expansion of the first parameter is joined with the
    beginning part of the original word, and the expansion
    of the last parameter is joined with the last part of the
    original word.
</code></pre>
<p>that results <code>ls</code> is called as</p>
<pre><code>ls 'this first element' 'second element that'
</code></pre>
<p>Therefore within a longer string with double quotes<br />
usually <code>${arr[*]}</code> expands as normally intended.</p>
<p>E.g. in the above artificial example</p>
<pre><code># ls "this ${arr[*]} that"
ls: cannot access 'this first element second element that': No such file or directory
</code></pre>
<p>the <code>ls</code> command is called with one single parameter.</p>
<h4 id="pcahyna_commented_at_2019-03-25_0952"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/issues/1068#issuecomment-476124587">2019-03-25 09:52</a>:<a class="headerlink" href="#pcahyna_commented_at_2019-03-25_0952" title="Permanent link">&para;</a></h4>
<p>It seems that
<a href="https://github.com/koalaman/shellcheck/wiki/SC2145">https://github.com/koalaman/shellcheck/wiki/SC2145</a>
uses a rule of thumb that ${arr[*]} is more likely to be correct than
${arr[@]} if it occurs embedded in a longer string, because
${arr[@]} will split the string into multiple parts and this is
unlikely to be desired. This heuristics IMO makes sense.</p>
<h4 id="jsmeix_commented_at_2019-03-25_1308"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1068#issuecomment-476188249">2019-03-25 13:08</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-03-25_1308" title="Permanent link">&para;</a></h4>
<p>Yes, I came to the same heuristic conclusion in my<br />
<a href="https://github.com/rear/rear/issues/1068#issuecomment-476122565">https://github.com/rear/rear/issues/1068#issuecomment-476122565</a></p>
<pre><code>Therefore within a longer string with double quotes
usually ${arr[*]} expands as normally intended.
</code></pre>
<p>FYI:<br />
The <code>printf</code> example in<br />
<a href="https://github.com/koalaman/shellcheck/wiki/SC2145">https://github.com/koalaman/shellcheck/wiki/SC2145</a><br />
works for me (output looks different but things do not fail)<br />
with bash 3.x and 4.x</p>
<pre><code># arr=( 'first element' 'second element' )

# set -x

# printf "Arr: %s\n" "this ${arr[*]} that"
+ printf 'Arr: %s\n' 'this first element second element that'
Arr: this first element second element that

# printf "Arr: %s\n" "this ${arr[@]} that"
+ printf 'Arr: %s\n' 'this first element' 'second element that'
Arr: this first element
Arr: second element that
</code></pre>
<p>I am looking for a simple example where <code>${arr[@]}</code> in a longer string<br />
would make things badly fail...</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2016-11-15.1068.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
