<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#748 Issue closed: ipv6 has been disabled in server, but ISO boots server with ipv6 assigned to eth0 and lo - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#748 Issue closed: ipv6 has been disabled in server, but ISO boots server with ipv6 assigned to eth0 and lo";
        var mkdocs_page_input_path = "issues/2015-12-23.748.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#748 Issue closed: ipv6 has been disabled in server, but ISO boots server with ipv6 assigned to eth0 and lo</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="748_issue_closed_ipv6_has_been_disabled_in_server_but_iso_boots_server_with_ipv6_assigned_to_eth0_and_lo"><a href="https://github.com/rear/rear/issues/748">#748 Issue</a> <code>closed</code>: ipv6 has been disabled in server, but ISO boots server with ipv6 assigned to eth0 and lo<a class="headerlink" href="#748_issue_closed_ipv6_has_been_disabled_in_server_but_iso_boots_server_with_ipv6_assigned_to_eth0_and_lo" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="blaxxton_opened_issue_at_2015-12-23_2213"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> opened issue at <a href="https://github.com/rear/rear/issues/748">2015-12-23 22:13</a>:<a class="headerlink" href="#blaxxton_opened_issue_at_2015-12-23_2213" title="Permanent link">&para;</a></h4>
<p>ipv6 is disabled on server but when we boot the server from ISO and<br />
choose Recover, there is ipv6 assigned to either eth0 and lo.</p>
<p>This cause problem recovering from EMC Legato Networker with ipv6 name
is not accessible.<br />
EMC legato Networker check if there is ipv6 assigned to interface, and
if there is , will look to find<br />
the server name based on ipv6 address defined in /etc/hosts and fails.</p>
<p>We had to delete the ipv6 address on both eth0 and loopback to be able
to communicate with EMC Networker server and recover.</p>
<p>There is an option of adding ipv6 to /etc/hosts, but even with that ,
autorecover from Legato would not work if ipv6 is enabled in rescue mode
while the original server has ipv6 disabled.</p>
<p>There should be an option to disable ipv6.</p>
<p>Thanks</p>
<h4 id="gdha_commented_at_2015-12-24_0733"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167061008">2015-12-24 07:33</a>:<a class="headerlink" href="#gdha_commented_at_2015-12-24_0733" title="Permanent link">&para;</a></h4>
<p>@blaxxton please run rear and capture the following output (of scripts).
Perhaps use GitHub Gist to store the output.</p>
<pre><code>ip a
rear -vd mkrescue
cd /tmp/rear.&lt;6AlinkJEojgKw9h&gt;/rootfs    (replace &lt;6AlinkJEojgKw9h&gt; with the unique string)
cat etc/rear/rescue.conf
cat etc/scripts/system-setup.d/60-network-devices.sh
cat etc/scripts/system-setup.d/62-routing.sh
cat etc/scripts/system-setup.d/63-teaming.sh
</code></pre>
<h4 id="gdha_commented_at_2015-12-24_0815"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167066169">2015-12-24 08:15</a>:<a class="headerlink" href="#gdha_commented_at_2015-12-24_0815" title="Permanent link">&para;</a></h4>
<p>@blaxxton perhaps also list the <code>ifcfg-&lt;dev&gt;</code> configuration script
(location sometimes /etc/sysconfig/network-scripts)</p>
<h4 id="schlomo_commented_at_2015-12-24_0816"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167066356">2015-12-24 08:16</a>:<a class="headerlink" href="#schlomo_commented_at_2015-12-24_0816" title="Permanent link">&para;</a></h4>
<p>@blaxxton how did you disable ipv6 on your server?</p>
<h4 id="blaxxton_commented_at_2015-12-24_1122"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167095405">2015-12-24 11:22</a>:<a class="headerlink" href="#blaxxton_commented_at_2015-12-24_1122" title="Permanent link">&para;</a></h4>
<pre><code>MyHostName###ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue state UNKNOWN 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP qlen 1000
    link/ether 00:50:56:b1:06:77 brd ff:ff:ff:ff:ff:ff
    inet 192.168.112.167/24 brd 192.168.112.255 scope global eth0
MyHostName###
MyHostName###rear -vd mkrescue      
Relax-and-Recover 1.17.2-git201509031543 / 2015-09-03
Using log file: /var/log/rear/rear-MyHostName.log
Creating disk layout
Creating root filesystem layout
EMC Networker will recover these filesystems: / /boot /fs_db /fs_data /fs_bkup 
TIP: To login as root via ssh you need to set up /root/.ssh/authorized_keys or SSH_ROOT_PASSWORD in your configuration file
Copying files and directories
Copying binaries and libraries
Copying kernel modules
Creating initramfs
Making ISO image
Wrote ISO image: /var/lib/rear/output/rear-MyHostName.iso (105M)
Saving result files with NSR (EMC NetWorker)
If the NSR_RETENTION_TIME="1 day" is too low please add NSR_RETENTION_TIME variable in /etc/rear/local.conf
 pool           retent  name
============================
dailyclone 12/23/15 /var/lib/rear/output/rear-MyHostName.iso
dailyclone 12/24/15 /var/lib/rear/output/rear-MyHostName.iso
dailyclone 12/25/15 /var/lib/rear/output/rear-MyHostName.iso
You should also rm -Rf /tmp/rear.XR09RJW2vDY1y3X
MyHostName###
MyHostName###cd /tmp/rear.XR09RJW2vDY1y3X/rootfs
MyHostName###pwd
/tmp/rear.XR09RJW2vDY1y3X/rootfs
MyHostName###cat etc/rear/rescue.conf
# initialize our /etc/rear/rescue.conf file sourced by the rear command in recover mode
# also the configuration is sourced by system-setup script during booting our recovery image
SHARE_DIR="/usr/share/rear"
CONFIG_DIR="/etc/rear"
VAR_DIR="/var/lib/rear"
LOG_DIR="/var/log/rear"
# TMPDIR variable may be defined in local.conf file as prefix dir for mktemp command
# e.g. by defining TMPDIR=/var we would get our BUILD_DIR=/var/tmp/rear.XXXXXXXXXXXX
# However, in rescue we want our BUILD_DIR=/tmp/rear.XXXXXXX as we are not sure that
# the user defined TMPDIR would exist in our rescue image
# by 'unset TMPDIR' we achieve above goal (as rescue.conf is read after local.conf)!
unset TMPDIR
MyHostName###
MyHostName###cat etc/scripts/system-setup.d/60-network-devices.sh
# if USE_DHCLIENT=y then use DHCP instead and skip 60-network-devices.sh
[[ ! -z "$USE_DHCLIENT" &amp;&amp; -z "$USE_STATIC_NETWORKING" ]] &amp;&amp; return
# if IPADDR=1.2.3.4 has been defined at boot time via ip=1.2.3.4 then configure 
if [[ "$IPADDR" ]] &amp;&amp; [[ "$NETMASK" ]] ; then
    device=${NETDEV:-eth0}
    ip link set dev "$device" up
    ip addr add "$IPADDR"/"$NETMASK" dev "$device"
    if [[ "$GATEWAY" ]] ; then
        ip route add default via "$GATEWAY"
    fi
    return
fi
ip addr add 192.168.112.167/24 dev eth0
ip link set dev eth0 up
ip link set dev eth0 mtu 1500
MyHostName###cat etc/scripts/system-setup.d/62-routing.sh
# if USE_DHCLIENT=y then skip 62-routing.sh as we are using DHCP instead
[[ ! -z "$USE_DHCLIENT" &amp;&amp; -z "$USE_STATIC_NETWORKING" ]] &amp;&amp; return
# if GATEWAY is defined as boot option gw=1.2.3.4 then use that one
[[ ! -z "$GATEWAY" ]] &amp;&amp; return
if [[ -e /proc/cmdline ]] ; then
    if grep -q 'noip' /proc/cmdline ; then
        return
    fi
fi
ip route add default via 192.168.112.1 dev eth0 table main
MyHostName###cat etc/scripts/system-setup.d/63-teaming.sh
cat: etc/scripts/system-setup.d/63-teaming.sh: No such file or directory
MyHostName###ls etc/scripts/system-setup.d/
00-functions.sh           40-start-udev-or-load-modules.sh  45-serial-console.sh           60-network-devices.sh  99-makedev.sh
10-console-setup.sh       41-load-special-modules.sh        55-migrate-network-devices.sh  62-routing.sh
20-check-boot-options.sh  42-engage-scsi.sh                 58-start-dhclient.sh           90-networker.sh*
MyHostName###
</code></pre>
<h4 id="blaxxton_commented_at_2015-12-24_1125"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167095601">2015-12-24 11:25</a>:<a class="headerlink" href="#blaxxton_commented_at_2015-12-24_1125" title="Permanent link">&para;</a></h4>
<p>I deleted the ipv6 address with ifconfig command after booting to rescue
by choosing recover.</p>
<h4 id="blaxxton_commented_at_2015-12-24_1126"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167095664">2015-12-24 11:26</a>:<a class="headerlink" href="#blaxxton_commented_at_2015-12-24_1126" title="Permanent link">&para;</a></h4>
<p>MyHostName###ls -la /etc/sysconfig/network-scripts/ifcfg-*<br />
-rw-r--r-- 1 root root 268 Dec 23 16:08
/etc/sysconfig/network-scripts/ifcfg-eth0<br />
-rw-r--r-- 1 root root 254 Oct 10 2013
/etc/sysconfig/network-scripts/ifcfg-lo<br />
MyHostName###</p>
<h4 id="blaxxton_commented_at_2015-12-24_1157"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167099445">2015-12-24 11:57</a>:<a class="headerlink" href="#blaxxton_commented_at_2015-12-24_1157" title="Permanent link">&para;</a></h4>
<p>ipv6 disabled on server by adding:</p>
<pre><code>MyHostName###tail -n 3 /etc/sysctl.conf 
# IPv6 support in the kernel, set to 0 by default
net.ipv6.conf.all.disable_ipv6 = 1
net.ipv6.conf.default.disable_ipv6 = 1
MyHostName###

MyHostName###head -n 2 /etc/sysconfig/network
NETWORKING=yes
NETWORKING_IPV6=no
MyHostName###

MyHostName###tail -n 1 /etc/sysconfig/network-scripts/ifcfg-eth0    
IPV6INIT=no
MyHostName###
</code></pre>
<h4 id="gdha_commented_at_2015-12-24_1230"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167104554">2015-12-24 12:30</a>:<a class="headerlink" href="#gdha_commented_at_2015-12-24_1230" title="Permanent link">&para;</a></h4>
<p>Did you define <code>USE_DHCLIENT</code> somewhere in <code>local.conf</code> or <code>site.conf</code>?
As I see no active IPv6 on your current system (which what you said),
but when looking at the scripts produced by rear I see also <strong>no</strong> IPv6
definitions. It can only be introduced by dhcpd6 I guess?<br />
You can always force static IP addresses with the variable
<code>USE_STATIC_NETWORKING=1</code> if that would be required.</p>
<h4 id="blaxxton_commented_at_2015-12-24_1335"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167113308">2015-12-24 13:35</a>:<a class="headerlink" href="#blaxxton_commented_at_2015-12-24_1335" title="Permanent link">&para;</a></h4>
<p>Already tired USE_STATIC_NETWORKING=1 in /etc/rear/local.conf<br />
and the result was the same, ipv6 is being set on eth0.</p>
<p>MyHostName###tail -n 2 /etc/rear/local.conf<br />
BACKUP=NSR<br />
USE_STATIC_NETWORKING=1<br />
MyHostName###</p>
<p>/etc/rear/local.conf does not have any USE_DHCLIENT.</p>
<p>I can't find where ipv6 is being set in any of the scripts.<br />
The only place ipv6 address is being set is when we set dhcp ipv6 but<br />
dhcp is not installed on server</p>
<p>MyHostName###rpm -aq | grep -i dhcp<br />
dhcp-common-4.1.1-38.P1.el6.x86_64<br />
MyHostName###</p>
<p>.</p>
<h4 id="blaxxton_commented_at_2015-12-24_1404"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167116297">2015-12-24 14:04</a>:<a class="headerlink" href="#blaxxton_commented_at_2015-12-24_1404" title="Permanent link">&para;</a></h4>
<p>Correct me if I am wrong.</p>
<p>In line 64 of 21_include_dhclient.sh:<br />
64 [ ! -z "$DHCLIENT6_BIN" ] &amp;&amp; USE_DHCLIENT=y</p>
<p>This means if DHCLIENT6_BIN is not empty set USE_DHCLIENT to y which
seems to be correct<br />
but on my server, below lines always return y:</p>
<p>MyHostName###export DHCLIENT6_BIN=""; echo $DHCLIENT6_BIN; [[ !
-z "$DHCLIENT6_BIN" ]] &amp;&amp; USE_DHCLIENT=y; echo $USE_DHCLIENT</p>
<p>y<br />
MyHostName###export DHCLIENT6_BIN="1"; echo $DHCLIENT6_BIN; [[ !
-z "$DHCLIENT6_BIN" ]] &amp;&amp; USE_DHCLIENT=y; echo $USE_DHCLIENT<br />
1<br />
y<br />
MyHostName###</p>
<p>I am using bash.</p>
<h4 id="blaxxton_commented_at_2015-12-24_1528"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167126047">2015-12-24 15:28</a>:<a class="headerlink" href="#blaxxton_commented_at_2015-12-24_1528" title="Permanent link">&para;</a></h4>
<p>I even tried passing the ip and nm to kernel at boot time, but still
ipv6 is being setup on both eth0 and loopback.</p>
<h4 id="blaxxton_commented_at_2015-12-24_1622"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167132677">2015-12-24 16:22</a>:<a class="headerlink" href="#blaxxton_commented_at_2015-12-24_1622" title="Permanent link">&para;</a></h4>
<p>MyHostName###export DHCLIENT6_BIN= ;
DHCLIENT6_BIN=${DHCLIENT6_BIN##*/}; echo $DHCLIENT6_BIN; [ ! -z
"$DHCLIENT6_BIN" ] &amp;&amp; USE_DHCLIENT=y; echo $USE_DHCLIENT</p>
<p>y<br />
MyHostName###export DHCLIENT6_BIN="/usr/bin/dhcclient.sh";
DHCLIENT6_BIN=${DHCLIENT6_BIN##*/}; echo $DHCLIENT6_BIN; [ ! -z
"$DHCLIENT6_BIN" ] &amp;&amp; USE_DHCLIENT=y; echo $USE_DHCLIENT<br />
dhcclient.sh<br />
y<br />
MyHostName###</p>
<h4 id="blaxxton_commented_at_2015-12-24_2116"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167160313">2015-12-24 21:16</a>:<a class="headerlink" href="#blaxxton_commented_at_2015-12-24_2116" title="Permanent link">&para;</a></h4>
<p>I agree, I don't see any command that set ipv6 in rootfs, but I think
some how USE_DHCLIENT is being set and dhcpd6 is being called. is it
possible it is defined in kernel config file ?</p>
<h4 id="gdha_commented_at_2015-12-29_1922"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167859194">2015-12-29 19:22</a>:<a class="headerlink" href="#gdha_commented_at_2015-12-29_1922" title="Permanent link">&para;</a></h4>
<p>@blaxxton to be 100% sure you could add <code>set -x</code> to the script
<code>./skel/default/etc/scripts/system-setup.d/58-start-dhclient.sh</code> and
rebuild the rescue image and boot from it. Then you should see what it
does... According to me the variable <code>USE_DHCLIENT</code> should <strong>not</strong> be
set and this script should be skipped for that reason.<br />
Otherwise, you could see what is running with <code>ps ax</code> on your rescue
system. Or, the <code>/var/log/messages</code> could give a hint of what happened.
It is a bit of mystery...</p>
<h4 id="blaxxton_commented_at_2015-12-29_1936"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167861465">2015-12-29 19:36</a>:<a class="headerlink" href="#blaxxton_commented_at_2015-12-29_1936" title="Permanent link">&para;</a></h4>
<p>I don't think running set -x option to debug would help because you were
right, and there is no where in script that ipv6 being set using ip
command.</p>
<p>adding EXCLUDE_MODULES=( ipv6 ) to /etc/rear/local.conf fixed my
problem and not seeing any ipv6 address assigned to either loopback or
eth0.</p>
<p>This is RedHat 6 and even after disabling ipv6 in
/etc/modprobe.d/ipv6.conf, I can see ipv6 modules in modprobe -l output.</p>
<p>According to RedHat Document:<br />
<a href="https://access.redhat.com/solutions/72733">https://access.redhat.com/solutions/72733</a></p>
<p>The root cause of the issue is the dracut-network plug-in but we don't
have such a plugin installed.<br />
resolution at RedHat level is rebuilding the initramfs file.<br />
The ipv6.conf file will be pulled into the initramfs file, and applied
at the initramfs stage.</p>
<p>I tried rebuilding the initramfs but still am able to see ipv6 modules
also not a very good idea to disable ipv6 module at system level.</p>
<p>somehow , your script create a initramfs that has ipv6 enabled based on
the server.</p>
<h4 id="gdha_commented_at_2015-12-29_1953"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167863884">2015-12-29 19:53</a>:<a class="headerlink" href="#gdha_commented_at_2015-12-29_1953" title="Permanent link">&para;</a></h4>
<p>perhaps you could run once <code>rear -vd mkrescue</code> and check under
/tmp/rear/.XXXX/rootfs/etc directory the file <code>modules</code>. Is the ipv6
listed in there?</p>
<h4 id="blaxxton_commented_at_2015-12-29_2048"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-167875108">2015-12-29 20:48</a>:<a class="headerlink" href="#blaxxton_commented_at_2015-12-29_2048" title="Permanent link">&para;</a></h4>
<p>Only one entry in that file:<br />
cat modules<br />
vmxnet3</p>
<p>but there is ipv6 module in /var/lib/rear/recovery/initrd_modules<br />
grep ipv6 /var/lib/rear/recovery/initrd_modules<br />
ipv6</p>
<p>grep ipv6 var/lib/rear/recovery/initrd_modules<br />
ipv6</p>
<p>ipv6 is being added to interfaces when kernel is being loaded.</p>
<h4 id="gdha_commented_at_2016-01-04_1017"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-168632485">2016-01-04 10:17</a>:<a class="headerlink" href="#gdha_commented_at_2016-01-04_1017" title="Permanent link">&para;</a></h4>
<p>Interesting feedback - the script
<code>./usr/share/rear/rescue/GNU/Linux/26_collect_initrd_modules.sh</code>
prepares the initrd_modules file.<br />
Perhaps, it would be a good idea if IPv6 is disabled to exclude it from
this list. However, most likely there will always be a case where one
needs it, no?</p>
<h4 id="schlomo_commented_at_2016-01-04_1311"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-168673791">2016-01-04 13:11</a>:<a class="headerlink" href="#schlomo_commented_at_2016-01-04_1311" title="Permanent link">&para;</a></h4>
<p>IMHO we should actively suppress IPv6 as long as we don't handle it
properly (with a flag to suppress that mechanism). So far we had more
reports of "IPv6 broke my environment" than of "Please handle IPv6
properly".</p>
<h4 id="gdha_commented_at_2016-01-04_1901"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-168770286">2016-01-04 19:01</a>:<a class="headerlink" href="#gdha_commented_at_2016-01-04_1901" title="Permanent link">&para;</a></h4>
<pre><code>$ cat /proc/net/if_inet6 
00000000000000000000000000000001 01 80 10 80       lo
fe80000000000000626720fffe18861c 03 40 20 80     wlo1
2a02a03f1a397700626720fffe18861c 03 40 00 00     wlo1
</code></pre>
<p>Is a good starting point</p>
<h4 id="blaxxton_commented_at_2016-01-05_0427"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-168893034">2016-01-05 04:27</a>:<a class="headerlink" href="#blaxxton_commented_at_2016-01-05_0427" title="Permanent link">&para;</a></h4>
<p>I think it is a good idea to disable ipv6 since ipv4 is always
availablein all environments, even those that has set up ipv6 on their
networkbut ipv6 would cause problem for those that has not setup ipv6 in
thier environments and add extra steps to disable ipv6 to be able to
recover.<br />
I don't think there is any environment totally on ipv6 and no ipv4.<br />
If yes, then it is a good idea to have it in config file.<br />
Thanks</p>
<pre><code>  From: gdha &lt;notifications@github.com&gt;
</code></pre>
<p>To: rear/rear <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
Cc: blaxxton <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;">&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;</a><br />
Sent: Monday, January 4, 2016 4:17 AM<br />
Subject: Re: [rear] ipv6 has been disabled in server, but ISO boots
server with ipv6 assigned to eth0 and lo (#748)</p>
<p>Interesting feedback - the script
./usr/share/rear/rescue/GNU/Linux/26_collect_initrd_modules.sh
prepares the initrd_modules file.<br />
Perhaps, it would be a good idea if IPv6 is disabled to exclude it from
this list. However, most likely there will always be a case where one
needs it, no?—<br />
Reply to this email directly or view it on GitHub.</p>
<h4 id="blaxxton_commented_at_2016-01-05_0456"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-168897675">2016-01-05 04:56</a>:<a class="headerlink" href="#blaxxton_commented_at_2016-01-05_0456" title="Permanent link">&para;</a></h4>
<p>One more note:<br />
We don't want to disable ipv6 at kernel level or even we don't want to
disable loading ipv6since there might be some interdepency between
modules.<br />
So we decided to disable ipv6 only in /etc/sysctl.conf
and /etc/sysconfig/network.<br />
I checked the
script /usr/share/rear/rescue/GNU/Linux/26_collect_initrd_modules.sh
and all it does copying the current initrd and initrmfs along with
modules but these are still having ipv6 enabled.<br />
It is best to recreate the initramfs while disabling ipv6 and then copy
it over:dracut --omit-drivers ipv6 /tmp/initramfs-$(uname -r).img
$(uname -r)<br />
so if there is a directive in config file, initramfs will be recreated
and then copies overand if there is no directive initramfs directly
copies over with no change.</p>
<p>Thanks</p>
<pre><code>  From: gdha &lt;notifications@github.com&gt;
</code></pre>
<p>To: rear/rear <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
Cc: blaxxton <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;">&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;</a><br />
Sent: Monday, January 4, 2016 4:17 AM<br />
Subject: Re: [rear] ipv6 has been disabled in server, but ISO boots
server with ipv6 assigned to eth0 and lo (#748)</p>
<p>Interesting feedback - the script
./usr/share/rear/rescue/GNU/Linux/26_collect_initrd_modules.sh
prepares the initrd_modules file.<br />
Perhaps, it would be a good idea if IPv6 is disabled to exclude it from
this list. However, most likely there will always be a case where one
needs it, no?—<br />
Reply to this email directly or view it on GitHub.</p>
<h4 id="schlomo_commented_at_2016-01-05_1240"><img src="https://avatars.githubusercontent.com/u/101384?v=4" width="50"><a href="https://github.com/schlomo">schlomo</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-168988903">2016-01-05 12:40</a>:<a class="headerlink" href="#schlomo_commented_at_2016-01-05_1240" title="Permanent link">&para;</a></h4>
<p>IMHO ReaR should faithfully copy what you did on your source system. If
you<br />
disabled IPv6 in sysctl.conf then we should just copy that.</p>
<p>A quick look reveals that sysctl is not handled by ReaR whatsoever.
Maybe<br />
we should just add a "copy all sysctl.conf stuff over and activate it
on<br />
boot" feature to solve your problem.</p>
<p>On 5 January 2016 at 05:56, blaxxton <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a> wrote:</p>
<blockquote>
<p>One more note:<br />
We don't want to disable ipv6 at kernel level or even we don't want
to<br />
disable loading ipv6since there might be some interdepency between
modules.<br />
So we decided to disable ipv6 only in /etc/sysctl.conf<br />
and /etc/sysconfig/network.<br />
I checked the<br />
script
/usr/share/rear/rescue/GNU/Linux/26_collect_initrd_modules.sh and<br />
all it does copying the current initrd and initrmfs along with modules
but<br />
these are still having ipv6 enabled.<br />
It is best to recreate the initramfs while disabling ipv6 and then
copy it<br />
over:dracut --omit-drivers ipv6 /tmp/initramfs-$(uname -r).img $(uname
-r)<br />
so if there is a directive in config file, initramfs will be recreated
and<br />
then copies overand if there is no directive initramfs directly copies
over<br />
with no change.</p>
<p>Thanks</p>
<p>From: gdha <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
To: rear/rear <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
Cc: blaxxton <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;">&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;</a><br />
Sent: Monday, January 4, 2016 4:17 AM<br />
Subject: Re: [rear] ipv6 has been disabled in server, but ISO boots
server<br />
with ipv6 assigned to eth0 and lo (#748)</p>
<p>Interesting feedback - the script<br />
./usr/share/rear/rescue/GNU/Linux/26_collect_initrd_modules.sh
prepares the<br />
initrd_modules file.<br />
Perhaps, it would be a good idea if IPv6 is disabled to exclude it
from<br />
this list. However, most likely there will always be a case where one
needs<br />
it, no?—<br />
Reply to this email directly or view it on GitHub.</p>
<p>—<br />
Reply to this email directly or view it on GitHub<br />
<a href="https://github.com/rear/rear/issues/748#issuecomment-168897675">https://github.com/rear/rear/issues/748#issuecomment-168897675</a>.</p>
</blockquote>
<h4 id="gdha_commented_at_2016-01-05_1939"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-169107581">2016-01-05 19:39</a>:<a class="headerlink" href="#gdha_commented_at_2016-01-05_1939" title="Permanent link">&para;</a></h4>
<p>@blaxxton perhaps you give it a try with development version
rear-1.17.2-git201601052030?</p>
<h4 id="blaxxton_commented_at_2016-01-06_0328"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-169210222">2016-01-06 03:28</a>:<a class="headerlink" href="#blaxxton_commented_at_2016-01-06_0328" title="Permanent link">&para;</a></h4>
<p>I am going to try it tomorrow, will let you know the result soon.</p>
<pre><code>  From: gdha &lt;notifications@github.com&gt;
</code></pre>
<p>To: rear/rear <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
Cc: blaxxton <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;">&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;</a><br />
Sent: Tuesday, January 5, 2016 1:40 PM<br />
Subject: Re: [rear] ipv6 has been disabled in server, but ISO boots
server with ipv6 assigned to eth0 and lo (#748)</p>
<p>@blaxxton perhaps you give it a try with development version
rear-1.17.2-git201601052030?—<br />
Reply to this email directly or view it on GitHub.</p>
<h4 id="blaxxton_commented_at_2016-01-06_2121"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-169465982">2016-01-06 21:21</a>:<a class="headerlink" href="#blaxxton_commented_at_2016-01-06_2121" title="Permanent link">&para;</a></h4>
<p>Can you please provide the link to download rear-1.17.2-git201601052030
?<br />
Thanks</p>
<pre><code>  From: gdha &lt;notifications@github.com&gt;
</code></pre>
<p>To: rear/rear <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
Cc: blaxxton <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;">&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;</a><br />
Sent: Tuesday, January 5, 2016 1:40 PM<br />
Subject: Re: [rear] ipv6 has been disabled in server, but ISO boots
server with ipv6 assigned to eth0 and lo (#748)</p>
<p>@blaxxton perhaps you give it a try with development version
rear-1.17.2-git201601052030?—<br />
Reply to this email directly or view it on GitHub.</p>
<h4 id="gdha_commented_at_2016-01-07_0720"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-169581247">2016-01-07 07:20</a>:<a class="headerlink" href="#gdha_commented_at_2016-01-07_0720" title="Permanent link">&para;</a></h4>
<p>See page
<a href="http://relax-and-recover.org/download/">http://relax-and-recover.org/download/</a>
and select a snapshot version according your distro and go deeper into
x86_64 directory.</p>
<h4 id="blaxxton_commented_at_2016-01-07_1532"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-169696455">2016-01-07 15:32</a>:<a class="headerlink" href="#blaxxton_commented_at_2016-01-07_1532" title="Permanent link">&para;</a></h4>
<p>My test server is RedHat 6, but there is no x86_64 on snapshot
version.<br />
downloaded from i686:</p>
<p>Index of
/repositories/Archiving:/Backup:/Rear:/Snapshot/RedHat_RHEL-6/i686</p>
<p>|   |<br />
|   | |   |   |   |   |   |<br />
| Index of /repositories/Archiving:/Backup:/Rear:/Snapsho...Index of
/repositories/Archiving:/Backup:/Rear:/Snapshot/RedHat_RHEL-6/i686 Name
Last modified Size |<br />
| |<br />
| View on download.opensuse.org | Preview by Yahoo |<br />
| |<br />
|   |</p>
<p>rear-1.17.2-115.git201601052030.el6.i686.rpm</p>
<p>Is this ok ?</p>
<pre><code>  From: gdha &lt;notifications@github.com&gt;
</code></pre>
<p>To: rear/rear <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
Cc: blaxxton <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;">&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;</a><br />
Sent: Thursday, January 7, 2016 1:20 AM<br />
Subject: Re: [rear] ipv6 has been disabled in server, but ISO boots
server with ipv6 assigned to eth0 and lo (#748)</p>
<p>See page
<a href="http://relax-and-recover.org/download/">http://relax-and-recover.org/download/</a>
and select a snapshot version according your distro and go deeper into
x86_64 directory.—<br />
Reply to this email directly or view it on GitHub.</p>
<h4 id="gdha_commented_at_2016-01-07_1559"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-169706692">2016-01-07 15:59</a>:<a class="headerlink" href="#gdha_commented_at_2016-01-07_1559" title="Permanent link">&para;</a></h4>
<p>@blaxxton yes that is ok</p>
<h4 id="blaxxton_commented_at_2016-01-12_0023"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-170741474">2016-01-12 00:23</a>:<a class="headerlink" href="#blaxxton_commented_at_2016-01-12_0023" title="Permanent link">&para;</a></h4>
<p>I just tried rear-1.17.2-118.git201601091610.el6.i686.rpm<br />
and it fails right at the beginning :<br />
2016-01-11 17:03:30.248917438 ERROR: The savefs command could not
retrieve the "save sets" from this client=== Stack trace ===Trace 0:
/usr/sbin/rear:410 mainTrace 1:
/usr/share/rear/lib/mkrescue-workflow.sh:29 WORKFLOW_mkrescueTrace 2:
/usr/share/rear/lib/framework-functions.sh:85 SourceStageTrace 3:
/usr/share/rear/lib/framework-functions.sh:45 SourceTrace 4:
/usr/share/rear/rescue/NSR/default/47_safe_filesystems.sh:3
sourceMessage: The savefs command could not retrieve the "save sets"
from this client===================</p>
<p>or later error:2016-01-11 17:18:31.334417502 Saving result files with
NSR (EMC NetWorker)2016-01-11 17:18:31.661689735 Saving files
'/var/lib/rear/output/rear-clientname.iso' with save98519:save: Unable
to setup direct save with server nsr_server: no matching IP interface
data domain devices for save of client
<code>clientname'; check storage nodes, devices or pools.90018:save: Cannot open a save session with NetWorker server 'nsr_server': no matching IP interface data domain devices for save of client</code>clientname';
check storage nodes, devices or pools2016-01-11 17:18:32.331632992
ERROR: Could not save result files with save=== Stack trace ===Trace 0:
/usr/sbin/rear:410 mainTrace 1:
/usr/share/rear/lib/mkrescue-workflow.sh:35 WORKFLOW_mkrescueTrace 2:
/usr/share/rear/lib/framework-functions.sh:85 SourceStageTrace 3:
/usr/share/rear/lib/framework-functions.sh:45 SourceTrace 4:
/usr/share/rear/output/NSR/default/95_nsr_save_result_files.sh:55
sourceTrace 5: /usr/share/rear/lib/_input-output-functions.sh:150
StopIfErrorMessage: Could not save result files with
save===================2016-01-11 17:18:32.335602303 Running exit
tasks.<br />
works fine with older version.<br />
Thanks</p>
<pre><code>  From: gdha &lt;notifications@github.com&gt;
</code></pre>
<p>To: rear/rear <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
Cc: blaxxton <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;">&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;</a><br />
Sent: Thursday, January 7, 2016 9:59 AM<br />
Subject: Re: [rear] ipv6 has been disabled in server, but ISO boots
server with ipv6 assigned to eth0 and lo (#748)</p>
<p>@blaxxton yes that is ok—<br />
Reply to this email directly or view it on GitHub.</p>
<h4 id="gdha_commented_at_2016-01-12_0652"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-170816429">2016-01-12 06:52</a>:<a class="headerlink" href="#gdha_commented_at_2016-01-12_0652" title="Permanent link">&para;</a></h4>
<p>@blaxxton could you check the <code>/var/lib/rear/recovery/</code> directory to
find out if the necessary <code>nsr_*</code> files were properly created? The NSR
scripts were not modified in the last month, so I don't get it.</p>
<h4 id="blaxxton_commented_at_2016-01-12_1550"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-170954075">2016-01-12 15:50</a>:<a class="headerlink" href="#blaxxton_commented_at_2016-01-12_1550" title="Permanent link">&para;</a></h4>
<p>Yes, files have been created:</p>
<p>ls -latr /tmp/rear.CztH5P9ZiI8iI4L/rootfs/var/lib/rear/recoverytotal
40drwxr-xr-x 5 root root 4096 Jan  9 20:22 ../-rw-r--r-- 1 root root
 143 Jan 12 08:36 mountpoint_permissions-rw-r--r-- 1 root root  665 Jan
12 08:36 diskbyid_mappings-rw-r--r-- 1 root root    5 Jan 12 08:36
bootloader-rw-r--r-- 1 root root  112 Jan 12 08:36
mountpoint_device-rw-r--r-- 1 root root   91 Jan 12 08:36
storage_drivers-rw-r--r-- 1 root root   11 Jan 12 08:36
nsr_server-rw-r--r-- 1 root root 2997 Jan 12 08:36
initrd_modules-r--r--r-- 1 root root    0 Jan 12 08:36
if_inet6drwxr-xr-x 2 root root 4096 Jan 12 08:36 ./-rw-r--r-- 1 root
root   24 Jan 12 08:36 nsr_paths<br />
ls -la /var/lib/rear/recoverytotal 40drwxr-xr-x 2 root root 4096 Jan 12
08:36 ./drwxr-xr-x 5 root root 4096 Jan  9 20:22 ../-rw-r--r-- 1 root
root    5 Jan 12 08:36 bootloader-rw-r--r-- 1 root root  665 Jan 12
08:36 diskbyid_mappings-r--r--r-- 1 root root    0 Jan 12 08:36
if_inet6-rw-r--r-- 1 root root 2997 Jan 12 08:36
initrd_modules-rw-r--r-- 1 root root  112 Jan 12 08:36
mountpoint_device-rw-r--r-- 1 root root  143 Jan 12 08:36
mountpoint_permissions-rw-r--r-- 1 root root   24 Jan 12 08:36
nsr_paths-rw-r--r-- 1 root root   11 Jan 12 08:36 nsr_server-rw-r--r--
1 root root   91 Jan 12 08:36 storage_drivers</p>
<p>What I noticed, if_inet6 is with size of 0 either with older version or
the current one.<br />
and ipv6 is in initrd_modules on both old and new version.<br />
On new version I have some additional pv-uuid in diskbyid_mappings  but
not sure if it is related.<br />
lvm-pv-uuid-53T30q-AsBm-ATpW-5Y2s-AF8r-Yrpt-3xiLdJ
sda3lvm-pv-uuid-r2Fd4w-mb2q-9KFp-FAVR-l1dp-Mk29-SQsA6M
sda2lvm-pv-uuid-yVs0X8-rrpT-1OdI-rJUC-haan-lSvM-yin7Y6 sdb</p>
<p>The actual error is complaining about:<br />
no matching IP interface data domain devices for save of client
Client_Name check storage nodes, devices or pools.</p>
<p>but old version can do the backup with no problem.<br />
What change you made in new version to fix the ipv6 ?<br />
Thanks</p>
<h4 id="gdha_commented_at_2016-01-12_1928"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-171025188">2016-01-12 19:28</a>:<a class="headerlink" href="#gdha_commented_at_2016-01-12_1928" title="Permanent link">&para;</a></h4>
<p>@blaxxton Did you still had an IPv6 address after you booted from the
rescue image?<br />
In rescue image you will find a new script
<code>/etc/scripts/system-setup.d/65-sysctl.sh</code> that read the
<code>/etc/sysctl*.conf</code> files.<br />
Furthermore, did you check the content of
<code>/var/lib/rear/recovery/nsr_server</code> and
<code>/var/lib/rear/recovery/nsr_paths</code>?</p>
<h4 id="blaxxton_commented_at_2016-01-13_1500"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-171321368">2016-01-13 15:00</a>:<a class="headerlink" href="#blaxxton_commented_at_2016-01-13_1500" title="Permanent link">&para;</a></h4>
<p>Still ipv6 there.</p>
<p>I think becuase 65-sysctl.sh only including /etc/sysctl.d/*.conf and
missing including /etc/sysctl.conf.</p>
<h1 id="run_sysctl_etcsysctlconf_and_etcsysctldconf_files">run sysctl /etc/sysctl.conf and /etc/sysctl.d/*.conf files<a class="headerlink" href="#run_sysctl_etcsysctlconf_and_etcsysctldconf_files" title="Permanent link">&para;</a></h1>
<p>for file in /etc/sysctl.d/*.conf ; do<br />
test -f "$file" &amp;&amp; sysctl -e -p "$file" &gt;/dev/null 2&gt;&amp;1<br />
done<br />
test -f /etc/sysctl.conf &amp;&amp; sysctl -e -p /etc/sysctl.conf &gt;/dev/null
2&gt;&amp;1</p>
<p>nsr_server and nsr_paths seems to be ok and contain the server name
and file systems are being backed up.<br />
Thanks</p>
<hr />
<p>From: gdha <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
To: rear/rear <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
Cc: blaxxton <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;">&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;</a><br />
Sent: Tuesday, January 12, 2016 1:28 PM<br />
Subject: Re: [rear] ipv6 has been disabled in server, but ISO boots
server with ipv6 assigned to eth0 and lo (#748)</p>
<p>@blaxxton Did you still had an IPv6 address after you booted from the
rescue image?<br />
In rescue image you will find a new script
/etc/scripts/system-setup.d/65-sysctl.sh that read the
/etc/sysctl*.conf files.<br />
Furthermore, did you check the content of
/var/lib/rear/recovery/nsr_server and
/var/lib/rear/recovery/nsr_paths?<br />
—<br />
Reply to this email directly or view it on GitHub.</p>
<h4 id="gdha_commented_at_2016-01-20_1447"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-173225509">2016-01-20 14:47</a>:<a class="headerlink" href="#gdha_commented_at_2016-01-20_1447" title="Permanent link">&para;</a></h4>
<p>@blaxxton did you re-run your tests with the latest modifications? In
rescue mode you could run <code>sysctl -a|grep ipv6</code> to verify the status of
IPv6.<br />
On the other hand, the link
<a href="https://wiki.archlinux.org/index.php/IPv6#Disable_IPv6">https://wiki.archlinux.org/index.php/IPv6#Disable_IPv6</a>
contains some useful information of parameters that can be added to
<code>KERNEL_CMDLINE</code> (in <code>/etc/rear/local.conf</code>)</p>
<h4 id="blaxxton_commented_at_2016-01-27_2018"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-175835139">2016-01-27 20:18</a>:<a class="headerlink" href="#blaxxton_commented_at_2016-01-27_2018" title="Permanent link">&para;</a></h4>
<p>Ok, thanks, the scripts is fixed and now it can read /etc/sysctl.conf,
but still there is ipv6 address assigned after booting from ISO.</p>
<p>Booted from ISO and sysctl -a | grep -i ipv6 | grep disable shows that
ipv6 is enabled.<br />
65-sysctl.sh was not executable, so I did chmod 755 65-sysctl.sh and
then ran ./65-sysctl.sh<br />
now ipv6 is gone.</p>
<p>Some how 65-sysctl.sh script is not being executed at boot time.</p>
<p>Can you please check why this script is not being called or executed
when we boot from ISO ?</p>
<p>Thanks</p>
<h4 id="blaxxton_commented_at_2016-01-28_1506"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-176227700">2016-01-28 15:06</a>:<a class="headerlink" href="#blaxxton_commented_at_2016-01-28_1506" title="Permanent link">&para;</a></h4>
<p>Can we disable backing up the ISO file in NSR ?We run rear mkrescue to
create the ISO to boot from but at the end it backup the ISO file as
well.<br />
We already backing up the server every night, and finding the correct
default backup pool is not always accurateso why not disabling the
backup of ISO at the time of creation, and only save it locally in
disksince we are going to back it up at night.<br />
Can this be done ?<br />
The other question is:Consider we run daily rear mkrescue , and server
crashes today but we find out the best recover time is last week and
not today, how at recover time and after booting from ISO  I can specify
specific date to recover ?<br />
Thanks</p>
<h4 id="gdha_commented_at_2016-02-09_1317"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-181859225">2016-02-09 13:17</a>:<a class="headerlink" href="#gdha_commented_at_2016-02-09_1317" title="Permanent link">&para;</a></h4>
<p>@blaxxton <em>Can we disable backing up the ISO file in NSR ?</em><br />
Would prefer to see this in another issue as otherwise it is getting a
mess...</p>
<h4 id="gdha_commented_at_2016-02-09_1319"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-181860202">2016-02-09 13:19</a>:<a class="headerlink" href="#gdha_commented_at_2016-02-09_1319" title="Permanent link">&para;</a></h4>
<p>@blaxxton <em>Some how 65-sysctl.sh script is not being executed at boot
time.</em><br />
<em>Can you please check why this script is not being called or executed
when we boot from ISO ?</em><br />
I am sorry I wouldn't know how I can see why it is not called in your
environment? You are asking too much of me. For remote assistance see
<a href="http://it3.be/rear-support/">http://it3.be/rear-support/</a></p>
<h4 id="gdha_commented_at_2016-02-15_1931"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-184355958">2016-02-15 19:31</a>:<a class="headerlink" href="#gdha_commented_at_2016-02-15_1931" title="Permanent link">&para;</a></h4>
<p>@blaxxton I've tested the <code>65-sysctl.sh</code> script and it worked fine. Ipv6
was disabled.</p>
<h4 id="gdha_commented_at_2016-02-22_1547"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-187238419">2016-02-22 15:47</a>:<a class="headerlink" href="#gdha_commented_at_2016-02-22_1547" title="Permanent link">&para;</a></h4>
<p>If no-one objects I'll mark it as fixed</p>
<h4 id="blaxxton_commented_at_2016-03-04_2134"><img src="https://avatars.githubusercontent.com/u/16419066?v=4" width="50"><a href="https://github.com/blaxxton">blaxxton</a> commented at <a href="https://github.com/rear/rear/issues/748#issuecomment-192477838">2016-03-04 21:34</a>:<a class="headerlink" href="#blaxxton_commented_at_2016-03-04_2134" title="Permanent link">&para;</a></h4>
<p>Hi<br />
I wanted to thank you for all your help.<br />
Thanks</p>
<pre><code>  From: gdha &lt;notifications@github.com&gt;
</code></pre>
<p>To: rear/rear <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#114;&#101;&#97;&#114;&#64;&#110;&#111;&#114;&#101;&#112;&#108;&#121;&#46;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
Cc: blaxxton <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;">&#98;&#108;&#97;&#120;&#120;&#116;&#111;&#110;&#64;&#121;&#97;&#104;&#111;&#111;&#46;&#99;&#111;&#109;</a><br />
Sent: Friday, March 4, 2016 7:03 AM<br />
Subject: Re: [rear] ipv6 has been disabled in server, but ISO boots
server with ipv6 assigned to eth0 and lo (#748)</p>
<p>Closed #748.—<br />
Reply to this email directly or view it on GitHub.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2015-12-23.748.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
