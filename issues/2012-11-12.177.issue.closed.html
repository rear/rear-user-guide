<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#177 Issue closed: uncomplete restore with TSM - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#177 Issue closed: uncomplete restore with TSM";
        var mkdocs_page_input_path = "issues/2012-11-12.177.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#177 Issue closed: uncomplete restore with TSM</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="177_issue_closed_uncomplete_restore_with_tsm"><a href="https://github.com/rear/rear/issues/177">#177 Issue</a> <code>closed</code>: uncomplete restore with TSM<a class="headerlink" href="#177_issue_closed_uncomplete_restore_with_tsm" title="Permanent link">&para;</a></h1>
<h4 id="ghwk_opened_issue_at_2012-11-12_1450"><img src="https://avatars.githubusercontent.com/u/2778369?v=4" width="50"><a href="https://github.com/ghwk">ghwk</a> opened issue at <a href="https://github.com/rear/rear/issues/177">2012-11-12 14:50</a>:<a class="headerlink" href="#ghwk_opened_issue_at_2012-11-12_1450" title="Permanent link">&para;</a></h4>
<p>I've tried to restore my server with rear 1.14 (BACKUP=TSM).,
Filesystems / /var and /boot.<br />
First time / and /var was completely restored, but not /boot. Second
time /var and /boot was completely restored, but not / (only some
directories) See log.</p>
<p>I assume there is a problem in in <code>40_restore_with_tsm.sh</code></p>
<pre><code>2012-11-09 13:23:25.749738301 Disk layout created.
2012-11-09 13:23:25.752299915 Including layout/recreate/default/25_verify_mount.sh
2012-11-09 13:23:25.756342785 Finished running 'layout/recreate' stage in 24 seconds
2012-11-09 13:23:25.758319398 Running 'restore' stage
2012-11-09 13:23:25.763718633 Including restore/TSM/default/40_restore_with_tsm.sh
2012-11-09 13:23:25.766037999 Restoring /
2012-11-09 13:23:25.768074969 Running 'dsmc restore /* /mnt/local// -verbose -subdir=yes -replace=all -tapeprompt=no '
/usr/share/rear/restore/TSM/default/40_restore_with_tsm.sh: line 16:  2424 Exit 12                 dsmc restore "${filespace}*" "/mnt/local/$filespace" -verbose -subdir=yes -replace=all -tapeprompt=no "${TSM_DSMC_RESTORE_OPTIONS[@]}"
      2425 Quit                    | while read Line; do
    if test "${Line:0:8}" == "ANS1898I"; then
        TsmProcessed="$(echo "${Line:9}" | tr -s '*') "; Line="Restoring";
    fi; if test "${Line:0:9}" == "Restoring"; then
        echo -n "$TsmProcessed"; star;
    else
        echo "$Line";
    fi;
done
2012-11-09 13:23:30.036246425 Restoring /boot/
2012-11-09 13:23:30.038327466 Running 'dsmc restore /boot/* /mnt/local//boot/ -verbose -subdir=yes -replace=all -tapeprompt=no '
2012-11-09 13:26:28.338489656 Restoring /var/
2012-11-09 13:26:28.340556280 Running 'dsmc restore /var/* /mnt/local//var/ -verbose -subdir=yes -replace=all -tapeprompt=no '
2012-11-09 13:44:27.820728893 Including restore/default/90_create_missing_directories.sh
2012-11-09 13:44:30.992764385 Including restore/SUSE_LINUX/91_create_missing_directories.sh
2012-11-09 13:44:30.996147058 Finished running 'restore' stage in 1265 seconds
</code></pre>
<h4 id="gdha_commented_at_2012-11-15_1335"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/177#issuecomment-10408571">2012-11-15 13:35</a>:<a class="headerlink" href="#gdha_commented_at_2012-11-15_1335" title="Permanent link">&para;</a></h4>
<p>What does <code>exit 12</code> mean in TSM?</p>
<h4 id="ghwk_commented_at_2012-11-16_0924"><img src="https://avatars.githubusercontent.com/u/2778369?v=4" width="50"><a href="https://github.com/ghwk">ghwk</a> commented at <a href="https://github.com/rear/rear/issues/177#issuecomment-10441085">2012-11-16 09:24</a>:<a class="headerlink" href="#ghwk_commented_at_2012-11-16_0924" title="Permanent link">&para;</a></h4>
<p>Good question !</p>
<p>Return codes from the command line interface:<br />
In general, the return code is related to the highest severity message
during the client operation.</p>
<pre><code>If the highest severity message is informational (ANSnnnnI), then the return code will be 0.
If the highest severity message is a warning (ANSnnnnW), then the return code will be 8.
If the highest severity message is an error (ANSnnnnE), then the return code will be 12.
</code></pre>
<p>Code 12:<br />
The operation completed with at least one error message (except for
error messages for skipped files). For scheduled events, the status will
be Failed. Review the dsmerror.log file (and dsmsched.log file for
scheduled events) to determine what error messages were issued and to
assess their impact on the operation. As a general rule, this return
code means that the error was severe enough to prevent the successful
completion of the operation. For example, an error that prevents an
entire file system from being processed yields return code 12. When a
file is not found the operation yields return code 12.</p>
<p>I should have seen in the dsmerror.log.</p>
<p>Perhaps rear should not eat the dsmc error messages ?</p>
<h4 id="dagwieers_commented_at_2012-11-16_1037"><img src="https://avatars.githubusercontent.com/u/388198?u=0732dee3fe5002278cfbf40359ec431bdcf5f06c&v=4" width="50"><a href="https://github.com/dagwieers">dagwieers</a> commented at <a href="https://github.com/rear/rear/issues/177#issuecomment-10443041">2012-11-16 10:37</a>:<a class="headerlink" href="#dagwieers_commented_at_2012-11-16_1037" title="Permanent link">&para;</a></h4>
<p>I agree, for restoring we should give as much information as possible to
the user. If default output is sufficient, it could go to the terminal,
otherwise it should be logged. (Maybe in this case default progress
output could go to the log, and normal output to terminal).</p>
<p>Patches to make this better will be accepted.</p>
<h4 id="ghwk_commented_at_2012-11-16_1108"><img src="https://avatars.githubusercontent.com/u/2778369?v=4" width="50"><a href="https://github.com/ghwk">ghwk</a> commented at <a href="https://github.com/rear/rear/issues/177#issuecomment-10443804">2012-11-16 11:08</a>:<a class="headerlink" href="#ghwk_commented_at_2012-11-16_1108" title="Permanent link">&para;</a></h4>
<p>Hello Dag,</p>
<p>I have looked at the code and found that I must have missed the
message.<br />
Probably because it was the first filespace and the following went<br />
through without error.<br />
What do you think of the proposal that rear breaks when dsmc failed.
In<br />
addition I have written a patch. The patch is not tested, because<br />
actually I dont have access to a TSM environment.</p>
<p>Am 16.11.2012 11:37, schrieb Dag Wieers:</p>
<blockquote>
<p>I agree, for restoring we should give as much information as
possible<br />
to the user. If default output is sufficient, it could go to the<br />
terminal, otherwise it should be logged. (Maybe in this case default<br />
progress output could go to the log, and normal output to terminal).</p>
<p>Patches to make this better will be accepted.</p>
<p>—<br />
Reply to this email directly or view it on GitHub<br />
<a href="https://github.com/rear/rear/issues/177#issuecomment-10443041">https://github.com/rear/rear/issues/177#issuecomment-10443041</a>.</p>
</blockquote>
<p>ciao</p>
<p>Gerhard Weick ORDIX AG<br />
Senior Consultant Kreuzberger Ring<br />
65205 Wiesbaden<br />
E-Mail <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#103;&#101;&#119;&#64;&#111;&#114;&#100;&#105;&#120;&#46;&#100;&#101;">&#103;&#101;&#119;&#64;&#111;&#114;&#100;&#105;&#120;&#46;&#100;&#101;</a><br />
Internet: <a href="http://www.ordix.de">http://www.ordix.de</a><br />
--- restore/TSM/default/40_restore_with_tsm.sh.orig 2012-11-16
09:51:58.000000000 +0100<br />
+++ restore/TSM/default/40_restore_with_tsm.sh 2012-11-16
10:42:33.000000000 +0100<br />
@@ -35,5 +35,15 @@<br />
echo "$Line"<br />
fi<br />
done</p>
<ul>
<li>
<p>DSMCSTATUS=$PIPESTATUS</p>
</li>
<li>
<p>[ $DSMCSTATUS -eq 12 ] &amp;&amp; </p>
</li>
<li>
<p>Error "'dsmc restore ${filespace}* /mnt/local/$filespace -verbose -subdir=yes -replace=all -tapeprompt=no ${TSM_DSMC_RESTORE_OPTIONS[@]}' failed."</p>
</li>
<li>
<p>[ $DSMCSTATUS -eq 8 ] &amp;&amp; {</p>
</li>
<li>
<p>LogPrint "restoring ${filespace} completed with at least one warning message. Review dsmerror.log"</p>
</li>
<li>
<p>}</p>
</li>
<li>
<p>[ $DSMCSTATUS -eq 4 ] &amp;&amp; {</p>
</li>
<li>
<p>LogPrint "restoring ${filespace} completed successfully, but some files were not processed. There were no other errors or warnings."</p>
</li>
<li>
<p>}</p>
</li>
<li>
<p>done</p>
</li>
</ul>
<h4 id="gdha_commented_at_2012-11-16_1514"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/177#issuecomment-10449984">2012-11-16 15:14</a>:<a class="headerlink" href="#gdha_commented_at_2012-11-16_1514" title="Permanent link">&para;</a></h4>
<p>I would prefer that you first test your enhancement of the code before
we add it (to avoid broken code). And, it would be even better to make
it available as a pull request.<br />
Thanks for the troubleshooting.</p>
<h4 id="gdha_commented_at_2013-12-03_1218"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/177#issuecomment-29704916">2013-12-03 12:18</a>:<a class="headerlink" href="#gdha_commented_at_2013-12-03_1218" title="Permanent link">&para;</a></h4>
<p>no feedback received - we mark this issue as dead. Re-open it if
required.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2012-11-12.177.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
