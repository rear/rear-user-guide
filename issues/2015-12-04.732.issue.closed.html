<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>2015 12 04.732.issue.closed - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "2015 12 04.732.issue.closed";
        var mkdocs_page_input_path = "issues/2015-12-04.732.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/rust.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', '366986045', 'auto');
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li>2015 12 04.732.issue.closed</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="732_issue_closed_suse_hack_week_13_use_rear_as_generic_installer_in_the_plain_suse_installation_system"><a href="https://github.com/rear/rear/issues/732">#732 Issue</a> <code>closed</code>: SUSE Hack Week 13: Use rear as generic installer in the plain SUSE installation system<a class="headerlink" href="#732_issue_closed_suse_hack_week_13_use_rear_as_generic_installer_in_the_plain_suse_installation_system" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>won't fix / can't fix / obsolete</code></p>
<h4 id="jsmeix_opened_issue_at_2015-12-04_1516"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> opened issue at <a href="https://github.com/rear/rear/issues/732">2015-12-04 15:16</a>:<a class="headerlink" href="#jsmeix_opened_issue_at_2015-12-04_1516" title="Permanent link">&para;</a></h4>
<p>During SUSE Hack Week 13 I will imlement to use rear<br />
as generic installer in the plain SUSE installation system.</p>
<p>See<br />
<a href="https://hackweek.suse.com/13/projects/1190">https://hackweek.suse.com/13/projects/1190</a></p>
<p>I think I can add functionality to rear so that it can be used as
generic installer without any incompatible changes.</p>
<p>My current plan:</p>
<p>I add a separated new workflow "install" where install-workflow.sh<br />
is derived from recover-workflow.sh as follows:</p>
<p>The stages of the install workflow are the same as the stages of the
recover workflow</p>
<ul>
<li>SourceStage "restore" is replaced with a new SourceStage "install"
    that installs software packages (RPMs)</li>
<li>after SourceStage "install" there is the additional new SourceStage
    "configure" that does the very basic configuration that is needed so
    that the system can boot (i.e. bootloader configuration and
    bootloader installation) and that 'root' can log in (i.e. set 'root'
    password and very basic networking setup like starting dhcpd and
    sshd).</li>
<li>there is no longer the SourceStage "finalize" that installed the
    boot loader because that already happened in SourceStage "configure"</li>
</ul>
<p>Basically usr/share/rear/lib/install-workflow.sh is something like</p>
<pre>
function WORKFLOW_install () {
    SourceStage "setup"
    SourceStage "verify"
    # Set up persistent storage (disk partitioning with filesystems and mount points):
    SourceStage "layout/prepare"
    SourceStage "layout/recreate"
    # Dump the payload into the persistent storage (install files).
    # Usually "dump the payload" means to install software packages:
    SourceStage "install"
    # Basic system configuration so that it can boot
    # (i.e. boot loader configuration and creating etc/fstab)
    # and that 'root' can log in (i.e. initial temporary root password,
    # keyboard layout, basic networking like dhcpd plus sshd running):
    SourceStage "configure"
    # Prepare for reboot:
    SourceStage "wrapup"
}
</pre>

<p>With the rear framework (in particular with appropriate
usr/share/rear/install/default/50_install_software_packages.sh and
usr/share/rear/configure/default/50_basic_configuration.sh scripts
that implement the stages "install" and "configure") and an appropriate
/etc/rear/disklayout.conf in the installation system, running "rear
install" in the installation system should install the system from
scratch.</p>
<p>I think I do not need to change any existing script in an incompatible
way - I even hope I do not need to change any existing script at all -
so that I can add the "install" functionality without any possible
regression elsewhere.</p>
<h4 id="jsmeix_commented_at_2015-12-04_1525"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-161994255">2015-12-04 15:25</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-12-04_1525" title="Permanent link">&para;</a></h4>
<p>For my very first tentative experiments see<br />
<a href="https://github.com/jsmeix/rear/tree/add_install_workflow">https://github.com/jsmeix/rear/tree/add_install_workflow</a></p>
<p>(Currently the 50_install_software_packages.sh and
50_basic_configuration.sh scripts are ugly SUSE-specific hacks.)</p>
<h4 id="jsmeix_commented_at_2015-12-04_1531"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-161996257">2015-12-04 15:31</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-12-04_1531" title="Permanent link">&para;</a></h4>
<p>For the fun:<br />
With some (but not too much) additional manual stuff in the installation
system I have right now installed my first SLES12 system via "rear
install" from within the plain SUSE installation system :-)</p>
<p>Have a nice weekend!</p>
<h4 id="gdha_commented_at_2015-12-04_1601"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-162005224">2015-12-04 16:01</a>:<a class="headerlink" href="#gdha_commented_at_2015-12-04_1601" title="Permanent link">&para;</a></h4>
<p>@jsmeix do you have some specific goal in mind like cloud installations
and bare metal restore from cloud images? Or, do you see it broader?</p>
<h4 id="jsmeix_commented_at_2015-12-09_1137"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-163196707">2015-12-09 11:37</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-12-09_1137" title="Permanent link">&para;</a></h4>
<p>@gdha</p>
<p>(late reply because I was not in the office until now)</p>
<p>I do not have a specific goal in mind.<br />
I see it as a natural/native/intrinsic/inherent/genuine functionality.</p>
<p>Why I see "install" as natural functionality:</p>
<p>See
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<pre>
Disaster recovery is installation
(reinstalling from scratch)
The core of disaster recovery is an installer
that reinstalls the system from scratch. 
</pre>

<p>I.e. the core functionality of rear is already "installation".</p>
<p>The only real diffeerence between "recovery installation"<br />
and "initial installation" is how the files get onto the system.</p>
<ul>
<li>For "recovery installation" the files get copied<br />
    from a backup onto the system.</li>
<li>For "initial installation" the files get copied<br />
    from software packages onto the system.</li>
</ul>
<p>See
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<pre>
The fundamental steps of system installation are:
1. prepare persistent storage (disk partitioning with filesystems and mount points)
2. dump the payload into the persistent storage (install files)
3. install a boot loader
4. reboot
In case of an initial system installation "dump the payload"
means usually to install RPM software packages.
In case of disaster recovery "dump the payload" means
to restore the files from a backup.
The only real difference between an usual system installation
and disaster recovery is how the payload is dumped. 
</pre>

<p>When rear works as generic installer in the plain SUSE installation
system, my next goal is to use rear as generic installer in any
reasonably powerful installation system - in particular to use rear as
generic installer in the installation systems of other major Linux
distributions.</p>
<p>With "reasonably powerful installation system" I mean anything<br />
that provides the usual tools to set up
partitioning/filesystems/mountpoints and to get files copied into the
system i.e. package install tools and backup restore tools. When the
user uses a special backup tool he cannot use a generic installation
system. When the user uses a special backup tool he must use a
specifically made installation system like the current rear recovery
system or the user must specifically enhance a generic installation
system (e.g. the SUSE installation system can be enhanced with any
additional software via "dud", see
<a href="https://en.opensuse.org/SDB:Linuxrc">https://en.opensuse.org/SDB:Linuxrc</a>).</p>
<p>Another future goal is to create a generic "static/fixed" rear
installation system and run the generic rear installer therein.</p>
<p>Currently the rear recovery system is specific for the system that
should be recovered.</p>
<p>This means for thousands of servers in business/enterprise environments
the user/admin has to deal with thousands of rear recovery systems where
each one is specific for one particular server.</p>
<p>With a generic "static/fixed" rear installation system the user has only
one rear installation system for all his servers and runs one
"static/fixed" generic rear installer therein.</p>
<p>The user has only system-specific config files that define how to
install and recover a system. With "config files" I mean in this context
only what is needed to specify how to install or reinstall a system
(i.e. disklayout.conf et alii). I do not mean the zillions of config
files /etc/* in an installed system.</p>
<p>To recover a system the user has mainly<br />
the disklayout.conf (how to do partitioning,filesystems,mountpoints)<br />
plus /etc/rear/local.conf (how to restore the backup).</p>
<p>For special cases the user may need additional config files like<br />
kernel_modules.conf and network_setup.conf to get his<br />
particular installation/recovery system set up as he needs<br />
(e.g. by default network set up may happen via DHCP).</p>
<p>To install a system the user needs some more config files:<br />
First and foremost disklayout.conf and /etc/rear/local.conf<br />
but additionally also some kind of<br />
files_install.conf (how to get files onto the system) and<br />
bootloader.conf (how to set up the bootloader) and<br />
basic_setup.conf (e.g. root password, networking, ...).</p>
<p>In the very end my final goal is to get separated parts separated<br />
so that each part can be used on its own:</p>
<ul>
<li>A generic installation/recovery system.</li>
<li>A generic installer that uses config files<br />
    (this is what this issue is about).</li>
<li>A generic system analyzer that writes config files<br />
    (i.e. partially what "rear mkrescue" does<br />
    and partially what "rear savelayout" does).</li>
<li>A tool to create a specific installation/recovery system<br />
    maily needed to add special backup/restore tools<br />
    (i.e. partially what "rear mkrescue" does).</li>
<li>A user dialog tool (text-based) to create config files<br />
    (optional new tool - config files should be human editable).</li>
</ul>
<p>To install a system from scratch the user<br />
boots the generic installation/recovery system and<br />
runs the generic user dialog that creates the initial config files<br />
or provides manually created config files.<br />
Then (within the generic installation/recovery system) the user<br />
runs the generic installer that installs the system.<br />
Finally the user reboots.</p>
<p>To prepare recovery the user runs in the running system<br />
the generic system analyzer that writes config files.<br />
Additionally the user creates a backup of his files<br />
(i.e. what "rear mkbackuponly" does).<br />
The user does this any time when he needs updated<br />
config files or an updated backup.<br />
When the user uses special backup software he must also<br />
run the tool that creates a specific installation/recovery system<br />
that has his special backup/restore software included<br />
(i.e. what "rear mkrescue" does).</p>
<p>To recover the system on new hardware the user<br />
boots the generic installation/recovery system<br />
or his specific installation/recovery system and<br />
runs the generic installer with his latest config files<br />
that recreates his system on the new hardware.<br />
Finally the user reboots.</p>
<h4 id="jsmeix_commented_at_2015-12-09_1613"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-163309845">2015-12-09 16:13</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-12-09_1613" title="Permanent link">&para;</a></h4>
<p>FYI:<br />
I have a first usable implementation of the "install" workflow.<br />
It is still a SUSE-specific proof-of-concept hack.<br />
It is not at all generic.<br />
But it works (for me)!<br />
See<br />
<a href="https://github.com/jsmeix/rear/tree/add_install_workflow">https://github.com/jsmeix/rear/tree/add_install_workflow</a></p>
<h4 id="gdha_commented_at_2015-12-09_1625"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-163313518">2015-12-09 16:25</a>:<a class="headerlink" href="#gdha_commented_at_2015-12-09_1625" title="Permanent link">&para;</a></h4>
<p>I think your install script is not located in the right directory
default<br />
-&gt; SUSE_LINUX/i386/ as it uses zypper (and it seems rather
hard-coded).<br />
But, I understand it is a proof-of-concept so I forgive you ;-)<br />
Gratien</p>
<p>On Wed, Dec 9, 2015 at 5:13 PM, Johannes Meixner
<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;">&#110;&#111;&#116;&#105;&#102;&#105;&#99;&#97;&#116;&#105;&#111;&#110;&#115;&#64;&#103;&#105;&#116;&#104;&#117;&#98;&#46;&#99;&#111;&#109;</a><br />
wrote:</p>
<blockquote>
<p>FYI:<br />
I have a first usable implementation of the "install" workflow.<br />
It is still a SUSE-specific proof-of-concept hack.<br />
It is not at all generic.<br />
But it works (for me)!<br />
See<br />
<a href="https://github.com/jsmeix/rear/tree/add_install_workflow">https://github.com/jsmeix/rear/tree/add_install_workflow</a></p>
<p>â€”<br />
Reply to this email directly or view it on GitHub<br />
<a href="https://github.com/rear/rear/issues/732#issuecomment-163309845">https://github.com/rear/rear/issues/732#issuecomment-163309845</a>.</p>
</blockquote>
<h4 id="jsmeix_commented_at_2015-12-10_0759"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-163527877">2015-12-10 07:59</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-12-10_0759" title="Permanent link">&para;</a></h4>
<p>I know that both my scripts are currently plain wrong in "default"<br />
and in particular the basic_configuration script needs to be split<br />
into its separated parts and much more things like that.</p>
<p>As long as I did not make a pull request I consider all my stuff as<br />
totally tentative and experimental.</p>
<p>My next steps will be to implement the current SUSE-specific install<br />
workflow properly so that I think it could be accepted by upstream<br />
as a SUSE-specific first step enhancement towards a generic<br />
install workflow and then I will make a pull request.</p>
<p>Note that my current install workflow does not change any existing<br />
file in rear which means it cannot cause regressions.</p>
<h4 id="jsmeix_commented_at_2015-12-10_1641"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-163682432">2015-12-10 16:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-12-10_1641" title="Permanent link">&para;</a></h4>
<p>Now
<a href="https://github.com/jsmeix/rear/tree/add_install_workflow">https://github.com/jsmeix/rear/tree/add_install_workflow</a><br />
works reasonably well for me and<br />
I have splitted SUSE-specific stuff into<br />
install/payload/SUSE_LINUX/</p>
<p>But it is still not ready for a pull request because there is<br />
too much hardcoded stuff in the SUSE-specific scripts.</p>
<p>Note that meanwhile I had to change an existing script:<br />
wrapup/default/99_copy_logfile.sh<br />
because before it only worked for the "recover" workflow<br />
but now I also use it for the "install" workflow (but my change<br />
is fully backward compatible).</p>
<p>Furthermore I enhanced the Source function a bit.<br />
Not it tries using $SHARE_DIR/$source_file as fallback<br />
if $source_file does not exist so that no longer the full path<br />
is required to include a file in $SHARE_DIR. I think I will<br />
make a totally separated pull request for this enhancement.</p>
<p>Tomorrow I would like to document my current state.<br />
In particular I would like to describe how to setup using<br />
rear as installer in the SUSE installation system because<br />
that requires a few "magic tricks" (nothing complicated<br />
but one must know how to do it so that it works o.k.l).</p>
<h4 id="jsmeix_commented_at_2015-12-11_1605"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-163975585">2015-12-11 16:05</a>:<a class="headerlink" href="#jsmeix_commented_at_2015-12-11_1605" title="Permanent link">&para;</a></h4>
<p>I postpone to document it until it is basically usable<br />
by someone else (except me).</p>
<p>Today I cleaned it up so that no longer hardcoded stuff is used<br />
except install/configure/SUSE_LINUX/20_fstab.sh that I need<br />
to make as generic fstab creator that creates fstab based on<br />
what is mounted under /mnt/local.</p>
<p>All other hardcoded hacks are removed now and the data<br />
needs now to be provided in variables in /etc/rear/local.conf<br />
as described in
<a href="https://github.com/rear/rear/commit/b8f5e5eaa67604dd6ccdbcabe8e685617377a013">https://github.com/rear/rear/commit/b8f5e5eaa67604dd6ccdbcabe8e685617377a013</a></p>
<p>I have now created a new branch<br />
<a href="https://github.com/jsmeix/rear/tree/first_working_install_workflow">https://github.com/jsmeix/rear/tree/first_working_install_workflow</a><br />
to get rid of the various confusing trial-and-error commits in<br />
my old
<a href="https://github.com/jsmeix/rear/tree/add_install_workflow">https://github.com/jsmeix/rear/tree/add_install_workflow</a><br />
but I keep that old branch for now as a reference.</p>
<p>I.e. the current up-to-date branch for the install workflow is<br />
<a href="https://github.com/jsmeix/rear/tree/first_working_install_workflow">https://github.com/jsmeix/rear/tree/first_working_install_workflow</a></p>
<p>But ist is still not ready for a pull request - mainly<br />
because a generic fstab creator is mandatory<br />
before someone (except me) should try it out.</p>
<p>Unfortunately next week I have to do other work<br />
and then there is Christmas vacation so that<br />
probably I can continue not until next year.</p>
<p>@gdha<br />
I would appreciate it if you could have a look<br />
what you think about my current code in general in<br />
<a href="https://github.com/jsmeix/rear/tree/first_working_install_workflow">https://github.com/jsmeix/rear/tree/first_working_install_workflow</a></p>
<p>I mean if the general way how I implemented it is o.k.<br />
or if there is perhaps something "broken by design".</p>
<h4 id="jsmeix_commented_at_2016-02-05_1025"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-180286151">2016-02-05 10:25</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-02-05_1025" title="Permanent link">&para;</a></h4>
<p>To document the current state (i.e. what I presented on FOSDEM)<br />
I added the new section</p>
<pre>
Using rear as generic installer in any installation system
</pre>

<p>to
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<h4 id="didacog_commented_at_2016-02-05_1058"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-180295928">2016-02-05 10:58</a>:<a class="headerlink" href="#didacog_commented_at_2016-02-05_1058" title="Permanent link">&para;</a></h4>
<p>Hi! this is what we talked at FOSDEM true? We will take a look!</p>
<h4 id="jsmeix_commented_at_2016-02-05_1113"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-180302607">2016-02-05 11:13</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-02-05_1113" title="Permanent link">&para;</a></h4>
<p>@didacog<br />
I assume you need help to get it working in its current experimental
proof-of-concept and work-in-progress state.</p>
<p>Just ask me if you need help.</p>
<p>To get prepared I suggest that you experiment with "generic system
installation with the plain SUSE installation system" and "generic
working with the plain SUSE installation system".</p>
<p>You must know how to enhance the SUSE installation system to add zypper
and rear and rear config files into the SUSE installation system to be
able to run "rear install" from inside the SUSE installation system.<br />
How to do that for "rear install" is not yet descibed at
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a>
but without a description it is probably hard.</p>
<p>What I use for my experiments are KVM/Qemu virtual machines with a
single 20 GB virtual harddisk that appears as /dev/sda and BIOS (do not
use UEFI). To make the harddisk appear as /dev/sda you must use full
hardware virtualization (except the CPU) which I always do to get
virtual machines that "look same" as real hardware (if you use some kind
of paravirtualization the harddisk appears as /dev/vd0 or similar). I
use "virt-manager" to set up virtual machines and to get full hardware
virtualization I select in virt-manager for the operating system type to
be "generic".</p>
<h4 id="jsmeix_commented_at_2016-02-05_1226"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-180329685">2016-02-05 12:26</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-02-05_1226" title="Permanent link">&para;</a></h4>
<p>Right now I added "A sketchy description how to use rear as generic
installer in the plain SUSE installation system for people who are
experienced in generic system installation with the plain SUSE
installation system" at
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<h4 id="didacog_commented_at_2016-02-05_1235"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-180335038">2016-02-05 12:35</a>:<a class="headerlink" href="#didacog_commented_at_2016-02-05_1235" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<p>Yes, first we'll do some testing with your current approach in order to
determine how to provide required services, configs,... from DRLM.</p>
<p>I will ask you for help if any doubts!</p>
<p>I have few to-do's for current DRLM roadmap, but when finished or in my
free time i will take a look for sure.</p>
<p>Thx!</p>
<h4 id="didacog_commented_at_2016-07-05_0925"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-230429845">2016-07-05 09:25</a>:<a class="headerlink" href="#didacog_commented_at_2016-07-05_0925" title="Permanent link">&para;</a></h4>
<p>@jsmeix as I've finished my heavy work on DRLM 2.0. I will start working
with your rear installer proposal.</p>
<p>If you can refresh me some concepts, I will start thinking about how to
implement it on DRLM.</p>
<h4 id="jsmeix_commented_at_2016-07-07_1325"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-231076465">2016-07-07 13:25</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-07_1325" title="Permanent link">&para;</a></h4>
<p>@didacog<br />
I documented my experimental proof-of-concept<br />
and work-in-progress state in the section<br />
"Using rear as generic installer in any installation system"<br />
in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<p>I did not work on it since that time.</p>
<p>Tomorrow I am not in the office so that further<br />
questions need to wait until next week...</p>
<h4 id="didacog_commented_at_2016-07-07_1328"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-231077079">2016-07-07 13:28</a>:<a class="headerlink" href="#didacog_commented_at_2016-07-07_1328" title="Permanent link">&para;</a></h4>
<p>@jsmeix cool! I can wait until next week without problem ;)</p>
<h4 id="jsmeix_commented_at_2016-07-07_1333"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-231078584">2016-07-07 13:33</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-07_1333" title="Permanent link">&para;</a></h4>
<p>@didacog<br />
uncool ;-)<br />
I had expected that you play around with it until next week<br />
so that you can ask me some cool questions :-)</p>
<p>FYI:</p>
<p>A related enhancement issue is
<a href="https://github.com/rear/rear/issues/841">https://github.com/rear/rear/issues/841</a></p>
<p>With rear recovery system update support it should be much<br />
easier (hopefully) to download the rear config files into<br />
the rear recovery/installation system during "rear install".</p>
<h4 id="didacog_commented_at_2016-07-08_1101"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-231333251">2016-07-08 11:01</a>:<a class="headerlink" href="#didacog_commented_at_2016-07-08_1101" title="Permanent link">&para;</a></h4>
<p>@jsmeix I told you next week because this weekend is my weeding... I
will not be able to take a look until next week. ;-)</p>
<h4 id="gdha_commented_at_2016-07-08_1123"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-231336595">2016-07-08 11:23</a>:<a class="headerlink" href="#gdha_commented_at_2016-07-08_1123" title="Permanent link">&para;</a></h4>
<p>@didacog Congrats!</p>
<h4 id="jsmeix_commented_at_2016-07-11_0734"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-231661708">2016-07-11 07:34</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-11_0734" title="Permanent link">&para;</a></h4>
<p>@didacog<br />
if "weeding" is a typo and you meant "wedding":<br />
Congratulations on your wedding!</p>
<h4 id="didacog_commented_at_2016-07-11_0738"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-231662472">2016-07-11 07:38</a>:<a class="headerlink" href="#didacog_commented_at_2016-07-11_0738" title="Permanent link">&para;</a></h4>
<p>@gdha @jsmeix thanks!! ;)</p>
<h4 id="didacog_commented_at_2016-07-20_0911"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-233895218">2016-07-20 09:11</a>:<a class="headerlink" href="#didacog_commented_at_2016-07-20_0911" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<p>I've been reading your approach for rear install, and the hardest part
for implement it on DRLM should be the provided "rescue/install" images.</p>
<p>On one hand the stuff like disklayout and config files should be quite
easy to implement with DRLM to get them through our RESTful API.</p>
<p>On the other hand will be some work on, at least, providing rear install
procedures for the major linux distros, now is just for SuSE (i know is
just an initial approach).</p>
<p>Did you think about how to provide the install-rescue images with rear
included? In your documentation is required to make a rescue from a
fresh install image, but this may not work on some "special"
installations like BOOT from SAN,... that need some modules included in
the initrd image.<br />
IMHO I think that should be as easy as installing with actual procedures
with no requirements on previous steps to provide the installation
images. I need to work on your approach a little bit more but seems
promising! ;)</p>
<h4 id="jsmeix_commented_at_2016-07-20_1457"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-233975310">2016-07-20 14:57</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-20_1457" title="Permanent link">&para;</a></h4>
<p>@didacog<br />
I do not fully understand what exactly you mean with installation image.</p>
<p>Do you mean an installation image based on the rear recovery system<br />
or do you mean an installation image based on a Linux distributors<br />
installation system?</p>
<p>In case of an installation image based on the rear recovery system<br />
most of what is needed is already there in rear.</p>
<p>Basically all what is missing is to add an RPM package installation
tool<br />
to the rear recovery system.<br />
I did this for SUSE by adding the "zypper" RPM package installation<br />
and dependency solver tool to the rear recovery system, see in<br />
particular the step 4. in the section "Using rear as generic installer<br />
in the plain SUSE installation system" at<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a><br />
the REQUIRED_PROGS and COPY_AS_IS values.</p>
<p>For Red Hat and one Debian and Ubuntu would have to add their<br />
preferred RPM or deb package installation and dependency solver<br />
tool to the rear recovery system in the same way.</p>
<p>If additional kernel modules are needed one would have to<br />
specify them via "MODULES_LOAD".</p>
<h4 id="didacog_commented_at_2016-07-21_0741"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-234180368">2016-07-21 07:41</a>:<a class="headerlink" href="#didacog_commented_at_2016-07-21_0741" title="Permanent link">&para;</a></h4>
<p>@jsmeix</p>
<p>I was talking about installation image, yes I've seen that on your
approach is required to create a base image from rear recovery system
and I just try to figure out if could be possible to skip this initial
installation and rear recovery image creation. Maybe not, I just was
thinking aloud :-P</p>
<p>Let me investigate a little bit more, so far I've just been reading your
docs and thought on them, I want to talk with my mates at DRLM and come
back with real objectives.</p>
<h4 id="jsmeix_commented_at_2016-07-21_0819"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-234187731">2016-07-21 08:19</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-21_0819" title="Permanent link">&para;</a></h4>
<p>I think to get a rear installation image for "Foo Linux 1.2.3"<br />
you must have a running "Foo Linux 1.2.3" system<br />
wherefrom something like "rear mkrescue"<br />
(or perhaps a future "rear mkinstsys") can copy<br />
what it needs to make an installation image that contains<br />
the right tools in the right versions (plus right patches)<br />
to install a "Foo Linux 1.2.3" system in the right way.</p>
<p>With
<a href="https://github.com/rear/rear/issues/841(rear)
recovery system update support">https://github.com/rear/rear/issues/841(rear</a><br />
it should in the end be possible to have one single static<br />
full-featured rear installation image for "Foo Linux 1.2.3"<br />
to be able to install any "Foo Linux 1.2.3" system.</p>
<p>This way admins who maintain hundreds of<br />
"Foo Linux 1.2.3" systems have one single static<br />
rear installation image for "Foo Linux 1.2.3" plus<br />
hundreds of rear configurations (one for each system).</p>
<p>Note that because Linux distributors seem to love<br />
to modify basic installation tools (like parted and so on)<br />
as they need it for their particular version of their distribution,<br />
one cannot have one single static full-featured rear installation<br />
image for several Linux distributions.</p>
<p>E.g. parted behaves different for different SLE versions,<br />
even for different service packs.<br />
In particular SLE12-SP1 parted and SLE12-SP2 parted behave<br />
different. The latter does no longer support the SUSE-specific<br />
'gpt_snc_mbr' hack (hooray that this hack is finally gone!).</p>
<p>But what could be possible is one single generic<br />
rear installation image for several Linux distributions<br />
that can do only traditional generic installations<br />
without any newest/fancy Linux distribution specific stuff.</p>
<p>Perhaps admins who maintain hundreds of systems<br />
of different Linux distributions may be interested in<br />
simplifying that mess when they can reduce the diversity<br />
to simple traditional generic installations that work with<br />
one single generic rear installation image plus<br />
hundreds of rear configurations (one for each system).</p>
<p>Alternatively you can use the original "Foo Linux 1.2.3"<br />
installation medium and add the rear installer to it<br />
to achieve an installation system that contains<br />
the right tools in the right versions (plus right patches)<br />
to install a "Foo Linux 1.2.3" system.<br />
Now one does no longer use the original "Foo Linux 1.2.3"<br />
installer but the generic rear installer.<br />
This is what I did with the SUSE "inst-sys" by using the<br />
SUSE-specific method "dud" to add the rear installer to<br />
the SUSE "inst-sys".<br />
For Red Hat one would use a Red Hat specific method to<br />
add the rear installer to the Red Hat installation system.</p>
<p>All that is not yet poperly implemented.<br />
What I currently implemented are quick and dirty hacks<br />
where the only purpose is to find out if it seems doable.</p>
<h4 id="didacog_commented_at_2016-07-21_0844"><img src="https://avatars.githubusercontent.com/u/5380209?u=163f1571e6b9c9c7df94e2c6ca152b0a7406b52d&v=4" width="50"><a href="https://github.com/didacog">didacog</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-234193135">2016-07-21 08:44</a>:<a class="headerlink" href="#didacog_commented_at_2016-07-21_0844" title="Permanent link">&para;</a></h4>
<p>@jsmeix<br />
I'm agree with you, as I said, I just was thinking aloud. The problem is
the same on each Linux Distro with differents tools and software
versions.</p>
<p>Let me talk with my mates @proura and @krbu. We need to think well how
to provide this stuff, from DRLM, in the easiest possible way.</p>
<p>This week we are on the final testings prior to publish DRLM 2.0 and I
don't want to mix issues.</p>
<p>Hope you can give me little bit more time ;-)</p>
<h4 id="jsmeix_commented_at_2016-07-21_0850"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-234194454">2016-07-21 08:50</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-07-21_0850" title="Permanent link">&para;</a></h4>
<p>Of course no need to hurry!</p>
<p>Also for me it has low priority (basically only for HackWeeks).</p>
<h4 id="jsmeix_commented_at_2016-11-25_0948"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/732#issuecomment-262918756">2016-11-25 09:48</a>:<a class="headerlink" href="#jsmeix_commented_at_2016-11-25_0948" title="Permanent link">&para;</a></h4>
<p>I think I have meanwhile a better plan, see<br />
<a href="https://github.com/rear/rear/issues/1085">https://github.com/rear/rear/issues/1085</a><br />
which emerged as successor of this issue here<br />
and is intended to replace it which is the reason<br />
why I close this issue here (at least for now)<br />
because I think with a BACKUP=ZYPPER method<br />
I can provide the same functionality i.e.<br />
"install a system from scratch" but BACKUP=ZYPPER<br />
integrates much nicer into the existing ReaR framework<br />
i.e. I can get the intended functionality with less effort.</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2022 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2015-12-04.732.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
