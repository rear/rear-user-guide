<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#1808 Issue closed: sshfs mount point not working. - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#1808 Issue closed: sshfs mount point not working.";
        var mkdocs_page_input_path = "issues/2018-05-16.1808.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/netfs_nas.html">Internal Backup with tar to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../scenarios/netfs_rsync.md">Internal Backup with rsync to NFS server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/rbme.html">External Backup using RBME</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/restic.html">External Backup using restic</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../development/squash-git-log-commments.html">How to squash git log comments into one line</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear29.html">Release Notes ReaR 2.9</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#1808 Issue closed: sshfs mount point not working.</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="1808_issue_closed_sshfs_mount_point_not_working"><a href="https://github.com/rear/rear/issues/1808">#1808 Issue</a> <code>closed</code>: sshfs mount point not working.<a class="headerlink" href="#1808_issue_closed_sshfs_mount_point_not_working" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>support / question</code>, <code>fixed / solved / done</code></p>
<h4 id="patlegu_opened_issue_at_2018-05-16_2157"><img src="https://avatars.githubusercontent.com/u/3754859?u=589fd4cb59162e0a3b1e920296625d650b384a99&v=4" width="50"><a href="https://github.com/patlegu">patlegu</a> opened issue at <a href="https://github.com/rear/rear/issues/1808">2018-05-16 21:57</a>:<a class="headerlink" href="#patlegu_opened_issue_at_2018-05-16_2157" title="Permanent link">&para;</a></h4>
<h4 id="relax-and-recover_rear_issue_template">Relax-and-Recover (ReaR) Issue Template<a class="headerlink" href="#relax-and-recover_rear_issue_template" title="Permanent link">&para;</a></h4>
<p>Fill in the following items before submitting a new issue<br />
(quick response is not guaranteed with free support):</p>
<ul>
<li>ReaR version ("/usr/sbin/rear -V"): <strong>2.3</strong></li>
<li>OS version ("cat /etc/rear/os.conf" or "lsb_release -a" or "cat
    /etc/os-release"): <strong>DEBIAN 9.2</strong></li>
<li>ReaR configuration files ("cat /etc/rear/site.conf" or "cat
    /etc/rear/local.conf"):<br />
<code>OUTPUT_URL="sshfs://rear-uxdc01@88.182.85.28/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs port=22222"</code></li>
<li>System architecture (x86 compatible or POWER and/or what kind of
    virtual machine):</li>
<li>Are you using BIOS or UEFI or another way to boot?</li>
<li>Brief description of the issue:<br />
    sshfs mount not working properly. The cmd is working fine when used
    on cmd line but it's falling in error when used configured in
    <strong>/etc/rear/local.conf.</strong></li>
</ul>
<!-- -->

<pre><code>/mount_cmd
...skipping
++ local defaultoptions=rw,noatime
++ local options=port=22222
++ local mount_cmd
++ case $(url_scheme $url) in
+++ url_scheme sshfs://rear-uxdc01@88.182.85.28/home/rear-uxdc01/ISOs
+++ local url=sshfs://rear-uxdc01@88.182.85.28/home/rear-uxdc01/ISOs
+++ local scheme=sshfs
+++ echo sshfs
+++ grep -q :
+++ echo sshfs
+++ url_host sshfs://rear-uxdc01@88.182.85.28/home/rear-uxdc01/ISOs
+++ local url=sshfs://rear-uxdc01@88.182.85.28/home/rear-uxdc01/ISOs
+++ local url_without_scheme=rear-uxdc01@88.182.85.28/home/rear-uxdc01/ISOs
+++ local authority_part=rear-uxdc01@88.182.85.28
+++ echo rear-uxdc01@88.182.85.28
++ local authority=rear-uxdc01@88.182.85.28
++ test rear-uxdc01@88.182.85.28
+++ url_path sshfs://rear-uxdc01@88.182.85.28/home/rear-uxdc01/ISOs
+++ local url=sshfs://rear-uxdc01@88.182.85.28/home/rear-uxdc01/ISOs
+++ local url_without_scheme=rear-uxdc01@88.182.85.28/home/rear-uxdc01/ISOs
+++ echo /home/rear-uxdc01/ISOs
++ local path=/home/rear-uxdc01/ISOs
++ test /home/rear-uxdc01/ISOs
++ lsmod
++ grep -q '^fuse'
++ mount_cmd='sshfs rear-uxdc01@88.182.85.28:/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs -o port=22222'
++ Log 'Mounting with '\''sshfs rear-uxdc01@88.182.85.28:/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs -o port=22222'\'''
+++ date '+%Y-%m-%d %H:%M:%S.%N '
++ local 'timestamp=2018-05-16 23:35:50.195815668 '
++ test 1 -gt 0
++ echo '2018-05-16 23:35:50.195815668 Mounting with '\''sshfs rear-uxdc01@88.182.85.28:/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs -o port=22222'\'''
2018-05-16 23:35:50.195815668 Mounting with 'sshfs rear-uxdc01@88.182.85.28:/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs -o port=22222'
++ eval sshfs rear-uxdc01@88.182.85.28:/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs -o port=22222
+++ sshfs rear-uxdc01@88.182.85.28:/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs -o port=22222
++ StopIfError 'Mount command '\''sshfs rear-uxdc01@88.182.85.28:/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs -o port=22222'\'' failed.'
++ ((  0 != 0  ))
++ AddExitTask 'umount -f -v '\''/home/rear-uxdc01/ISOs'\'' &gt;&amp;2'
++ EXIT_TASKS=("$*" "${EXIT_TASKS[@]}")
++ Debug 'Added '\''umount -f -v '\''/home/rear-uxdc01/ISOs'\'' &gt;&amp;2'\'' as an exit task'
++ test 1
++ Log 'Added '\''umount -f -v '\''/home/rear-uxdc01/ISOs'\'' &gt;&amp;2'\'' as an exit task'
+++ date '+%Y-%m-%d %H:%M:%S.%N '
++ local 'timestamp=2018-05-16 23:35:50.690206299 '
++ test 1 -gt 0
++ echo '2018-05-16 23:35:50.690206299 Added '\''umount -f -v '\''/home/rear-uxdc01/ISOs'\'' &gt;&amp;2'\'' as an exit task'
2018-05-16 23:35:50.690206299 Added 'umount -f -v '/home/rear-uxdc01/ISOs' &gt;&amp;2' as an exit task
++ return 0
</code></pre>
<p>The CMD LINE :<br />
<code>sshfs rear-uxdc01@88.182.85.28:/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs -o port=22222</code>
is working fine.</p>
<ul>
<li>Work-around, if any:<br />
    none</li>
</ul>
<h4 id="patlegu_commented_at_2018-05-17_1122"><img src="https://avatars.githubusercontent.com/u/3754859?u=589fd4cb59162e0a3b1e920296625d650b384a99&v=4" width="50"><a href="https://github.com/patlegu">patlegu</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-389833199">2018-05-17 11:22</a>:<a class="headerlink" href="#patlegu_commented_at_2018-05-17_1122" title="Permanent link">&para;</a></h4>
<p>The <strong>mount_cmd</strong> is working fine, it appears on 'df -k' while the
<code>rear mkbackup</code> run but it's dismounted as the function <strong>StopIfError</strong>
seem to see it failed. What's very strange is that the return code is 0
as we can see in the test <code>[ 0 !=0 ]</code></p>
<h4 id="jsmeix_commented_at_2018-05-17_1402"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-389877411">2018-05-17 14:02</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-05-17_1402" title="Permanent link">&para;</a></h4>
<p>I am not a sshfs user but I think</p>
<pre>
OUTPUT_URL="sshfs://rear-uxdc01@51.15.151.255/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs port=12222"
</pre>

<p>cannot work because <code>man rear</code> reads</p>
<pre>
BACKUP_URL=sshfs://
    To backup to a remote server via sshfs (SSH protocol), use
    BACKUP_URL=sshfs://user@remote-system.name.org/home/user/backup-dir/
</pre>

<p>and OUTPUT_URL has same syntax as BACKUP_URL<br />
because <code>man rear</code> also reads</p>
<pre>
If you do not specify OUTPUT_URL variable then by default
it will be aligned to what was defined by variable BACKUP_URL
</pre>

<p>cf.<br />
<a href="https://github.com/rear/rear/blob/master/doc/rear.8.adoc">https://github.com/rear/rear/blob/master/doc/rear.8.adoc</a></p>
<h4 id="patlegu_commented_at_2018-05-17_1643"><img src="https://avatars.githubusercontent.com/u/3754859?u=589fd4cb59162e0a3b1e920296625d650b384a99&v=4" width="50"><a href="https://github.com/patlegu">patlegu</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-389932329">2018-05-17 16:43</a>:<a class="headerlink" href="#patlegu_commented_at_2018-05-17_1643" title="Permanent link">&para;</a></h4>
<p>I'm not trying to backup true <em>sshfs</em>, I'm doing this true BORG. I'm
just trying to save the <strong>iso</strong> on a sshfs directory instead of getting
it locally. So it's the good variable, <strong>OUTPUT_URL</strong><br />
I don't use BACKUP_URL as BACKUP=BORG with BORGBACKUP_HOST and
BORGBACKUP_PORT</p>
<p>If I use the MOUNT_CMD generated and launch it manually, no problem.
The remote directory is mounted locally on <code>/home/rear-uxdc01/ISOs</code><br />
After that if, I put in the <em>local.conf</em><br />
<code>OUTPUT_URL="file:////home/rear-uxdc01/ISOs"</code><br />
which is the mount point of the sshfs<br />
The <code>rear mkbackup</code> save the iso file as expected in the mount point
<code>/home/rear-uxdc01/ISOs</code><br />
So you we can expect to let it as this, but the problem is that my
backup server will have many others connected to it, and you can easily
imagine the impact to let all theses sshfs opened.</p>
<p>By using the <strong>OUTPUT_URL</strong>, sshfs is mounted before the backup and
dismounted at the end.</p>
<h4 id="gozora_commented_at_2018-05-17_1704"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-389938773">2018-05-17 17:04</a>:<a class="headerlink" href="#gozora_commented_at_2018-05-17_1704" title="Permanent link">&para;</a></h4>
<p>@patlegu can you please provide your <em>local.conf</em> you are using ?</p>
<p>Thanks</p>
<p>V.</p>
<h4 id="patlegu_commented_at_2018-05-17_1745"><img src="https://avatars.githubusercontent.com/u/3754859?u=589fd4cb59162e0a3b1e920296625d650b384a99&v=4" width="50"><a href="https://github.com/patlegu">patlegu</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-389951364">2018-05-17 17:45</a>:<a class="headerlink" href="#patlegu_commented_at_2018-05-17_1745" title="Permanent link">&para;</a></h4>
<pre><code>OUTPUT=ISO
OUTPUT_URL="sshfs://rear-uxdc01@88.182.85.28/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs port=22222"

BACKUP=BORG
BORGBACKUP_HOST="88.182.85.28"
BORGBACKUP_PORT="22222"
BORGBACKUP_USERNAME="rear-uxdc01"
BORGBACKUP_REPO="/home/rear-uxdc01/backup"
BORGBACKUP_REMOTE_PATH="/usr/sbin/borg"
BORGBACKUP_ARCHIVE_CACHE="/tmp/borg_archive"
BORGBACKUP_ARCHIVE_PREFIX="rearuxdc01"

BORGBACKUP_ENC_TYPE="repokey"
COPY_AS_IS_BORG=( /root/.config/borg/keys/,/usr/sbin/borg-linux64-standalone,/usr/sbin/borg )
export  BORG_PASSPHRASE='some good alphanumeric key'
export BORG_REPO='/home/rear-uxdc01/backup'
export BORG_RELOCATED_REPO_ACCESS_IS_OK="yes"
export BORG_UNKNOWN_UNENCRYPTED_REPO_ACCESS_IS_OK="yes"
</code></pre>
<h4 id="gozora_commented_at_2018-05-18_0533"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-390099218">2018-05-18 05:33</a>:<a class="headerlink" href="#gozora_commented_at_2018-05-18_0533" title="Permanent link">&para;</a></h4>
<p>@patlegu I'll check this later today and let you know ...</p>
<p>V.</p>
<h4 id="gozora_commented_at_2018-05-18_0541"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-390100335">2018-05-18 05:41</a>:<a class="headerlink" href="#gozora_commented_at_2018-05-18_0541" title="Permanent link">&para;</a></h4>
<p>@patlegu In you initial
<a href="https://github.com/rear/rear/issues/1808#issue-323802357">https://github.com/rear/rear/issues/1808#issue-323802357</a>
you are mentioning:</p>
<blockquote>
<p>The cmd is working fine when used on cmd line but it's falling in
error when used configured in /etc/rear/local.conf.</p>
</blockquote>
<p>What exactly is the error you are getting ?</p>
<p>V.</p>
<h4 id="jsmeix_commented_at_2018-05-18_0701"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-390114338">2018-05-18 07:01</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-05-18_0701" title="Permanent link">&para;</a></h4>
<p>@gozora<br />
in
<a href="https://github.com/rear/rear/issues/1808#issuecomment-389951364">https://github.com/rear/rear/issues/1808#issuecomment-389951364</a><br />
there is still that strange
<code>OUTPUT_URL="first_word second_word third_word"</code><br />
which does not look right as far as I can guess as a non-sshfs user,<br />
cf.
<a href="https://github.com/rear/rear/issues/1808#issuecomment-389877411">https://github.com/rear/rear/issues/1808#issuecomment-389877411</a></p>
<h4 id="gozora_commented_at_2018-05-18_0712"><img src="https://avatars.githubusercontent.com/u/12116358?u=1c5ba9dcee5ca3082f03029a7fbe647efd30eb49&v=4" width="50"><a href="https://github.com/gozora">gozora</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-390116824">2018-05-18 07:12</a>:<a class="headerlink" href="#gozora_commented_at_2018-05-18_0712" title="Permanent link">&para;</a></h4>
<p>Hello @jsmeix,</p>
<p>INDEED! Thanks!</p>
<p>@patlegu You can't use such format for <em>OUTPUT_URL</em>.<br />
You need ReaR to choose the mount point.<br />
And if you need to specify non-default port for SSH operations, I'd
recommend to use <em>~/.ssh/config</em> something like:</p>
<pre><code>Host 88.182.85.28
     Port 22222
</code></pre>
<h4 id="patlegu_commented_at_2018-05-18_0727"><img src="https://avatars.githubusercontent.com/u/3754859?u=589fd4cb59162e0a3b1e920296625d650b384a99&v=4" width="50"><a href="https://github.com/patlegu">patlegu</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-390120049">2018-05-18 07:27</a>:<a class="headerlink" href="#patlegu_commented_at_2018-05-18_0727" title="Permanent link">&para;</a></h4>
<p>Hello.<br />
@jsmeix,@gozora: You're right, this syntax is needed by Rear, not sshfs.
These three parameters are analyzed in the 'global-functions.sh'
functions and used by <em>mount_url</em> for sshfs (line 399):<br />
'### Mount URL $1 at mountpoint $2[, with options $3]'<br />
For sshfs, resulting in this command :
<code>mount_cmd="sshfs $authority:$path $mountpoint -o $options"</code><br />
and that's what I get (line 434):<br />
<code>mount_cmd="sshfs rear-uxdc01@88.182.85.28:/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs -o port=22222"</code><br />
I think I've finded where is the problem and I'm testing this today and
let you know.</p>
<p>Pat.</p>
<h4 id="jsmeix_commented_at_2018-05-18_0737"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-390122316">2018-05-18 07:37</a>:<a class="headerlink" href="#jsmeix_commented_at_2018-05-18_0737" title="Permanent link">&para;</a></h4>
<p>@patlegu<br />
see also default.conf e.g. the current one at<br />
<a href="https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf">https://github.com/rear/rear/blob/master/usr/share/rear/conf/default.conf</a><br />
that reads in particular</p>
<pre>
# In case of doubt inspect the scripts how exactly a particular variable works.

[...]

# Output/backup locations
##

# The URL defines the remote share as <scheme>://<host>/<share> like these examples:
# nfs://host.domain/path/path/path
# cifs://server.domain/share
# usb:///dev/sdb1
...
# Additional options to the mount command are given using *_OPTIONS
# Alternatively, you can provide your own mount/unmount commands, in that case
# Relax-and-Recover will append its mountpoint to the command.
...
# Specify the location of the output:
# When OUTPUT_URL is not specified it inherits the BACKUP_URL value.
OUTPUT_URL=
OUTPUT_OPTIONS=
OUTPUT_MOUNTCMD=
OUTPUT_UMOUNTCMD=
OUTPUT_PREFIX="$HOSTNAME"
</pre>

<p>and the main script how exactly that works is<br />
usr/share/rear/lib/global-functions.sh<br />
therein the mount_url() function<br />
together with the other URL related functions therein.</p>
<p>I never used things like OUTPUT_MOUNTCMD but as far as I see in<br />
usr/share/rear/output/default/100_mount_output_path.sh<br />
OUTPUT_MOUNTCMD cannnot be a string of words but must be a single
command<br />
and all the options to the mount command must be in OUTPUT_OPTIONS.</p>
<h4 id="patlegu_commented_at_2018-05-18_0959"><img src="https://avatars.githubusercontent.com/u/3754859?u=589fd4cb59162e0a3b1e920296625d650b384a99&v=4" width="50"><a href="https://github.com/patlegu">patlegu</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-390158687">2018-05-18 09:59</a>:<a class="headerlink" href="#patlegu_commented_at_2018-05-18_0959" title="Permanent link">&para;</a></h4>
<p>@jsmeix : You're right, but I don't say I use this <em>OUTPUT_MOUNTCMD</em> in
configuration file. I just say that <em>mount_cmd</em> appear in the log file,
and I try to copy and paste it in a shell and it work. That's just this,
I've not been as clear as I should have been, sorry.<br />
And as you mentioned, the only option I've used in local.conf is:<br />
<code>OUTPUT_URL="sshfs://rear-uxdc01@88.182.85.28/home/rear-uxdc01/ISOs /home/rear-uxdc01/ISOs port=22222"</code></p>
<h4 id="patlegu_commented_at_2018-05-21_1317"><img src="https://avatars.githubusercontent.com/u/3754859?u=589fd4cb59162e0a3b1e920296625d650b384a99&v=4" width="50"><a href="https://github.com/patlegu">patlegu</a> commented at <a href="https://github.com/rear/rear/issues/1808#issuecomment-390650929">2018-05-21 13:17</a>:<a class="headerlink" href="#patlegu_commented_at_2018-05-21_1317" title="Permanent link">&para;</a></h4>
<p>I've found where is the problem. The remote directory is mounted under a
path and the iso file is copied to another one in the temporary working
path. To work, the output_path function just need to be modified.</p>
<pre><code>(file|sshfs)
    # type file needs a local path (must be mounted by user)
    # type sshfs need a local path too but is mounted and unmounted automatically before and after the files copy.
    # To work properly, the OUPUT_URL must be set in the /etc/rear/local.conf file like this :
    # OUTPUT_URL="sshfs://&lt;remote user&gt;@&lt;remote host&gt;&lt;remote path&gt; &lt;local mount point&gt; &lt;sshfs option&gt;"
    # Be carefull to not include the ":" between &lt;remote host&gt;&lt;remote path&gt; as it's done automatically.
    # This exemple OUTPUT_URL="sshfs://rear-user@11.222.333.444/home/rear-user/ISOs /home/rear-user/ISOs
    # NOTE that sshfs options can be cumulated like this : port=2222,idmap=user
</code></pre>
<p>Hope this help.<br />
@+<br />
Pat</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2025 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2018-05-16.1808.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
