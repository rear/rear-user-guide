<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2955 Issue closed: Devuan 4 + ReaR Not Able to Recover - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2955 Issue closed: Devuan 4 + ReaR Not Able to Recover";
        var mkdocs_page_input_path = "issues/2023-03-07.2955.issue.closed.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/backup_netfs.html">Example of BACKUP=NETFS</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear28.html">Release Notes ReaR 2.8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">#2955 Issue closed: Devuan 4 + ReaR Not Able to Recover</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2955_issue_closed_devuan_4_rear_not_able_to_recover"><a href="https://github.com/rear/rear/issues/2955">#2955 Issue</a> <code>closed</code>: Devuan 4 + ReaR Not Able to Recover<a class="headerlink" href="#2955_issue_closed_devuan_4_rear_not_able_to_recover" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>support / question</code>, <code>needs sponsorship</code>,
<code>no-issue-activity</code></p>
<h4 id="3t0n1c_opened_issue_at_2023-03-07_2015"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> opened issue at <a href="https://github.com/rear/rear/issues/2955">2023-03-07 20:15</a>:<a class="headerlink" href="#3t0n1c_opened_issue_at_2023-03-07_2015" title="Permanent link">&para;</a></h4>
<!-- Relax-and-Recover (ReaR) Issue Template

Fill in the following items before submitting a new issue.
(quick response is not guaranteed with free support):

Please use proper GitHub Flavoured Markdown, see https://docs.github.com/en/get-started/writing-on-github/getting-started-with-writing-and-formatting-on-github/basic-writing-and-formatting-syntax

-- You can safely remove this comment block
-->

<ul>
<li>
<p>ReaR version ("/usr/sbin/rear -V"): 2.6 or 2.7</p>
</li>
<li>
<p>If your ReaR version is <strong>not</strong> the current version, explain why you
    can't upgrade:<br />
    I tried 2.6 that is available through my distro, and when it did not
    work,<br />
    I manually installed 2.7 - which also fails similarly.</p>
</li>
<li>
<p>OS version ("cat /etc/os-release" or "lsb_release -a" or "cat
    /etc/rear/os.conf"):</p>
</li>
</ul>
<!-- -->

<pre><code>PRETTY_NAME="Devuan GNU/Linux 4 (chimaera)"
NAME="Devuan GNU/Linux"
VERSION_ID="4"
VERSION="4 (chimaera)"
VERSION_CODENAME="chimaera"
ID=devuan
ID_LIKE=debian
HOME_URL="https://www.devuan.org/"
SUPPORT_URL="https://devuan.org/os/community"
BUG_REPORT_URL="https://bugs.devuan.org/"
</code></pre>
<ul>
<li>ReaR configuration files ("cat /etc/rear/site.conf" and/or "cat
    /etc/rear/local.conf"):</li>
</ul>
<!-- -->

<pre><code>OUTPUT=ISO
OUTPUT_URL="nfs://192.168.1.100/md0/REAR"
BACKUP=NETFS
BACKUP_URL=iso:///backup
</code></pre>
<ul>
<li>
<p>Hardware vendor/product (PC or PowerNV BareMetal or ARM) or VM (KVM
    guest or PowerVM LPAR):<br />
    Dell PowerEdge R210</p>
</li>
<li>
<p>System architecture (x86 compatible or PPC64/PPC64LE or what exact
    ARM device):<br />
    Intel Xeon 64 Bit</p>
</li>
<li>
<p>Firmware (BIOS or UEFI or Open Firmware) and bootloader (GRUB or
    ELILO or Petitboot):<br />
    Bios with Grub2</p>
</li>
<li>
<p>Storage (local disk or SSD) and/or SAN (FC or iSCSI or FCoE) and/or
    multipath (DM or NVMe):<br />
    Local SSD</p>
</li>
<li>
<p>Storage layout
    (<code>lsblk -ipo NAME,KNAME,PKNAME,TRAN,TYPE,FSTYPE,LABEL,SIZE,MOUNTPOINT</code>):</p>
</li>
</ul>
<!-- -->

<pre><code>/dev/sda    /dev/sda           sata   disk              14.9G
`-/dev/sda1 /dev/sda1 /dev/sda        part ext4         14.9G /
</code></pre>
<ul>
<li>Description of the issue (ideally so that others can reproduce it):</li>
</ul>
<p>Because this machine does not use very much storage<br />
I opted to include the backup within the ISO<br />
as you can see in my site.conf file listed above.<br />
ReaR created the ISO and stores it on my NFS share without issues.<br />
The problem arises when I try to recover.<br />
So I boot the ISO, I get to the login, type root and go in.<br />
After I type 'rear recover' I get the following:</p>
<pre><code>ERROR: Cannot mount ISO because there is no /dev/disk/by-label/RELAXRECOVER
</code></pre>
<p>Also if I do ifconfig there are no ethernet adapters available<br />
other than lo. That is strange to me.<br />
One thing that I found odd is that it tries to run systemd-udevd<br />
(and giving a countdown) and it fails to start it because<br />
it doesn't exist on my OS.<br />
I was unable to get it to run any further...</p>
<ul>
<li>
<p>Workaround, if any:<br />
    None</p>
</li>
<li>
<p>Attachments, as applicable ("rear -D mkrescue/mkbackup/recover"
    debug log files):<br />
    TBD</p>
</li>
</ul>
<p>You can drag-drop log files into this editor to create an attachment or
paste verbatim text<br />
like command output or file content by including it between a leading
and a closing line of<br />
three backticks like this:</p>
<pre><code>verbatim content
</code></pre>
<h4 id="jsmeix_commented_at_2023-03-08_0904"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1459796876">2023-03-08 09:04</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-08_0904" title="Permanent link">&para;</a></h4>
<p>Right now I didn't do an analysis.</p>
<p>From plain looking at<br />
<a href="https://github.com/rear/rear/issues/2955#issue-1614143309">https://github.com/rear/rear/issues/2955#issue-1614143309</a><br />
the ISO label 'RELAXRECOVER' puzzles me<br />
because there is no longer 'RELAXRECOVER'<br />
in our ReaR 2.7 code since<br />
<a href="https://github.com/rear/rear/pull/2814">https://github.com/rear/rear/pull/2814</a><br />
was merged, see also our ReaR 2.7 release notes at<br />
<a href="https://github.com/rear/rear/blob/rear-2.7/doc/rear-release-notes.txt#L319">https://github.com/rear/rear/blob/rear-2.7/doc/rear-release-notes.txt#L319</a></p>
<p>But 'RELAXRECOVER' was in ReaR 2.6</p>
<p>Perhaps something mixed up while you<br />
tried both ReaR 2.6 and ReaR 2.7 on your system?<br />
See the section<br />
"Testing current ReaR upstream GitHub master code"<br />
in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a><br />
how you can have several ReaR versions in parallel<br />
each one in its own separated directory<br />
without conflicts between each other.</p>
<p>In general I recommend to try out our latest GitHub master code<br />
because the GitHub master code is the only place where we fix things<br />
and if there are issues it helps when you use exactly the code<br />
where we could fix things.</p>
<p>In general for an analysis we need full debug ReaR log files.<br />
See the section<br />
"Debugging issues with Relax-and-Recover" in<br />
<a href="https://en.opensuse.org/SDB:Disaster_Recovery">https://en.opensuse.org/SDB:Disaster_Recovery</a></p>
<h4 id="jsmeix_commented_at_2023-03-08_0920"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1459834494">2023-03-08 09:20</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-08_0920" title="Permanent link">&para;</a></h4>
<p>In particular regarding Devuan and<br />
in general regarding Debian based Linux distributions:</p>
<p>On<br />
<a href="https://en.wikipedia.org/wiki/Devuan">https://en.wikipedia.org/wiki/Devuan</a><br />
I read that</p>
<pre><code>Devuan is a fork of the Debian Linux distribution
that uses sysvinit, runit or OpenRC instead of systemd
</code></pre>
<p>At ReaR upstream we neither have a maintainer for Devuan<br />
nor do we have a maintainer for Debian or for<br />
Debian based Linux distributions (like Ubuntu).</p>
<p>So ReaR support for Debian based Linux distributions<br />
and in particular ReaR support for Devuan<br />
with its nowadays unusual init system<br />
can be only as good as voluntary contributors<br />
who use such Linux distributions contribute<br />
to ReaR upstream - which is much appreciated!</p>
<h4 id="3t0n1c_commented_at_2023-03-08_1319"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1460145923">2023-03-08 13:19</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-08_1319" title="Permanent link">&para;</a></h4>
<blockquote>
<p>RELAXRECOVER' was in ReaR 2.6</p>
</blockquote>
<p>I apologize for the confusion. You are correct in stating that
RELAXRECOVER' was in ReaR 2.6 but not in 2.7.<br />
The error I get in 2.7 is different, though I tried so many things I
forgot to take a screenshot of the exact error for 2.7.<br />
It very much stops in the same spot.</p>
<p>I will take your advise and try the latest from Master and see where
that takes me.<br />
I don't expect anyone to go out of their way to make this work with
Devuan if it's that much of a hassle. I was more or less looking for
advise on how to make it work (if possible) perhaps from someone who got
it working on Devuan.<br />
Since Devuan is a fork of Debian without systemD, and also because ReaR
works just fine on Debian 11, it made sense to me to point fingers at
systemD not being there as being the culprit.<br />
I've attached 2 screenshots that may show more relevant information.<br />
<img alt="IMG_4412" src="https://user-images.githubusercontent.com/127246980/223723141-4af73d85-b499-4b55-9fb2-23cdafe40961.JPG" /><br />
<img alt="IMG_4417" src="https://user-images.githubusercontent.com/127246980/223723197-0c180038-459a-4cce-ad66-4a77e4bfc05b.JPG" /></p>
<p>I appreciate all your efforts and I will report back using the latest
version from Master.<br />
Thank you!</p>
<h4 id="3t0n1c_commented_at_2023-03-08_1455"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1460284747">2023-03-08 14:55</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-08_1455" title="Permanent link">&para;</a></h4>
<p>So I grabbed the latest from github and compiled my own .deb file.<br />
I ran into the ISO size limitation while running "rear mkbackup", so I
decided to place the backup.tar.gz file on the nfs share instead. That
worked well to create the ISO and backup file on the nfs server.<br />
All went well, until I needed to restore.<br />
I have taken screenshots to show everything. Hopefully it can shed some
light on what is happening.<br />
No network interfaces are available. Right after I logged in with root,
I ran ifconfig. One of the screenshots shows that only lo interface is
available. No wonder it can't get to the nfs server during restore.<br />
See screenshots below for details.<br />
Thank you<br />
<img alt="IMG_4424" src="https://user-images.githubusercontent.com/127246980/223746657-4e8dc3ae-2061-45cc-9362-7a462469c270.JPG" /><br />
<img alt="IMG_4425" src="https://user-images.githubusercontent.com/127246980/223746659-e2598d3e-b91a-4506-b54e-a85702b1dad9.JPG" /><br />
<img alt="IMG_4426" src="https://user-images.githubusercontent.com/127246980/223746660-1dd98631-d6fb-4e11-a11f-90f78cf432f5.JPG" /><br />
<img alt="IMG_4427" src="https://user-images.githubusercontent.com/127246980/223746663-df6f5f8f-543a-4d23-a7f5-b743d0b4e836.JPG" /><br />
<img alt="IMG_4428" src="https://user-images.githubusercontent.com/127246980/223746666-51c77f12-3196-4c2f-aff9-684e57865f22.JPG" /><br />
<img alt="IMG_4429" src="https://user-images.githubusercontent.com/127246980/223746667-cf3ef1af-10bc-408d-bca3-c72e2db49ce8.JPG" /><br />
<img alt="IMG_4430" src="https://user-images.githubusercontent.com/127246980/223746669-a24e5015-2f15-4b68-9b9f-b6fca029666f.JPG" /><br />
<img alt="IMG_4431" src="https://user-images.githubusercontent.com/127246980/223746672-74267a5c-c5c6-4058-930c-e7d29976922f.JPG" /><br />
<img alt="IMG_4432" src="https://user-images.githubusercontent.com/127246980/223746673-25a1354f-b8f6-46e1-9192-565619403104.JPG" /></p>
<h4 id="3t0n1c_commented_at_2023-03-09_2240"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1462926031">2023-03-09 22:40</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-09_2240" title="Permanent link">&para;</a></h4>
<p>If anyone has any suggestions I am willing to try just about anything. I
would love to be able to use ReaR on Devuan...</p>
<p>Thanks everyone!</p>
<h4 id="jsmeix_commented_at_2023-03-10_0858"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1463479749">2023-03-10 08:58</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-10_0858" title="Permanent link">&para;</a></h4>
<p>@3t0n1c<br />
sorry for possibly longer delays, you are not forgotten.<br />
But other stuff came in at work which has higher priority.<br />
In general SUSE customer issues have higher priority for me<br />
(and for my employer and our customers) than ReaR upstream issues.</p>
<h4 id="gdha_commented_at_2023-03-10_0913"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1463500418">2023-03-10 09:13</a>:<a class="headerlink" href="#gdha_commented_at_2023-03-10_0913" title="Permanent link">&para;</a></h4>
<p>@3t0n1c if you do not have active network interface then mounting an ISO
image over NFS is not possible.<br />
Try to identify how the network interfaces are started on a normal
system as perhaps we are missing the required init script on the rescue
image as this Devuan is not systemd minded.</p>
<h4 id="jsmeix_commented_at_2023-03-10_0913"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1463501314">2023-03-10 09:13</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-10_0913" title="Permanent link">&para;</a></h4>
<p>@3t0n1c<br />
a general info:</p>
<p>After you logged in as 'root' into the ReaR recovery system<br />
you can do therein what you want before you start "rear -D recover".</p>
<p>In case of issues I recommend to run 'rear' with '-D' to get<br />
debug messages on the terminal and full 'set -x' debugscript<br />
messages in the ReaR log file.</p>
<p>So before you run "rear -D recover" you can do what is needed<br />
to manually set up networking as you need it in your case.<br />
When there is no network interface like 'eth0' perhaps some<br />
kernel modules for the network interface hardware may not<br />
have been loaded automatically in Devuan so you may have<br />
to load them manually.<br />
When you know what commands make networking work in the<br />
ReaR recovery system as you need it in your case<br />
you can specify them in NETWORKING_PREPARATION_COMMANDS<br />
to get that automated, see usr/share/rear/conf/default.conf<br />
<a href="https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L3185">https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L3185</a><br />
and to get kernel module loading done use MODULES_LOAD<br />
<a href="https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L1598">https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L1598</a><br />
To get all modules of the original system in the recovery system<br />
with the same module loading ordering as in the original system<br />
you may use the output of a command like</p>
<pre><code># lsmod | tail -n +2 | cut -d ' ' -f 1 | tac | tr -s '[:space:]' ' '
</code></pre>
<p>as value for MODULES_LOAD, cf.<br />
<a href="https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/examples/SLE12-SP2-btrfs-example.conf#L38">https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/examples/SLE12-SP2-btrfs-example.conf#L38</a></p>
<p>You can also do what is needed (e.g. create a symlink)<br />
so that /dev/disk/by-label/RELAXRECOVER points to<br />
the actual kernel device node where your ISO medium is.<br />
E.g. use 'lsblk' to see what block devices there are<br />
in the ReaR recovery system - one of them should be<br />
the one where your ISO medium is.</p>
<h4 id="3t0n1c_commented_at_2023-03-10_1149"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1463691244">2023-03-10 11:49</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-10_1149" title="Permanent link">&para;</a></h4>
<blockquote>
<p>@3t0n1c if you do not have active network interface then mounting an
ISO image over NFS is not possible. Try to identify how the network
interfaces are started on a normal system as perhaps we are missing
the required init script on the rescue image as this Devuan is not
systemd minded.</p>
</blockquote>
<p>As you can see from my reply, I am aware there are no network interfaces
available thus NFS is not going to work.<br />
The question is what fails to run and how do I get it going?<br />
I don't mind modifying some scripts to get things running. I feel pretty
comfortable in bash.<br />
I just don't want to start having to learn what each script does and how
they all interact in order to reinvent the wheel if I don't have to.</p>
<p>Thank you for your input!</p>
<h4 id="3t0n1c_commented_at_2023-03-10_1155"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1463697749">2023-03-10 11:55</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-10_1155" title="Permanent link">&para;</a></h4>
<blockquote>
<p>@3t0n1c a general info:</p>
<p>After you logged in as 'root' into the ReaR recovery system you can do
therein what you want before you start "rear -D recover".</p>
<p>In case of issues I recommend to run 'rear' with '-D' to get debug
messages on the terminal and full 'set -x' debugscript messages in the
ReaR log file.</p>
<p>So before you run "rear -D recover" you can do what is needed to
manually set up networking as you need it in your case. When there is
no network interface like 'eth0' perhaps some kernel modules for the
network interface hardware may not have been loaded automatically in
Devuan so you may have to load them manually. When you know what
commands make networking work in the ReaR recovery system as you need
it in your case you can specify them in
NETWORKING_PREPARATION_COMMANDS to get that automated, see
usr/share/rear/conf/default.conf
<a href="https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L3185">https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L3185</a>
and to get kernel module loading done use MODULES_LOAD
<a href="https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L1598">https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L1598</a>
To get all modules of the original system in the recovery system with
the same module loading ordering as in the original system you may use
the output of a command like</p>
<pre><code># lsmod | tail -n +2 | cut -d ' ' -f 1 | tac | tr -s '[:space:]' ' '
</code></pre>
<p>as value for MODULES_LOAD, cf.
<a href="https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/examples/SLE12-SP2-btrfs-example.conf#L38">https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/examples/SLE12-SP2-btrfs-example.conf#L38</a></p>
<p>You can also do what is needed (e.g. create a symlink) so that
/dev/disk/by-label/RELAXRECOVER points to the actual kernel device
node where your ISO medium is. E.g. use 'lsblk' to see what block
devices there are in the ReaR recovery system - one of them should be
the one where your ISO medium is.</p>
</blockquote>
<p>I will look into what you suggested. Sounds like I have some work to
do.<br />
As you can see from my screenshots, there are no network interfaces
available. Also unde /dev/ there is no sr0 or sr1, or even cdrom. No
ethX interfaces exist. Like you said, and I agree the drivers are not
loaded.<br />
That leads me again to believing without systemd modules are not loaded
thus things just don't work.<br />
I am not sure how easy it is/will be modify any of the scripts to make
this work. I am beginning to be more and more pessimistic about this
ever working properly on Devuan without a tone of work or modifications.</p>
<p>Thank you for your advice!</p>
<h4 id="3t0n1c_commented_at_2023-03-10_1403"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1463849432">2023-03-10 14:03</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-10_1403" title="Permanent link">&para;</a></h4>
<p>I just went and tried a few things just to see if we can turn the
spotlight on the problem... So far no go.<br />
So first I tried to just run lsblk to see the drives. It returned
nothing... See picture.<br />
<img alt="IMG_4449" src="https://user-images.githubusercontent.com/127246980/224335489-66873d00-5e7a-4cd6-bcf7-c5052ddd7ca0.JPG" /></p>
<p>The I did the lsmod to list the loaded modules.<br />
See output here:<br />
<img alt="IMG_4450" src="https://user-images.githubusercontent.com/127246980/224335677-82560d1f-4f63-42d0-a316-5bc9c780b496.JPG" /><br />
I don't know if that tells you anything, but I don't see any network
modules listed, or drives, or cdrom or anything like that.<br />
There is barely anything there. The original system has a boatload of
modules loaded. Shouldn't they all be present here as well?<br />
Should is the key word here. Is there a way to force-load all the
modules that are loaded on the original system on here and see what
happens?</p>
<p>As suggested, I will try to run it using the -D flag and report back.</p>
<p>Thank you all. I really appreciate the efforts.</p>
<h4 id="jsmeix_commented_at_2023-03-10_1436"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1463893235">2023-03-10 14:36</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-10_1436" title="Permanent link">&para;</a></h4>
<p>@3t0n1c<br />
regarding</p>
<pre><code>Is there a way to force-load all the modules
that are loaded on the original system
on here and see what happens?
</code></pre>
<p>In my<br />
<a href="https://github.com/rear/rear/issues/2955#issuecomment-1463501314">https://github.com/rear/rear/issues/2955#issuecomment-1463501314</a><br />
I meant that you shoud run on your original system<br />
a command like</p>
<pre><code># lsmod | tail -n +2 | cut -d ' ' -f 1 | tac | tr -s '[:space:]' ' '
</code></pre>
<p>and use its output as value<br />
for MODULES_LOAD in your etc/rear/local.conf<br />
and then recreate the ReaR recovery system and the backup<br />
anew on your original system via</p>
<pre><code># rear -D mkbackup
</code></pre>
<p>Then retry if this works better to recreate your original system<br />
on your replacement hardware or your replacement VM.</p>
<h4 id="3t0n1c_commented_at_2023-03-10_1500"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1463928112">2023-03-10 15:00</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-10_1500" title="Permanent link">&para;</a></h4>
<p>I apologize, I misunderstood.<br />
I will try that are report back.</p>
<p>Thank you!</p>
<h4 id="3t0n1c_commented_at_2023-03-10_1605"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1464027916">2023-03-10 16:05</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-10_1605" title="Permanent link">&para;</a></h4>
<p>Quick update!<br />
So I added the list of modules to my /etc/rear/local.conf file.<br />
Ran rear -D mkbackup. Worked fine. No issues.<br />
Then, proceeded to boot the system from the fresh ISO.<br />
It appears to get stuck at the following screen, though the kernel is
not locked. I can hit Numlock and the led on my keyboard flashes, so
she's not dead or panicked. I've waited 30 minutes, never made it past
this point. See picture below:<br />
<img alt="IMG_4484" src="https://user-images.githubusercontent.com/127246980/224364083-69cbf918-7b8e-4e26-b4eb-36eb62866bb8.JPG" /></p>
<p>Also, just in case this may shed some light on stuff, here's the output
from rear -D mkbackup</p>
<pre><code>rear -D mkbackup

Relax-and-Recover 2.7-git.4996.ff64d61e.master / 2023-03-07
Running rear mkbackup (PID 6479 date 2023-03-10 10:39:20)
Command line options: /usr/sbin/rear -D mkbackup
Using log file: /var/log/rear/rear-router01.log
Using build area: /var/tmp/rear.LbktYX8daUnl7m7
Running 'init' stage ======================
Running workflow mkbackup on the normal/original system
Running 'prep' stage ======================
Using backup archive '/var/tmp/rear.LbktYX8daUnl7m7/outputfs/router01/backup.tar.gz'
Using '/usr/bin/xorrisofs' to create ISO filesystem images
Using autodetected kernel '/boot/vmlinuz-5.10.0-17-amd64' as kernel in the recovery system
Modified ReaR recovery system area after 'prep' stage (/var/tmp/rear.LbktYX8daUnl7m7/rootfs not empty)
Running 'layout/save' stage ======================
Creating disk layout
Overwriting existing disk layout file /var/lib/rear/layout/disklayout.conf
Disabling excluded components in /var/lib/rear/layout/disklayout.conf
Using guessed bootloader 'GRUB' for 'rear recover' (found in first bytes on /dev/sda)
Skip saving storage layout as 'barrel' devicegraph (no 'barrel' command)
Verifying that the entries in /var/lib/rear/layout/disklayout.conf are correct
Created disk layout (check the results in /var/lib/rear/layout/disklayout.conf)
Running 'rescue' stage ======================
Creating recovery system root filesystem skeleton layout
Handling network interface 'eth0'
eth0 is a physical device
Handled network interface 'eth0'
Handling network interface 'eth0.2'
eth0.2 is a vlan
eth0.2 has eth0 as parent
eth0 already handled...
Handled network interface 'eth0.2'
Handling network interface 'eth0.3'
eth0.3 is a vlan
eth0.3 has eth0 as parent
eth0 already handled...
Handled network interface 'eth0.3'
Handling network interface 'eth0.5'
eth0.5 is a vlan
eth0.5 has eth0 as parent
eth0 already handled...
Handled network interface 'eth0.5'
Handling network interface 'eth1'
eth1 is a physical device
Handled network interface 'eth1'
Handling network interface 'eth1.147'
eth1.147 is a vlan
eth1.147 has eth1 as parent
eth1 already handled...
Handled network interface 'eth1.147'
Handling network interface 'eth1.148'
eth1.148 is a vlan
eth1.148 has eth1 as parent
eth1 already handled...
Handled network interface 'eth1.148'
Handling network interface 'eth1.149'
eth1.149 is a vlan
eth1.149 has eth1 as parent
eth1 already handled...
Handled network interface 'eth1.149'
Handling network interface 'eth1.150'
eth1.150 is a vlan
eth1.150 has eth1 as parent
eth1 already handled...
Handled network interface 'eth1.150'
Skipping 'proton0': not bound to any physical interface.
Skipping 'tun0': not bound to any physical interface.
Included current keyboard mapping (via 'dumpkeys -f')
No default US keyboard mapping included (no KEYMAPS_DEFAULT_DIRECTORY specified)
No support for different keyboard layouts (neither KEYMAPS_DEFAULT_DIRECTORY nor KEYMAPS_DIRECTORIES specified)
Copying logfile /var/log/rear/rear-router01.log into initramfs as '/tmp/rear-router01-partial-2023-03-10T10:39:24-05:00.log'
Running 'build' stage ======================
Copying files and directories
Copying binaries and libraries
Copying all kernel modules in /lib/modules/5.10.0-17-amd64 (MODULES contains 'all_modules')
Copying all files in /lib*/firmware/
Symlink '/usr/share/misc/magic' -&gt; '/usr/share/file/magic' refers to a non-existing directory on the recovery system.
It will not be copied by default. You can include '/usr/share/file/magic' via the 'COPY_AS_IS' configuration variable.
Skip copying broken symlink '/etc/mtab' target '/proc/16146/mounts' on /proc/ /sys/ /dev/ or /run/
Testing that the recovery system in /var/tmp/rear.LbktYX8daUnl7m7/rootfs contains a usable system
Testing each binary with 'ldd' and look for 'not found' libraries within the recovery system
Testing that the existing programs in the PROGS array can be found as executable command within the recovery system
Testing that each program in the REQUIRED_PROGS array can be found as executable command within the recovery system
Running 'pack' stage ======================
Creating recovery/rescue system initramfs/initrd initrd.cgz with gzip default compression
Created initrd.cgz with gzip default compression (166591322 bytes) in 25 seconds
Running 'output' stage ======================
Making ISO image
Wrote ISO image: /var/lib/rear/output/rear-router01.iso (167M)
Copying resulting files to nfs location
Saving /var/log/rear/rear-router01.log as rear-router01.log to nfs location
Copying result files '/var/lib/rear/output/rear-router01.iso /var/tmp/rear.LbktYX8daUnl7m7/tmp/VERSION /var/tmp/rear.LbktYX8daUnl7m7/tmp/README /var/tmp/rear.LbktYX8daUnl7m7/tmp/rear-router01.log' to /var/tmp/rear.LbktYX8daUnl7m7/outputfs/router01 at nfs location
Running 'backup' stage ======================
Making backup (using backup method NETFS)
Creating tar archive '/var/tmp/rear.LbktYX8daUnl7m7/outputfs/router01/backup.tar.gz'
Archived 2972 MiB [avg 10283 KiB/sec] OK
WARNING: tar ended with return code 1 and below output (last 5 lines):
  ---snip---
  tar: /var/tmp/rear.LbktYX8daUnl7m7/tmp/backup.log: file changed as we read it
  ----------
This means that files have been modified during the archiving
process. As a result the backup may not be completely consistent
or may not be a perfect copy of the system. Relax-and-Recover
will continue, however it is highly advisable to verify the
backup in order to be sure to safely recover this system.

Archived 2972 MiB in 297 seconds [avg 10248 KiB/sec]
Exiting rear mkbackup (PID 6479) and its descendant processes ...
Running exit tasks
To remove the build area you may use (with caution): rm -Rf --one-file-system /var/tmp/rear.LbktYX8daUnl7m7
</code></pre>
<p>As always thank you for your help!</p>
<h4 id="3t0n1c_commented_at_2023-03-10_1911"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1464272514">2023-03-10 19:11</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-10_1911" title="Permanent link">&para;</a></h4>
<p>Enjoy your weekend everyone!</p>
<h4 id="jsmeix_commented_at_2023-03-13_0732"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1465642166">2023-03-13 07:32</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-13_0732" title="Permanent link">&para;</a></h4>
<p>Regarding no further output after</p>
<pre><code>Probing EDD (edd=off to disable)... ok
</code></pre>
<p>In ReaR 2.7 we have a new issue because<br />
we fixed some serial console code in ReaR<br />
but we did not see how all that serial console code in ReaR<br />
(partially falsely) worked so that in the end it mostly worked.</p>
<p>In<br />
<a href="https://github.com/rear/rear/issues/2843">https://github.com/rear/rear/issues/2843</a><br />
see in particular<br />
<a href="https://github.com/rear/rear/issues/2843#issuecomment-1196337765">https://github.com/rear/rear/issues/2843#issuecomment-1196337765</a><br />
for the reason (as far as I understand it) and<br />
<a href="https://github.com/rear/rear/issues/2843#issuecomment-1196588256">https://github.com/rear/rear/issues/2843#issuecomment-1196588256</a><br />
<a href="https://github.com/rear/rear/issues/2843#issuecomment-1196592017">https://github.com/rear/rear/issues/2843#issuecomment-1196592017</a><br />
for possible solutions.<br />
For the latter solution ReaR version 2.7 is needed.</p>
<p>When I boot the ReaR recovery system on my KVM VMs<br />
without <code>USE_SERIAL_CONSOLE='no'</code> in my<br />
etc/rear/local.conf (during "rear mkrescue/mkbackup)<br />
I get</p>
<pre><code>...
Loading kernel.....................
Loading initrd.cgz..........................ready.
Probing EDD (edd=off to disable)... ok
</code></pre>
<p>and then no further kernel boot messages and<br />
no ReaR recovery system startup messages are shown.<br />
But after a shorter time (about half a minute)<br />
the screen blanks and shows the recovery system login screen<br />
where then all works normal.</p>
<p>It never happened to me that after</p>
<pre><code>Probing EDD (edd=off to disable)... ok
</code></pre>
<p>no longer any output is shown<br />
but that happened to another ReaR user, see<br />
<a href="https://github.com/rear/rear/issues/2933#issuecomment-1432684472">https://github.com/rear/rear/issues/2933#issuecomment-1432684472</a></p>
<p>Now I see that<br />
<a href="https://github.com/rear/rear/issues/2843#issuecomment-1196556049">https://github.com/rear/rear/issues/2843#issuecomment-1196556049</a><br />
shows how it can happen that with a wrong serial console setting<br />
it can look as if the ReaR recovery system had hung up after</p>
<pre><code>Probing EDD (edd=off to disable)... ok
</code></pre>
<p>(excerpt from that @hpannenb issue comment)</p>
<pre><code>During the startup I will be asked in 55-migrate-network-devices.sh
about to provide the proper network mapping.
With ReaR 2.7 this dialog is present on e.g. ttyS0 (serial) only;
with ReaR 2.6 this dialog was shown on tty0 (console).
</code></pre>
<p>In
skel/default/etc/scripts/system-setup.d/55-migrate-network-devices.sh<br />
there is</p>
<pre><code>echo "The original network interface $old_dev $old_mac is not available"
PS3="Choose replacement for $old_dev $old_mac "
skip_choice="Skip replacing $old_dev $old_mac"
select choice in "${NEW_DEVICES[@]}" "$skip_choice" ; do
</code></pre>
<p><a href="https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/skel/default/etc/scripts/system-setup.d/55-migrate-network-devices.sh#L177">https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/skel/default/etc/scripts/system-setup.d/55-migrate-network-devices.sh#L177</a></p>
<p>But 'select' does not support a timeout<br />
so 'select' waits endlessly and for the user<br />
it looks as if the ReaR recovery system had hung up.</p>
<p>By "googling" for 'bash select timeout' I found my<br />
<a href="https://github.com/rear/rear/issues/1366">https://github.com/rear/rear/issues/1366</a><br />
and the related<br />
<a href="https://github.com/rear/rear/issues/1399">https://github.com/rear/rear/issues/1399</a></p>
<p>Those resulted the new UserInput() function<br />
and its usage during "rear recover".</p>
<p>But we cannot 'source lib/_input-output-functions.sh'<br />
during ReaR recovery system startup in<br />
skel/default/etc/scripts/system-setup<br />
because lib/_input-output-functions.sh also does special stuff<br />
like stdin stdout redirections and exit task settings.<br />
I think this should not be in a script that defines functions<br />
but it was always therein and I do not understand<br />
why this is in lib/_input-output-functions.sh and<br />
not in sbin/rear (where I would expect it)<br />
so I left it as is because it works as is.</p>
<p>But in the end it means the 'select' and 'read' calls in the<br />
ReaR recovery system startup scripts in skel/default/etc/scripts<br />
were not changed so there are not yet timeouts for<br />
user dialogs during ReaR recovery system startup<br />
which contradicts the initial intent of<br />
<a href="https://github.com/rear/rear/issues/1366">https://github.com/rear/rear/issues/1366</a></p>
<h4 id="3t0n1c_commented_at_2023-03-13_1952"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1466863565">2023-03-13 19:52</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-13_1952" title="Permanent link">&para;</a></h4>
<p>Hey all. I'm back with updates.<br />
So what you suggested worked getting me further, and I was able to get
it to load past <code>Probing EDD (edd=off to disable)... ok</code>.<br />
Since I use 2.7 I added <code>USE_SERIAL_CONSOLE='no'</code> to my local.conf file,
so that indeed helped.<br />
Now, the system comes up to the login screen. I have networking and I
can ping my nfs server. This is awesome!<br />
Though the saga continues. For some odd reason it does not detect any
storage. The storage is a single SSD drive attached to sata0 and it is
functional as the machine can boot from it.<br />
I ran lsblk and fdisk -l. Both return nothing.<br />
Just an educated guess, perhaps udev is not running or not starting,
hence can't detect storage? Is it due to systemd not being present?</p>
<p>So of course further down if I run "rear recover", it fails stating
ERROR: No filesystem mounted on /mnt/local.</p>
<p>Thoughts?</p>
<p>Thank you for all the help and effort guys!!!</p>
<h4 id="3t0n1c_commented_at_2023-03-13_2337"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1467123113">2023-03-13 23:37</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-13_2337" title="Permanent link">&para;</a></h4>
<p>I just took a few screenshots for you guys to see details.<br />
I hope this helps:<br />
<img alt="IMG_4528" src="https://user-images.githubusercontent.com/127246980/224855313-0560053d-2db2-4ec4-a8a0-905ec83987fa.JPG" /><br />
<img alt="IMG_4529" src="https://user-images.githubusercontent.com/127246980/224855321-013d3f61-ed57-44f5-ba14-67c7c37998d5.JPG" /><br />
<img alt="IMG_4530" src="https://user-images.githubusercontent.com/127246980/224855325-a418ed0b-b5a7-4754-b949-4cbeca6be788.JPG" /></p>
<p>Thank you</p>
<h4 id="jsmeix_commented_at_2023-03-14_1359"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1468157489">2023-03-14 13:59</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-14_1359" title="Permanent link">&para;</a></h4>
<p>I don't know why there are no disk / block device nodes<br />
in the ReaR recovery system for Devuan.</p>
<p>I guess it is because the Devuan init system is too different<br />
and because there is no Devuan specific support in ReaR<br />
"rear mkrescue" fails to make "the right things" in the<br />
ReaR recovery system for Devuan.</p>
<p>In general regarding debugging issues during<br />
the startup of the ReaR recovery system:</p>
<p>The basic idea behind is to not let the startup scripts<br />
that are run initially in the ReaR recovery system are<br />
run automatically and mostly silently but instead run<br />
them manually one after the other with 'set -x'<br />
bash debugging mode.</p>
<p>To do that add 'debug' to the ReaR kernel command line<br />
when booting the ReaR recovery system.</p>
<p>In the ReaR recovery system boot menue select<br />
the topmost enty of the form "Recover HOSTNAME" and<br />
press the [Tab] key to edit the boot command line<br />
and append the word ' debug' at its end and boot that.</p>
<p>You might then find yourself stopped at a blank screen.<br />
In this case press [Enter] which runs the very first of the<br />
startup scripts (/etc/scripts/system-setup.d/00functions.sh).<br />
There is or was sometimes the issue that the initial message<br />
is not always printed so you may need to type the very first<br />
[Enter] blindly.</p>
<p>The further startup scripts are run one by one<br />
each one after pressing [Enter].</p>
<p>In 'debug' mode the startup scripts are run with 'set -x'<br />
so that this way you can better see what actually goes on<br />
in each of the startup scripts.</p>
<p>Perhaps this might indicate where things do not work<br />
during ReaR recovery system startup for Devuan.</p>
<h4 id="3t0n1c_commented_at_2023-03-14_1428"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1468204272">2023-03-14 14:28</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-14_1428" title="Permanent link">&para;</a></h4>
<p>I will give that a shot and report back.<br />
Thank you for all your support, it is much appreciated!</p>
<h4 id="3t0n1c_commented_at_2023-03-14_1804"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1468583829">2023-03-14 18:04</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-14_1804" title="Permanent link">&para;</a></h4>
<p>So before I dug any deeper, I looked again at the list of kernel modules
and realized I was missing the sata related module. I've added it to the
list, and made another backup.<br />
Things have improved but we're not out of the woods yet. So, lsblk now
shows both my sata drive and the USB thumb drive that rear boots from,
however fdisk -l still returns no output.<br />
I am not sure if this might help in any way shape or form, but I thought
it was worth mentioning.<br />
Rear proceeds to error out stating that /dev/sda is not a block device.
Something is still broken...<br />
See screenshots:<br />
<img alt="IMG_4541" src="https://user-images.githubusercontent.com/127246980/225096663-21f6d6f5-9aa3-4e54-ba31-45556fdbfdb2.JPG" /></p>
<p>See BUG in the middle of screen below. Perhaps it's not a bug but yet
erroring out due to other unknown issues.<br />
<img alt="IMG_4542" src="https://user-images.githubusercontent.com/127246980/225096702-85b722c8-a404-44f2-b2bc-a3ba7aeca8e1.JPG" /></p>
<p>I will have to run in debug mode as suggested, but if any other
suggestions come to mind please don't hesitate to reply.</p>
<p>Thank you</p>
<h4 id="jsmeix_commented_at_2023-03-15_1141"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1469850864">2023-03-15 11:41</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-15_1141" title="Permanent link">&para;</a></h4>
<p>@3t0n1c<br />
I wonder how you could "missing the sata related module"?</p>
<p>Did a command like</p>
<pre><code># lsmod | tail -n +2 | cut -d ' ' -f 1 | tac | tr -s '[:space:]' ' '
</code></pre>
<p>and using its output as value<br />
for MODULES_LOAD in your etc/rear/local.conf<br />
somehow not work for you?</p>
<p>Module dependencies can be rather tricky and non-obvious, cf.<br />
<a href="https://github.com/rear/rear/issues/1355">https://github.com/rear/rear/issues/1355</a><br />
and see the description about 'MODULES' in default.conf<br />
<a href="https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L1540">https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L1540</a></p>
<p>So ensure to have all modules loaded inside the ReaR recovery system<br />
that are loaded on your original system.</p>
<p>How does</p>
<pre><code># parted -s /dev/sda unit GiB print
</code></pre>
<p>show your disk when called inside the ReaR recovery system?</p>
<p>Does it work to manually use 'parted' in the recovery system like</p>
<pre><code># parted -s /dev/sda mklabel gpt
</code></pre>
<p>and if yes, what does then</p>
<pre><code># parted -s /dev/sda unit GiB print
</code></pre>
<p>show?</p>
<p>As far as I see ReaR does not call 'fdisk' but 'parted' and<br />
'sfdisk' only in the special case of BLOCKCLONE_STRICT_PARTITIONING.</p>
<h4 id="jsmeix_commented_at_2023-03-15_1148"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1469861228">2023-03-15 11:48</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-15_1148" title="Permanent link">&para;</a></h4>
<p>@3t0n1c<br />
to reduce testing time while you try out this and that<br />
with the ReaR recovery system:</p>
<p>To only create a new ReaR recovery system<br />
without a backup of the files use</p>
<pre><code># rear -D mkrescue
</code></pre>
<p>This may result errors when the backup is included in the ISO<br />
but it works when the backup is e.g. on an NFS server.</p>
<h4 id="jsmeix_commented_at_2023-03-15_1201"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1469877986">2023-03-15 12:01</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-15_1201" title="Permanent link">&para;</a></h4>
<p>The above BUG ERROR is not a bug in ReaR.<br />
It is because of the missing support in ReaR<br />
for the rather special Devuan init system.</p>
<p>I had tested ReaR 2.7 with old SLES11 that has no systemd<br />
and I had no issues with the recovery system startup, cf.<br />
<a href="https://github.com/rear/rear/wiki/Test-Matrix-ReaR-2.7#sles11-sp4-with-lvm-that-is-luks-encrypted">https://github.com/rear/rear/wiki/Test-Matrix-ReaR-2.7#sles11-sp4-with-lvm-that-is-luks-encrypted</a></p>
<p>So usual traditional SysVinit is supported in ReaR 2.7<br />
at least SysVinit as used in SLES and RHEL.</p>
<h4 id="3t0n1c_commented_at_2023-03-15_1240"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1469932909">2023-03-15 12:40</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-15_1240" title="Permanent link">&para;</a></h4>
<blockquote>
<p>@3t0n1c I wonder how you could "missing the sata related module"?</p>
</blockquote>
<p>The command worked fine, when I copied and pasted the output, I missed
some stuff. The line was very long.<br />
Error on my part...</p>
<blockquote>
<p>Did a command like</p>
<pre><code># lsmod | tail -n +2 | cut -d ' ' -f 1 | tac | tr -s '[:space:]' ' '
</code></pre>
<p>and using its output as value for MODULES_LOAD in your
etc/rear/local.conf somehow not work for you?</p>
<p>Module dependencies can be rather tricky and non-obvious, cf. #1355
and see the description about 'MODULES' in default.conf
<a href="https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L1540">https://github.com/rear/rear/blob/rear-2.7/usr/share/rear/conf/default.conf#L1540</a></p>
<p>So ensure to have all modules loaded inside the ReaR recovery system
that are loaded on your original system.</p>
</blockquote>
<p>Well, I tried parted as per your instructions and no go.<br />
See screenshot below:</p>
<p><img alt="IMG_4549" src="https://user-images.githubusercontent.com/127246980/225311569-bd2c5059-928a-49ba-9341-aec984249a32.JPG" /></p>
<blockquote>
<p>How does</p>
<pre><code># parted -s /dev/sda unit GiB print
</code></pre>
<p>show your disk when called inside the ReaR recovery system?</p>
<p>Does it work to manually use 'parted' in the recovery system like</p>
<pre><code># parted -s /dev/sda mklabel gpt
</code></pre>
<p>and if yes, what does then</p>
<pre><code># parted -s /dev/sda unit GiB print
</code></pre>
<p>show?</p>
<p>As far as I see ReaR does not call 'fdisk' but 'parted' and 'sfdisk'
only in the special case of BLOCKCLONE_STRICT_PARTITIONING.</p>
</blockquote>
<h4 id="jsmeix_commented_at_2023-03-15_1353"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1470051832">2023-03-15 13:53</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-15_1353" title="Permanent link">&para;</a></h4>
<p>On my openSUSE Leap 15.4 homeoffice laptop I get</p>
<pre><code># man lsblk
...
DESCRIPTION
  lsblk lists information about all available
  or the specified block devices.
  The lsblk command reads the sysfs filesystem
  and udev db to gather information.
  If the udev db is not available
  or lsblk is compiled without udev support,
  then it tries to read LABELs, UUIDs
  and filesystem types from the block device.
  In this case root permissions are necessary.
...

# mount
...
sysfs on /sys type sysfs ...
devtmpfs on /dev type devtmpfs ...

# ls -l /sys/dev/block/ | grep sda
lrwxrwxrwx ... 8:0 -&gt; ../../devices/pci0000:00/0000:00:1f.2/ata5/host4/target4:0:0/4:0:0:0/block/sda
lrwxrwxrwx ... 8:1 -&gt; ../../devices/pci0000:00/0000:00:1f.2/ata5/host4/target4:0:0/4:0:0:0/block/sda/sda1
lrwxrwxrwx ... 8:2 -&gt; ../../devices/pci0000:00/0000:00:1f.2/ata5/host4/target4:0:0/4:0:0:0/block/sda/sda2
...

# ls -l /dev/sda*
brw-rw---- 1 root disk 8, 0 ... /dev/sda
brw-rw---- 1 root disk 8, 1 ... /dev/sda1
brw-rw---- 1 root disk 8, 2 ... /dev/sda2
...
</code></pre>
<p>So it seems you have things only in the<br />
kernel's own (virtual) sysfs filesystem, cf.<br />
<a href="https://en.wikipedia.org/wiki/Sysfs">https://en.wikipedia.org/wiki/Sysfs</a><br />
but no device nodes in /dev<br />
(which is in my case also a virtual devtmpfs filesystem).</p>
<p>Because usually udev cares about the device nodes in /dev<br />
it seems udev (or whatever else is used for the device nodes in /dev)<br />
does not work or is missing in the ReaR recovery system for Devuan.</p>
<p>I neither know what is used in Devuan for the device nodes in /dev<br />
nor how that is used nor how to enable/start it in Devuan.</p>
<h4 id="3t0n1c_commented_at_2023-03-16_1306"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1471921526">2023-03-16 13:06</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-16_1306" title="Permanent link">&para;</a></h4>
<p>I appreciate all the help and input.<br />
I am trying to figure out what handles /dev nodes in Devuan.<br />
I believe it actually uses eudev, hence the presence of
/etc/init.d/eudev .</p>
<p>Then, under /etc/rc0.d I have a file called K02eudev.<br />
Obviously that file is a link to /etc/init.d/eudev.</p>
<p>These are the contents.<br />
Hopefully this might shed some light on what I could add/modify<br />
to the ReaR udev scripts to get this going.</p>
<pre><code>#!/bin/sh -e
### BEGIN INIT INFO
# Provides:          eudev udev
# Required-Start:    mountkernfs
# Required-Stop:     umountroot
# Default-Start:     S
# Default-Stop:      0 6
# Short-Description: Start udevd, populate /dev and load drivers.
### END INIT INFO

PATH="/lib/udev:/sbin:/bin"
NAME="udevd"
DAEMON="/sbin/udevd"
DAEMON_ARGS="--daemon"
DESC="hot-plug events dispatcher"

# we need to unmount /dev/pts/ and remount it later over the devtmpfs
unmount_devpts() {
  if mountpoint -q /dev/pts/; then
    umount -n -l /dev/pts/
  fi

  if mountpoint -q /dev/shm/; then
    umount -n -l /dev/shm/
  fi
}

# mount a devtmpfs over /dev, if somebody did not already do it
mount_devtmpfs() {
  if grep -E -q "^[^[:space:]]+ /dev devtmpfs" /proc/mounts; then
    mount -n -o remount,nosuid,size=$tmpfs_size,mode=0755 -t devtmpfs devtmpfs /dev
    return
  fi

  if ! mount -n -o nosuid,size=$tmpfs_size,mode=0755 -t devtmpfs devtmpfs /dev; then
    log_failure_msg "eudev requires devtmpfs support, $NAME not started"
    log_end_msg 1
  fi

  return 0
}

create_dev_makedev() {
  if [ -e /sbin/MAKEDEV ]; then
    ln -sf /sbin/MAKEDEV /dev/MAKEDEV
  else
    ln -sf /bin/true /dev/MAKEDEV
  fi
}

# shell version of /usr/bin/tty
my_tty() {
  [ -x /bin/readlink ] || return 0
  [ -e /proc/self/fd/0 ] || return 0
  readlink --silent /proc/self/fd/0 || true
}

warn_if_interactive() {
  if [ "$RUNLEVEL" = "S" -a "$PREVLEVEL" = "N" ]; then
    return
  fi

  TTY=$(my_tty)
  if [ -z "$TTY" -o "$TTY" = "/dev/console" -o "$TTY" = "/dev/null" ]; then
    return
  fi

  printf "\n\n\nIt has been detected that the command\n\n\t$0 $*\n\n"
  printf "has been run from an interactive shell.\n"
  printf "It will probably not do what you expect, so this script will wait\n"
  printf "60 seconds before continuing. Press ^C to stop it.\n"
  printf "RUNNING THIS COMMAND IS HIGHLY DISCOURAGED!\n\n\n\n"
  sleep 60
}

make_static_nodes() {
  [ -e /lib/modules/$(uname -r)/modules.devname ] || return 0
  [ -x /bin/kmod ] || return 0

  /bin/kmod static-nodes --format=tmpfiles --output=/proc/self/fd/1 | \
  while read type name mode uid gid age arg; do
    [ -e $name ] &amp;&amp; continue
    case "$type" in
      c|b|c!|b!) mknod -m $mode $name $type $(echo $arg | sed 's/:/ /') ;;
      d|d!) mkdir $name ;;
      *) echo "unparseable line ($type $name $mode $uid $gid $age $arg)" &gt;&amp;2 ;;
    esac

    if [ -x /sbin/restorecon ]; then
      /sbin/restorecon $name
    fi
  done
}


##############################################################################

[ -x $DAEMON ] || exit 0


# defaults
tmpfs_size="10M"

if [ -e /etc/udev/udev.conf ]; then
  . /etc/udev/udev.conf
fi

. /lib/lsb/init-functions

if [ ! -e /proc/filesystems ]; then
  log_failure_msg "eudev requires a mounted procfs, $NAME not started"
  log_end_msg 1
fi

if ! grep -q '[[:space:]]devtmpfs$' /proc/filesystems; then
  log_failure_msg "eudev requires devtmpfs support, $NAME not started"
  log_end_msg 1
fi

if [ ! -d /sys/class/ ]; then
  log_failure_msg "eudev requires a mounted sysfs, $NAME not started"
  log_end_msg 1
fi

# System processes and/or kernel threads are surrounded by brackets: [...]
if ! ps --no-headers --format args ax | egrep -q '^\['; then
  log_warning_msg "eudev does not support containers, $NAME not started"
  exit 0
fi

if [ -d /sys/class/mem/null -a ! -L /sys/class/mem/null ] || \
   [ -e /sys/block -a ! -e /sys/class/block ]; then
  log_warning_msg "CONFIG_SYSFS_DEPRECATED must not be selected"
  log_warning_msg "Booting will continue in 30 seconds but many things will be broken"
  sleep 30
fi

# When modifying this script, do not forget that between the time that the
# new /dev has been mounted and udevadm trigger has been run there will be
# no /dev/null. This also means that you cannot use the "&amp;" shell command.

case "$1" in
    start)
    if [ ! -e "/run/udev/" ]; then
        warn_if_interactive
    fi

    if [ -w /sys/kernel/uevent_helper ]; then
        echo &gt; /sys/kernel/uevent_helper
    fi

    if ! mountpoint -q /dev/; then
        unmount_devpts
        mount_devtmpfs
        [ -d /proc/1 ] || mount -n /proc
    fi

    make_static_nodes

    # clean up parts of the database created by the initramfs udev
    udevadm info --cleanup-db

    # set the SELinux context for devices created in the initramfs
    [ -x /sbin/restorecon ] &amp;&amp; /sbin/restorecon -R /dev

    log_daemon_msg "Starting $DESC" "$NAME"
    if start-stop-daemon --start --name $NAME --exec $DAEMON --quiet \
        -- $DAEMON_ARGS; then
      log_end_msg $?
    else
        log_warning_msg $?
        log_warning_msg "Waiting 15 seconds and trying to continue anyway"
        sleep 15
    fi

    log_action_begin_msg "Synthesizing the initial hotplug events (subsystems)"
    if udevadm trigger --type=subsystems --action=add; then
        log_action_end_msg $?
    else
        log_action_end_msg $?
    fi

    log_action_begin_msg "Synthesizing the initial hotplug events (devices)"
    if udevadm trigger --type=devices --action=add; then
        log_action_end_msg $?
     else
        log_action_end_msg $?
    fi

    create_dev_makedev

    # wait for the udevd childs to finish
    log_action_begin_msg "Waiting for /dev to be fully populated"
    if udevadm settle; then
        log_action_end_msg 0
    else
        log_action_end_msg 0 'timeout'
    fi
    ;;

    stop)
    log_daemon_msg "Stopping $DESC" "$NAME"
    if start-stop-daemon --stop --name $NAME --quiet --oknodo --retry 5; then
      log_end_msg $?
    else
      log_end_msg $?
    fi
    ;;

    restart)
    log_daemon_msg "Stopping $DESC" "$NAME"
    if start-stop-daemon --stop --name $NAME --quiet --oknodo --retry 5; then
      log_end_msg $?
    else
      log_end_msg $? || true
    fi

    log_daemon_msg "Starting $DESC" "$NAME"
    if start-stop-daemon --start --name $NAME --exec $DAEMON --quiet \
      -- $DAEMON_ARGS; then
      log_end_msg $?
    else
      log_end_msg $?
    fi
    ;;

    reload|force-reload)
    udevadm control --reload-rules
    ;;

    status)
    status_of_proc $DAEMON $NAME &amp;&amp; exit 0 || exit $?
    ;;

    *)
    echo "Usage: /etc/init.d/eudev {start|stop|restart|reload|force-reload|status}" &gt;&amp;2
    exit 1
    ;;
esac

exit 0
</code></pre>
<h4 id="3t0n1c_commented_at_2023-03-16_1311"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1471928789">2023-03-16 13:11</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-16_1311" title="Permanent link">&para;</a></h4>
<p>I apologize about the way the code pasted. I used the "add code" tag but
it didn't help much for obvious reasons...<br />
Perhaps I'm not doing it right.</p>
<p>Sorry!</p>
<h4 id="jsmeix_commented_at_2023-03-16_1357"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1472025060">2023-03-16 13:57</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-16_1357" title="Permanent link">&para;</a></h4>
<p>See<br />
<a href="https://github.com/rear/rear/blob/master/.github/ISSUE_TEMPLATE.md">https://github.com/rear/rear/blob/master/.github/ISSUE_TEMPLATE.md</a><br />
how to paste verbatim text like command output or file content<br />
by including it between a leading and a closing line<br />
of three backticks (othing else on those lines) like:</p>
<pre><code>```
verbatim text
```
</code></pre>
<h4 id="3t0n1c_commented_at_2023-03-16_1402"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1472040594">2023-03-16 14:02</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-16_1402" title="Permanent link">&para;</a></h4>
<blockquote>
<p>See
<a href="https://github.com/rear/rear/blob/master/.github/ISSUE_TEMPLATE.md">https://github.com/rear/rear/blob/master/.github/ISSUE_TEMPLATE.md</a>
how to paste verbatim text like command output or file content by
including it between a leading and a closing line of three backticks
(othing else on those lines) like:</p>
<p>verbatim text</p>
<p>Good to know. Thank you sir!</p>
</blockquote>
<h4 id="3t0n1c_commented_at_2023-03-16_1407"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1472049576">2023-03-16 14:07</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-16_1407" title="Permanent link">&para;</a></h4>
<p>This might also help understand how Devuan uses udev, or eudev rather.</p>
<pre><code>Is it running?
--&gt;
someuser@mybox:~$ /etc/init.d/eudev status
or
--&gt;
someuser@mybox:~$ ps -aef | grep udev

restart it:
--&gt;
someuser@mybox:~$ sudo /etc/init.d/eudev restart

eudev is a replacement for udev obviously.
Udev depends on and is integrated with systemd,
so regular udev won't work in Devuan for that reason.
</code></pre>
<p>Thanks</p>
<h4 id="jsmeix_commented_at_2023-03-16_1411"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1472056241">2023-03-16 14:11</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-16_1411" title="Permanent link">&para;</a></h4>
<p>See in default.conf the descriptions about COPY_AS_IS<br />
and the LIBS PROGS and REQUIRED_PROGS arrays<br />
how to get additional things as needed<br />
included in the ReaR recovery system.</p>
<p>This is only a first step to get some initial support<br />
in ReaR for the rather special Devuan init system<br />
for your specific case.</p>
<p>When you got the needed things of the Devuan init system<br />
included in the ReaR recovery system, you can then<br />
boot the ReaR recovery system, log in as root<br />
and - as a first trial and error step - manually<br />
do what is needed get the needed device nodes<br />
setup in /dev inside the ReaR recovery system,<br />
e.g. by running that script in<br />
<a href="https://github.com/rear/rear/issues/2955#issuecomment-1471921526">https://github.com/rear/rear/issues/2955#issuecomment-1471921526</a></p>
<p>Check what programs are called by that script because<br />
you also need all that in your recovery system.<br />
You may add a line <code>set -x</code> at the beginning of that script<br />
to print commands and their arguments as they are executed<br />
for debugging.</p>
<p>When the needed device nodes in /dev are there<br />
then you can as the next trial and error step<br />
run "rear -D recover" and see how far that goes.</p>
<p>And then step by step repeat the above procedure<br />
again and again until "rear recover" works<br />
for your specific case.</p>
<p>It is likely much more work to get general support<br />
in ReaR for the rather special Devuan init system.</p>
<h4 id="jsmeix_commented_at_2023-03-16_1413"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1472060858">2023-03-16 14:13</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-16_1413" title="Permanent link">&para;</a></h4>
<p>Perhaps you could get in contact with Devuan developers<br />
and make them aware of ReaR?</p>
<p>Perhaps they get interested so that<br />
they may even contribute to ReaR<br />
to get general support in ReaR<br />
for the Devuan init system?</p>
<h4 id="jsmeix_commented_at_2023-03-16_1426"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1472083623">2023-03-16 14:26</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-16_1426" title="Permanent link">&para;</a></h4>
<p>FYI<br />
what I found regarding 'init.d' in the ReaR sources (excerpt)</p>
<pre><code>localhost:~/rear.github.master # find usr/sbin/rear usr/share/rear -type f | xargs grep 'init\.d'
...
usr/share/rear/conf/Linux-ia64.conf:
COPY_AS_IS+=( /etc/sysconfig /etc/dev.d /etc/udev /etc/init.d /etc/modprobe.d /etc/security /etc/netplug /etc/netplug.d )
</code></pre>
<p>Because IA64 support is rather old I guess it is from times<br />
when SysVinit was in use, so e.g. something like</p>
<pre><code>COPY_AS_IS+=( ... /etc/init.d ... )
</code></pre>
<p>could be needed (and likely much more).</p>
<p>E.g. in the script in<br />
<a href="https://github.com/rear/rear/issues/2955#issuecomment-1471921526">https://github.com/rear/rear/issues/2955#issuecomment-1471921526</a><br />
I see things like 'log_failure_msg' and others are called<br />
so you need to get all that in your recovery system.</p>
<h4 id="3t0n1c_commented_at_2023-03-16_1433"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1472096322">2023-03-16 14:33</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-16_1433" title="Permanent link">&para;</a></h4>
<p>I appreciate your help.<br />
It sounds like it's becoming exponentially more complicated as we move
along with this.<br />
I posted on the Devuan help forum about ReaR.<br />
Almost 100 views, no replies as of yet.<br />
I am guessing there are not many folks that use or contribute to Devuan
that are even aware or ReaR.</p>
<p>Though this may be a dumb question.<br />
Wasn't there a version of ReaR that existed pre-systemD?<br />
If so, what are the chances it may work on Devuan?</p>
<p>I will post here if I hear back from Devuan folks.</p>
<p>Thank you</p>
<h4 id="jsmeix_commented_at_2023-03-16_1440"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1472108803">2023-03-16 14:40</a>:<a class="headerlink" href="#jsmeix_commented_at_2023-03-16_1440" title="Permanent link">&para;</a></h4>
<p>Because the Devuan init system uses 'eudev'<br />
it seems the Devuan init system is rather<br />
different compared to traditional SysVinit<br />
so I think an old ReaR version won't work.</p>
<p>I know nothing at all about 'eudev'.<br />
I notice
<a href="https://wiki.gentoo.org/wiki/Eudev">https://wiki.gentoo.org/wiki/Eudev</a><br />
for the very first time.</p>
<h4 id="3t0n1c_commented_at_2023-03-16_1845"><img src="https://avatars.githubusercontent.com/u/127246980?u=428cc17594762df04abae30abfebc669926f2ed7&v=4" width="50"><a href="https://github.com/3t0n1c">3t0n1c</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1472563870">2023-03-16 18:45</a>:<a class="headerlink" href="#3t0n1c_commented_at_2023-03-16_1845" title="Permanent link">&para;</a></h4>
<p>Quick update.<br />
So I struggled with it for a bit today.<br />
I believe I managed to get eudev to run or at least seem to run on ReaR
before the restore.<br />
So when I execute</p>
<pre><code>/etc/init.d/eudev restart
</code></pre>
<p>it restarts with no errors.<br />
Looking at the processes I can see the PID for udev change, so that
tells me it actually restarts udev.<br />
My storage still does not seem to appear in /dev/.<br />
I don't know if anyone has any other suggestions I can try, I'd be happy
to give it another shot.<br />
If not, I will reluctantly stop trying at this time in hopes that in the
near future Devuan will be supported.<br />
I will leave this issue open for the time being.</p>
<p>Thank you all!!!</p>
<p>Regards</p>
<h4 id="github-actions_commented_at_2023-05-20_0217"><img src="https://avatars.githubusercontent.com/in/15368?v=4" width="50"><a href="https://github.com/apps/github-actions">github-actions</a> commented at <a href="https://github.com/rear/rear/issues/2955#issuecomment-1555428741">2023-05-20 02:17</a>:<a class="headerlink" href="#github-actions_commented_at_2023-05-20_0217" title="Permanent link">&para;</a></h4>
<p>Stale issue message</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2024 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2023-03-07.2955.issue.closed.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/rear/rear-user-guide" class="fa fa-code-fork" style="color: #fcfcfc"> rear/rear-user-guide</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
