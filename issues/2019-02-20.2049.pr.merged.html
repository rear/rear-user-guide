<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="Relax-and-Recover (ReaR) User Guide Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Relax-and-Recover (ReaR) kind of documentation ans starting with a good User Guide."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://relax-and-recover.org/rear-user-guide/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://relax-and-recover.org/rear-user-guide/img/rear_logo_50.png"/>
    <meta property="og:image:width" content="50"/>
    <meta property="og:image:height" content="50"/>
    
    <title>#2049 PR merged: add eno-fix.rules to the RULE_FILES array #2046 - Relax-and-Recover (ReaR) User Guide Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/rear.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "#2049 PR merged: add eno-fix.rules to the RULE_FILES array #2046";
        var mkdocs_page_input_path = "issues/2019-02-20.2049.pr.merged.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', "366986045", "auto");
        ga('send', 'pageview');
      </script>
    
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../index.html" class="icon icon-home"> Relax-and-Recover (ReaR) User Guide Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/introduction.html">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/history.html">Bit of History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/getting-started.html">Getting started with ReaR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basics/configuration.html">Basic configuration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">SCENARIOS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../scenarios/index.html">Scenarios Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEVELOPMENT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../development/github-pr.html">Make a pull request with GitHub</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear27.html">Release Notes ReaR 2.7</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/rear26.html">Release Notes ReaR 2.6</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../releasenotes/knownproblems.html">Known Problems and Workarounds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">ISSUES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Issues History</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Relax-and-Recover (ReaR) User Guide Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
      <li class="breadcrumb-item active">#2049 PR merged: add eno-fix.rules to the RULE_FILES array #2046</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="2049_pr_merged_add_eno-fixrules_to_the_rule_files_array_2046"><a href="https://github.com/rear/rear/pull/2049">#2049 PR</a> <code>merged</code>: add eno-fix.rules to the RULE_FILES array #2046<a class="headerlink" href="#2049_pr_merged_add_eno-fixrules_to_the_rule_files_array_2046" title="Permanent link">&para;</a></h1>
<p><strong>Labels</strong>: <code>enhancement</code>, <code>fixed / solved / done</code></p>
<h4 id="gdha_opened_issue_at_2019-02-20_0701"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> opened issue at <a href="https://github.com/rear/rear/pull/2049">2019-02-20 07:01</a>:<a class="headerlink" href="#gdha_opened_issue_at_2019-02-20_0701" title="Permanent link">&para;</a></h4>
<p>Signed-off-by: Gratien D'haese <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#103;&#114;&#97;&#116;&#105;&#101;&#110;&#46;&#100;&#104;&#97;&#101;&#115;&#101;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">&#103;&#114;&#97;&#116;&#105;&#101;&#110;&#46;&#100;&#104;&#97;&#101;&#115;&#101;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;</a></p>
<ul>
<li>
<p>Type: <strong>Enhancement</strong></p>
</li>
<li>
<p>Impact: <strong>Low</strong></p>
</li>
<li>
<p>Reference to related issue (URL): #2046</p>
</li>
<li>
<p>How was this pull request tested? at the customer site with success</p>
</li>
<li>
<p>Brief description of the changes in this pull request: See #2046
    for the full problem description.</p>
</li>
</ul>
<blockquote>
<p>What we found is that Red Hat Enterprise Linux 7 virtual guests using
the vmxnet3 driver on VMware hypervisors have names such as
eno16780032 instead of an expected name such as ens192 (scheme 2).
Unfortunately, this can lead to not only inconsistent network device
names but sometimes network loss when the virtual guest machine or the
hypervisor was rebooted.</p>
</blockquote>
<h4 id="jsmeix_commented_at_2019-02-20_1023"><img src="https://avatars.githubusercontent.com/u/1788608?u=925fc54e2ce01551392622446ece427f51e2f0ce&v=4" width="50"><a href="https://github.com/jsmeix">jsmeix</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-465515118">2019-02-20 10:23</a>:<a class="headerlink" href="#jsmeix_commented_at_2019-02-20_1023" title="Permanent link">&para;</a></h4>
<p>@gdha<br />
while you are at it I would like to suggest to replace in<br />
usr/share/rear/finalize/GNU/Linux/310_migrate_udev_rules.sh</p>
<pre><code>cp $v "$rule" $TARGET_FS_ROOT/"$rule" &gt;&amp;2
StopIfError "Could not copy '$rule' -&gt; '$TARGET_FS_ROOT/$rule'"
</code></pre>
<p>with</p>
<pre><code># Do not error out at this late state of "rear recover" (after the backup was restored) but inform the user:
cp $v "$rule" "$TARGET_FS_ROOT/$rule" || LogPrintError "Failed to copy '$rule' to '$TARGET_FS_ROOT/$rule'"
</code></pre>
<p>cf.
<a href="https://github.com/rear/rear/issues/1972#issuecomment-440251103">https://github.com/rear/rear/issues/1972#issuecomment-440251103</a><br />
and my recent adaptions in
finalize/GNU/Linux/280_migrate_uuid_tags.sh at<br />
<a href="https://github.com/rear/rear/pull/2047/commits/6b1889cbf7bed297a5a695fd01f52865c4527827#diff-5700db308d823937817e66eaa11ec7fd">https://github.com/rear/rear/pull/2047/commits/6b1889cbf7bed297a5a695fd01f52865c4527827#diff-5700db308d823937817e66eaa11ec7fd</a></p>
<h4 id="gdha_commented_at_2019-03-05_1258"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-469670336">2019-03-05 12:58</a>:<a class="headerlink" href="#gdha_commented_at_2019-03-05_1258" title="Permanent link">&para;</a></h4>
<p>@rmetrich Will tis little fix be included in the RHEL rear-2.0 or
rear-2.4 release?</p>
<h4 id="rmetrich_commented_at_2019-03-05_1301"><img src="https://avatars.githubusercontent.com/u/1163635?u=36b5e32e1dd55f1ce77cad431a5683fce40a7934&v=4" width="50"><a href="https://github.com/rmetrich">rmetrich</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-469671120">2019-03-05 13:01</a>:<a class="headerlink" href="#rmetrich_commented_at_2019-03-05_1301" title="Permanent link">&para;</a></h4>
<p>@gdha I don't think so, not now at least, we had no customer facing
this.</p>
<h4 id="rmetrich_commented_at_2019-03-05_1302"><img src="https://avatars.githubusercontent.com/u/1163635?u=36b5e32e1dd55f1ce77cad431a5683fce40a7934&v=4" width="50"><a href="https://github.com/rmetrich">rmetrich</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-469671414">2019-03-05 13:02</a>:<a class="headerlink" href="#rmetrich_commented_at_2019-03-05_1302" title="Permanent link">&para;</a></h4>
<p>@pcahyna is dealing with RHEL ReaR package.</p>
<h4 id="pcahyna_commented_at_2019-03-05_1326"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-469678636">2019-03-05 13:26</a>:<a class="headerlink" href="#pcahyna_commented_at_2019-03-05_1326" title="Permanent link">&para;</a></h4>
<p>I don't remember any report about ReaR on VMware. I suspect ReaR is most
used on physical machines or LPARs.<br />
How does the problem manifest itself? Is it loss of network connectivity
in the rescue system?</p>
<h4 id="gdha_commented_at_2019-03-05_1356"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-469688311">2019-03-05 13:56</a>:<a class="headerlink" href="#gdha_commented_at_2019-03-05_1356" title="Permanent link">&para;</a></h4>
<p>@pcahyna @rmetrich Within the Johnson &amp; Johnson group we have quite a
few VMware systems suffering from this missing file in the udev rule (at
least from systems build with RHEL 7.2 or 7.3):<br />
<em>During the recovery we had issues with:</em></p>
<pre><code>LAN interface name being ens192 instead of "eno16780032"
LAN interface name being ens224 instead of "eno33559296"
</code></pre>
<p>In a following up session we modified</p>
<pre><code>RULE_FILES=( /etc/udev/rules.d/*persistent*{names,net}.rules /etc/udev/rules.d/*eno-fix.rules )
</code></pre>
<p>in script
<code>skel/default/etc/scripts/system-setup.d/55-migrate-network-devices.sh</code>
which activated LAN interface migration questions during the recovery
booting and we could apply our IP addresses on the new interfaces
correctly.<br />
Our DR recovery went fluent afterwards.</p>
<h4 id="pcahyna_commented_at_2019-03-05_1441"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-469704691">2019-03-05 14:41</a>:<a class="headerlink" href="#pcahyna_commented_at_2019-03-05_1441" title="Permanent link">&para;</a></h4>
<p>Ah, so the network interfaces will have different names in the rescue
system. Is that really a problem after @rmetrich's #2004 is integrated?</p>
<h4 id="gdha_commented_at_2019-03-05_1504"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-469714062">2019-03-05 15:04</a>:<a class="headerlink" href="#gdha_commented_at_2019-03-05_1504" title="Permanent link">&para;</a></h4>
<p>@pcahyna <strong>yes</strong>, as the <code>/etc/udev/rules.d/90-eno-fix.rules</code> overrules
the ifcfg files.<br />
However, if we remove the <code>/etc/udev/rules.d/90-eno-fix.rules</code> via
<code>BACKUP_RESTORE_MOVE_AWAY_FILES=( /etc/udev/rules.d/90-eno-fix.rules )</code>
setting in the <code>local.conf</code> then <strong>no</strong><br />
So, if you let me know in which release of RHEL rear the #2004 will be
included we can fix this via our internal rear chef cookbook.</p>
<h4 id="pcahyna_commented_at_2019-03-05_1740"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-469778586">2019-03-05 17:40</a>:<a class="headerlink" href="#pcahyna_commented_at_2019-03-05_1740" title="Permanent link">&para;</a></h4>
<blockquote>
<p>@pcahyna <strong>yes</strong>, as the <code>/etc/udev/rules.d/90-eno-fix.rules</code>
overrules the ifcfg files.</p>
</blockquote>
<p>Does that mean that (with #2004 and without this PR) the rescue system
will work, but the restored system will be wrongly configured? I.e. even
with #2004 included, we should include this PR?</p>
<blockquote>
<p>However, if we remove the <code>/etc/udev/rules.d/90-eno-fix.rules</code> via
<code>BACKUP_RESTORE_MOVE_AWAY_FILES=( /etc/udev/rules.d/90-eno-fix.rules )</code>
setting in the <code>local.conf</code> then <strong>no</strong><br />
So, if you let me know in which release of RHEL rear the #2004 will
be included we can fix this via our internal rear chef cookbook.</p>
</blockquote>
<p>We intend to include #2004 in the next update.</p>
<h4 id="gdha_commented_at_2019-03-06_0801"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-470007425">2019-03-06 08:01</a>:<a class="headerlink" href="#gdha_commented_at_2019-03-06_0801" title="Permanent link">&para;</a></h4>
<blockquote>
<blockquote>
<p>@pcahyna <strong>yes</strong>, as the <code>/etc/udev/rules.d/90-eno-fix.rules</code>
overrules the ifcfg files.</p>
</blockquote>
<p>Does that mean that (with #2004 and without this PR) the rescue
system will work, but the restored system will be wrongly configured?
I.e. even with #2004 included, we should include this PR?</p>
</blockquote>
<p>Yes that is what we discovered. My advise would be to include it as it
targets only a small group of VMware users and cannot do any harm for
the others</p>
<blockquote>
<p>We intend to include #2004 in the next update.</p>
</blockquote>
<p>Great news.</p>
<h4 id="pcahyna_commented_at_2019-03-06_1430"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-470127782">2019-03-06 14:30</a>:<a class="headerlink" href="#pcahyna_commented_at_2019-03-06_1430" title="Permanent link">&para;</a></h4>
<p>I can not reproduce the underlying issue on VMWare ESXi 5.5 btw. in RHEL
7.2 using the vmxnet3 driver. The network interface is called ens192
instead of eno <em>something</em>.</p>
<h4 id="pcahyna_commented_at_2019-03-06_1441"><img src="https://avatars.githubusercontent.com/u/26300485?u=9105d243bc9f7ade463a3e52e8dd13fa67837158&v=4" width="50"><a href="https://github.com/pcahyna">pcahyna</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-470131822">2019-03-06 14:41</a>:<a class="headerlink" href="#pcahyna_commented_at_2019-03-06_1441" title="Permanent link">&para;</a></h4>
<p>This approach of adding special cases to the code does not seem to be
well maintainable. Would it be possible to recreate the host
configuration in the rescue system as faithfully as possible by adding
everything under /etc/udev/rules.d/ ?</p>
<h4 id="gdha_commented_at_2019-03-06_1454"><img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50"><a href="https://github.com/gdha">gdha</a> commented at <a href="https://github.com/rear/rear/pull/2049#issuecomment-470136724">2019-03-06 14:54</a>:<a class="headerlink" href="#gdha_commented_at_2019-03-06_1454" title="Permanent link">&para;</a></h4>
<p>@pcahyna if you want to simulate the behavior under your test
environment you can do the following:</p>
<p>cd /etc/sysconfig/network-scripts<br />
mkdir backup</p>
<p>cp ifcfg-ens224 backup<br />
ethtool -P ens224<br />
mv ifcfg-ens224 ifcfg-eno33559296</p>
<p>cp ifcfg-ens192 backup<br />
ethtool -P ens192<br />
mv ifcfg-ens192 ifcfg-eno16780032</p>
<p>vi ifcfg-eno33559296<br />
and comment the line starting with HWADDR<br />
and rename ens224 into eno33559296</p>
<p>vi ifcfg-eno16780032<br />
and comment the line starting with HWADDR<br />
and rename ens192 eno16780032</p>
<p>cd /etc/udev/rules.d/<br />
vi 90-eno-fix.rules<br />
[expected output]</p>
<pre><code>   # This file was automatically generated on systemd update
   SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="00:50:56:9b:99:d6", NAME="eno16780032"
   SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="00:50:56:9b:89:98", NAME="eno33559296"

 ==&gt; change MAC addresses of two lines with above info from 'ethtool' command
</code></pre>
<p>Reboot the system</p>
<hr />
<p>[Export of Github issue for
<a href="https://github.com/rear/rear">rear/rear</a>.]</p>
              
            </div>
          </div>

<footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2023 - CC0 1.0 Universal<br />Give <a href="https://github.com/rear/rear-user-guide/issues/new?title=issues/2019-02-20.2049.pr.merged.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
