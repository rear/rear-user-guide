[\#373 Issue](https://github.com/rear/rear/issues/373) `closed`: More than 128 disks not allowed
================================================================================================

**Labels**: `enhancement`, `support / question`

#### <img src="https://avatars.githubusercontent.com/u/4814297?v=4" width="50">[sanderu](https://github.com/sanderu) opened issue at [2014-03-03 09:24](https://github.com/rear/rear/issues/373):

When trying to create an image (mkbackup) I get an error telling me that
more than 128 partitions are not allowed.

The server is an Oracle DB server with multipathing and has more than
128 disks, not partitions.

Output from "df -h":

    $ df -h
    Filesystem                         Size  Used Avail Use% Mounted on
    /dev/mapper/system-root            7.7G  4.8G  2.6G  66% /
    tmpfs                               63G  633M   63G   1% /dev/shm
    /dev/sdbk1                         591M  313M  248M  56% /boot
    /dev/mapper/system-home           1008M  328M  630M  35% /home
    /dev/mapper/system-var             7.7G  6.1G  1.3G  84% /var
    /dev/mapper/gridclu-12              40G  9.8G   30G  25% /global/clu/12.1.0
    /dev/mapper/gridclu-clubase         20G   15G  5.1G  75% /global/clu/clubase
    /dev/mapper/oracledev-12            40G  5.1G   35G  13% /global/dev/12.1.0
    /dev/mapper/oracledev-orabase       20G  8.2G   12G  42% /global/dev/orabase
    /dev/mapper/oraclepreprod-12        40G  5.1G   35G  13% /global/preprod/12.1.0
    /dev/mapper/oraclepreprod-orabase   20G  5.6G   15G  29% /global/preprod/orabase
    /dev/mapper/oracleprod-12           40G  5.0G   35G  13% /global/prod/12.1.0
    /dev/mapper/oracleprod-orabase      20G  5.4G   15G  28% /global/prod/orabase
    /dev/mapper/oracletest-12           40G  5.1G   35G  13% /global/test/12.1.0
    /dev/mapper/oracletest-orabase      20G  5.3G   15G  27% /global/test/orabase
    /dev/asm/voltsmconf-308             10G  977M  9.1G  10% /global/oraadmin
    /dev/asm/voldump-308               489G  307G  183G  63% /global/orahotbackup

Output from rear-SERVERNAME.log:

    ++ partition_name=/dev/mapper/mpathcp
    ++ partition_name=mapper/mpathcp
    ++ partition_name=mpathcp
    +++ get_partition_number mpathcp
    +++ local partition=mpathcp
    ++++ echo mpathcp
    ++++ grep -o -E '[0-9]+$'
    +++ local number=
    +++ '[' -gt 0 ']'
    +++ StopIfError 'Partition number '\'''\'' of partition mpathcp is not a valid number.'
    +++ ((  2 != 0  ))
    +++ Error 'Partition number '\'''\'' of partition mpathcp is not a valid number.'
    +++ '[' Partition number ''\'''\''' of partition mpathcp is not a valid number. -eq Partition number ''\'''\''' of partition mpathcp is not a valid number. ']'
    +++ EXIT_CODE=1
    +++ VERBOSE=1
    +++ LogPrint 'ERROR: Partition number '\'''\'' of partition mpathcp is not a valid number.'
    +++ Log 'ERROR: Partition number '\'''\'' of partition mpathcp is not a valid number.'
    +++ test 1 -gt 0
    ++++ Stamp
    ++++ date '+%Y-%m-%d %H:%M:%S '
    +++ echo '2014-03-03 01:31:10 ERROR: Partition number '\'''\'' of partition mpathcp is not a valid number.'
    2014-03-03 01:31:10 ERROR: Partition number '' of partition mpathcp is not a valid number.
    +++ Print 'ERROR: Partition number '\'''\'' of partition mpathcp is not a valid number.'
    +++ test 1
    +++ echo -e 'ERROR: Partition number '\'''\'' of partition mpathcp is not a valid number.'
    +++ has_binary caller
    +++ for bin in '$@'
    +++ type caller
    +++ return 0
    +++ echo '=== Stack trace ==='
    === Stack trace ===
    +++ local c=0
    +++ caller 0
    +++ awk '
                                    { l[NR]=$3":"$1" "$2 }
                                    END { for (i=NR; i>0;) print "Trace "NR-i": "l[i--] }
    +++ :
    +++ caller 1
                            '
    +++ :
    +++ caller 2
    +++ :
    +++ caller 3
    +++ :
    +++ caller 4
    +++ :
    +++ caller 5
    +++ :
    +++ caller 6
    +++ :
    +++ caller 7
    +++ :
    +++ caller 8
    Trace 0: /usr/sbin/rear:249 main
    Trace 1: /usr/share/rear/lib/mkrescue-workflow.sh:33 WORKFLOW_mkrescue
    Trace 2: /usr/share/rear/lib/framework-functions.sh:79 SourceStage
    Trace 3: /usr/share/rear/lib/framework-functions.sh:40 Source
    Trace 4: /usr/share/rear/layout/save/GNU/Linux/28_multipath_layout.sh:24 source
    Trace 5: /usr/share/rear/layout/save/GNU/Linux/20_partition_layout.sh:60 extract_partitions
    Trace 6: /usr/share/rear/lib/layout-functions.sh:326 get_partition_number
    Trace 7: /usr/share/rear/lib/_input-output-functions.sh:131 StopIfError
    +++ echo 'Message: Partition number '\'''\'' of partition mpathcp is not a valid number.'
    Message: Partition number '' of partition mpathcp is not a valid number.
    +++ echo ===================
    ===================
    +++ kill -USR1 16629
    +++ ((   <= 128  ))
    /usr/share/rear/lib/layout-functions.sh: line 329: ((: <= 128 : syntax error: operand expected (error token is "<= 128 ")
    +++ StopIfError 'Partition mpathcp is numbered '\'''\''. More than 128 partitions is not supported.'
    +++ ((  1 != 0  ))
    +++ Error 'Partition mpathcp is numbered '\'''\''. More than 128 partitions is not supported.'
    +++ '[' Partition mpathcp is numbered ''\'''\''.' More than 128 partitions is not supported. -eq Partition mpathcp is numbered ''\'''\''.' More than 128 partitions is not supported. ']'
    +++ EXIT_CODE=1
    +++ VERBOSE=1
    +++ LogPrint 'ERROR: Partition mpathcp is numbered '\'''\''. More than 128 partitions is not supported.'
    +++ Log 'ERROR: Partition mpathcp is numbered '\'''\''. More than 128 partitions is not supported.'
    +++ test 1 -gt 0
    ++++ Stamp
    ++++ date '+%Y-%m-%d %H:%M:%S '
    +++ echo '2014-03-03 01:31:10 ERROR: Partition mpathcp is numbered '\'''\''. More than 128 partitions is not supported.'
    2014-03-03 01:31:10 ERROR: Partition mpathcp is numbered ''. More than 128 partitions is not supported.
    +++ Print 'ERROR: Partition mpathcp is numbered '\'''\''. More than 128 partitions is not supported.'
    +++ test 1
    +++ echo -e 'ERROR: Partition mpathcp is numbered '\'''\''. More than 128 partitions is not supported.'
    +++ has_binary caller
    +++ for bin in '$@'
    +++ type caller
    +++ return 0
    +++ echo '=== Stack trace ==='
    === Stack trace ===
    +++ local c=0
    +++ caller 0
    +++ :
                            '
    +++ caller 1
    +++ :
    +++ caller 2
    +++ :
    +++ caller 3
    +++ :
    +++ caller 4
    +++ :
    +++ caller 5
    +++ :
    +++ caller 6
    +++ :
    +++ caller 7
    +++ :
    +++ caller 8
    Trace 0: /usr/sbin/rear:249 main
    Trace 1: /usr/share/rear/lib/mkrescue-workflow.sh:33 WORKFLOW_mkrescue
    Trace 2: /usr/share/rear/lib/framework-functions.sh:79 SourceStage
    Trace 3: /usr/share/rear/lib/framework-functions.sh:40 Source
    Trace 4: /usr/share/rear/layout/save/GNU/Linux/28_multipath_layout.sh:24 source
    Trace 5: /usr/share/rear/layout/save/GNU/Linux/20_partition_layout.sh:60 extract_partitions
    Trace 6: /usr/share/rear/lib/layout-functions.sh:330 get_partition_number
    Trace 7: /usr/share/rear/lib/_input-output-functions.sh:131 StopIfError
    +++ echo 'Message: Partition mpathcp is numbered '\'''\''. More than 128 partitions is not supported.'
    Message: Partition mpathcp is numbered ''. More than 128 partitions is not supported.

Output from /dev/mapper:

    crw-rw---- 1 root root 10, 58 Mar  3 07:59 control
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 gridclu-12 -> ../dm-38
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 gridclu-clubase -> ../dm-39
    lrwxrwxrwx 1 root root      7 Mar  3 07:59 mpathb -> ../dm-2
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathby -> ../dm-14
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathbz -> ../dm-27
    lrwxrwxrwx 1 root root      7 Mar  3 07:59 mpathc -> ../dm-4
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathca -> ../dm-10
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcb -> ../dm-25
    lrwxrwxrwx 1 root root      7 Mar  3 07:59 mpathcc -> ../dm-8
    lrwxrwxrwx 1 root root      7 Mar  3 07:59 mpathcd -> ../dm-7
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathce -> ../dm-11
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcf -> ../dm-17
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcg -> ../dm-16
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathch -> ../dm-22
    lrwxrwxrwx 1 root root      7 Mar  3 07:59 mpathci -> ../dm-9
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcj -> ../dm-29
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathck -> ../dm-12
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcl -> ../dm-21
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcm -> ../dm-26
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcn -> ../dm-24
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathco -> ../dm-23
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcp -> ../dm-20
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcq -> ../dm-19
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcr -> ../dm-18
    lrwxrwxrwx 1 root root      7 Mar  3 07:59 mpathcs -> ../dm-6
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathct -> ../dm-13
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcu -> ../dm-30
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcv -> ../dm-28
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcw -> ../dm-31
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathcx -> ../dm-32
    lrwxrwxrwx 1 root root      7 Mar  3 07:59 mpathd -> ../dm-3
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 mpathe -> ../dm-15
    lrwxrwxrwx 1 root root      7 Mar  3 07:59 mpathf -> ../dm-5
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 oracledev-12 -> ../dm-40
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 oracledev-orabase -> ../dm-41
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 oraclepreprod-12 -> ../dm-44
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 oraclepreprod-orabase -> ../dm-45
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 oracleprod-12 -> ../dm-36
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 oracleprod-orabase -> ../dm-37
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 oracletest-12 -> ../dm-42
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 oracletest-orabase -> ../dm-43
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 system-home -> ../dm-34
    lrwxrwxrwx 1 root root      7 Mar  3 07:59 system-root -> ../dm-0
    lrwxrwxrwx 1 root root      7 Mar  3 07:59 system-swap -> ../dm-1
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 system-swap5 -> ../dm-35
    lrwxrwxrwx 1 root root      8 Mar  3 07:59 system-var -> ../dm-33

Output from "multipath -ll":

    mpathcu (3600507680180874aa000000000000083) dm-30 IBM,2145
    size=125G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:28 sdac 65:192 active ready running
    | `- 1:0:0:28 sdcn 69:176 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:28 sdbh 67:176 active ready running
      `- 1:0:1:28 sdds 71:160 active ready running
    mpathch (3600507680180874aa00000000000007a) dm-22 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:20 sdaz 67:48  active ready running
    | `- 1:0:1:20 sddk 71:32  active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:20 sdu  65:64  active ready running
      `- 1:0:0:20 sdcf 69:48  active ready running
    mpathe (3600507680180874aa00000000000001a) dm-15 IBM,2145
    size=80G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:0  sdaf 65:240 active ready running
    | `- 1:0:1:0  sdcq 69:224 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:0  sda  8:0    active ready running
      `- 1:0:0:0  sdbl 67:240 active ready running
    mpathct (3600507680180874aa000000000000072) dm-13 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:12 sdar 66:176 active ready running
    | `- 1:0:1:12 sddc 70:160 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:12 sdm  8:192  active ready running
      `- 1:0:0:12 sdbx 68:176 active ready running
    mpathcg (3600507680180874aa000000000000074) dm-16 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:14 sdat 66:208 active ready running
    | `- 1:0:1:14 sdde 70:192 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:14 sdo  8:224  active ready running
      `- 1:0:0:14 sdbz 68:208 active ready running
    mpathd (3600507680180874aa00000000000001c) dm-3 IBM,2145
    size=80G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:2  sdah 66:16  active ready running
    | `- 1:0:1:2  sdcs 70:0   active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:2  sdc  8:32   active ready running
      `- 1:0:0:2  sdbn 68:16  active ready running
    mpathcs (3600507680180874aa00000000000006b) dm-6 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:5  sdf  8:80   active ready running
    | `- 1:0:0:5  sdbq 68:64  active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:5  sdak 66:64  active ready running
      `- 1:0:1:5  sdcv 70:48  active ready running
    mpathcf (3600507680180874aa000000000000076) dm-17 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:16 sdav 66:240 active ready running
    | `- 1:0:1:16 sddg 70:224 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:16 sdq  65:0   active ready running
      `- 1:0:0:16 sdcb 68:240 active ready running
    mpathc (3600507680180874aa00000000000001d) dm-4 IBM,2145
    size=80G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:3  sdd  8:48   active ready running
    | `- 1:0:0:3  sdbo 68:32  active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:3  sdai 66:32  active ready running
      `- 1:0:1:3  sdct 70:16  active ready running
    mpathbz (3600507680180874aa00000000000007f) dm-27 IBM,2145
    size=50G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:25 sdz  65:144 active ready running
    | `- 1:0:0:25 sdck 69:128 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:25 sdbe 67:128 active ready running
      `- 1:0:1:25 sddp 71:112 active ready running
    mpathcr (3600507680180874aa000000000000075) dm-18 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:15 sdp  8:240  active ready running
    | `- 1:0:0:15 sdca 68:224 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:15 sdau 66:224 active ready running
      `- 1:0:1:15 sddf 70:208 active ready running
    mpathce (3600507680180874aa000000000000070) dm-11 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:10 sdap 66:144 active ready running
    | `- 1:0:1:10 sdda 70:128 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:10 sdk  8:160  active ready running
      `- 1:0:0:10 sdbv 68:144 active ready running
    mpathb (3600507680180874aa00000000000001b) dm-2 IBM,2145
    size=80G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:1  sdb  8:16   active ready running
    | `- 1:0:0:1  sdbm 68:0   active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:1  sdag 66:0   active ready running
      `- 1:0:1:1  sdcr 69:240 active ready running
    mpathby (3600507680180874aa000000000000073) dm-14 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:13 sdn  8:208  active ready running
    | `- 1:0:0:13 sdby 68:192 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:13 sdas 66:192 active ready running
      `- 1:0:1:13 sddd 70:176 active ready running
    mpathcq (3600507680180874aa000000000000077) dm-19 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:17 sdr  65:16  active ready running
    | `- 1:0:0:17 sdcc 69:0   active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:17 sdaw 67:0   active ready running
      `- 1:0:1:17 sddh 70:240 active ready running
    mpathcd (3600507680180874aa00000000000006c) dm-7 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:6  sdal 66:80  active ready running
    | `- 1:0:1:6  sdcw 70:64  active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:6  sdg  8:96   active ready running
      `- 1:0:0:6  sdbr 68:80  active ready running
    mpathcp (3600507680180874aa000000000000078) dm-20 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:18 sdax 67:16  active ready running
    | `- 1:0:1:18 sddi 71:0   active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:18 sds  65:32  active ready running
      `- 1:0:0:18 sdcd 69:16  active ready running
    mpathcc (3600507680180874aa00000000000006d) dm-8 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:7  sdh  8:112  active ready running
    | `- 1:0:0:7  sdbs 68:96  active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:7  sdam 66:96  active ready running
      `- 1:0:1:7  sdcx 70:80  active ready running
    mpathco (3600507680180874aa00000000000007b) dm-23 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:21 sdv  65:80  active ready running
    | `- 1:0:0:21 sdcg 69:64  active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:21 sdba 67:64  active ready running
      `- 1:0:1:21 sddl 71:48  active ready running
    mpathcb (3600507680180874aa00000000000007c) dm-25 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:22 sdbb 67:80  active ready running
    | `- 1:0:1:22 sddm 71:64  active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:22 sdw  65:96  active ready running
      `- 1:0:0:22 sdch 69:80  active ready running
    mpathcn (3600507680180874aa00000000000007d) dm-24 IBM,2145
    size=50G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:23 sdx  65:112 active ready running
    | `- 1:0:0:23 sdci 69:96  active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:23 sdbc 67:96  active ready running
      `- 1:0:1:23 sddn 71:80  active ready running
    mpathca (3600507680180874aa00000000000006f) dm-10 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:9  sdj  8:144  active ready running
    | `- 1:0:0:9  sdbu 68:128 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:9  sdao 66:128 active ready running
      `- 1:0:1:9  sdcz 70:112 active ready running
    mpathcm (3600507680180874aa00000000000007e) dm-26 IBM,2145
    size=50G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:24 sdbd 67:112 active ready running
    | `- 1:0:1:24 sddo 71:96  active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:24 sdy  65:128 active ready running
      `- 1:0:0:24 sdcj 69:112 active ready running
    mpathcl (3600507680180874aa000000000000079) dm-21 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:19 sdt  65:48  active ready running
    | `- 1:0:0:19 sdce 69:32  active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:19 sday 67:32  active ready running
      `- 1:0:1:19 sddj 71:16  active ready running
    mpathcx (3600507680180874aa000000000000084) dm-32 IBM,2145
    size=125G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:29 sdbi 67:192 active ready running
    | `- 1:0:1:29 sddt 71:176 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:29 sdad 65:208 active ready running
      `- 1:0:0:29 sdco 69:192 active ready running
    mpathck (3600507680180874aa000000000000071) dm-12 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:11 sdl  8:176  active ready running
    | `- 1:0:0:11 sdbw 68:160 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:11 sdaq 66:160 active ready running
      `- 1:0:1:11 sddb 70:144 active ready running
    mpathcw (3600507680180874aa000000000000085) dm-31 IBM,2145
    size=125G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:0:30 sdae 65:224 active ready running
    | `- 1:0:0:30 sdcp 69:208 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:1:30 sdbj 67:208 active ready running
      `- 1:0:1:30 sddu 71:192 active ready running
    mpathcj (3600507680180874aa000000000000080) dm-29 IBM,2145
    size=50G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:26 sdbf 67:144 active ready running
    | `- 1:0:1:26 sddq 71:128 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:26 sdaa 65:160 active ready running
      `- 1:0:0:26 sdcl 69:144 active ready running
    mpathcv (3600507680180874aa000000000000082) dm-28 IBM,2145
    size=125G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:27 sdbg 67:160 active ready running
    | `- 1:0:1:27 sddr 71:144 active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:27 sdab 65:176 active ready running
      `- 1:0:0:27 sdcm 69:160 active ready running
    mpathci (3600507680180874aa00000000000006e) dm-9 IBM,2145
    size=200G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:8  sdan 66:112 active ready running
    | `- 1:0:1:8  sdcy 70:96  active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:8  sdi  8:128  active ready running
      `- 1:0:0:8  sdbt 68:112 active ready running
    mpathf (3600507680180874aa000000000000022) dm-5 IBM,2145
    size=80G features='1 queue_if_no_path' hwhandler='0' wp=rw
    |-+- policy='round-robin 0' prio=50 status=active
    | |- 0:0:1:4  sdaj 66:48  active ready running
    | `- 1:0:1:4  sdcu 70:32  active ready running
    `-+- policy='round-robin 0' prio=10 status=enabled
      |- 0:0:0:4  sde  8:64   active ready running
      `- 1:0:0:4  sdbp 68:48  active ready running

What to do from here to make this work?

#### <img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50">[gdha](https://github.com/gdha) commented at [2014-03-04 09:58](https://github.com/rear/rear/issues/373#issuecomment-36608281):

Perhaps post the complete debug output onto a gist (so I see the
complete context).

#### <img src="https://avatars.githubusercontent.com/u/4814297?v=4" width="50">[sanderu](https://github.com/sanderu) commented at [2014-03-05 13:58](https://github.com/rear/rear/issues/373#issuecomment-36744040):

@gdha Gist created:
[https://gist.github.com/sanderu/f42bb9b94d731842c5c6](https://gist.github.com/sanderu/f42bb9b94d731842c5c6)

Let me know if you want more regarding configuration, output from
commands etc.

#### <img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50">[gdha](https://github.com/gdha) commented at [2014-03-14 18:02](https://github.com/rear/rear/issues/373#issuecomment-37677715):

@sanderu sorry for the delay. Does device mpathcp contain any partition?
Doen't understand why it is confused. It cannot be the amount of disks
as I have seen number above 380 disks already (debug file of 60MB!).
Please have a look what it already created under `var/lib/rear/layout` -
perhaps it rings a bell?

#### <img src="https://avatars.githubusercontent.com/u/4814297?v=4" width="50">[sanderu](https://github.com/sanderu) commented at [2014-03-17 06:56](https://github.com/rear/rear/issues/373#issuecomment-37789060):

@gdha No worries, the gist was long so a lot to look through.

Mpathcp does not contain any partition. All the sd\* devices used for
multipath are in the disklayout.conf mentioned in same format (disks for
mpathcp shown):

    disk /dev/sdax 214748364800 
    disk /dev/sdcd 214748364800 
    disk /dev/sddi 214748364800 
    disk /dev/sds 214748364800 

I believe you were hinting at looking for "part" like these:

    part /dev/sdbk 629145600 1048576 primary boot /dev/sdbk1
    part /dev/sdbk 299335942144 630194176 primary lvm /dev/sdbk2

Files/dirs in /var/lib/rear/layout:

    $ ls -lah /var/lib/rear/layout/*
    -rw-r--r-- 1 root root    0 Mar 17 01:30 /var/lib/rear/layout/diskdeps.conf
    -rw-r--r-- 1 root root  11K Mar 17 01:30 /var/lib/rear/layout/disklayout.conf
    -rw-r--r-- 1 root root    0 Mar 17 01:30 /var/lib/rear/layout/disktodo.conf

    /var/lib/rear/layout/config:
    total 16K
    drwxr-xr-x 2 root root 4.0K Feb  5 10:39 .
    drwxr-xr-x 4 root root 4.0K Feb  5 10:49 ..
    -rw-r--r-- 1 root root 1.4K Feb  5 10:49 df.txt
    -rw-r--r-- 1 root root  267 Feb  5 10:39 files.md5sum

    /var/lib/rear/layout/lvm:
    total 32K
    drwxr-xr-x 2 root root 4.0K Feb  5 10:49 .
    drwxr-xr-x 4 root root 4.0K Feb  5 10:49 ..
    -rw------- 1 root root 1.8K Feb  5 10:49 gridclu.cfg
    -rw------- 1 root root 1.8K Feb  5 10:49 oracledev.cfg
    -rw------- 1 root root 1.8K Feb  5 10:49 oraclepreprod.cfg
    -rw------- 1 root root 1.8K Feb  5 10:49 oracleprod.cfg
    -rw------- 1 root root 1.8K Feb  5 10:49 oracletest.cfg
    -rw------- 1 root root 3.0K Feb  5 10:49 system.cfg

but nothing that mentions mpathcp:

    $ sudo sh -c "grep -r mpathcp /var/lib/rear/layout/*"
    $ sudo sh -c "grep -r mpath /var/lib/rear/layout/*"
    /var/lib/rear/layout/disklayout.conf:lvmdev /dev/oracleprod /dev/disk/by-id/dm-uuid-mpath-3600507680180874aa00000000000001a Ye44W0-9zCZ-dice-IzzE-cnNN-UtjI-T521wl 167772160
    /var/lib/rear/layout/disklayout.conf:lvmdev /dev/gridclu /dev/disk/by-id/dm-uuid-mpath-3600507680180874aa000000000000022 2fcxX1-F4OF-gsVs-eKLq-Ubqe-9iBj-GUi01M 167772160
    /var/lib/rear/layout/disklayout.conf:lvmdev /dev/oracledev /dev/disk/by-id/dm-uuid-mpath-3600507680180874aa00000000000001d ukyCT0-XIlq-4JG3-WrDV-b82z-cWUn-Y8RrFj 167772160
    /var/lib/rear/layout/disklayout.conf:lvmdev /dev/oracletest /dev/disk/by-id/dm-uuid-mpath-3600507680180874aa00000000000001c mIDDtq-e9UD-iviI-DZaI-d8Tl-c1oE-vMhPAI 167772160
    /var/lib/rear/layout/disklayout.conf:lvmdev /dev/oraclepreprod /dev/disk/by-id/dm-uuid-mpath-3600507680180874aa00000000000001b vdaHXg-LBiW-3OC0-C9sF-xJjD-dLBW-1yA3tl 167772160
    /var/lib/rear/layout/disklayout.conf:multipath /dev/mapper/mpathcu /dev/sdac,/dev/sdbh,/dev/sdcn,/dev/sdds
    /var/lib/rear/layout/disklayout.conf:multipath /dev/mapper/mpathch /dev/sdaz,/dev/sdcf,/dev/sddk,/dev/sdu
    /var/lib/rear/layout/disklayout.conf:multipath /dev/mapper/mpathe /dev/sda,/dev/sdaf,/dev/sdbl,/dev/sdcq
    /var/lib/rear/layout/disklayout.conf:multipath /dev/mapper/mpathct /dev/sdar,/dev/sdbx,/dev/sddc,/dev/sdm
    /var/lib/rear/layout/disklayout.conf:multipath /dev/mapper/mpathcg /dev/sdat,/dev/sdbz,/dev/sdde,/dev/sdo
    /var/lib/rear/layout/disklayout.conf:multipath /dev/mapper/mpathd /dev/sdah,/dev/sdbn,/dev/sdc,/dev/sdcs
    /var/lib/rear/layout/disklayout.conf:multipath /dev/mapper/mpathcs /dev/sdak,/dev/sdbq,/dev/sdcv,/dev/sdf
    /var/lib/rear/layout/disklayout.conf:multipath /dev/mapper/mpathcf /dev/sdav,/dev/sdcb,/dev/sddg,/dev/sdq
    /var/lib/rear/layout/disklayout.conf:multipath /dev/mapper/mpathc /dev/sdai,/dev/sdbo,/dev/sdct,/dev/sdd
    /var/lib/rear/layout/lvm/oracleprod.cfg:                        device = "/dev/disk/by-id/dm-uuid-mpath-3600507680180874aa00000000000001a"      # Hint only
    /var/lib/rear/layout/lvm/gridclu.cfg:                   device = "/dev/disk/by-id/dm-uuid-mpath-3600507680180874aa000000000000022"      # Hint only
    /var/lib/rear/layout/lvm/oracledev.cfg:                 device = "/dev/disk/by-id/dm-uuid-mpath-3600507680180874aa00000000000001d"      # Hint only
    /var/lib/rear/layout/lvm/oraclepreprod.cfg:                     device = "/dev/disk/by-id/dm-uuid-mpath-3600507680180874aa00000000000001b"      # Hint only
    /var/lib/rear/layout/lvm/oracletest.cfg:                        device = "/dev/disk/by-id/dm-uuid-mpath-3600507680180874aa00000000000001c"      # Hint only

Where to go from here?

#### <img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50">[gdha](https://github.com/gdha) commented at [2014-03-20 15:34](https://github.com/rear/rear/issues/373#issuecomment-38181830):

@sanderu

    ls -l /dev/mapper/mpathcp
    ls -l /dev/dm-20
    cat /sys/block/dm-20/dev
    dmsetup info /dev/dm-20
    parted /dev/sdax print
    parted /dev/dm-20 print

I believe there are no partitions on this device, so why does rear
thinks it is partitioned?

#### <img src="https://avatars.githubusercontent.com/u/4814297?v=4" width="50">[sanderu](https://github.com/sanderu) commented at [2014-03-21 08:16](https://github.com/rear/rear/issues/373#issuecomment-38256000):

@gdha

    $ ls -l /dev/mapper/mpathcp 
    lrwxrwxrwx 1 root root 8 Mar  3 07:59 /dev/mapper/mpathcp -> ../dm-20

    $ ls -l /dev/dm-20
    brw-rw---- 1 root disk 253, 20 Mar  3 07:59 /dev/dm-20

    $ cat /sys/block/dm-20/dev
    253:20

    $ sudo dmsetup info /dev/dm-20
    Name:              mpathcp
    State:             ACTIVE
    Read Ahead:        1024
    Tables present:    LIVE
    Open count:        9
    Event number:      1
    Major, minor:      253, 20
    Number of targets: 1
    UUID: mpath-3600507680180874aa000000000000078

    $ sudo parted /dev/sdax print
    Error: /dev/sdax: unrecognised disk label

    $ sudo parted /dev/dm-20 print
    Error: /dev/dm-20: unrecognised disk label

Could it be related to the server using Oracle ASM
([http://docs.oracle.com/cd/B28359\_01/server.111/b31107/asmcon.htm\#OSTMG036](http://docs.oracle.com/cd/B28359_01/server.111/b31107/asmcon.htm#OSTMG036))
?

#### <img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50">[gdha](https://github.com/gdha) commented at [2014-03-21 15:47](https://github.com/rear/rear/issues/373#issuecomment-38289589):

@sanderu that is very interesting point. That might be the case. Anyhow,
we may not touch these kind of disks, right? The question is how can
rear identify these devices are under control of ASM? Is there a simple
command for that?

#### <img src="https://avatars.githubusercontent.com/u/4814297?v=4" width="50">[sanderu](https://github.com/sanderu) commented at [2014-03-24 07:05](https://github.com/rear/rear/issues/373#issuecomment-38416652):

@gdha  
No, we cannot touch these disks.... sorry.

However, they can be identified by using 'blkid':

    $ sudo /sbin/blkid 
    /dev/mapper/system-swap: UUID="4561d0fa-974b-404a-b585-2666c3824c76" TYPE="swap" 
    /dev/mapper/system-swap5: UUID="0d131889-a5ec-49be-81f4-99ddc8e1000a" TYPE="swap" 
    /dev/sdb: UUID="vdaHXg-LBiW-3OC0-C9sF-xJjD-dLBW-1yA3tl" TYPE="LVM2_member" 
    /dev/sdc: UUID="mIDDtq-e9UD-iviI-DZaI-d8Tl-c1oE-vMhPAI" TYPE="LVM2_member" 
    /dev/sdd: UUID="ukyCT0-XIlq-4JG3-WrDV-b82z-cWUn-Y8RrFj" TYPE="LVM2_member" 
    /dev/sde: UUID="2fcxX1-F4OF-gsVs-eKLq-Ubqe-9iBj-GUi01M" TYPE="LVM2_member" 
    /dev/sdf: LABEL="ASMDISK005" TYPE="oracleasm" 
    /dev/sdg: LABEL="ASMDISK011" TYPE="oracleasm" 
    /dev/sdh: LABEL="ASMDISK013" TYPE="oracleasm" 
    /dev/sdi: LABEL="ASMDISK022" TYPE="oracleasm" 
    /dev/sdj: LABEL="ASMDISK017" TYPE="oracleasm" 
    /dev/sdk: LABEL="ASMDISK008" TYPE="oracleasm" 
    /dev/sdl: LABEL="ASMDISK020" TYPE="oracleasm" 
    /dev/sdm: LABEL="ASMDISK003" TYPE="oracleasm" 
    /dev/sdn: LABEL="ASMDISK009" TYPE="oracleasm" 
    /dev/sdaf: UUID="Ye44W0-9zCZ-dice-IzzE-cnNN-UtjI-T521wl" TYPE="LVM2_member" 
    /dev/sdo: LABEL="ASMDISK004" TYPE="oracleasm" 
    /dev/sdq: LABEL="ASMDISK006" TYPE="oracleasm" 
    /dev/sdp: LABEL="ASMDISK007" TYPE="oracleasm" 
    /dev/sdr: LABEL="ASMDISK010" TYPE="oracleasm" 
    /dev/sdag: UUID="vdaHXg-LBiW-3OC0-C9sF-xJjD-dLBW-1yA3tl" TYPE="LVM2_member" 
    /dev/sds: LABEL="ASMDISK012" TYPE="oracleasm" 
    /dev/sdt: LABEL="ASMDISK019" TYPE="oracleasm" 
    /dev/sdu: LABEL="ASMDISK002" TYPE="oracleasm" 
    /dev/sdah: UUID="mIDDtq-e9UD-iviI-DZaI-d8Tl-c1oE-vMhPAI" TYPE="LVM2_member" 
    /dev/sdv: LABEL="ASMDISK014" TYPE="oracleasm" 
    /dev/sdx: LABEL="ASMDISK016" TYPE="oracleasm" 
    /dev/sdw: LABEL="ASMDISK015" TYPE="oracleasm" 
    /dev/sdai: UUID="ukyCT0-XIlq-4JG3-WrDV-b82z-cWUn-Y8RrFj" TYPE="LVM2_member" 
    /dev/sdy: LABEL="ASMDISK018" TYPE="oracleasm" 
    /dev/sdz: LABEL="ASMDISK001" TYPE="oracleasm" 
    /dev/sdab: LABEL="ASMDISK024" TYPE="oracleasm" 
    /dev/sdam: LABEL="ASMDISK013" TYPE="oracleasm" 
    /dev/sdax: LABEL="ASMDISK012" TYPE="oracleasm" 
    /dev/sdal: LABEL="ASMDISK011" TYPE="oracleasm" 
    /dev/sdaa: LABEL="ASMDISK021" TYPE="oracleasm" 
    /dev/sdao: LABEL="ASMDISK017" TYPE="oracleasm" 
    /dev/sdac: LABEL="ASMDISK023" TYPE="oracleasm" 
    /dev/sdaj: UUID="2fcxX1-F4OF-gsVs-eKLq-Ubqe-9iBj-GUi01M" TYPE="LVM2_member" 
    /dev/sdap: LABEL="ASMDISK008" TYPE="oracleasm" 
    /dev/sdae: LABEL="ASMDISK025" TYPE="oracleasm" 
    /dev/sdar: LABEL="ASMDISK003" TYPE="oracleasm" 
    /dev/sdaq: LABEL="ASMDISK020" TYPE="oracleasm" 
    /dev/sdaz: LABEL="ASMDISK002" TYPE="oracleasm" 
    /dev/sdad: LABEL="ASMDISK026" TYPE="oracleasm" 
    /dev/sdbb: LABEL="ASMDISK015" TYPE="oracleasm" 
    /dev/sdan: LABEL="ASMDISK022" TYPE="oracleasm" 
    /dev/sdat: LABEL="ASMDISK004" TYPE="oracleasm" 
    /dev/sdbe: LABEL="ASMDISK001" TYPE="oracleasm" 
    /dev/sdau: LABEL="ASMDISK007" TYPE="oracleasm" 
    /dev/sdak: LABEL="ASMDISK005" TYPE="oracleasm" 
    /dev/sdav: LABEL="ASMDISK006" TYPE="oracleasm" 
    /dev/sdbc: LABEL="ASMDISK016" TYPE="oracleasm" 
    /dev/sdaw: LABEL="ASMDISK010" TYPE="oracleasm" 
    /dev/sdbf: LABEL="ASMDISK021" TYPE="oracleasm" 
    /dev/sday: LABEL="ASMDISK019" TYPE="oracleasm" 
    /dev/sdbd: LABEL="ASMDISK018" TYPE="oracleasm" 
    /dev/sdbi: LABEL="ASMDISK026" TYPE="oracleasm" 
    /dev/sdbj: LABEL="ASMDISK025" TYPE="oracleasm" 
    /dev/sdbh: LABEL="ASMDISK023" TYPE="oracleasm" 
    /dev/sdba: LABEL="ASMDISK014" TYPE="oracleasm" 
    /dev/sdbm: UUID="vdaHXg-LBiW-3OC0-C9sF-xJjD-dLBW-1yA3tl" TYPE="LVM2_member" 
    /dev/sdbn: UUID="mIDDtq-e9UD-iviI-DZaI-d8Tl-c1oE-vMhPAI" TYPE="LVM2_member" 
    /dev/sdbo: UUID="ukyCT0-XIlq-4JG3-WrDV-b82z-cWUn-Y8RrFj" TYPE="LVM2_member" 
    /dev/sdbk1: UUID="71fe2df2-41d0-4855-a151-2c6e85ca354f" TYPE="ext4" 
    /dev/sdbk2: UUID="7K1NTo-CvYD-qyKx-2kF0-oNER-2SDZ-XVj66j" TYPE="LVM2_member" 
    /dev/sdbl: UUID="Ye44W0-9zCZ-dice-IzzE-cnNN-UtjI-T521wl" TYPE="LVM2_member" 
    /dev/sdbg: LABEL="ASMDISK024" TYPE="oracleasm" 
    /dev/sdbq: LABEL="ASMDISK005" TYPE="oracleasm" 
    /dev/sdbr: LABEL="ASMDISK011" TYPE="oracleasm" 
    /dev/sdbp: UUID="2fcxX1-F4OF-gsVs-eKLq-Ubqe-9iBj-GUi01M" TYPE="LVM2_member" 
    /dev/sdbv: LABEL="ASMDISK008" TYPE="oracleasm" 
    /dev/sdbt: LABEL="ASMDISK022" TYPE="oracleasm" 
    /dev/sdbw: LABEL="ASMDISK020" TYPE="oracleasm" 
    /dev/sdbs: LABEL="ASMDISK013" TYPE="oracleasm" 
    /dev/sdbx: LABEL="ASMDISK003" TYPE="oracleasm" 
    /dev/sdbz: LABEL="ASMDISK004" TYPE="oracleasm" 
    /dev/sdca: LABEL="ASMDISK007" TYPE="oracleasm" 
    /dev/sdby: LABEL="ASMDISK009" TYPE="oracleasm" 
    /dev/sdcb: LABEL="ASMDISK006" TYPE="oracleasm" 
    /dev/sdcc: LABEL="ASMDISK010" TYPE="oracleasm" 
    /dev/sdbu: LABEL="ASMDISK017" TYPE="oracleasm" 
    /dev/sdcd: LABEL="ASMDISK012" TYPE="oracleasm" 
    /dev/sdce: LABEL="ASMDISK019" TYPE="oracleasm" 
    /dev/sdcf: LABEL="ASMDISK002" TYPE="oracleasm" 
    /dev/sdcg: LABEL="ASMDISK014" TYPE="oracleasm" 
    /dev/sdci: LABEL="ASMDISK016" TYPE="oracleasm" 
    /dev/sdcj: LABEL="ASMDISK018" TYPE="oracleasm" 
    /dev/sdch: LABEL="ASMDISK015" TYPE="oracleasm" 
    /dev/sdck: LABEL="ASMDISK001" TYPE="oracleasm" 
    /dev/sdcl: LABEL="ASMDISK021" TYPE="oracleasm" 
    /dev/sdcm: LABEL="ASMDISK024" TYPE="oracleasm" 
    /dev/sdas: LABEL="ASMDISK009" TYPE="oracleasm" 
    /dev/sdco: LABEL="ASMDISK026" TYPE="oracleasm" 
    /dev/sdcp: LABEL="ASMDISK025" TYPE="oracleasm" 
    /dev/sdcs: UUID="mIDDtq-e9UD-iviI-DZaI-d8Tl-c1oE-vMhPAI" TYPE="LVM2_member" 
    /dev/sdcr: UUID="vdaHXg-LBiW-3OC0-C9sF-xJjD-dLBW-1yA3tl" TYPE="LVM2_member" 
    /dev/sdcu: UUID="2fcxX1-F4OF-gsVs-eKLq-Ubqe-9iBj-GUi01M" TYPE="LVM2_member" 
    /dev/sdct: UUID="ukyCT0-XIlq-4JG3-WrDV-b82z-cWUn-Y8RrFj" TYPE="LVM2_member" 
    /dev/sdcq: UUID="Ye44W0-9zCZ-dice-IzzE-cnNN-UtjI-T521wl" TYPE="LVM2_member" 
    /dev/sdcn: LABEL="ASMDISK023" TYPE="oracleasm" 
    /dev/sdcw: LABEL="ASMDISK011" TYPE="oracleasm" 
    /dev/sdcy: LABEL="ASMDISK022" TYPE="oracleasm" 
    /dev/sdcz: LABEL="ASMDISK017" TYPE="oracleasm" 
    /dev/sddb: LABEL="ASMDISK020" TYPE="oracleasm" 
    /dev/sddc: LABEL="ASMDISK003" TYPE="oracleasm" 
    /dev/sddd: LABEL="ASMDISK009" TYPE="oracleasm" 
    /dev/sdda: LABEL="ASMDISK008" TYPE="oracleasm" 
    /dev/sdde: LABEL="ASMDISK004" TYPE="oracleasm" 
    /dev/sddh: LABEL="ASMDISK010" TYPE="oracleasm" 
    /dev/sddk: LABEL="ASMDISK002" TYPE="oracleasm" 
    /dev/sdcv: LABEL="ASMDISK005" TYPE="oracleasm" 
    /dev/sddi: LABEL="ASMDISK012" TYPE="oracleasm" 
    /dev/sddl: LABEL="ASMDISK014" TYPE="oracleasm" 
    /dev/sddg: LABEL="ASMDISK006" TYPE="oracleasm" 
    /dev/sddn: LABEL="ASMDISK016" TYPE="oracleasm" 
    /dev/sddo: LABEL="ASMDISK018" TYPE="oracleasm" 
    /dev/sddp: LABEL="ASMDISK001" TYPE="oracleasm" 
    /dev/sddq: LABEL="ASMDISK021" TYPE="oracleasm" 
    /dev/sddr: LABEL="ASMDISK024" TYPE="oracleasm" 
    /dev/sdds: LABEL="ASMDISK023" TYPE="oracleasm" 
    /dev/sddf: LABEL="ASMDISK007" TYPE="oracleasm" 
    /dev/sddu: LABEL="ASMDISK025" TYPE="oracleasm" 
    /dev/sddm: LABEL="ASMDISK015" TYPE="oracleasm" 
    /dev/sddt: LABEL="ASMDISK026" TYPE="oracleasm" 
    /dev/sddj: LABEL="ASMDISK019" TYPE="oracleasm" 
    /dev/mapper/system-root: UUID="0ea023b8-a7b0-49f7-b865-1a2eaf42d16a" TYPE="ext4" 
    /dev/sdcx: LABEL="ASMDISK013" TYPE="oracleasm" 
    /dev/mapper/mpathb: UUID="vdaHXg-LBiW-3OC0-C9sF-xJjD-dLBW-1yA3tl" TYPE="LVM2_member" 
    /dev/mapper/mpathd: UUID="mIDDtq-e9UD-iviI-DZaI-d8Tl-c1oE-vMhPAI" TYPE="LVM2_member" 
    /dev/mapper/mpathc: UUID="ukyCT0-XIlq-4JG3-WrDV-b82z-cWUn-Y8RrFj" TYPE="LVM2_member" 
    /dev/mapper/mpathf: UUID="2fcxX1-F4OF-gsVs-eKLq-Ubqe-9iBj-GUi01M" TYPE="LVM2_member" 
    /dev/mapper/mpathcs: LABEL="ASMDISK005" TYPE="oracleasm" 
    /dev/mapper/mpathcd: LABEL="ASMDISK011" TYPE="oracleasm" 
    /dev/mapper/mpathcc: LABEL="ASMDISK013" TYPE="oracleasm" 
    /dev/mapper/mpathci: LABEL="ASMDISK022" TYPE="oracleasm" 
    /dev/mapper/mpathca: LABEL="ASMDISK017" TYPE="oracleasm" 
    /dev/mapper/mpathce: LABEL="ASMDISK008" TYPE="oracleasm" 
    /dev/mapper/mpathck: LABEL="ASMDISK020" TYPE="oracleasm" 
    /dev/mapper/mpathct: LABEL="ASMDISK003" TYPE="oracleasm" 
    /dev/mapper/mpathby: LABEL="ASMDISK009" TYPE="oracleasm" 
    /dev/mapper/mpathe: UUID="Ye44W0-9zCZ-dice-IzzE-cnNN-UtjI-T521wl" TYPE="LVM2_member" 
    /dev/mapper/mpathcg: LABEL="ASMDISK004" TYPE="oracleasm" 
    /dev/mapper/mpathcf: LABEL="ASMDISK006" TYPE="oracleasm" 
    /dev/mapper/mpathcr: LABEL="ASMDISK007" TYPE="oracleasm" 
    /dev/mapper/mpathcq: LABEL="ASMDISK010" TYPE="oracleasm" 
    /dev/mapper/mpathcp: LABEL="ASMDISK012" TYPE="oracleasm" 
    /dev/mapper/mpathcl: LABEL="ASMDISK019" TYPE="oracleasm" 
    /dev/mapper/mpathch: LABEL="ASMDISK002" TYPE="oracleasm" 
    /dev/mapper/mpathco: LABEL="ASMDISK014" TYPE="oracleasm" 
    /dev/mapper/mpathcn: LABEL="ASMDISK016" TYPE="oracleasm" 
    /dev/mapper/mpathcb: LABEL="ASMDISK015" TYPE="oracleasm" 
    /dev/mapper/mpathcm: LABEL="ASMDISK018" TYPE="oracleasm" 
    /dev/mapper/mpathbz: LABEL="ASMDISK001" TYPE="oracleasm" 
    /dev/mapper/mpathcv: LABEL="ASMDISK024" TYPE="oracleasm" 
    /dev/mapper/mpathcj: LABEL="ASMDISK021" TYPE="oracleasm" 
    /dev/mapper/mpathcu: LABEL="ASMDISK023" TYPE="oracleasm" 
    /dev/mapper/mpathcw: LABEL="ASMDISK025" TYPE="oracleasm" 
    /dev/mapper/mpathcx: LABEL="ASMDISK026" TYPE="oracleasm" 
    /dev/mapper/system-var: UUID="65976a7c-14ed-4b3b-8ddb-43c7bf54da7f" TYPE="ext4" 
    /dev/mapper/system-home: UUID="9daa6d27-cb29-4594-a42c-78d5b945fa39" TYPE="ext4" 
    /dev/mapper/oracleprod-12: UUID="69f4540d-4e8b-4c4a-8cb5-05a3f0c86a50" TYPE="ext4" 
    /dev/mapper/oracleprod-orabase: UUID="0ec8434d-2ec0-4e94-8ffb-b9b0baaa70b9" TYPE="ext4" 
    /dev/mapper/gridclu-12: UUID="3faa47ca-2062-4b21-9d17-4d192320a7f6" TYPE="ext4" 
    /dev/mapper/gridclu-clubase: UUID="cac3a44f-7b28-4b3b-b18b-98fd39206f47" TYPE="ext4" 
    /dev/mapper/oracledev-12: UUID="bd0fe251-d582-4ea5-8ec2-78d321c06ca0" TYPE="ext4" 
    /dev/mapper/oracledev-orabase: UUID="c0db4a71-7030-405f-8a1f-ea391f17cd3b" TYPE="ext4" 
    /dev/mapper/oracletest-12: UUID="efd29bf7-b341-445a-a1e8-5ae19f0150f4" TYPE="ext4" 
    /dev/mapper/oracletest-orabase: UUID="1a15bd7f-40c6-470e-8bac-ceddada7edc2" TYPE="ext4" 
    /dev/mapper/oraclepreprod-12: UUID="a9da5388-875e-4c32-ae11-836bfd06a10c" TYPE="ext4" 
    /dev/mapper/oraclepreprod-orabase: UUID="612fd8f5-93e0-459e-904f-8be4a404b673" TYPE="ext4" 
    /dev/mapper/oracledev-11: UUID="fe161bd7-e51e-4b48-b1f4-5fb2075debd3" TYPE="ext4" 
    /dev/mapper/oracletest-11: UUID="eb4c6bcf-1940-49a3-a0e5-5482d4532350" TYPE="ext4" 
    /dev/mapper/oracleprod-11: UUID="220ecfae-9e9c-4cef-88a1-fbf9380a000e" TYPE="ext4" 
    /dev/mapper/oraclepreprod-11: UUID="6d5d806a-17ba-41a1-ad71-960b6a69a629" TYPE="ext4" 
    /dev/mapper/mpathcy: LABEL="ASMDISK027" TYPE="oracleasm" 
    /dev/mapper/mpathcz: LABEL="ASMDISK028" TYPE="oracleasm" 

    $ sudo /sbin/blkid  | wc -l
    177

When taking ASM into account, the needed binary tools may also be
needed:

    $ which oracleasm
    /usr/sbin/oracleasm
    $ which oracleasm-discover
    /usr/sbin/oracleasm-discover

Perhaps this is of help for the "ASM" creation on recovery:  
[http://docs.oracle.com/cd/E11882\_01/server.112/e18951/asmca.htm\#CHDGGBFB](http://docs.oracle.com/cd/E11882_01/server.112/e18951/asmca.htm#CHDGGBFB)

#### <img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50">[gdha](https://github.com/gdha) commented at [2014-03-25 11:29](https://github.com/rear/rear/issues/373#issuecomment-38553577):

@sanderu I strongly believe that Oracle ASM recovery is out-of-scope of
rear. If you believe that it is important to have those oracle
executable available during recovery you can easily add them via a prep
script, e.g. as an example
`/usr/share/rear/prep/GNU/Linux/22_include_lvm_tools.sh`

#### <img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50">[gdha](https://github.com/gdha) commented at [2014-04-01 14:23](https://github.com/rear/rear/issues/373#issuecomment-39210868):

@sanderu perhaps we could excluded the TYPE="oracleasm" disks from being
touched (comment these out) in the `disklayout.conf` file?

#### <img src="https://avatars.githubusercontent.com/u/4814297?v=4" width="50">[sanderu](https://github.com/sanderu) commented at [2014-04-08 10:17](https://github.com/rear/rear/issues/373#issuecomment-39831960):

@gdha I agree that Oracle ASM recovery is out-of-scope for rear.

Excluding oracleasm disks from <code>disklayout.conf</code> could be an
idea.  
However, the disks are not listed in <code>disklayout.conf</code> as
oracleasm disks - they are listed as /dev/sdXX and are only detectable
as oracleasm using blkid if I'm not mistaken.

But shouldn't rear be able to at least keep track of the
devices/multipaths to ensure disklayout is the same ?

#### <img src="https://avatars.githubusercontent.com/u/6906300?v=4" width="50">[Thitho007](https://github.com/Thitho007) commented at [2014-06-17 16:06](https://github.com/rear/rear/issues/373#issuecomment-46328211):

I currently have the same problem.  
The server also has many LUNs (Oracle RAC with ASM)

I think the problem lies elsewhere.

The problem is that if there are more than 42 LUNs on the system, you
can end up with devices called mpatha and mpathap.

In fact, in the extract\_partitions function in file
`/usr/share/rear/layout/save/GNU/Linux/20_partition_layout.sh` when the
script tries to find partition on device "mpatha", it finds a device
named "mpathap" instead of the partition p(number) of the device
"mpatha".

Below the patch:

    --- /usr/share/rear/layout/save/GNU/Linux/20_partition_layout.sh        2014-06-17 13:31:49.092529337 +0200
    +++ /usr/share/rear/layout/save/GNU/Linux/20_partition_layout.sh_OK     2014-06-17 13:31:39.869538531 +0200
    @@ -35,7 +35,7 @@
         if [[ ${#sysfs_paths[@]} -eq 0 ]] ; then
             ### try to find partitions like /dev/mapper/datalun1p1
             if [[ ${device/mapper//} != ${device} ]] ; then
    -            for path in ${device}p* ${device}-part*  ${device}_part*; do
    +            for path in ${device}p[0-9]* ${device}-part*  ${device}_part*; do
                     sysfs_path=$(get_sysfs_name $path)
                     if [[ "$sysfs_path" ]] && [[ -e "/sys/block/$sysfs_path" ]] ; then
                         sysfs_paths=( "${sysfs_paths[@]}" "/sys/block/$sysfs_path" )

Tested and verified on rhel 6.4.

PS: Sorry for my bad English

#### <img src="https://avatars.githubusercontent.com/u/432453?v=4" width="50">[clausa](https://github.com/clausa) commented at [2014-06-18 09:09](https://github.com/rear/rear/issues/373#issuecomment-46412209):

@Thitho007 Good catch

Working with @sanderu and I can confirm that the patch solved our
problem :-)

#### <img src="https://avatars.githubusercontent.com/u/6906300?v=4" width="50">[Thitho007](https://github.com/Thitho007) commented at [2014-06-18 09:45](https://github.com/rear/rear/issues/373#issuecomment-46415400):

@clausa Glad to hear that :-)

@gdha I'm a noob with Github :-(  
I try to submit you a pull request. Hope it's OK.

#### <img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50">[gdha](https://github.com/gdha) commented at [2014-06-20 14:02](https://github.com/rear/rear/issues/373#issuecomment-46681031):

@Thitho007 thank you for fixing the issue. We keep it open for a time
for feedback etc...

#### <img src="https://avatars.githubusercontent.com/u/4814297?v=4" width="50">[sanderu](https://github.com/sanderu) commented at [2014-07-23 05:05](https://github.com/rear/rear/issues/373#issuecomment-49833355):

@gdha I can confirm the fix is working.  
@Thitho007 Thanks for the fix - you really saved the day.

#### <img src="https://avatars.githubusercontent.com/u/888633?u=cdaeb31efcc0048d3619651aa18dd4b76e636b21&v=4" width="50">[gdha](https://github.com/gdha) commented at [2015-11-18 13:18](https://github.com/rear/rear/issues/373#issuecomment-157709838):

Some interesting URLs for future reference:  
[https://fritshoogland.wordpress.com/2008/02/13/playing-with-asm-disks-on-linux-part-1/](https://fritshoogland.wordpress.com/2008/02/13/playing-with-asm-disks-on-linux-part-1/)  
[http://www.oracle.com/technetwork/server-storage/linux/install-082632.html](http://www.oracle.com/technetwork/server-storage/linux/install-082632.html)  
[http://docs.oracle.com/cd/E11882\_01/server.112/e18951/toc.htm](http://docs.oracle.com/cd/E11882_01/server.112/e18951/toc.htm)

------------------------------------------------------------------------

\[Export of Github issue for
[rear/rear](https://github.com/rear/rear).\]
